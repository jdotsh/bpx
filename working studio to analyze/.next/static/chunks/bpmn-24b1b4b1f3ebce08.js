"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[964],{6490:function(e,t,n){n.d(t,{Z:function(){return pD}});var i,o=n(4723),r=n(8625),a=n(785),s=n(891),c=n(1334),l=n(3231);function p(e,t){var n=this;t=t||1e3,e.on(["render.shape","render.connection"],t,function(e,t){var i=e.type,o=t.element,r=t.gfx,a=t.attrs;if(n.canRender(o))return"render.shape"===i?n.drawShape(r,o,a):n.drawConnection(r,o,a)}),e.on(["render.getShapePath","render.getConnectionPath"],t,function(e,t){if(n.canRender(t))return"render.getShapePath"===e.type?n.getShapePath(t):n.getConnectionPath(t)})}function h(e){return e.flat().join(",").replace(/,?([A-Za-z]),?/g,"$1")}function u(e){return["L",e.x,e.y]}function d(e,t,n){let i=t.x-e.x,o=t.y-e.y,r=n/f(i,o);return{x:e.x+i*r,y:e.y+o*r}}function f(e,t){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2))}function m(e,t,n){(0,a.hj)(t)&&(n=t,t=null),t||(t={});let i=(0,c.Ue)("path",t);return(0,a.hj)(n)&&(i.dataset.cornerRadius=String(n)),g(i,e)}function g(e,t){let n=parseInt(e.dataset.cornerRadius,10)||0;return(0,c.Lj)(e,{d:h(function(e,t){var n;let i=e.length,o=[["M",(n=e[0]).x,n.y]];for(let n=1;n<i;n++){let i=e[n-1],r=e[n],a=e[n+1];if(!a||!t){o.push(u(r));continue}let s=Math.min(t,f(r.x-i.x,r.y-i.y),f(a.x-r.x,a.y-r.y));if(!s){o.push(u(r));continue}let c=d(r,i,s),l=d(r,i,.5*s),p=d(r,a,s),h=d(r,a,.5*s);o.push(u(c)),o.push(["C",l.x,l.y,h.x,h.y,p.x,p.y])}return o}(t,n))}),e}function v(e){return(0,a.hX)(e,function(t){return!(0,a.sE)(e,function(e){return e!==t&&function e(t,n){return n?t===n?n:t.parent?e(t.parent,n):void 0:void 0}(t,e)})})}function y(e,t,n){var i=!n||-1===e.indexOf(t);return i&&e.push(t),i}function b(e,t,n){n=n||0,(0,a.kJ)(e)||(e=[e]),(0,a.Ed)(e,function(e,i){var o=t(e,i,n);(0,a.kJ)(o)&&o.length&&b(o,t,n+1)})}function x(e,t){var n,i,o;return n=!t,i=[],o=[],b(e,function(e,t,r){y(i,e,n);var a=e.children;if(a&&y(o,a,n))return a}),i}function _(e,t){var n,i,o,r;return t=!!t,(0,a.kJ)(e)||(e=[e]),(0,a.Ed)(e,function(e){var a=e;e.waypoints&&!t&&(a=_(e.waypoints,!0));var s=a.x,c=a.y,l=a.height||0,p=a.width||0;(s<n||void 0===n)&&(n=s),(c<i||void 0===i)&&(i=c),(s+p>o||void 0===o)&&(o=s+p),(c+l>r||void 0===r)&&(r=c+l)}),{x:n,y:i,height:r-i,width:o-n}}function w(e,t){var n={};return(0,a.Ed)(e,function(e){var i=e;i.waypoints&&(i=_(i)),!(0,a.hj)(t.y)&&i.x>t.x&&(n[e.id]=e),!(0,a.hj)(t.x)&&i.y>t.y&&(n[e.id]=e),i.x>t.x&&i.y>t.y&&((0,a.hj)(t.width)&&(0,a.hj)(t.height)&&i.width+i.x<t.width+t.x&&i.height+i.y<t.height+t.y?n[e.id]=e:(0,a.hj)(t.width)&&(0,a.hj)(t.height)||(n[e.id]=e))}),n}function E(e){return"waypoints"in e?"connection":"x"in e?"shape":"root"}function S(e){return!!(e&&e.isFrame)}function k(e,t){return(0,a.f0)({},e||{},t||{})}function C(e,t){p.call(this,e,1),this.CONNECTION_STYLE=t.style(["no-fill"],{strokeWidth:5,stroke:"fuchsia"}),this.SHAPE_STYLE=t.style({fill:"white",stroke:"fuchsia",strokeWidth:2}),this.FRAME_STYLE=t.style(["no-fill"],{stroke:"fuchsia",strokeDasharray:4,strokeWidth:2})}function R(e,t){if(!e||!t)return -1;var n=e.indexOf(t);return -1!==n&&e.splice(n,1),n}function P(e,t,n){if(e&&t){"number"!=typeof n&&(n=-1);var i=e.indexOf(t);if(-1!==i){if(i===n||-1===n)return;e.splice(i,1)}-1!==n?e.splice(n,0,t):e.push(t)}}function T(e,t){return e&&t?e.indexOf(t):-1}p.prototype.canRender=function(e){},p.prototype.drawShape=function(e,t){},p.prototype.drawConnection=function(e,t){},p.prototype.getShapePath=function(e){},p.prototype.getConnectionPath=function(e){},(0,o.Z)(C,p),C.prototype.canRender=function(){return!0},C.prototype.drawShape=function(e,t,n){var i=(0,c.Ue)("rect");return(0,c.Lj)(i,{x:0,y:0,width:t.width||0,height:t.height||0}),S(t)?(0,c.Lj)(i,(0,a.f0)({},this.FRAME_STYLE,n||{})):(0,c.Lj)(i,(0,a.f0)({},this.SHAPE_STYLE,n||{})),(0,c.R3)(e,i),i},C.prototype.drawConnection=function(e,t,n){var i=m(t.waypoints,(0,a.f0)({},this.CONNECTION_STYLE,n||{}));return(0,c.R3)(e,i),i},C.prototype.getShapePath=function(e){var t=e.x,n=e.y,i=e.width;return h([["M",t,n],["l",i,0],["l",0,e.height],["l",-i,0],["z"]])},C.prototype.getConnectionPath=function(e){var t,n,i=e.waypoints,o=[];for(t=0;n=i[t];t++)n=n.original||n,o.push([0===t?"M":"L",n.x,n.y]);return h(o)},C.$inject=["eventBus","styles"];var j=n(8661);function D(e,t){return Math.round(e*t)/t}function B(e){return(0,a.hj)(e)?e+"px":e}function M(e,t,n){let i=(0,c.Ue)("g");(0,c.Sh)(i).add(t);let o=void 0!==n?n:e.childNodes.length-1;return e.insertBefore(i,e.childNodes[o]||null),i}let A={shape:["x","y","width","height"],connection:["waypoints"]};function L(e,t,n,i){this._eventBus=t,this._elementRegistry=i,this._graphicsFactory=n,this._rootsIdx=0,this._layers={},this._planes=[],this._rootElement=null,this._focused=!1,this._init(e||{})}function O(e,t){let n="matrix("+t.a+","+t.b+","+t.c+","+t.d+","+t.e+","+t.f+")";e.setAttribute("transform",n)}L.$inject=["config.canvas","eventBus","graphicsFactory","elementRegistry"],L.prototype._init=function(e){let t=this._eventBus,n=this._container=function(e){let t=(e=(0,a.f0)({},{width:"100%",height:"100%"},e)).container||document.body,n=document.createElement("div");return n.setAttribute("class","djs-container djs-parent"),(0,s.i5)(n,{position:"relative",overflow:"hidden",width:B(e.width),height:B(e.height)}),t.appendChild(n),n}(e),i=this._svg=(0,c.Ue)("svg");(0,c.Lj)(i,{width:"100%",height:"100%"}),(0,s.Lj)(i,"tabindex",0),e.autoFocus&&t.on("element.hover",()=>{this.restoreFocus()}),t.on("element.mousedown",500,e=>{this.focus()}),i.addEventListener("focusin",()=>{this._setFocused(!0)}),i.addEventListener("focusout",()=>{this._setFocused(!1)}),(0,c.R3)(n,i);let o=this._viewport=M(i,"viewport");e.deferUpdate&&(this._viewboxChanged=(0,a.Ds)((0,a.ak)(this._viewboxChanged,this),300)),t.on("diagram.init",()=>{t.fire("canvas.init",{svg:i,viewport:o})}),t.on(["shape.added","connection.added","shape.removed","connection.removed","elements.changed","root.set"],()=>{delete this._cachedViewbox}),t.on("diagram.destroy",500,this._destroy,this),t.on("diagram.clear",500,this._clear,this)},L.prototype._destroy=function(){this._eventBus.fire("canvas.destroy",{svg:this._svg,viewport:this._viewport});let e=this._container.parentNode;e&&e.removeChild(this._container),delete this._svg,delete this._container,delete this._layers,delete this._planes,delete this._rootElement,delete this._viewport},L.prototype._setFocused=function(e){e!=this._focused&&(this._focused=e,this._eventBus.fire("canvas.focus.changed",{focused:e}))},L.prototype._clear=function(){this._elementRegistry.getAll().forEach(e=>{let t=E(e);"root"===t?this.removeRootElement(e):this._removeElement(e,t)}),this._planes=[],this._rootElement=null,delete this._cachedViewbox},L.prototype.focus=function(){this._svg.focus({preventScroll:!0}),this._setFocused(!0)},L.prototype.restoreFocus=function(){document.activeElement===document.body&&this.focus()},L.prototype.isFocused=function(){return this._focused},L.prototype.getDefaultLayer=function(){return this.getLayer("base",0)},L.prototype.getLayer=function(e,t){if(!e)throw Error("must specify a name");let n=this._layers[e];if(n||(n=this._layers[e]=this._createLayer(e,t)),void 0!==t&&n.index!==t)throw Error("layer <"+e+"> already created at index <"+t+">");return n.group},L.prototype._getChildIndex=function(e){return(0,a.u4)(this._layers,function(t,n){return n.visible&&e>=n.index&&t++,t},0)},L.prototype._createLayer=function(e,t){void 0===t&&(t=1);let n=this._getChildIndex(t);return{group:M(this._viewport,"layer-"+e,n),index:t,visible:!0}},L.prototype.showLayer=function(e){if(!e)throw Error("must specify a name");let t=this._layers[e];if(!t)throw Error("layer <"+e+"> does not exist");let n=this._viewport,i=t.group,o=t.index;if(t.visible)return i;let r=this._getChildIndex(o);return n.insertBefore(i,n.childNodes[r]||null),t.visible=!0,i},L.prototype.hideLayer=function(e){if(!e)throw Error("must specify a name");let t=this._layers[e];if(!t)throw Error("layer <"+e+"> does not exist");let n=t.group;return t.visible&&((0,c.Od)(n),t.visible=!1),n},L.prototype._removeLayer=function(e){let t=this._layers[e];t&&(delete this._layers[e],(0,c.Od)(t.group))},L.prototype.getActiveLayer=function(){let e=this._findPlaneForRoot(this.getRootElement());return e?e.layer:null},L.prototype.findRoot=function(e){if("string"==typeof e&&(e=this._elementRegistry.get(e)),e)return(this._findPlaneForRoot(function(e){for(;e.parent;)e=e.parent;return e}(e))||{}).rootElement},L.prototype.getRootElements=function(){return this._planes.map(function(e){return e.rootElement})},L.prototype._findPlaneForRoot=function(e){return(0,a.sE)(this._planes,function(t){return t.rootElement===e})},L.prototype.getContainer=function(){return this._container},L.prototype._updateMarker=function(e,t,n){let i;e.id||(e=this._elementRegistry.get(e)),e.markers=e.markers||new Set,(i=this._elementRegistry._elements[e.id])&&((0,a.Ed)([i.gfx,i.secondaryGfx],function(i){i&&(n?(e.markers.add(t),(0,c.Sh)(i).add(t)):(e.markers.delete(t),(0,c.Sh)(i).remove(t)))}),this._eventBus.fire("element.marker.update",{element:e,gfx:i.gfx,marker:t,add:!!n}))},L.prototype.addMarker=function(e,t){this._updateMarker(e,t,!0)},L.prototype.removeMarker=function(e,t){this._updateMarker(e,t,!1)},L.prototype.hasMarker=function(e,t){return e.id||(e=this._elementRegistry.get(e)),!!e.markers&&e.markers.has(t)},L.prototype.toggleMarker=function(e,t){this.hasMarker(e,t)?this.removeMarker(e,t):this.addMarker(e,t)},L.prototype.getRootElement=function(){let e=this._rootElement;return e||this._planes.length?e:this.setRootElement(this.addRootElement(null))},L.prototype.addRootElement=function(e){let t=this._rootsIdx++;e||(e={id:"__implicitroot_"+t,children:[],isImplicit:!0});let n=e.layer="root-"+t;this._ensureValid("root",e);let i=this.getLayer(n,0);return this.hideLayer(n),this._addRoot(e,i),this._planes.push({rootElement:e,layer:i}),e},L.prototype.removeRootElement=function(e){if("string"==typeof e&&(e=this._elementRegistry.get(e)),this._findPlaneForRoot(e))return this._removeRoot(e),this._removeLayer(e.layer),this._planes=this._planes.filter(function(t){return t.rootElement!==e}),this._rootElement===e&&(this._rootElement=null),e},L.prototype.setRootElement=function(e){if(e===this._rootElement)return e;if(!e)throw Error("rootElement required");return this._findPlaneForRoot(e)||(e=this.addRootElement(e)),this._setRoot(e),e},L.prototype._removeRoot=function(e){let t=this._elementRegistry,n=this._eventBus;n.fire("root.remove",{element:e}),n.fire("root.removed",{element:e}),t.remove(e)},L.prototype._addRoot=function(e,t){let n=this._elementRegistry,i=this._eventBus;i.fire("root.add",{element:e}),n.add(e,t),i.fire("root.added",{element:e,gfx:t})},L.prototype._setRoot=function(e,t){let n=this._rootElement;n&&(this._elementRegistry.updateGraphics(n,null,!0),this.hideLayer(n.layer)),e&&(t||(t=this._findPlaneForRoot(e).layer),this._elementRegistry.updateGraphics(e,this._svg,!0),this.showLayer(e.layer)),this._rootElement=e,this._eventBus.fire("root.set",{element:e})},L.prototype._ensureValid=function(e,t){if(!t.id)throw Error("element must have an id");if(this._elementRegistry.get(t.id))throw Error("element <"+t.id+"> already exists");let n=A[e];if(!(0,a.yW)(n,function(e){return void 0!==t[e]}))throw Error("must supply { "+n.join(", ")+" } with "+e)},L.prototype._setParent=function(e,t,n){P(t.children,e,n),e.parent=t},L.prototype._addElement=function(e,t,n,i){n=n||this.getRootElement();let o=this._eventBus,r=this._graphicsFactory;this._ensureValid(e,t),o.fire(e+".add",{element:t,parent:n}),this._setParent(t,n,i);let a=r.create(e,t,i);return this._elementRegistry.add(t,a),r.update(e,t,a),o.fire(e+".added",{element:t,gfx:a}),t},L.prototype.addShape=function(e,t,n){return this._addElement("shape",e,t,n)},L.prototype.addConnection=function(e,t,n){return this._addElement("connection",e,t,n)},L.prototype._removeElement=function(e,t){let n=this._elementRegistry,i=this._graphicsFactory,o=this._eventBus;if(e=n.get(e.id||e))return o.fire(t+".remove",{element:e}),i.remove(e),R(e.parent&&e.parent.children,e),e.parent=null,o.fire(t+".removed",{element:e}),n.remove(e),e},L.prototype.removeShape=function(e){return this._removeElement(e,"shape")},L.prototype.removeConnection=function(e){return this._removeElement(e,"connection")},L.prototype.getGraphics=function(e,t){return this._elementRegistry.getGraphics(e,t)},L.prototype._changeViewbox=function(e){this._eventBus.fire("canvas.viewbox.changing"),e.apply(this),this._cachedViewbox=null,this._viewboxChanged()},L.prototype._viewboxChanged=function(){this._eventBus.fire("canvas.viewbox.changed",{viewbox:this.viewbox()})},L.prototype.viewbox=function(e){let t,n,i,o,r,a,s;if(void 0===e&&this._cachedViewbox)return structuredClone(this._cachedViewbox);let l=this._viewport,p=this.getSize();return e?this._changeViewbox(function(){r=Math.min(p.width/e.width,p.height/e.height);let t=this._svg.createSVGMatrix().scale(r).translate(-e.x,-e.y);(0,c.vs)(l,t)}):(t=(i=this._rootElement?this.getActiveLayer():null)&&i.getBBox()||{},r=D((n=(o=(0,c.vs)(l))?o.matrix:(0,c.wz)()).a,1e3),a=D(-n.e||0,1e3),s=D(-n.f||0,1e3),e=this._cachedViewbox={x:a?a/r:0,y:s?s/r:0,width:p.width/r,height:p.height/r,scale:r,inner:{width:t.width||0,height:t.height||0,x:t.x||0,y:t.y||0},outer:p}),e},L.prototype.scroll=function(e){let t=this._viewport,n=t.getCTM();return e&&this._changeViewbox(function(){e=(0,a.f0)({dx:0,dy:0},e||{}),O(t,n=this._svg.createSVGMatrix().translate(e.dx,e.dy).multiply(n))}),{x:n.e,y:n.f}},L.prototype.scrollToElement=function(e,t){let n,i,o=100;"string"==typeof e&&(e=this._elementRegistry.get(e));let r=this.findRoot(e);if(r!==this.getRootElement()&&this.setRootElement(r),r===e)return;t||(t={}),"number"==typeof t&&(o=t),t={top:t.top||o,right:t.right||o,bottom:t.bottom||o,left:t.left||o};let a=_(e),s=(0,j.JA)(a),c=this.viewbox(),l=this.zoom();c.y+=t.top/l,c.x+=t.left/l,c.width-=(t.right+t.left)/l,c.height-=(t.bottom+t.top)/l;let p=(0,j.JA)(c);if(a.width<c.width&&a.height<c.height){let e=Math.max(0,s.right-p.right),t=Math.min(0,s.left-p.left),o=Math.max(0,s.bottom-p.bottom),r=Math.min(0,s.top-p.top);n=e||t,i=o||r}else n=a.x-c.x,i=a.y-c.y;this.scroll({dx:-n*l,dy:-i*l})},L.prototype.zoom=function(e,t){let n,i;return e?"fit-viewport"===e?this._fitViewport(t):(this._changeViewbox(function(){"object"!=typeof t&&(t={x:(n=this.viewbox().outer).width/2,y:n.height/2}),i=this._setZoom(e,t)}),D(i.a,1e3)):this.viewbox(e).scale},L.prototype._fitViewport=function(e){let t,n;let i=this.viewbox(),o=i.outer,r=i.inner;return r.x>=0&&r.y>=0&&r.x+r.width<=o.width&&r.y+r.height<=o.height&&!e?n={x:0,y:0,width:Math.max(r.width+r.x,o.width),height:Math.max(r.height+r.y,o.height)}:(t=Math.min(1,o.width/r.width,o.height/r.height),n={x:r.x+(e?r.width/2-o.width/t/2:0),y:r.y+(e?r.height/2-o.height/t/2:0),width:o.width/t,height:o.height/t}),this.viewbox(n),this.viewbox(!1).scale},L.prototype._setZoom=function(e,t){let n,i,o,r;let s=this._svg,c=this._viewport,l=s.createSVGMatrix(),p=s.createSVGPoint(),h=(i=c.getCTM()).a;return t?(n=(0,a.f0)(p,t).matrixTransform(i.inverse()),o=l.translate(n.x,n.y).scale(1/h*e).translate(-n.x,-n.y),r=i.multiply(o)):r=l.scale(e),O(this._viewport,r),r},L.prototype.getSize=function(){return{width:this._container.clientWidth,height:this._container.clientHeight}},L.prototype.getAbsoluteBBox=function(e){let t;let n=this.viewbox(),i=(t=e.waypoints?this.getGraphics(e).getBBox():e).x*n.scale-n.x*n.scale;return{x:i,y:t.y*n.scale-n.y*n.scale,width:t.width*n.scale,height:t.height*n.scale}},L.prototype.resized=function(){delete this._cachedViewbox,this._eventBus.fire("canvas.resized")};var N="data-element-id";function $(e){this._elements={},this._eventBus=e}$.$inject=["eventBus"],$.prototype.add=function(e,t,n){var i=e.id;this._validateId(i),(0,c.Lj)(t,N,i),n&&(0,c.Lj)(n,N,i),this._elements[i]={element:e,gfx:t,secondaryGfx:n}},$.prototype.remove=function(e){var t=this._elements,n=e.id||e,i=n&&t[n];i&&((0,c.Lj)(i.gfx,N,""),i.secondaryGfx&&(0,c.Lj)(i.secondaryGfx,N,""),delete t[n])},$.prototype.updateId=function(e,t){this._validateId(t),"string"==typeof e&&(e=this.get(e)),this._eventBus.fire("element.updateId",{element:e,newId:t});var n=this.getGraphics(e),i=this.getGraphics(e,!0);this.remove(e),e.id=t,this.add(e,n,i)},$.prototype.updateGraphics=function(e,t,n){var i=e.id||e,o=this._elements[i];return n?o.secondaryGfx=t:o.gfx=t,t&&(0,c.Lj)(t,N,i),t},$.prototype.get=function(e){t="string"==typeof e?e:e&&(0,c.Lj)(e,N);var t,n=this._elements[t];return n&&n.element},$.prototype.filter=function(e){var t=[];return this.forEach(function(n,i){e(n,i)&&t.push(n)}),t},$.prototype.find=function(e){for(var t=this._elements,n=Object.keys(t),i=0;i<n.length;i++){var o=t[n[i]],r=o.element;if(e(r,o.gfx))return r}},$.prototype.getAll=function(){return this.filter(function(e){return e})},$.prototype.forEach=function(e){var t=this._elements;Object.keys(t).forEach(function(n){var i=t[n];return e(i.element,i.gfx)})},$.prototype.getGraphics=function(e,t){var n=e.id||e,i=this._elements[n];return i&&(t?i.secondaryGfx:i.gfx)},$.prototype._validateId=function(e){if(!e)throw Error("element must have an id");if(this._elements[e])throw Error("element with id "+e+" already added")};var I=n(6070),z=new I.g({name:"children",enumerable:!0,collection:!0},{name:"parent"}),H=new I.g({name:"labels",enumerable:!0,collection:!0},{name:"labelTarget"}),F=new I.g({name:"attachers",collection:!0},{name:"host"}),G=new I.g({name:"outgoing",collection:!0},{name:"source"}),W=new I.g({name:"incoming",collection:!0},{name:"target"});function V(){Object.defineProperty(this,"businessObject",{writable:!0}),Object.defineProperty(this,"label",{get:function(){return this.labels[0]},set:function(e){var t=this.label,n=this.labels;!e&&t?n.remove(t):n.add(e,0)}}),z.bind(this,"parent"),H.bind(this,"labels"),G.bind(this,"outgoing"),W.bind(this,"incoming")}function U(){V.call(this),z.bind(this,"children"),F.bind(this,"host"),F.bind(this,"attachers")}function Z(){V.call(this),z.bind(this,"children")}function K(){U.call(this),H.bind(this,"labelTarget")}function J(){V.call(this),G.bind(this,"source"),W.bind(this,"target")}(0,o.Z)(U,V),(0,o.Z)(Z,U),(0,o.Z)(K,U),(0,o.Z)(J,V);var q={connection:J,shape:U,label:K,root:Z};function X(){this._uid=12}X.prototype.createRoot=function(e){return this.create("root",e)},X.prototype.createLabel=function(e){return this.create("label",e)},X.prototype.createShape=function(e){return this.create("shape",e)},X.prototype.createConnection=function(e){return this.create("connection",e)},X.prototype.create=function(e,t){return(t=(0,a.f0)({},t||{})).id||(t.id=e+"_"+this._uid++),function(e,t){var n=q[e];if(!n)throw Error("unknown type: <"+e+">");return(0,a.f0)(new n,t)}(e,t)};var Y="__fn",Q=Array.prototype.slice;function ee(){this._listeners={},this.on("diagram.destroy",1,this._destroy,this)}function et(){}ee.prototype.on=function(e,t,n,i){if(e=(0,a.kJ)(e)?e:[e],(0,a.mf)(t)&&(i=n,n=t,t=1e3),!(0,a.hj)(t))throw Error("priority must be a number");var o=n;i&&((o=(0,a.ak)(n,i))[Y]=n[Y]||n);var r=this;e.forEach(function(e){r._addListener(e,{priority:t,callback:o,next:null})})},ee.prototype.once=function(e,t,n,i){var o=this;if((0,a.mf)(t)&&(i=n,n=t,t=1e3),!(0,a.hj)(t))throw Error("priority must be a number");function r(){r.__isTomb=!0;var t=n.apply(i,arguments);return o.off(e,r),t}r[Y]=n,this.on(e,t,r)},ee.prototype.off=function(e,t){e=(0,a.kJ)(e)?e:[e];var n=this;e.forEach(function(e){n._removeListener(e,t)})},ee.prototype.createEvent=function(e){var t=new et;return t.init(e),t},ee.prototype.fire=function(e,t){if(r=Q.call(arguments),"object"==typeof e&&(e=(t=e).type),!e)throw Error("no event type specified");if(i=this._listeners[e]){n=t instanceof et?t:this.createEvent(t),r[0]=n;var n,i,o,r,a=n.type;e!==a&&(n.type=e);try{o=this._invokeListeners(n,r,i)}finally{e!==a&&(n.type=a)}return void 0===o&&n.defaultPrevented&&(o=!1),o}},ee.prototype.handleError=function(e){return!1===this.fire("error",{error:e})},ee.prototype._destroy=function(){this._listeners={}},ee.prototype._invokeListeners=function(e,t,n){for(var i;n&&!e.cancelBubble;)i=this._invokeListener(e,t,n),n=n.next;return i},ee.prototype._invokeListener=function(e,t,n){var i;if(n.callback.__isTomb)return i;try{i=n.callback.apply(null,t),void 0!==i&&(e.returnValue=i,e.stopPropagation()),!1===i&&e.preventDefault()}catch(e){if(!this.handleError(e))throw console.error("unhandled error in event listener",e),e}return i},ee.prototype._addListener=function(e,t){var n,i=this._getListeners(e);if(!i){this._setListeners(e,t);return}for(;i;){if(i.priority<t.priority){t.next=i,n?n.next=t:this._setListeners(e,t);return}n=i,i=i.next}n.next=t},ee.prototype._getListeners=function(e){return this._listeners[e]},ee.prototype._setListeners=function(e,t){this._listeners[e]=t},ee.prototype._removeListener=function(e,t){var n,i,o,r=this._getListeners(e);if(!t){this._setListeners(e,null);return}for(;r;)n=r.next,((o=r.callback)===t||o[Y]===t)&&(i?i.next=n:this._setListeners(e,n)),i=r,r=n},et.prototype.stopPropagation=function(){this.cancelBubble=!0},et.prototype.preventDefault=function(){this.defaultPrevented=!0},et.prototype.init=function(e){(0,a.f0)(this,e||{})};var en=n(2722);function ei(e,t,n,i,o){var r=(0,c.pH)();r.setTranslate(t,n);var a=(0,c.pH)();a.setRotate(i||0,0,0);var s=(0,c.pH)();s.setScale(o||1,o||1),(0,c.vs)(e,[r,a,s])}function eo(e,t,n){var i=(0,c.pH)();i.setTranslate(t,n),(0,c.vs)(e,i)}function er(e,t){var n=(0,c.pH)();n.setRotate(t,0,0),(0,c.vs)(e,n)}function ea(e,t){this._eventBus=e,this._elementRegistry=t}function es(e,t,n){var i=n||t.firstChild;e!==i&&t.insertBefore(e,i)}ea.$inject=["eventBus","elementRegistry"],ea.prototype._getChildrenContainer=function(e){var t,n=this._elementRegistry.getGraphics(e);return e.parent?(t=(0,en.G)(n))||(t=(0,c.Ue)("g"),(0,c.Sh)(t).add("djs-children"),(0,c.R3)(n.parentNode,t)):t=n,t},ea.prototype._clear=function(e){var t=(0,en.s)(e);return(0,s.ZH)(t),t},ea.prototype._createContainer=function(e,t,n,i){var o=(0,c.Ue)("g");(0,c.Sh)(o).add("djs-group"),void 0!==n?es(o,t,t.childNodes[n]):(0,c.R3)(t,o);var r=(0,c.Ue)("g");(0,c.Sh)(r).add("djs-element"),(0,c.Sh)(r).add("djs-"+e),i&&(0,c.Sh)(r).add("djs-frame"),(0,c.R3)(o,r);var a=(0,c.Ue)("g");return(0,c.Sh)(a).add("djs-visual"),(0,c.R3)(r,a),r},ea.prototype.create=function(e,t,n){var i=this._getChildrenContainer(t.parent);return this._createContainer(e,i,n,S(t))},ea.prototype.updateContainments=function(e){var t,n=this,i=this._elementRegistry;t=(0,a.u4)(e,function(e,t){return t.parent&&(e[t.parent.id]=t.parent),e},{}),(0,a.Ed)(t,function(e){var t=e.children;if(t){var o=n._getChildrenContainer(e);(0,a.Ed)(t.slice().reverse(),function(e){es(i.getGraphics(e).parentNode,o)})}})},ea.prototype.drawShape=function(e,t,n={}){return this._eventBus.fire("render.shape",{gfx:e,element:t,attrs:n})},ea.prototype.getShapePath=function(e){return this._eventBus.fire("render.getShapePath",e)},ea.prototype.drawConnection=function(e,t,n={}){return this._eventBus.fire("render.connection",{gfx:e,element:t,attrs:n})},ea.prototype.getConnectionPath=function(e){return this._eventBus.fire("render.getConnectionPath",e)},ea.prototype.update=function(e,t,n){if(t.parent){var i=this._clear(n);if("shape"===e)this.drawShape(i,t),eo(n,t.x,t.y);else if("connection"===e)this.drawConnection(i,t);else throw Error("unknown type: "+e);t.hidden?(0,c.Lj)(n,"display","none"):(0,c.Lj)(n,"display","block")}},ea.prototype.remove=function(e){var t=this._elementRegistry.getGraphics(e);(0,c.Od)(t.parentNode)};var ec={__depends__:[{__init__:["defaultRenderer"],defaultRenderer:["type",C],styles:["type",function(){var e={"no-fill":{fill:"none"},"no-border":{strokeOpacity:0},"no-events":{pointerEvents:"none"}},t=this;this.cls=function(e,t,n){var i=this.style(t,n);return(0,a.f0)(i,{class:e})},this.style=function(t,n){(0,a.kJ)(t)||n||(n=t,t=[]);var i=(0,a.u4)(t,function(t,n){return(0,a.f0)(t,e[n]||{})},{});return n?(0,a.f0)(i,n):i},this.computeStyle=function(e,n,i){return(0,a.kJ)(n)||(i=n,n=[]),t.style(n||[],(0,a.f0)({},i,e||{}))}}]}],__init__:["canvas"],canvas:["type",L],elementRegistry:["type",$],elementFactory:["type",X],eventBus:["type",ee],graphicsFactory:["type",ea]};function el(e,t){var n,i,o;this._injector=t||(i=[{config:["value",n=(n=e)||{}]},ec].concat(n.modules||[]),(o=new l.zs(i)).init(),o),this.get("eventBus").fire("diagram.init")}el.prototype.get=function(e,t){return this._injector.get(e,t)},el.prototype.invoke=function(e,t,n){return this._injector.invoke(e,t,n)},el.prototype.destroy=function(){this.get("eventBus").fire("diagram.destroy")},el.prototype.clear=function(){this.get("eventBus").fire("diagram.clear")};var ep=n(1817);function eh(e){return e?"<"+e.$type+(e.id?' id="'+e.id:"")+'" />':"<null>"}function eu(e){(0,a.e$)(e,"di")||Object.defineProperty(e,"di",{enumerable:!1,get:function(){throw Error("Tried to access di from the businessObject. The di is available through the diagram element only. For more information, see https://github.com/bpmn-io/bpmn-js/issues/1472")}})}function ed(e,t){return e.$instanceOf(t)}function ef(e){var t={},n=[],i={};function o(e,t){return function(n){e(n,t)}}function r(n,o){try{var r=i[n.id]&&function(t,n){if(t.gfx)throw Error(`already rendered ${eh(t)}`);return e.element(t,i[t.id],n)}(n,o);return t[n.id]=n,r}catch(e){s(e.message,{element:n,error:e}),console.error(`failed to import ${eh(n)}`,e)}}function s(t,n){e.error(t,n)}var c=this.registerDi=function(e){var t=e.bpmnElement;t?i[t.id]?s(`multiple DI elements defined for ${eh(t)}`,{element:t}):(i[t.id]=e,eu(t)):s(`no bpmnElement referenced in ${eh(e)}`,{element:e})};function l(e){c(e)}this.handleDefinitions=function(r,d){var f,m,v,y=r.diagrams;if(d&&-1===y.indexOf(d))throw Error("diagram not part of <bpmn:Definitions />");if(!d&&y&&y.length&&(d=y[0]),!d)throw Error("no diagram to display");i={},c(f=d.plane),(0,a.Ed)(f.planeElement,l);var b=d.plane;if(!b)throw Error(`no plane for ${eh(d)}`);var x=b.bpmnElement;if(!x){if(x=(0,a.sE)(r.rootElements,function(e){return ed(e,"bpmn:Process")||ed(e,"bpmn:Collaboration")}))s(`correcting missing bpmnElement on ${eh(b)} to ${eh(x)}`),b.bpmnElement=x,c(b);else throw Error("no process or collaboration to display")}var _=(v=x,e.root(v,i[v.id],b));if(ed(x,"bpmn:Process")||ed(x,"bpmn:SubProcess"))h(x,_);else if(ed(x,"bpmn:Collaboration"))m=x,(0,a.Ed)(m.participants,o(E,_)),n.push(function(){var e;e=m.messageFlows,(0,a.Ed)(e,o(u,_))}),g(m.artifacts,_),function(e,n){(0,a.hX)(e,function(e){return!t[e.id]&&ed(e,"bpmn:Process")&&e.laneSets}).forEach(o(h,n))}(r.rootElements,_);else throw Error(`unsupported bpmnElement for ${eh(b)}: ${eh(x)}`);p(n)};var p=this.handleDeferred=function(){for(;n.length;)n.shift()()};function h(e,n){w(e,n),v(e.ioSpecification,n),g(e.artifacts,n),t[e.id]=e}function u(e,t){r(e,t)}function d(e,t){r(e,t)}function f(e,t){r(e,t)}function m(e,t){r(e,t)}function g(e,t){(0,a.Ed)(e,function(e){ed(e,"bpmn:Association")?n.push(function(){r(e,t)}):r(e,t)})}function v(e,t){e&&((0,a.Ed)(e.dataInputs,o(f,t)),(0,a.Ed)(e.dataOutputs,o(m,t)))}var y=this.handleSubProcess=function(e,t){w(e,t),g(e.artifacts,t)};function b(e,t){var i=r(e,t);ed(e,"bpmn:SubProcess")&&y(e,i||t),ed(e,"bpmn:Activity")&&v(e.ioSpecification,t),n.push(function(){(0,a.Ed)(e.dataInputAssociations,o(d,t)),(0,a.Ed)(e.dataOutputAssociations,o(d,t))})}function x(e,t){n.push(function(){var n=r(e,t);e.childLaneSet&&_(e.childLaneSet,n||t),(0,a.Ed)(e.flowNodeRef,function(t){var n=t.get("lanes");n&&n.push(e)})})}function _(e,t){(0,a.Ed)(e.lanes,o(x,t))}function w(e,t){var i,c;i=e.flowElements,(0,a.Ed)(i,function(e){ed(e,"bpmn:SequenceFlow")?n.push(function(){r(e,t)}):ed(e,"bpmn:BoundaryEvent")?n.unshift(function(){b(e,t)}):ed(e,"bpmn:FlowNode")?b(e,t):ed(e,"bpmn:DataObject")||(ed(e,"bpmn:DataStoreReference")?r(e,t):ed(e,"bpmn:DataObjectReference")?r(e,t):s(`unrecognized flowElement ${eh(e)} in context ${eh(t&&t.businessObject)}`,{element:e,context:t}))}),e.laneSets&&(c=e.laneSets,(0,a.Ed)(c,o(_,t)))}function E(e,t){var n=r(e,t),i=e.processRef;i&&h(i,n||t)}}function em(e,t){var n=ev(e);return n&&"function"==typeof n.$instanceOf&&n.$instanceOf(t)}function eg(e,t){return(0,a.G)(t,function(t){return em(e,t)})}function ev(e){return e&&e.businessObject||e}function ey(e){return e&&e.di}var eb='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14.02 5.57" width="53" height="21"><path fill="currentColor" d="M1.88.92v.14c0 .41-.13.68-.4.8.33.14.46.44.46.86v.33c0 .61-.33.95-.95.95H0V0h.95c.65 0 .93.3.93.92zM.63.57v1.06h.24c.24 0 .38-.1.38-.43V.98c0-.28-.1-.4-.32-.4zm0 1.63v1.22h.36c.2 0 .32-.1.32-.39v-.35c0-.37-.12-.48-.4-.48H.63zM4.18.99v.52c0 .64-.31.98-.94.98h-.3V4h-.62V0h.92c.63 0 .94.35.94.99zM2.94.57v1.35h.3c.2 0 .3-.09.3-.37v-.6c0-.29-.1-.38-.3-.38h-.3zm2.89 2.27L6.25 0h.88v4h-.6V1.12L6.1 3.99h-.6l-.46-2.82v2.82h-.55V0h.87zM8.14 1.1V4h-.56V0h.79L9 2.4V0h.56v4h-.64zm2.49 2.29v.6h-.6v-.6zM12.12 1c0-.63.33-1 .95-1 .61 0 .95.37.95 1v2.04c0 .64-.34 1-.95 1-.62 0-.95-.37-.95-1zm.62 2.08c0 .28.13.39.33.39s.32-.1.32-.4V.98c0-.29-.12-.4-.32-.4s-.33.11-.33.4z"/><path fill="currentColor" d="M0 4.53h14.02v1.04H0zM11.08 0h.63v.62h-.63zm.63 4V1h-.63v2.98z"/></svg>',ex={verticalAlign:"middle"},e_={color:"#404040"},ew={zIndex:"1001",position:"fixed",top:"0",left:"0",right:"0",bottom:"0"},eE={width:"100%",height:"100%",background:"rgba(40,40,40,0.2)"},eS={position:"absolute",left:"50%",top:"40%",transform:"translate(-50%)",width:"260px",padding:"10px",background:"white",boxShadow:"0 1px 4px rgba(0,0,0,0.3)",fontFamily:"Helvetica, Arial, sans-serif",fontSize:"14px",display:"flex",lineHeight:"1.3"},ek='<div class="bjs-powered-by-lightbox"><div class="backdrop"></div><div class="notice"><a href="https://bpmn.io" target="_blank" rel="noopener" class="link">'+eb+'</a><span>Web-based tooling for BPMN, DMN and forms powered by <a href="https://bpmn.io" target="_blank" rel="noopener">bpmn.io</a>.</span></div></div>';function eC(e){e=(0,a.f0)({},eP,e),this._moddle=this._createModdle(e),this._container=this._createContainer(e),this._init(this._container,this._moddle,e),function(e){let t=(0,s.H6)('<a href="http://bpmn.io" target="_blank" class="bjs-powered-by" title="Powered by bpmn.io" >'+eb+"</a>");(0,s.i5)((0,s.IO)("svg",t),ex),(0,s.i5)(t,e_,{position:"absolute",bottom:"15px",right:"15px",zIndex:"100"}),e.appendChild(t),s.B.bind(t,"click",function(e){i||(i=(0,s.H6)(ek),(0,s.i5)(i,ew),(0,s.i5)((0,s.IO)("svg",i),ex),(0,s.i5)((0,s.IO)(".backdrop",i),eE),(0,s.i5)((0,s.IO)(".notice",i),eS),(0,s.i5)((0,s.IO)(".link",i),e_,{margin:"15px 20px 15px 10px",alignSelf:"center"}),s.cl.bind(i,".backdrop","click",function(e){document.body.removeChild(i)})),document.body.appendChild(i),e.preventDefault()})}(this._container)}function eR(e,t){return e.warnings=t,e}(0,o.Z)(eC,el),eC.prototype.importXML=async function(e,t){let n=[];try{var i;let o;e=this._emit("import.parse.start",{xml:e})||e;try{o=await this._moddle.fromXML(e,"bpmn:Definitions")}catch(e){throw this._emit("import.parse.complete",{error:e}),e}let r=o.rootElement,a=o.references,s=o.warnings,c=o.elementsById;n=n.concat(s),r=this._emit("import.parse.complete",(i={error:null,definitions:r,elementsById:c,references:a,warnings:n},this.get("eventBus").createEvent(i)))||r;let l=await this.importDefinitions(r,t);return n=n.concat(l.warnings),this._emit("import.done",{error:null,warnings:n}),{warnings:n}}catch(t){let e=t;throw n=n.concat(e.warnings||[]),eR(e,n),e=function(e){let t=/unparsable content <([^>]+)> detected([\s\S]*)$/.exec(e.message);return t&&(e.message="unparsable content <"+t[1]+"> detected; this may indicate an invalid BPMN 2.0 diagram file"+t[2]),e}(e),this._emit("import.done",{error:e,warnings:e.warnings}),e}},eC.prototype.importDefinitions=async function(e,t){return this._setDefinitions(e),{warnings:(await this.open(t)).warnings}},eC.prototype.open=async function(e){var t,n,i,o,r,s,c;let l=this._definitions,p=e;if(!l){let e=Error("no XML imported");throw eR(e,[]),e}if("string"==typeof e&&!(p=e&&(0,a.sE)(l.diagrams,function(t){return t.id===e})||null)){let t=Error("BPMNDiagram <"+e+"> not found");throw eR(t,[]),t}try{this.clear()}catch(e){throw eR(e,[]),e}let{warnings:h}=await (t=this,n=p,c=[],new Promise(function(e,p){try{return i=t.get("bpmnImporter"),o=t.get("eventBus"),r=t.get("canvas"),o.fire("import.render.start",{definitions:l}),function(e,t){var n=new ef({root:function(e,t){return i.add(e,t)},element:function(e,t,n){return i.add(e,t,n)},error:function(e,t){c.push({message:e,context:t})}});t=t||e.diagrams&&e.diagrams[0];var o=function(e,t){if(t&&t.plane){var n,i=t.plane.bpmnElement,o=i;em(i,"bpmn:Process")||em(i,"bpmn:Collaboration")||(o=function(e){for(var t=e;t;){if(em(t,"bpmn:Process"))return t;t=t.$parent}}(i)),n=em(o,"bpmn:Collaboration")?o:(0,a.sE)(e.rootElements,function(e){if(em(e,"bpmn:Collaboration"))return(0,a.sE)(e.participants,function(e){return e.processRef===o})});var r=[o];n&&(r=(0,a.UI)(n.participants,function(e){return e.processRef})).push(n);var s=function e(t){var n=[];return(0,a.Ed)(t,function(t){t&&(n.push(t),n=n.concat(e(t.flowElements)))}),n}(r),c=[t],l=[i];return(0,a.Ed)(e.diagrams,function(e){if(e.plane){var t=e.plane.bpmnElement;-1!==s.indexOf(t)&&-1===l.indexOf(t)&&(c.push(e),l.push(t))}}),c}}(e,t);if(!o)throw Error("no diagram to display");(0,a.Ed)(o,function(t){n.handleDefinitions(e,t)});var s=t.plane.bpmnElement.id;r.setRootElement(r.findRoot(s+"_plane")||r.findRoot(s))}(l,n),o.fire("import.render.complete",{error:s,warnings:c}),e({warnings:c})}catch(e){return e.warnings=c,p(e)}}));return{warnings:h}},eC.prototype.saveXML=async function(e){e=e||{};let t=this._definitions,n,i;try{if(!t)throw Error("no definitions loaded");t=this._emit("saveXML.start",{definitions:t})||t,i=(await this._moddle.toXML(t,e)).xml,i=this._emit("saveXML.serialized",{xml:i})||i}catch(e){n=e}let o=n?{error:n}:{xml:i};if(this._emit("saveXML.done",o),n)throw n;return o},eC.prototype.saveSVG=async function(){let e,t;this._emit("saveSVG.start");try{let t=this.get("canvas"),n=t.getActiveLayer(),i=(0,s.IO)(":scope > defs",t._svg),o=(0,c.db)(n),r=i?"<defs>"+(0,c.db)(i)+"</defs>":"",a=n.getBBox();e='<?xml version="1.0" encoding="utf-8"?>\n<!-- created with bpmn-js / http://bpmn.io -->\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+a.width+'" height="'+a.height+'" viewBox="'+a.x+" "+a.y+" "+a.width+" "+a.height+'" version="1.1">'+r+o+"</svg>"}catch(e){t=e}if(this._emit("saveSVG.done",{error:t,svg:e}),t)throw t;return{svg:e}},eC.prototype._setDefinitions=function(e){this._definitions=e},eC.prototype.getModules=function(){return this._modules},eC.prototype.clear=function(){this.getDefinitions()&&el.prototype.clear.call(this)},eC.prototype.destroy=function(){el.prototype.destroy.call(this),(0,s.Od)(this._container)},eC.prototype.on=function(e,t,n,i){return this.get("eventBus").on(e,t,n,i)},eC.prototype.off=function(e,t){this.get("eventBus").off(e,t)},eC.prototype.attachTo=function(e){if(!e)throw Error("parentNode required");this.detach(),e.get&&e.constructor.prototype.jquery&&(e=e.get(0)),"string"==typeof e&&(e=(0,s.IO)(e)),e.appendChild(this._container),this._emit("attach",{}),this.get("canvas").resized()},eC.prototype.getDefinitions=function(){return this._definitions},eC.prototype.detach=function(){let e=this._container,t=e.parentNode;t&&(this._emit("detach",{}),t.removeChild(e))},eC.prototype._init=function(e,t,n){let i=[].concat([{bpmnjs:["value",this],moddle:["value",t]}],n.modules||this.getModules(n),n.additionalModules||[]),o=(0,a.f0)((0,a.CE)(n,["additionalModules"]),{canvas:(0,a.f0)({},n.canvas,{container:e}),modules:i});el.call(this,o),n&&n.container&&this.attachTo(n.container)},eC.prototype._emit=function(e,t){return this.get("eventBus").fire(e,t)},eC.prototype._createContainer=function(e){let t=(0,s.H6)('<div class="bjs-container"></div>');return(0,s.i5)(t,{width:eT(e.width),height:eT(e.height),position:e.position}),t},eC.prototype._createModdle=function(e){let t=(0,a.f0)({},this._moddleExtensions,e.moddleExtensions);return new ep.Z(t)},eC.prototype._modules=[];let eP={width:"100%",height:"100%",position:"relative"};function eT(e){return e+((0,a.hj)(e)?"px":"")}function ej(e){eC.call(this,e),this.on("import.parse.complete",function(e){e.error||this._collectIds(e.definitions,e.elementsById)},this),this.on("diagram.destroy",function(){this.get("moddle").ids.clear()},this)}function eD(e,t){return!em(e,"bpmn:CallActivity")&&(em(e,"bpmn:SubProcess")?!!((t=t||ey(e))&&em(t,"bpmndi:BPMNPlane"))||t&&!!t.isExpanded:!em(e,"bpmn:Participant")||!!ev(e).processRef)}function eB(e){if(em(e,"bpmn:Participant")||em(e,"bpmn:Lane")){var t=ey(e).isHorizontal;return void 0===t||t}}function eM(e){return e&&!!ev(e).triggeredByEvent}function eA(e,t){var n=ev(e).eventDefinitions;return(0,a.G)(n,function(e){return em(e,t)})}(0,o.Z)(ej,eC),ej.prototype._createModdle=function(e){var t=eC.prototype._createModdle.call(this,e);return t.ids=new r.Z([32,36,1]),t},ej.prototype._collectIds=function(e,t){var n,i=e.$model.ids;for(n in i.clear(),t)i.claim(n,t[n])};var eL=n(4554),eO={width:90,height:20};function eN(e){return em(e,"bpmn:Event")||em(e,"bpmn:Gateway")||em(e,"bpmn:DataStoreReference")||em(e,"bpmn:DataObjectReference")||em(e,"bpmn:DataInput")||em(e,"bpmn:DataOutput")||em(e,"bpmn:SequenceFlow")||em(e,"bpmn:MessageFlow")||em(e,"bpmn:Group")}function e$(e){return(0,eL.j_)(e.label)}function eI(e){if(e.waypoints){var t,n,i,o,r,a,s,c,l,p,h;return n=(t=e.waypoints).length/2-1,i=t[Math.floor(n)],o=t[Math.ceil(n+.01)],l=t.length/2-1,p=t[Math.floor(l)],h=t[Math.ceil(l+.01)],r={x:p.x+(h.x-p.x)/2,y:p.y+(h.y-p.y)/2},a=Math.atan((o.y-i.y)/(o.x-i.x)),s=r.x,c=r.y,Math.abs(a)<Math.PI/2?c-=15:s+=15,{x:s,y:c}}return em(e,"bpmn:Group")?{x:e.x+e.width/2,y:e.y+eO.height/2}:{x:e.x+e.width/2,y:e.y+e.height+eO.height/2}}function ez(e){return em(e,"bpmn:FlowElement")||em(e,"bpmn:Participant")||em(e,"bpmn:Lane")||em(e,"bpmn:SequenceFlow")||em(e,"bpmn:MessageFlow")||em(e,"bpmn:DataInput")||em(e,"bpmn:DataOutput")?"name":em(e,"bpmn:TextAnnotation")?"text":em(e,"bpmn:Group")?"categoryValueRef":void 0}function eH(e){var t,n=e.businessObject,i=ez(n);if(i)return"categoryValueRef"===i?(t=n.categoryValueRef)&&t.value||"":n[i]||""}var eF="hsl(225, 10%, 15%)";function eG(e,t){return(0,a.G)(e.eventDefinitions,function(e){return e.$type===t})}function eW(e,t,n){var i=ey(e);return n||i.get("color:background-color")||i.get("bioc:fill")||t||"white"}function eV(e,t,n){var i=ey(e);return n||i.get("color:border-color")||i.get("bioc:stroke")||t||eF}function eU(e,t,n,i){var o=ey(e).get("label");return i||o&&o.get("color:color")||t||eV(e,n)}function eZ(e,t={}){return{width:eK(e,t),height:eJ(e,t)}}function eK(e,t={}){return(0,a.e$)(t,"width")?t.width:e.width}function eJ(e,t={}){return(0,a.e$)(t,"height")?t.height:e.height}var eq=new r.Z;function eX(e,t,n,i,o,r,l){p.call(this,t,l);var h=e&&e.defaultFillColor,u=e&&e.defaultStrokeColor,d=e&&e.defaultLabelColor;function f(e){return n.computeStyle(e,{strokeLinecap:"round",strokeLinejoin:"round",stroke:eF,strokeWidth:2,fill:"white"})}function g(e){return n.computeStyle(e,["no-fill"],{strokeLinecap:"round",strokeLinejoin:"round",stroke:eF,strokeWidth:2})}function v(e,t){var{ref:n={x:0,y:0},scale:i=1,element:r,parentGfx:a=o._svg}=t,l=(0,c.Ue)("marker",{id:e,viewBox:"0 0 20 20",refX:n.x,refY:n.y,markerWidth:20*i,markerHeight:20*i,orient:"auto"});(0,c.R3)(l,r);var p=(0,s.IO)(":scope > defs",a);p||(p=(0,c.Ue)("defs"),(0,c.R3)(a,p)),(0,c.R3)(p,l)}function y(e,t,n,i){var o=eq.nextPrefixed("marker-");return"sequenceflow-end"===t&&v(o,{element:(0,c.Ue)("path",{d:"M 1 5 L 11 10 L 1 15 Z",...f({fill:i,stroke:i,strokeWidth:1})}),ref:{x:11,y:10},scale:.5,parentGfx:e}),"messageflow-start"===t&&v(o,{element:(0,c.Ue)("circle",{cx:6,cy:6,r:3.5,...f({fill:n,stroke:i,strokeWidth:1,strokeDasharray:[1e4,1]})}),ref:{x:6,y:6},parentGfx:e}),"messageflow-end"===t&&v(o,{element:(0,c.Ue)("path",{d:"m 1 5 l 0 -3 l 7 3 l -7 3 z",...f({fill:n,stroke:i,strokeWidth:1,strokeDasharray:[1e4,1]})}),ref:{x:8.5,y:5},parentGfx:e}),"association-start"===t&&v(o,{element:(0,c.Ue)("path",{d:"M 11 5 L 1 10 L 11 15",...g({fill:"none",stroke:i,strokeWidth:1.5,strokeDasharray:[1e4,1]})}),ref:{x:1,y:10},scale:.5,parentGfx:e}),"association-end"===t&&v(o,{element:(0,c.Ue)("path",{d:"M 1 5 L 11 10 L 1 15",...g({fill:"none",stroke:i,strokeWidth:1.5,strokeDasharray:[1e4,1]})}),ref:{x:11,y:10},scale:.5,parentGfx:e}),"conditional-flow-marker"===t&&v(o,{element:(0,c.Ue)("path",{d:"M 0 10 L 8 6 L 16 10 L 8 14 Z",...f({fill:n,stroke:i})}),ref:{x:-1,y:10},scale:.5,parentGfx:e}),"conditional-default-flow-marker"===t&&v(o,{element:(0,c.Ue)("path",{d:"M 6 4 L 10 16",...f({stroke:i,fill:"none"})}),ref:{x:0,y:10},scale:.5,parentGfx:e}),"url(#"+o+")"}function b(e,t,n,i,o={}){(0,a.Kn)(i)&&(o=i,i=0),i=i||0,o=f(o);var r=(0,c.Ue)("circle",{cx:t/2,cy:n/2,r:Math.round((t+n)/4-i),...o});return(0,c.R3)(e,r),r}function x(e,t,n,i,o,r){(0,a.Kn)(o)&&(r=o,o=0),o=o||0,r=f(r);var s=(0,c.Ue)("rect",{x:o,y:o,width:t-2*o,height:n-2*o,rx:i,ry:i,...r});return(0,c.R3)(e,s),s}function _(e,t,n,i){var o=m(t,n=g(n),i);return(0,c.R3)(e,o),o}function w(e,t,n){n=g(n);var i=(0,c.Ue)("path",{...n,d:t});return(0,c.R3)(e,i),i}function E(e,t,n,i){return w(t,n,(0,a.f0)({"data-marker":e},i))}function S(e){return function(t,n,i){return z[e](t,n,i)}}var k={"bpmn:MessageEventDefinition":function(e,t,n={},o){return w(e,i.getScaledPath("EVENT_MESSAGE",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:n.width||t.width,containerHeight:n.height||t.height,position:{mx:.235,my:.315}}),{fill:o?eV(t,u,n.stroke):eW(t,h,n.fill),stroke:o?eW(t,h,n.fill):eV(t,u,n.stroke),strokeWidth:1})},"bpmn:TimerEventDefinition":function(e,t,n={}){var o=n.width||t.width,r=n.height||t.height,a=n.width?1:2,s=b(e,o,r,.2*r,{fill:eW(t,h,n.fill),stroke:eV(t,u,n.stroke),strokeWidth:a});w(e,i.getScaledPath("EVENT_TIMER_WH",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:o,containerHeight:r,position:{mx:.5,my:.5}}),{stroke:eV(t,u,n.stroke),strokeWidth:a});for(var c=0;c<12;c++){var l=i.getScaledPath("EVENT_TIMER_LINE",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:o,containerHeight:r,position:{mx:.5,my:.5}}),p=o/2,d=r/2;w(e,l,{strokeWidth:1,stroke:eV(t,u,n.stroke),transform:"rotate("+30*c+","+d+","+p+")"})}return s},"bpmn:EscalationEventDefinition":function(e,t,n={},o){return w(e,i.getScaledPath("EVENT_ESCALATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:n.width||t.width,containerHeight:n.height||t.height,position:{mx:.5,my:.2}}),{fill:o?eV(t,u,n.stroke):eW(t,h,n.fill),stroke:eV(t,u,n.stroke),strokeWidth:1})},"bpmn:ConditionalEventDefinition":function(e,t,n={}){return w(e,i.getScaledPath("EVENT_CONDITIONAL",{xScaleFactor:1,yScaleFactor:1,containerWidth:n.width||t.width,containerHeight:n.height||t.height,position:{mx:.5,my:.222}}),{fill:eW(t,h,n.fill),stroke:eV(t,u,n.stroke),strokeWidth:1})},"bpmn:LinkEventDefinition":function(e,t,n={},o){return w(e,i.getScaledPath("EVENT_LINK",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.57,my:.263}}),{fill:o?eV(t,u,n.stroke):eW(t,h,n.fill),stroke:eV(t,u,n.stroke),strokeWidth:1})},"bpmn:ErrorEventDefinition":function(e,t,n={},o){return w(e,i.getScaledPath("EVENT_ERROR",{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:n.width||t.width,containerHeight:n.height||t.height,position:{mx:.2,my:.722}}),{fill:o?eV(t,u,n.stroke):eW(t,h,n.fill),stroke:eV(t,u,n.stroke),strokeWidth:1})},"bpmn:CancelEventDefinition":function(e,t,n={},o){var r=w(e,i.getScaledPath("EVENT_CANCEL_45",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.638,my:-.055}}),{fill:o?eV(t,u,n.stroke):"none",stroke:eV(t,u,n.stroke),strokeWidth:1});return er(r,45),r},"bpmn:CompensateEventDefinition":function(e,t,n={},o){return w(e,i.getScaledPath("EVENT_COMPENSATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:n.width||t.width,containerHeight:n.height||t.height,position:{mx:.22,my:.5}}),{fill:o?eV(t,u,n.stroke):eW(t,h,n.fill),stroke:eV(t,u,n.stroke),strokeWidth:1})},"bpmn:SignalEventDefinition":function(e,t,n={},o){return w(e,i.getScaledPath("EVENT_SIGNAL",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:n.width||t.width,containerHeight:n.height||t.height,position:{mx:.5,my:.2}}),{strokeWidth:1,fill:o?eV(t,u,n.stroke):eW(t,h,n.fill),stroke:eV(t,u,n.stroke)})},"bpmn:MultipleEventDefinition":function(e,t,n={},o){return w(e,i.getScaledPath("EVENT_MULTIPLE",{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:n.width||t.width,containerHeight:n.height||t.height,position:{mx:.211,my:.36}}),{fill:o?eV(t,u,n.stroke):eW(t,h,n.fill),stroke:eV(t,u,n.stroke),strokeWidth:1})},"bpmn:ParallelMultipleEventDefinition":function(e,t,n={}){return w(e,i.getScaledPath("EVENT_PARALLEL_MULTIPLE",{xScaleFactor:1.2,yScaleFactor:1.2,containerWidth:n.width||t.width,containerHeight:n.height||t.height,position:{mx:.458,my:.194}}),{fill:eW(t,h,n.fill),stroke:eV(t,u,n.stroke),strokeWidth:1})},"bpmn:TerminateEventDefinition":function(e,t,n={}){return b(e,t.width,t.height,8,{fill:eV(t,u,n.stroke),stroke:eV(t,u,n.stroke),strokeWidth:4})}};function C(e,t,n={},i){var o=ev(e),r="bpmn:IntermediateThrowEvent"===o.$type||"bpmn:EndEvent"===o.$type,a=i||e;return o.get("eventDefinitions")&&o.get("eventDefinitions").length>1?o.get("parallelMultiple")?k["bpmn:ParallelMultipleEventDefinition"](t,a,n,r):k["bpmn:MultipleEventDefinition"](t,a,n,r):eG(o,"bpmn:MessageEventDefinition")?k["bpmn:MessageEventDefinition"](t,a,n,r):eG(o,"bpmn:TimerEventDefinition")?k["bpmn:TimerEventDefinition"](t,a,n,r):eG(o,"bpmn:ConditionalEventDefinition")?k["bpmn:ConditionalEventDefinition"](t,a,n,r):eG(o,"bpmn:SignalEventDefinition")?k["bpmn:SignalEventDefinition"](t,a,n,r):eG(o,"bpmn:EscalationEventDefinition")?k["bpmn:EscalationEventDefinition"](t,a,n,r):eG(o,"bpmn:LinkEventDefinition")?k["bpmn:LinkEventDefinition"](t,a,n,r):eG(o,"bpmn:ErrorEventDefinition")?k["bpmn:ErrorEventDefinition"](t,a,n,r):eG(o,"bpmn:CancelEventDefinition")?k["bpmn:CancelEventDefinition"](t,a,n,r):eG(o,"bpmn:CompensateEventDefinition")?k["bpmn:CompensateEventDefinition"](t,a,n,r):eG(o,"bpmn:TerminateEventDefinition")?k["bpmn:TerminateEventDefinition"](t,a,n,r):null}var R={ParticipantMultiplicityMarker:function(e,t,n={}){var o=eK(t,n),r=eJ(t,n);E("participant-multiplicity",e,i.getScaledPath("MARKER_PARALLEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:o,containerHeight:r,position:{mx:(o/2-6)/o,my:(r-15)/r}}),{strokeWidth:2,fill:eW(t,h,n.fill),stroke:eV(t,u,n.stroke)})},SubProcessMarker:function(e,t,n={}){eo(x(e,14,14,0,{strokeWidth:1,fill:eW(t,h,n.fill),stroke:eV(t,u,n.stroke)}),t.width/2-7.5,t.height-20),E("sub-process",e,i.getScaledPath("MARKER_SUB_PROCESS",{xScaleFactor:1.5,yScaleFactor:1.5,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2-7.5)/t.width,my:(t.height-20)/t.height}}),{fill:eW(t,h,n.fill),stroke:eV(t,u,n.stroke)})},ParallelMarker:function(e,t,n){var o=eK(t,n),r=eJ(t,n);E("parallel",e,i.getScaledPath("MARKER_PARALLEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:o,containerHeight:r,position:{mx:(o/2+n.parallel)/o,my:(r-20)/r}}),{fill:eW(t,h,n.fill),stroke:eV(t,u,n.stroke)})},SequentialMarker:function(e,t,n){E("sequential",e,i.getScaledPath("MARKER_SEQUENTIAL",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+n.seq)/t.width,my:(t.height-19)/t.height}}),{fill:eW(t,h,n.fill),stroke:eV(t,u,n.stroke)})},CompensationMarker:function(e,t,n){E("compensation",e,i.getScaledPath("MARKER_COMPENSATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+n.compensation)/t.width,my:(t.height-13)/t.height}}),{strokeWidth:1,fill:eW(t,h,n.fill),stroke:eV(t,u,n.stroke)})},LoopMarker:function(e,t,n){var o=eK(t,n),r=eJ(t,n);E("loop",e,i.getScaledPath("MARKER_LOOP",{xScaleFactor:1,yScaleFactor:1,containerWidth:o,containerHeight:r,position:{mx:(o/2+n.loop)/o,my:(r-7)/r}}),{strokeWidth:1.5,fill:"none",stroke:eV(t,u,n.stroke),strokeMiterlimit:.5})},AdhocMarker:function(e,t,n){var o=eK(t,n),r=eJ(t,n);E("adhoc",e,i.getScaledPath("MARKER_ADHOC",{xScaleFactor:1,yScaleFactor:1,containerWidth:o,containerHeight:r,position:{mx:(o/2+n.adhoc)/o,my:(r-15)/r}}),{strokeWidth:1,fill:eV(t,u,n.stroke),stroke:eV(t,u,n.stroke)})}};function P(e,t,n=[],i={}){i={fill:i.fill,stroke:i.stroke,width:eK(t,i),height:eJ(t,i)};var o=ev(t),r=n.includes("SubProcessMarker");i=r?{...i,seq:-21,parallel:-22,compensation:-25,loop:-18,adhoc:10}:{...i,seq:-5,parallel:-6,compensation:-7,loop:0,adhoc:-8},o.get("isForCompensation")&&n.push("CompensationMarker"),em(o,"bpmn:AdHocSubProcess")&&(n.push("AdhocMarker"),r||(0,a.f0)(i,{compensation:i.compensation-18}));var s=o.get("loopCharacteristics"),c=s&&s.get("isSequential");s&&((0,a.f0)(i,{compensation:i.compensation-18}),n.includes("AdhocMarker")&&(0,a.f0)(i,{seq:-23,loop:-18,parallel:-24}),void 0===c&&n.push("LoopMarker"),!1===c&&n.push("ParallelMarker"),!0===c&&n.push("SequentialMarker")),n.includes("CompensationMarker")&&1===n.length&&(0,a.f0)(i,{compensation:-8}),(0,a.Ed)(n,function(n){!function(e,t,n,i){R[e](t,n,i)}(n,e,t,i)})}function T(e,t,n={}){n=(0,a.f0)({size:{width:100}},n);var i=r.createText(t||"",n);return(0,c.Sh)(i).add("djs-label"),(0,c.R3)(e,i),i}function j(e,t,n,i={}){var o=ev(t),r=eZ({x:t.x,y:t.y,width:t.width,height:t.height},i);return T(e,o.name,{align:n,box:r,padding:7,style:{fill:eU(t,d,u,i.stroke)}})}function D(e,t,n,i={}){var o=eB(n),r=T(e,t,{box:{height:30,width:o?eJ(n,i):eK(n,i)},align:"center-middle",style:{fill:eU(n,d,u,i.stroke)}});o&&ei(r,0,-(-1*eJ(n,i)),270)}function B(e,t,n={}){var{width:i,height:o}=eZ(t,n);return x(e,i,o,10,{...n,fill:eW(t,h,n.fill),fillOpacity:.95,stroke:eV(t,u,n.stroke)})}function M(e,t,n={}){var i=ev(t),o=eW(t,h,n.fill),r=eV(t,u,n.stroke);return("One"===i.get("associationDirection")||"Both"===i.get("associationDirection"))&&(n.markerEnd=y(e,"association-end",o,r)),"Both"===i.get("associationDirection")&&(n.markerStart=y(e,"association-start",o,r)),n=eY(n,["markerStart","markerEnd"]),_(e,t.waypoints,{...n,stroke:r,strokeDasharray:"0, 5"},5)}function A(e,t,n={}){var o,r,a=eW(t,h,n.fill),s=eV(t,u,n.stroke),c=w(e,i.getScaledPath("DATA_OBJECT_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.474,my:.296}}),{fill:a,fillOpacity:.95,stroke:s});return r=(o=ev(t)).dataObjectRef,(o.isCollection||r&&r.isCollection)&&w(e,i.getScaledPath("DATA_OBJECT_COLLECTION_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.33,my:(t.height-18)/t.height}}),{strokeWidth:2,fill:a,stroke:s}),c}function L(e,t,n={}){return b(e,t.width,t.height,{fillOpacity:.95,...n,fill:eW(t,h,n.fill),stroke:eV(t,u,n.stroke)})}function O(e,t,n={}){var i,o,r,a,s,l,p;return i=t.width,o=t.height,r={fill:eW(t,h,n.fill),fillOpacity:.95,stroke:eV(t,u,n.stroke)},l=[{x:a=i/2,y:0},{x:i,y:s=o/2},{x:a,y:o},{x:0,y:s}].map(function(e){return e.x+","+e.y}).join(" "),r=f(r),p=(0,c.Ue)("polygon",{...r,points:l}),(0,c.R3)(e,p),p}function N(e,t,n={}){var i=x(e,eK(t,n),eJ(t,n),0,{fill:eW(t,h,n.fill),fillOpacity:n.fillOpacity||.95,stroke:eV(t,u,n.stroke),strokeWidth:1.5}),o=ev(t);return em(o,"bpmn:Lane")&&D(e,o.get("name"),t,n),i}function $(e,t,n={}){var i=B(e,t,n),o=eD(t);if(eM(t)&&((0,c.Lj)(i,{strokeDasharray:"0, 5.5",strokeWidth:2.5}),!o)){var r,a,s,l=(ev(t).flowElements||[]).filter(e=>em(e,"bpmn:StartEvent"));1===l.length&&(r=l[0],a={fill:eW(t,h,n.fill),stroke:eV(t,u,n.stroke),width:22,height:22},s=ev(r).isInterrupting,b(e,20,20,{fill:a.fill,stroke:a.stroke,strokeWidth:s?1:1.2,strokeDasharray:s?0:3,transform:"translate(1,1)"}),C(r,e,a,t))}return j(e,t,o?"center-top":"center-middle",n),o?P(e,t,void 0,n):P(e,t,["SubProcessMarker"],n),i}function I(e,t,n={}){var i=B(e,t,n);return j(e,t,"center-middle",n),P(e,t,void 0,n),i}var z=this.handlers={"bpmn:AdHocSubProcess":function(e,t,n={}){return n=eD(t)?eY(n,["fill","stroke","width","height"]):eY(n,["fill","stroke"]),$(e,t,n)},"bpmn:Association":function(e,t,n={}){return M(e,t,n=eY(n,["fill","stroke"]))},"bpmn:BoundaryEvent":function(e,t,n={}){var{renderIcon:i=!0}=n;n=eY(n,["fill","stroke"]);var o=ev(t).get("cancelActivity");n={strokeWidth:1.5,fill:eW(t,h,n.fill),fillOpacity:1,stroke:eV(t,u,n.stroke)},o||(n.strokeDasharray="6");var r=L(e,t,n);return b(e,t.width,t.height,3,{...n,fill:"none"}),i&&C(t,e,n),r},"bpmn:BusinessRuleTask":function(e,t,n={}){var o=I(e,t,n=eY(n,["fill","stroke"])),r=w(e,i.getScaledPath("TASK_TYPE_BUSINESS_RULE_MAIN",{abspos:{x:8,y:8}}));(0,c.Lj)(r,{fill:eW(t,h,n.fill),stroke:eV(t,u,n.stroke),strokeWidth:1});var a=w(e,i.getScaledPath("TASK_TYPE_BUSINESS_RULE_HEADER",{abspos:{x:8,y:8}}));return(0,c.Lj)(a,{fill:eV(t,u,n.stroke),stroke:eV(t,u,n.stroke),strokeWidth:1}),o},"bpmn:CallActivity":function(e,t,n={}){return $(e,t,{strokeWidth:5,...n=eY(n,["fill","stroke"])})},"bpmn:ComplexGateway":function(e,t,n={}){var o=O(e,t,n=eY(n,["fill","stroke"]));return w(e,i.getScaledPath("GATEWAY_COMPLEX",{xScaleFactor:.5,yScaleFactor:.5,containerWidth:t.width,containerHeight:t.height,position:{mx:.46,my:.26}}),{fill:eV(t,u,n.stroke),stroke:eV(t,u,n.stroke),strokeWidth:1}),o},"bpmn:DataInput":function(e,t,n={}){n=eY(n,["fill","stroke"]);var o=i.getRawPath("DATA_ARROW"),r=A(e,t,n);return w(e,o,{fill:"none",stroke:eV(t,u,n.stroke),strokeWidth:1}),r},"bpmn:DataInputAssociation":function(e,t,n={}){return M(e,t,{...n=eY(n,["fill","stroke"]),markerEnd:y(e,"association-end",eW(t,h,n.fill),eV(t,u,n.stroke))})},"bpmn:DataObject":function(e,t,n={}){return A(e,t,n=eY(n,["fill","stroke"]))},"bpmn:DataObjectReference":S("bpmn:DataObject"),"bpmn:DataOutput":function(e,t,n={}){n=eY(n,["fill","stroke"]);var o=i.getRawPath("DATA_ARROW"),r=A(e,t,n);return w(e,o,{strokeWidth:1,fill:eW(t,h,n.fill),stroke:eV(t,u,n.stroke)}),r},"bpmn:DataOutputAssociation":function(e,t,n={}){return M(e,t,{...n=eY(n,["fill","stroke"]),markerEnd:y(e,"association-end",eW(t,h,n.fill),eV(t,u,n.stroke))})},"bpmn:DataStoreReference":function(e,t,n={}){return n=eY(n,["fill","stroke"]),w(e,i.getScaledPath("DATA_STORE",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:0,my:.133}}),{fill:eW(t,h,n.fill),fillOpacity:.95,stroke:eV(t,u,n.stroke),strokeWidth:2})},"bpmn:EndEvent":function(e,t,n={}){var{renderIcon:i=!0}=n,o=L(e,t,{...n=eY(n,["fill","stroke"]),strokeWidth:4});return i&&C(t,e,n),o},"bpmn:EventBasedGateway":function(e,t,n={}){n=eY(n,["fill","stroke"]);var o=ev(t),r=O(e,t,n);b(e,t.width,t.height,.2*t.height,{fill:eW(t,"none",n.fill),stroke:eV(t,u,n.stroke),strokeWidth:1});var a=o.get("eventGatewayType"),s=!!o.get("instantiate");return"Parallel"===a?w(e,i.getScaledPath("GATEWAY_PARALLEL",{xScaleFactor:.4,yScaleFactor:.4,containerWidth:t.width,containerHeight:t.height,position:{mx:.474,my:.296}}),{fill:"none",stroke:eV(t,u,n.stroke),strokeWidth:1}):"Exclusive"===a&&(s||b(e,t.width,t.height,.26*t.height,{fill:"none",stroke:eV(t,u,n.stroke),strokeWidth:1}),w(e,i.getScaledPath("GATEWAY_EVENT_BASED",{xScaleFactor:.18,yScaleFactor:.18,containerWidth:t.width,containerHeight:t.height,position:{mx:.36,my:.44}}),{fill:"none",stroke:eV(t,u,n.stroke),strokeWidth:2})),r},"bpmn:ExclusiveGateway":function(e,t,n={}){var o=O(e,t,n=eY(n,["fill","stroke"])),r=i.getScaledPath("GATEWAY_EXCLUSIVE",{xScaleFactor:.4,yScaleFactor:.4,containerWidth:t.width,containerHeight:t.height,position:{mx:.32,my:.3}});return ey(t).get("isMarkerVisible")&&w(e,r,{fill:eV(t,u,n.stroke),stroke:eV(t,u,n.stroke),strokeWidth:1}),o},"bpmn:Gateway":function(e,t,n={}){return O(e,t,n=eY(n,["fill","stroke"]))},"bpmn:Group":function(e,t,n={}){return n=eY(n,["fill","stroke","width","height"]),x(e,t.width,t.height,10,{stroke:eV(t,u,n.stroke),strokeWidth:1.5,strokeDasharray:"10, 6, 0, 6",fill:"none",pointerEvents:"none",width:eK(t,n),height:eJ(t,n)})},"bpmn:InclusiveGateway":function(e,t,n={}){var i=O(e,t,n=eY(n,["fill","stroke"]));return b(e,t.width,t.height,.24*t.height,{fill:eW(t,h,n.fill),stroke:eV(t,u,n.stroke),strokeWidth:2.5}),i},"bpmn:IntermediateEvent":function(e,t,n={}){var{renderIcon:i=!0}=n,o=L(e,t,{...n=eY(n,["fill","stroke"]),strokeWidth:1.5});return b(e,t.width,t.height,3,{fill:"none",stroke:eV(t,u,n.stroke),strokeWidth:1.5}),i&&C(t,e,n),o},"bpmn:IntermediateCatchEvent":S("bpmn:IntermediateEvent"),"bpmn:IntermediateThrowEvent":S("bpmn:IntermediateEvent"),"bpmn:Lane":function(e,t,n={}){return N(e,t,{...n=eY(n,["fill","stroke","width","height"]),fillOpacity:.25})},"bpmn:ManualTask":function(e,t,n={}){var o=I(e,t,n=eY(n,["fill","stroke"]));return w(e,i.getScaledPath("TASK_TYPE_MANUAL",{abspos:{x:17,y:15}}),{fill:eW(t,h,n.fill),stroke:eV(t,u,n.stroke),strokeWidth:.5}),o},"bpmn:MessageFlow":function(e,t,n={}){n=eY(n,["fill","stroke"]);var o=ev(t),r=ey(t),a=eW(t,h,n.fill),s=eV(t,u,n.stroke),c=_(e,t.waypoints,{markerEnd:y(e,"messageflow-end",a,s),markerStart:y(e,"messageflow-start",a,s),stroke:s,strokeDasharray:"10, 11",strokeWidth:1.5},5);if(o.get("messageRef")){var l=c.getPointAtLength(c.getTotalLength()/2),p=i.getScaledPath("MESSAGE_FLOW_MARKER",{abspos:{x:l.x,y:l.y}}),d={strokeWidth:1};"initiating"===r.get("messageVisibleKind")?(d.fill=a,d.stroke=s):(d.fill=s,d.stroke=a);var f=w(e,p,d),m=T(e,o.get("messageRef").get("name"),{align:"center-top",fitBox:!0,style:{fill:s}}),g=f.getBBox(),v=m.getBBox();ei(m,l.x-v.width/2,l.y+g.height/2+10,0)}return c},"bpmn:ParallelGateway":function(e,t,n={}){var o=O(e,t,n=eY(n,["fill","stroke"]));return w(e,i.getScaledPath("GATEWAY_PARALLEL",{xScaleFactor:.6,yScaleFactor:.6,containerWidth:t.width,containerHeight:t.height,position:{mx:.46,my:.2}}),{fill:eV(t,u,n.stroke),stroke:eV(t,u,n.stroke),strokeWidth:1}),o},"bpmn:Participant":function(e,t,n={}){var i=N(e,t,n=eY(n,["fill","stroke","width","height"])),o=eD(t),r=eB(t),a=ev(t),s=a.get("name");if(o)_(e,r?[{x:30,y:0},{x:30,y:eJ(t,n)}]:[{x:0,y:30},{x:eK(t,n),y:30}],{stroke:eV(t,u,n.stroke),strokeWidth:1.5}),D(e,s,t,n);else{var c=eZ(t,n);r||(c.height=eK(t,n),c.width=eJ(t,n));var l=T(e,s,{box:c,align:"center-middle",style:{fill:eU(t,d,u,n.stroke)}});r||ei(l,0,-(-1*eJ(t,n)),270)}return a.get("participantMultiplicity")&&function(e,t,n,i){R[e](t,n,i)}("ParticipantMultiplicityMarker",e,t,n),i},"bpmn:ReceiveTask":function(e,t,n={}){n=eY(n,["fill","stroke"]);var o,r=ev(t),a=I(e,t,n);return r.get("instantiate")?(b(e,28,28,4.4,{fill:eW(t,h,n.fill),stroke:eV(t,u,n.stroke),strokeWidth:1}),o=i.getScaledPath("TASK_TYPE_INSTANTIATING_SEND",{abspos:{x:7.77,y:9.52}})):o=i.getScaledPath("TASK_TYPE_SEND",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:21,containerHeight:14,position:{mx:.3,my:.4}}),w(e,o,{fill:eW(t,h,n.fill),stroke:eV(t,u,n.stroke),strokeWidth:1}),a},"bpmn:ScriptTask":function(e,t,n={}){var o=I(e,t,n=eY(n,["fill","stroke"]));return w(e,i.getScaledPath("TASK_TYPE_SCRIPT",{abspos:{x:15,y:20}}),{fill:eW(t,h,n.fill),stroke:eV(t,u,n.stroke),strokeWidth:1}),o},"bpmn:SendTask":function(e,t,n={}){var o=I(e,t,n=eY(n,["fill","stroke"]));return w(e,i.getScaledPath("TASK_TYPE_SEND",{xScaleFactor:1,yScaleFactor:1,containerWidth:21,containerHeight:14,position:{mx:.285,my:.357}}),{fill:eV(t,u,n.stroke),stroke:eW(t,h,n.fill),strokeWidth:1}),o},"bpmn:SequenceFlow":function(e,t,n={}){var i=eW(t,h,(n=eY(n,["fill","stroke"])).fill),o=eV(t,u,n.stroke),r=_(e,t.waypoints,{markerEnd:y(e,"sequenceflow-end",i,o),stroke:o},5),a=ev(t),{source:s}=t;if(s){var l=ev(s);a.get("conditionExpression")&&em(l,"bpmn:Activity")&&(0,c.Lj)(r,{markerStart:y(e,"conditional-flow-marker",i,o)}),l.get("default")&&(em(l,"bpmn:Gateway")||em(l,"bpmn:Activity"))&&l.get("default")===a&&(0,c.Lj)(r,{markerStart:y(e,"conditional-default-flow-marker",i,o)})}return r},"bpmn:ServiceTask":function(e,t,n={}){var o=I(e,t,n=eY(n,["fill","stroke"]));return b(e,10,10,{fill:eW(t,h,n.fill),stroke:"none",transform:"translate(6, 6)"}),w(e,i.getScaledPath("TASK_TYPE_SERVICE",{abspos:{x:12,y:18}}),{fill:eW(t,h,n.fill),stroke:eV(t,u,n.stroke),strokeWidth:1}),b(e,10,10,{fill:eW(t,h,n.fill),stroke:"none",transform:"translate(11, 10)"}),w(e,i.getScaledPath("TASK_TYPE_SERVICE",{abspos:{x:17,y:22}}),{fill:eW(t,h,n.fill),stroke:eV(t,u,n.stroke),strokeWidth:1}),o},"bpmn:StartEvent":function(e,t,n={}){var{renderIcon:i=!0}=n;n=eY(n,["fill","stroke"]),ev(t).get("isInterrupting")||(n={...n,strokeDasharray:"6"});var o=L(e,t,n);return i&&C(t,e,n),o},"bpmn:SubProcess":function(e,t,n={}){return n=eD(t)?eY(n,["fill","stroke","width","height"]):eY(n,["fill","stroke"]),$(e,t,n)},"bpmn:Task":function(e,t,n={}){return I(e,t,n=eY(n,["fill","stroke"]))},"bpmn:TextAnnotation":function(e,t,n={}){var{width:o,height:r}=eZ(t,n=eY(n,["fill","stroke","width","height"])),a=x(e,o,r,0,0,{fill:"none",stroke:"none"});return w(e,i.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:o,containerHeight:r,position:{mx:0,my:0}}),{stroke:eV(t,u,n.stroke)}),T(e,ev(t).get("text")||"",{align:"left-top",box:eZ(t,n),padding:7,style:{fill:eU(t,d,u,n.stroke)}}),a},"bpmn:Transaction":function(e,t,i={}){i=eD(t)?eY(i,["fill","stroke","width","height"]):eY(i,["fill","stroke"]);var o=$(e,t,{strokeWidth:1.5,...i}),r=n.style(["no-fill","no-events"],{stroke:eV(t,u,i.stroke),strokeWidth:1.5});return eD(t)||(i={}),x(e,eK(t,i),eJ(t,i),7,3,r),o},"bpmn:UserTask":function(e,t,n={}){var o=I(e,t,n=eY(n,["fill","stroke"]));return w(e,i.getScaledPath("TASK_TYPE_USER_1",{abspos:{x:15,y:12}}),{fill:eW(t,h,n.fill),stroke:eV(t,u,n.stroke),strokeWidth:.5}),w(e,i.getScaledPath("TASK_TYPE_USER_2",{abspos:{x:15,y:12}}),{fill:eW(t,h,n.fill),stroke:eV(t,u,n.stroke),strokeWidth:.5}),w(e,i.getScaledPath("TASK_TYPE_USER_3",{abspos:{x:15,y:12}}),{fill:eV(t,u,n.stroke),stroke:eV(t,u,n.stroke),strokeWidth:.5}),o},label:function(e,t,n={}){return function(e,t,n={}){var i={width:90,height:30,x:t.width/2+t.x,y:t.height/2+t.y};return T(e,eH(t),{box:i,fitBox:!0,style:(0,a.f0)({},r.getExternalStyle(),{fill:eU(t,d,u,n.stroke)})})}(e,t,n)}};this._drawPath=w,this._renderer=function(e){return z[e]}}function eY(e,t=[]){return t.reduce((t,n)=>(e[n]&&(t[n]=e[n]),t),{})}(0,o.Z)(eX,p),eX.$inject=["config.bpmnRenderer","eventBus","styles","pathMap","canvas","textRenderer"],eX.prototype.canRender=function(e){return em(e,"bpmn:BaseElement")},eX.prototype.drawShape=function(e,t,n={}){var{type:i}=t;return this._renderer(i)(e,t,n)},eX.prototype.drawConnection=function(e,t,n={}){var{type:i}=t;return this._renderer(i)(e,t,n)},eX.prototype.getShapePath=function(e){var t,n,i,o,r,a,s,c,l,p,u,d;return em(e,"bpmn:Event")?h([["M",e.x+e.width/2,e.y+e.height/2],["m",0,-(t=e.width/2)],["a",t,t,0,1,1,0,2*t],["a",t,t,0,1,1,0,-2*t],["z"]]):em(e,"bpmn:Activity")?(n=e.x,h([["M",n+10,e.y],["l",(i=e.width)-20,0],["a",10,10,0,0,1,10,10],["l",0,(o=e.height)-20],["a",10,10,0,0,1,-10,10],["l",20-i,0],["a",10,10,0,0,1,-10,-10],["l",0,20-o],["a",10,10,0,0,1,10,-10],["z"]])):em(e,"bpmn:Gateway")?(r=e.width,a=e.height,s=e.x,c=e.y,h([["M",s+(l=r/2),c],["l",l,p=a/2],["l",-l,p],["l",-l,-p],["z"]])):(u=e.x,h([["M",u,e.y],["l",d=e.width,0],["l",0,e.height],["l",-d,0],["z"]]))};var eQ={width:150,height:50};function e0(e){this._config=(0,a.f0)({},{size:eQ,padding:0,style:{},align:"center-top"},e||{})}function e1(e){var t=(0,a.f0)({fontFamily:"Arial, sans-serif",fontSize:12,fontWeight:"normal",lineHeight:1.2},e&&e.defaultStyle||{}),n=parseInt(t.fontSize,10)-1,i=(0,a.f0)({},t,{fontSize:n},e&&e.externalStyle||{}),o=new e0({style:t});this.getExternalLabelBounds=function(e,t){var n=o.getDimensions(t,{box:{width:90,height:30},style:i});return{x:Math.round(e.x+e.width/2-n.width/2),y:Math.round(e.y),width:Math.ceil(n.width),height:Math.ceil(n.height)}},this.getTextAnnotationBounds=function(e,n){var i=o.getDimensions(n,{box:e,style:t,align:"left-top",padding:5});return{x:e.x,y:e.y,width:e.width,height:Math.max(30,Math.round(i.height))}},this.createText=function(e,t){return o.createText(e,t||{})},this.getDefaultStyle=function(){return t},this.getExternalStyle=function(){return i}}e0.prototype.createText=function(e,t){return this.layoutText(e,t).element},e0.prototype.getDimensions=function(e,t){return this.layoutText(e,t).dimensions},e0.prototype.layoutText=function(e,t){var n,i,o,r=(0,a.f0)({},this._config.size,t.box),l=(0,a.f0)({},this._config.style,t.style),p={horizontal:(n=(t.align||this._config.align).split("-"))[0]||"center",vertical:n[1]||"top"},h=(i=void 0!==t.padding?t.padding:this._config.padding,(0,a.Kn)(i)?(0,a.f0)({top:0,left:0,right:0,bottom:0},i):{top:i,left:i,right:i,bottom:i}),u=t.fitBox||!1,d=function(e){if("fontSize"in e&&"lineHeight"in e)return e.lineHeight*parseInt(e.fontSize,10)}(l),f=e.split(/\u00AD?\r?\n/),m=[],g=r.width-h.left-h.right,v=(0,c.Ue)("text");(0,c.Lj)(v,{x:0,y:0}),(0,c.Lj)(v,l);var y=((o=document.getElementById("helper-svg"))||(o=(0,c.Ue)("svg"),(0,c.Lj)(o,{id:"helper-svg"}),(0,s.i5)(o,{visibility:"hidden",position:"fixed",width:0,height:0}),document.body.appendChild(o)),o);for((0,c.R3)(y,v);f.length;)m.push(function(e,t,n){for(var i,o=e.shift(),r=o;;){if((i=function(e,t){t.textContent=e;try{var n,i,o=""===e;return t.textContent=o?"dummy":e,i={width:(n=t.getBBox()).width+2*n.x,height:n.height},o&&(i.width=0),i}catch(e){return console.log(e),{width:0,height:0}}}(r,n)).width=r?i.width:0," "===r||""===r||i.width<Math.round(t)||r.length<2)return function(e,t,n,i){if(t.length<n.length){var o=n.slice(t.length).trim();e.unshift(o)}return{width:i.width,height:i.height,text:t}}(e,r,o,i);r=function(e,t,n){var i=Math.max(e.length*(n/t),1),o=function(e,t){var n,i=e.split(/(\s|-|\u00AD)/g),o=[],r=0;if(i.length>1)for(;n=i.shift();)if(n.length+r<t)o.push(n),r+=n.length;else{("-"===n||"\xad"===n)&&o.pop();break}var a=o[o.length-1];return a&&"\xad"===a&&(o[o.length-1]="-"),o.join("")}(e,i);return o||(o=e.slice(0,Math.max(Math.round(i-1),1))),o}(r,i.width,t)}}(f,g,v));"middle"===p.vertical&&(h.top=h.bottom=0);var b=(0,a.u4)(m,function(e,t,n){return e+(d||t.height)},0)+h.top+h.bottom,x=(0,a.u4)(m,function(e,t,n){return t.width>e?t.width:e},0),_=h.top;"middle"===p.vertical&&(_+=(r.height-b)/2),_-=(d||m[0].height)/4;var w=(0,c.Ue)("text");return(0,c.Lj)(w,l),(0,a.Ed)(m,function(e){switch(_+=d||e.height,p.horizontal){case"left":t=h.left;break;case"right":t=(u?x:g)-h.right-e.width;break;default:t=Math.max(((u?x:g)-e.width)/2+h.left,0)}var t,n=(0,c.Ue)("tspan");(0,c.Lj)(n,{x:t,y:_}),n.textContent=e.text,(0,c.R3)(w,n)}),(0,c.Od)(v),{dimensions:{width:x,height:b},element:w}},e1.$inject=["config.textRenderer"];var e2=/\{([^{}]+)\}/g,e5=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,e3={translate:["value",function(e,t){return t=t||{},e.replace(/{([^}]+)}/g,function(e,n){return t[n]||"{"+n+"}"})}]};function e6(e,t,n){return(0,a.f0)({id:e.id,type:e.$type,businessObject:e,di:t},n)}function e4(e,t,n){return Error(`element ${eh(t)} referenced by ${eh(e)}#${n} not yet drawn`)}function e9(e,t,n,i,o){this._eventBus=e,this._canvas=t,this._elementFactory=n,this._elementRegistry=i,this._textRenderer=o}e9.$inject=["eventBus","canvas","elementFactory","elementRegistry","textRenderer"],e9.prototype.add=function(e,t,n){if(em(t,"bpmndi:BPMNPlane")){var i,o,r,a=em(e,"bpmn:SubProcess")?{id:e.id+"_plane"}:{};i=this._elementFactory.createRoot(e6(e,t,a)),this._canvas.addRootElement(i)}else if(em(t,"bpmndi:BPMNShape")){var s,c,l,p,h=!eD(e,t),u=em(e,"bpmn:Group");o=n&&(n.hidden||n.collapsed);var d=t.bounds;i=this._elementFactory.createShape(e6(e,t,{collapsed:h,hidden:o,x:Math.round(d.x),y:Math.round(d.y),width:Math.round(d.width),height:Math.round(d.height),isFrame:u})),em(e,"bpmn:BoundaryEvent")&&this._attachBoundary(e,i),em(e,"bpmn:Lane")&&(r=0),!em(e,"bpmn:DataStoreReference")||(s=n,l=(c=(0,j.wS)(d)).x,p=c.y,l>=s.x&&l<=s.x+s.width&&p>=s.y&&p<=s.y+s.height)||(n=this._canvas.findRoot(n)),this._canvas.addShape(i,n,r)}else if(em(t,"bpmndi:BPMNEdge")){var f,m=this._getSource(e),g=this._getTarget(e);o=n&&(n.hidden||n.collapsed),i=this._elementFactory.createConnection(e6(e,t,{hidden:o,source:m,target:g,waypoints:(f=t.waypoint)&&!(f.length<2)?f.map(function(e){return{x:e.x,y:e.y}}):[(0,j.wS)(m),(0,j.wS)(g)]})),em(e,"bpmn:DataAssociation")&&(n=this._canvas.findRoot(n)),this._canvas.addConnection(i,n,r)}else throw Error(`unknown di ${eh(t)} for element ${eh(e)}`);return eN(e)&&eH(i)&&this.addLabel(e,t,i),this._eventBus.fire("bpmnElement.added",{element:i}),i},e9.prototype._attachBoundary=function(e,t){var n=e.attachedToRef;if(!n)throw Error(`missing ${eh(e)}#attachedToRef`);var i=this._elementRegistry.get(n.id),o=i&&i.attachers;if(!i)throw e4(e,n,"attachedToRef");t.host=i,o||(i.attachers=o=[]),-1===o.indexOf(t)&&o.push(t)},e9.prototype.addLabel=function(e,t,n){var i,o,r,s,c,l,p;return(p=t.label)&&p.bounds?(l=p.bounds,c={width:Math.max(eO.width,l.width),height:l.height},s={x:l.x+l.width/2,y:l.y+l.height/2}):(s=eI(n),c=eO),i=(0,a.f0)({x:s.x-c.width/2,y:s.y-c.height/2},c),(o=eH(n))&&(i=this._textRenderer.getExternalLabelBounds(i,o)),r=this._elementFactory.createLabel(e6(e,t,{id:e.id+"_label",labelTarget:n,type:"label",hidden:n.hidden||!eH(n),x:Math.round(i.x),y:Math.round(i.y),width:Math.round(i.width),height:Math.round(i.height)})),this._canvas.addShape(r,n.parent)},e9.prototype._getConnectedElement=function(e,t){var n,i,o=e.$type;if(i=e[t+"Ref"],"source"===t&&"bpmn:DataInputAssociation"===o&&(i=i&&i[0]),("source"===t&&"bpmn:DataOutputAssociation"===o||"target"===t&&"bpmn:DataInputAssociation"===o)&&(i=e.$parent),n=i&&this._getElement(i))return n;if(i)throw e4(e,i,t+"Ref");throw Error(`${eh(e)}#${t} Ref not specified`)},e9.prototype._getSource=function(e){return this._getConnectedElement(e,"source")},e9.prototype._getTarget=function(e){return this._getConnectedElement(e,"target")},e9.prototype._getElement=function(e){return this._elementRegistry.get(e.id)};var e8=n(725),e7=new e8.Z("ov");function te(e,t,n,i){var o,r;this._eventBus=t,this._canvas=n,this._elementRegistry=i,this._ids=e7,this._overlayDefaults=(0,a.f0)({show:null,scale:!0},e&&e.defaults),this._overlays={},this._overlayContainers=[],this._overlayRoot=(o=n.getContainer(),r=(0,s.H6)('<div class="djs-overlay-container" />'),(0,s.i5)(r,{position:"absolute",width:0,height:0}),o.insertBefore(r,o.firstChild),r),this._init()}function tt(e,t,n){(0,s.i5)(e,{left:t+"px",top:n+"px"})}function tn(e,t){e.style.display=!1===t?"none":""}function ti(e,t){e.style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach(function(n){e.style[n+"transform"]=t})}te.$inject=["config.overlays","eventBus","canvas","elementRegistry"],te.prototype.get=function(e){if((0,a.HD)(e)&&(e={id:e}),(0,a.HD)(e.element)&&(e.element=this._elementRegistry.get(e.element)),e.element){var t=this._getOverlayContainer(e.element,!0);return t?e.type?(0,a.hX)(t.overlays,(0,a.KQ)({type:e.type})):t.overlays.slice():[]}return e.type?(0,a.hX)(this._overlays,(0,a.KQ)({type:e.type})):e.id?this._overlays[e.id]:null},te.prototype.add=function(e,t,n){if((0,a.Kn)(t)&&(n=t,t=null),e.id||(e=this._elementRegistry.get(e)),!n.position)throw Error("must specifiy overlay position");if(!n.html)throw Error("must specifiy overlay html");if(!e)throw Error("invalid element specified");var i=this._ids.next();return n=(0,a.f0)({},this._overlayDefaults,n,{id:i,type:t,element:e,html:n.html}),this._addOverlay(n),i},te.prototype.remove=function(e){var t=this.get(e)||[];(0,a.kJ)(t)||(t=[t]);var n=this;(0,a.Ed)(t,function(e){var t=n._getOverlayContainer(e.element,!0);if(e&&((0,s.Od)(e.html),(0,s.Od)(e.htmlContainer),delete e.htmlContainer,delete e.element,delete n._overlays[e.id]),t){var i=t.overlays.indexOf(e);-1!==i&&t.overlays.splice(i,1)}})},te.prototype.isShown=function(){return"none"!==this._overlayRoot.style.display},te.prototype.show=function(){tn(this._overlayRoot)},te.prototype.hide=function(){tn(this._overlayRoot,!1)},te.prototype.clear=function(){this._overlays={},this._overlayContainers=[],(0,s.ZH)(this._overlayRoot)},te.prototype._updateOverlayContainer=function(e){var t=e.element,n=e.html,i=t.x,o=t.y;if(t.waypoints){var r=_(t);i=r.x,o=r.y}tt(n,i,o),(0,s.Lj)(e.html,"data-container-id",t.id)},te.prototype._updateOverlay=function(e){var t,n,i=e.position,o=e.htmlContainer,r=e.element,a=i.left,s=i.top;void 0!==i.right&&(t=r.waypoints?_(r).width:r.width,a=-1*i.right+t),void 0!==i.bottom&&(n=r.waypoints?_(r).height:r.height,s=-1*i.bottom+n),tt(o,a||0,s||0),this._updateOverlayVisibilty(e,this._canvas.viewbox())},te.prototype._createOverlayContainer=function(e){var t=(0,s.H6)('<div class="djs-overlays" />');(0,s.i5)(t,{position:"absolute"}),this._overlayRoot.appendChild(t);var n={html:t,element:e,overlays:[]};return this._updateOverlayContainer(n),this._overlayContainers.push(n),n},te.prototype._updateRoot=function(e){var t=e.scale||1,n="matrix("+[t,0,0,t,-1*e.x*t,-1*e.y*t].join(",")+")";ti(this._overlayRoot,n)},te.prototype._getOverlayContainer=function(e,t){var n=(0,a.sE)(this._overlayContainers,function(t){return t.element===e});return n||t?n:this._createOverlayContainer(e)},te.prototype._addOverlay=function(e){var t,n,i=e.id,o=e.element,r=e.html;r.get&&r.constructor.prototype.jquery&&(r=r.get(0)),(0,a.HD)(r)&&(r=(0,s.H6)(r)),n=this._getOverlayContainer(o),t=(0,s.H6)('<div class="djs-overlay" data-overlay-id="'+i+'">'),(0,s.i5)(t,{position:"absolute"}),t.appendChild(r),e.type&&(0,s.Sh)(t).add("djs-overlay-"+e.type),tn(t,this._canvas.findRoot(o)===this._canvas.getRootElement()),e.htmlContainer=t,n.overlays.push(e),n.html.appendChild(t),this._overlays[i]=e,this._updateOverlay(e),this._updateOverlayVisibilty(e,this._canvas.viewbox())},te.prototype._updateOverlayVisibilty=function(e,t){var n=e.show,i=this._canvas.findRoot(e.element),o=n&&n.minZoom,r=n&&n.maxZoom,s=e.htmlContainer,c=this._canvas.getRootElement(),l=!0;i!==c?l=!1:n&&((0,a.$K)(o)&&o>t.scale||(0,a.$K)(r)&&r<t.scale)&&(l=!1),tn(s,l),this._updateOverlayScale(e,t)},te.prototype._updateOverlayScale=function(e,t){var n,i,o,r=e.scale,s=e.htmlContainer,c="";!0!==r&&(!1===r?(n=1,i=1):(n=r.min,i=r.max),(0,a.$K)(n)&&t.scale<n&&(o=(1/t.scale||1)*n),(0,a.$K)(i)&&t.scale>i&&(o=(1/t.scale||1)*i)),(0,a.$K)(o)&&(c="scale("+o+","+o+")"),ti(s,c)},te.prototype._updateOverlaysVisibilty=function(e){var t=this;(0,a.Ed)(this._overlays,function(n){t._updateOverlayVisibilty(n,e)})},te.prototype._init=function(){var e=this._eventBus,t=this;e.on("canvas.viewbox.changing",function(e){t.hide()}),e.on("canvas.viewbox.changed",function(e){var n;n=e.viewbox,t._updateRoot(n),t._updateOverlaysVisibilty(n),t.show()}),e.on(["shape.remove","connection.remove"],function(e){var n=e.element,i=t.get({element:n});(0,a.Ed)(i,function(e){t.remove(e.id)});var o=t._getOverlayContainer(n);if(o){(0,s.Od)(o.html);var r=t._overlayContainers.indexOf(o);-1!==r&&t._overlayContainers.splice(r,1)}}),e.on("element.changed",500,function(e){var n=e.element,i=t._getOverlayContainer(n,!0);i&&((0,a.Ed)(i.overlays,function(e){t._updateOverlay(e)}),t._updateOverlayContainer(i))}),e.on("element.marker.update",function(e){var n=t._getOverlayContainer(e.element,!0);n&&(0,s.Sh)(n.html)[e.add?"add":"remove"](e.marker)}),e.on("root.set",function(){t._updateOverlaysVisibilty(t._canvas.viewbox())}),e.on("diagram.clear",this.clear,this)};var to={__init__:["overlays"],overlays:["type",te]};function tr(e,t,n,i){e.on("element.changed",function(i){var o=i.element;(o.parent||o===t.getRootElement())&&(i.gfx=n.getGraphics(o)),i.gfx&&e.fire(E(o)+".changed",i)}),e.on("elements.changed",function(t){var n=t.elements;n.forEach(function(t){e.fire("element.changed",{element:t})}),i.updateContainments(n)}),e.on("shape.changed",function(e){i.update("shape",e.element,e.gfx)}),e.on("connection.changed",function(e){i.update("connection",e.element,e.gfx)})}tr.$inject=["eventBus","canvas","elementRegistry","graphicsFactory"];var ta={__init__:["changeSupport"],changeSupport:["type",tr]};function ts(e){this._eventBus=e}function tc(e){return function(t,n,i,o,r){((0,a.mf)(t)||(0,a.hj)(t))&&(r=o,o=i,i=n,n=t,t=null),this.on(t,e,n,i,o,r)}}function tl(e,t){t.invoke(ts,this),this.executed(function(t){var n=t.context;n.rootElement?e.setRootElement(n.rootElement):n.rootElement=e.getRootElement()}),this.revert(function(t){var n=t.context;n.rootElement&&e.setRootElement(n.rootElement)})}ts.$inject=["eventBus"],ts.prototype.on=function(e,t,n,i,o,r){if(((0,a.mf)(t)||(0,a.hj)(t))&&(r=o,o=i,i=n,n=t,t=null),(0,a.mf)(n)&&(r=o,o=i,i=n,n=1e3),(0,a.Kn)(o)&&(r=o,o=!1),!(0,a.mf)(i))throw Error("handlerFn must be a function");(0,a.kJ)(e)||(e=[e]);var s=this._eventBus;(0,a.Ed)(e,function(e){var a,c,l=["commandStack",e,t].filter(function(e){return e}).join(".");s.on(l,n,o?(a=i,c=r,function(e){return a.call(c||null,e.context,e.command,e)}):i,r)})},ts.prototype.canExecute=tc("canExecute"),ts.prototype.preExecute=tc("preExecute"),ts.prototype.preExecuted=tc("preExecuted"),ts.prototype.execute=tc("execute"),ts.prototype.executed=tc("executed"),ts.prototype.postExecute=tc("postExecute"),ts.prototype.postExecuted=tc("postExecuted"),ts.prototype.revert=tc("revert"),ts.prototype.reverted=tc("reverted"),(0,o.Z)(tl,ts),tl.$inject=["canvas","injector"];var tp=n(5694),th="_plane";function tu(e){var t=e.id;return em(e,"bpmn:SubProcess")?t+th:t}function td(e){return em(ey(e),"bpmndi:BPMNPlane")}function tf(e){return e.replace(RegExp(th+"$"),"")}function tm(e,t,n){var i=(0,s.H6)('<ul class="bjs-breadcrumbs"></ul>'),o=n.getContainer(),r=(0,s.Sh)(o);o.appendChild(i);var c=[];function l(e){e&&(c=function(e){for(var t=ev(e),n=[],i=t;i;i=i.$parent)(em(i,"bpmn:SubProcess")||em(i,"bpmn:Process"))&&n.push(i);return n.reverse()}(e));var o=c.flatMap(function(e){var i=n.findRoot(tu(e))||n.findRoot(e.id);if(!i&&em(e,"bpmn:Process")){var o=t.find(function(t){var n=ev(t);return n&&n.get("processRef")===e});i=o&&n.findRoot(o.id)}if(!i)return[];var r=(0,tp.r)(e.name||e.id),a=(0,s.H6)('<li><span class="bjs-crumb"><a title="'+r+'">'+r+"</a></span></li>");return a.addEventListener("click",function(){n.setRootElement(i)}),a});i.innerHTML="";var a=o.length>1;r.toggle("bjs-breadcrumbs-shown",a),o.forEach(function(e){i.appendChild(e)})}e.on("element.changed",function(e){var t=ev(e.element);(0,a.sE)(c,function(e){return e===t})&&l()}),e.on("root.set",function(e){l(e.element)})}function tg(e,t){var n=null,i=new tv;e.on("root.set",function(e){var o=e.element,r=t.viewbox(),a=i.get(o);if(i.set(n,{x:r.x,y:r.y,zoom:r.scale}),n=o,em(o,"bpmn:SubProcess")||a){a=a||{x:0,y:0,zoom:1};var s=(r.x-a.x)*r.scale,c=(r.y-a.y)*r.scale;(0!==s||0!==c)&&t.scroll({dx:s,dy:c}),a.zoom!==r.scale&&t.zoom(a.zoom,{x:0,y:0})}}),e.on("diagram.clear",function(){i.clear(),n=null})}function tv(){this._entries=[],this.set=function(e,t){var n=!1;for(var i in this._entries)if(this._entries[i][0]===e){this._entries[i][1]=t,n=!0;break}n||this._entries.push([e,t])},this.get=function(e){for(var t in this._entries)if(this._entries[t][0]===e)return this._entries[t][1];return null},this.clear=function(){this._entries.length=0},this.remove=function(e){var t=-1;for(var n in this._entries)if(this._entries[n][0]===e){t=n;break}-1!==t&&this._entries.splice(t,1)}}function ty(e,t){this._eventBus=e,this._moddle=t;var n=this;e.on("import.render.start",1500,function(e,t){n._handleImport(t.definitions)})}function tb(e,t,n,i,o){ts.call(this,t),this._canvas=e,this._eventBus=t,this._elementRegistry=n,this._overlays=i,this._translate=o;var r=this;this.executed("shape.toggleCollapse",250,function(e){var t=e.shape;r._canDrillDown(t)?r._addOverlay(t):r._removeOverlay(t)},!0),this.reverted("shape.toggleCollapse",250,function(e){var t=e.shape;r._canDrillDown(t)?r._addOverlay(t):r._removeOverlay(t)},!0),this.executed(["shape.create","shape.move","shape.delete"],250,function(e){var t=e.oldParent,n=e.newParent||e.parent,i=e.shape;r._canDrillDown(i)&&r._addOverlay(i),r._updateDrilldownOverlay(t),r._updateDrilldownOverlay(n),r._updateDrilldownOverlay(i)},!0),this.reverted(["shape.create","shape.move","shape.delete"],250,function(e){var t=e.oldParent,n=e.newParent||e.parent,i=e.shape;r._canDrillDown(i)&&r._addOverlay(i),r._updateDrilldownOverlay(t),r._updateDrilldownOverlay(n),r._updateDrilldownOverlay(i)},!0),t.on("import.render.complete",function(){n.filter(function(e){return r._canDrillDown(e)}).map(function(e){r._addOverlay(e)})})}function tx(e){e&&"function"==typeof e.stopPropagation&&e.stopPropagation()}function t_(e){return e.originalEvent||e.srcEvent}function tw(e){tx(e),tx(t_(e))}function tE(e){return e.pointers&&e.pointers.length&&(e=e.pointers[0]),e.touches&&e.touches.length&&(e=e.touches[0]),e?{x:e.clientX,y:e.clientY}:null}function tS(){return/mac/i.test(navigator.platform)}function tk(e,t){return(t_(e)||e).button===t}function tC(e){return tk(e,0)}function tR(e){var t=t_(e)||e;return!!tC(e)&&(tS()?t.metaKey:t.ctrlKey)}function tP(e){var t=t_(e)||e;return tC(e)&&t.shiftKey}function tT(e){return!0}function tj(e){return tC(e)||tk(e,1)}function tD(e,t,n){var i=this;function o(n,i,o){var r,a;(p[n]||tC)(i)&&(o?a=t.getGraphics(o):(r=i.delegateTarget||i.target)&&(a=r,o=t.get(a)),a&&o&&!1===e.fire(n,{element:o,gfx:a,originalEvent:i})&&(i.stopPropagation(),i.preventDefault()))}var r={},l={click:"element.click",contextmenu:"element.contextmenu",dblclick:"element.dblclick",mousedown:"element.mousedown",mousemove:"element.mousemove",mouseover:"element.hover",mouseout:"element.out",mouseup:"element.mouseup"},p={"element.contextmenu":tT,"element.mousedown":tj,"element.mouseup":tj,"element.click":tj,"element.dblclick":tj};function h(e,t,n,i){var a=r[n]=function(e){o(n,e)};i&&(p[n]=i),a.$delegate=s.cl.bind(e,"svg, .djs-element",t,a)}function u(e,t,n){var i=r[n];i&&s.cl.unbind(e,t,i.$delegate)}e.on("canvas.destroy",function(e){var t;t=e.svg,(0,a.Ed)(l,function(e,n){u(t,n,e)})}),e.on("canvas.init",function(e){var t;t=e.svg,(0,a.Ed)(l,function(e,n){h(t,n,e)})}),e.on(["shape.added","connection.added"],function(t){var n=t.element,i=t.gfx;e.fire("interactionEvents.createHit",{element:n,gfx:i})}),e.on(["shape.changed","connection.changed"],500,function(t){var n=t.element,i=t.gfx;e.fire("interactionEvents.updateHit",{element:n,gfx:i})}),e.on("interactionEvents.createHit",500,function(e){var t=e.element,n=e.gfx;i.createDefaultHit(t,n)}),e.on("interactionEvents.updateHit",function(e){var t=e.element,n=e.gfx;i.updateDefaultHit(t,n)});var d=y("djs-hit djs-hit-stroke"),f=y("djs-hit djs-hit-click-stroke"),v={all:y("djs-hit djs-hit-all"),"click-stroke":f,stroke:d,"no-move":y("djs-hit djs-hit-no-move")};function y(e,t){return t=(0,a.f0)({stroke:"white",strokeWidth:15},t||{}),n.cls(e,["no-fill","no-border"],t)}function b(e,t){var n=v[t];if(!n)throw Error("invalid hit type <"+t+">");return(0,c.Lj)(e,n),e}this.removeHits=function(e){var t=(0,s.Kt)(".djs-hit",e);(0,a.Ed)(t,c.Od)},this.createDefaultHit=function(e,t){var n,i=e.waypoints,o=e.isFrame;return i?this.createWaypointsHit(t,i):(n=o?"stroke":"all",this.createBoxHit(t,n,{width:e.width,height:e.height}))},this.createWaypointsHit=function(e,t){var n=m(t);return b(n,"stroke"),(0,c.R3)(e,n),n},this.createBoxHit=function(e,t,n){n=(0,a.f0)({x:0,y:0},n);var i=(0,c.Ue)("rect");return b(i,t),(0,c.Lj)(i,n),(0,c.R3)(e,i),i},this.updateDefaultHit=function(e,t){var n=(0,s.IO)(".djs-hit",t);if(n)return e.waypoints?g(n,e.waypoints):(0,c.Lj)(n,{width:e.width,height:e.height}),n},this.fire=o,this.triggerMouseEvent=function(e,t,n){var i=l[e];if(!i)throw Error("unmapped DOM event name <"+e+">");return o(i,t,n)},this.mouseHandler=function(e){return r[e]},this.registerEvent=h,this.unregisterEvent=u}tm.$inject=["eventBus","elementRegistry","canvas"],tg.$inject=["eventBus","canvas"],ty.prototype._handleImport=function(e){if(e.diagrams){var t=this;this._definitions=e,this._processToDiagramMap={},e.diagrams.forEach(function(e){e.plane&&e.plane.bpmnElement&&(t._processToDiagramMap[e.plane.bpmnElement.id]=e)}),e.diagrams.filter(e=>e.plane).flatMap(e=>t._createNewDiagrams(e.plane)).forEach(function(e){t._movePlaneElementsToOrigin(e.plane)})}},ty.prototype._createNewDiagrams=function(e){var t=this,n=[],i=[];e.get("planeElement").forEach(function(t){var o=t.bpmnElement;if(o){var r,a=o.$parent;em(o,"bpmn:SubProcess")&&!t.isExpanded&&n.push(o),!em(r=o.$parent,"bpmn:SubProcess")||r===e.bpmnElement||eg(o,["bpmn:DataInputAssociation","bpmn:DataOutputAssociation"])||i.push({diElement:t,parent:a})}});var o=[];return n.forEach(function(e){if(!t._processToDiagramMap[e.id]){var n=t._createDiagram(e);t._processToDiagramMap[e.id]=n,o.push(n)}}),i.forEach(function(e){for(var i=e.diElement,o=e.parent;o&&-1===n.indexOf(o);)o=o.$parent;if(o){var r=t._processToDiagramMap[o.id];t._moveToDiPlane(i,r.plane)}}),o},ty.prototype._movePlaneElementsToOrigin=function(e){var t,n=e.get("planeElement"),i=(t={top:1/0,right:-1/0,bottom:-1/0,left:1/0},e.planeElement.forEach(function(e){if(e.bounds){var n=(0,j.JA)(e.bounds);t.top=Math.min(n.top,t.top),t.left=Math.min(n.left,t.left)}}),(0,j.z_)(t)),o={x:i.x-180,y:i.y-160};n.forEach(function(e){e.waypoint?e.waypoint.forEach(function(e){e.x=e.x-o.x,e.y=e.y-o.y}):e.bounds&&(e.bounds.x=e.bounds.x-o.x,e.bounds.y=e.bounds.y-o.y)})},ty.prototype._moveToDiPlane=function(e,t){var n=(function e(t){return em(t,"bpmndi:BPMNDiagram")?t:e(t.$parent)})(e).plane.get("planeElement");n.splice(n.indexOf(e),1),t.get("planeElement").push(e)},ty.prototype._createDiagram=function(e){var t=this._moddle.create("bpmndi:BPMNPlane",{bpmnElement:e}),n=this._moddle.create("bpmndi:BPMNDiagram",{plane:t});return t.$parent=n,t.bpmnElement=e,n.$parent=this._definitions,this._definitions.diagrams.push(n),n},ty.$inject=["eventBus","moddle"],(0,o.Z)(tb,ts),tb.prototype._updateDrilldownOverlay=function(e){var t=this._canvas;if(e){var n=t.findRoot(e);n&&this._updateOverlayVisibility(n)}},tb.prototype._canDrillDown=function(e){var t=this._canvas;return em(e,"bpmn:SubProcess")&&t.findRoot(tu(e))},tb.prototype._updateOverlayVisibility=function(e){var t=this._overlays,n=ev(e),i=t.get({element:n.id,type:"drilldown"})[0];if(i){var o=n&&n.get("flowElements")&&n.get("flowElements").length;(0,s.Sh)(i.html).toggle("bjs-drilldown-empty",!o)}},tb.prototype._addOverlay=function(e){var t=this._canvas,n=this._overlays,i=ev(e);n.get({element:e,type:"drilldown"}).length&&this._removeOverlay(e);var o=(0,s.H6)('<button type="button" class="bjs-drilldown"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4.81801948,3.50735931 L10.4996894,9.1896894 L10.5,4 L12,4 L12,12 L4,12 L4,10.5 L9.6896894,10.4996894 L3.75735931,4.56801948 C3.46446609,4.27512627 3.46446609,3.80025253 3.75735931,3.50735931 C4.05025253,3.21446609 4.52512627,3.21446609 4.81801948,3.50735931 Z"/></svg></button>'),r=i.get("name")||i.get("id"),a=this._translate("Open {element}",{element:r});o.setAttribute("title",a),o.addEventListener("click",function(){t.setRootElement(t.findRoot(tu(e)))}),n.add(e,"drilldown",{position:{bottom:-7,right:-8},html:o}),this._updateOverlayVisibility(e)},tb.prototype._removeOverlay=function(e){this._overlays.remove({element:e,type:"drilldown"})},tb.$inject=["canvas","eventBus","elementRegistry","overlays","translate"],tD.$inject=["eventBus","elementRegistry","styles"];var tB={__init__:["interactionEvents"],interactionEvents:["type",tD]};function tM(e,t){this._eventBus=e,this._canvas=t,this._selectedElements=[];var n=this;e.on(["shape.remove","connection.remove"],function(e){var t=e.element;n.deselect(t)}),e.on(["diagram.clear","root.set"],function(e){n.select(null)})}tM.$inject=["eventBus","canvas"],tM.prototype.deselect=function(e){var t=this._selectedElements,n=t.indexOf(e);if(-1!==n){var i=t.slice();t.splice(n,1),this._eventBus.fire("selection.changed",{oldSelection:i,newSelection:t})}},tM.prototype.get=function(){return this._selectedElements},tM.prototype.isSelected=function(e){return -1!==this._selectedElements.indexOf(e)},tM.prototype.select=function(e,t){var n=this._selectedElements,i=n.slice();(0,a.kJ)(e)||(e=e?[e]:[]);var o=this._canvas,r=o.getRootElement();e=e.filter(function(e){return r===o.findRoot(e)}),t?(0,a.Ed)(e,function(e){-1===n.indexOf(e)&&n.push(e)}):this._selectedElements=n=e.slice(),this._eventBus.fire("selection.changed",{oldSelection:i,newSelection:n})};var tA="hover",tL="selected";function tO(e,t){function n(t,n){e.addMarker(t,n)}function i(t,n){e.removeMarker(t,n)}this._canvas=e,t.on("element.hover",function(e){n(e.element,tA)}),t.on("element.out",function(e){i(e.element,tA)}),t.on("selection.changed",function(e){var t=e.oldSelection,o=e.newSelection;(0,a.Ed)(t,function(e){-1===o.indexOf(e)&&i(e,tL)}),(0,a.Ed)(o,function(e){-1===t.indexOf(e)&&n(e,tL)})})}function tN(e,t,n,i){e.on("create.end",500,function(e){var n=e.context,i=n.canExecute,o=n.elements,r=(n.hints||{}).autoSelect;if(i){if(!1===r)return;(0,a.kJ)(r)?t.select(r):t.select(o.filter(t$))}}),e.on("connect.end",500,function(e){var n=e.context.connection;n&&t.select(n)}),e.on("shape.move.end",500,function(e){var n=e.previousSelection||[],o=i.get(e.context.shape.id);(0,a.sE)(n,function(e){return o.id===e.id})||t.select(o)}),e.on("element.click",function(e){if(tC(e)){var i=e.element;i===n.getRootElement()&&(i=null);var o=t.isSelected(i),r=t.get().length>1,a=tP(e);if(o&&r)return a?t.deselect(i):t.select(i);o?t.deselect(i):t.select(i,a)}})}function t$(e){return!e.hidden}tO.$inject=["canvas","eventBus"],tN.$inject=["eventBus","selection","canvas","elementRegistry"];var tI={__init__:["selectionVisuals","selectionBehavior"],__depends__:[tB],selection:["type",tM],selectionVisuals:["type",tO],selectionBehavior:["type",tN]};function tz(e){eC.call(this,e)}(0,o.Z)(tz,eC),tz.prototype._modules=[{__depends__:[{__init__:["bpmnRenderer"],bpmnRenderer:["type",eX],textRenderer:["type",e1],pathMap:["type",function(){this.pathMap={EVENT_MESSAGE:{d:"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}",height:36,width:36,heightElements:[6,14],widthElements:[10.5,21]},EVENT_SIGNAL:{d:"M {mx},{my} l {e.x0},{e.y0} l -{e.x1},0 Z",height:36,width:36,heightElements:[18],widthElements:[10,20]},EVENT_ESCALATION:{d:"M {mx},{my} l {e.x0},{e.y0} l -{e.x0},-{e.y1} l -{e.x0},{e.y1} Z",height:36,width:36,heightElements:[20,7],widthElements:[8]},EVENT_CONDITIONAL:{d:"M {e.x0},{e.y0} l {e.x1},0 l 0,{e.y2} l -{e.x1},0 Z M {e.x2},{e.y3} l {e.x0},0 M {e.x2},{e.y4} l {e.x0},0 M {e.x2},{e.y5} l {e.x0},0 M {e.x2},{e.y6} l {e.x0},0 M {e.x2},{e.y7} l {e.x0},0 M {e.x2},{e.y8} l {e.x0},0 ",height:36,width:36,heightElements:[8.5,14.5,18,11.5,14.5,17.5,20.5,23.5,26.5],widthElements:[10.5,14.5,12.5]},EVENT_LINK:{d:"m {mx},{my} 0,{e.y0} -{e.x1},0 0,{e.y1} {e.x1},0 0,{e.y0} {e.x0},-{e.y2} -{e.x0},-{e.y2} z",height:36,width:36,heightElements:[4.4375,6.75,7.8125],widthElements:[9.84375,13.5]},EVENT_ERROR:{d:"m {mx},{my} {e.x0},-{e.y0} {e.x1},-{e.y1} {e.x2},{e.y2} {e.x3},-{e.y3} -{e.x4},{e.y4} -{e.x5},-{e.y5} z",height:36,width:36,heightElements:[.023,8.737,8.151,16.564,10.591,8.714],widthElements:[.085,6.672,6.97,4.273,5.337,6.636]},EVENT_CANCEL_45:{d:"m {mx},{my} -{e.x1},0 0,{e.x0} {e.x1},0 0,{e.y1} {e.x0},0 0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z",height:36,width:36,heightElements:[4.75,8.5],widthElements:[4.75,8.5]},EVENT_COMPENSATION:{d:"m {mx},{my} {e.x0},-{e.y0} 0,{e.y1} z m {e.x1},-{e.y2} {e.x2},-{e.y3} 0,{e.y1} -{e.x2},-{e.y3} z",height:36,width:36,heightElements:[6.5,13,.4,6.1],widthElements:[9,9.3,8.7]},EVENT_TIMER_WH:{d:"M {mx},{my} l {e.x0},-{e.y0} m -{e.x0},{e.y0} l {e.x1},{e.y1} ",height:36,width:36,heightElements:[10,2],widthElements:[3,7]},EVENT_TIMER_LINE:{d:"M {mx},{my} m {e.x0},{e.y0} l -{e.x1},{e.y1} ",height:36,width:36,heightElements:[10,3],widthElements:[0,0]},EVENT_MULTIPLE:{d:"m {mx},{my} {e.x1},-{e.y0} {e.x1},{e.y0} -{e.x0},{e.y1} -{e.x2},0 z",height:36,width:36,heightElements:[6.28099,12.56199],widthElements:[3.1405,9.42149,12.56198]},EVENT_PARALLEL_MULTIPLE:{d:"m {mx},{my} {e.x0},0 0,{e.y1} {e.x1},0 0,{e.y0} -{e.x1},0 0,{e.y1} -{e.x0},0 0,-{e.y1} -{e.x1},0 0,-{e.y0} {e.x1},0 z",height:36,width:36,heightElements:[2.56228,7.68683],widthElements:[2.56228,7.68683]},GATEWAY_EXCLUSIVE:{d:"m {mx},{my} {e.x0},{e.y0} {e.x1},{e.y0} {e.x2},0 {e.x4},{e.y2} {e.x4},{e.y1} {e.x2},0 {e.x1},{e.y3} {e.x0},{e.y3} {e.x3},0 {e.x5},{e.y1} {e.x5},{e.y2} {e.x3},0 z",height:17.5,width:17.5,heightElements:[8.5,6.5312,-6.5312,-8.5],widthElements:[6.5,-6.5,3,-3,5,-5]},GATEWAY_PARALLEL:{d:"m {mx},{my} 0,{e.y1} -{e.x1},0 0,{e.y0} {e.x1},0 0,{e.y1} {e.x0},0 0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z",height:30,width:30,heightElements:[5,12.5],widthElements:[5,12.5]},GATEWAY_EVENT_BASED:{d:"m {mx},{my} {e.x0},{e.y0} {e.x0},{e.y1} {e.x1},{e.y2} {e.x2},0 z",height:11,width:11,heightElements:[-6,6,12,-12],widthElements:[9,-3,-12]},GATEWAY_COMPLEX:{d:"m {mx},{my} 0,{e.y0} -{e.x0},-{e.y1} -{e.x1},{e.y2} {e.x0},{e.y1} -{e.x2},0 0,{e.y3} {e.x2},0  -{e.x0},{e.y1} l {e.x1},{e.y2} {e.x0},-{e.y1} 0,{e.y0} {e.x3},0 0,-{e.y0} {e.x0},{e.y1} {e.x1},-{e.y2} -{e.x0},-{e.y1} {e.x2},0 0,-{e.y3} -{e.x2},0 {e.x0},-{e.y1} -{e.x1},-{e.y2} -{e.x0},{e.y1} 0,-{e.y0} -{e.x3},0 z",height:17.125,width:17.125,heightElements:[4.875,3.4375,2.125,3],widthElements:[3.4375,2.125,4.875,3]},DATA_OBJECT_PATH:{d:"m 0,0 {e.x1},0 {e.x0},{e.y0} 0,{e.y1} -{e.x2},0 0,-{e.y2} {e.x1},0 0,{e.y0} {e.x0},0",height:61,width:51,heightElements:[10,50,60],widthElements:[10,40,50,60]},DATA_OBJECT_COLLECTION_PATH:{d:"m{mx},{my} m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10",height:10,width:10,heightElements:[],widthElements:[]},DATA_ARROW:{d:"m 5,9 9,0 0,-3 5,5 -5,5 0,-3 -9,0 z",height:61,width:51,heightElements:[],widthElements:[]},DATA_STORE:{d:"m  {mx},{my} l  0,{e.y2} c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 l  0,-{e.y2} c -{e.x0},-{e.y1} -{e.x1},-{e.y1} -{e.x2},0c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 m  -{e.x2},{e.y0}c  {e.x0},{e.y1} {e.x1},{e.y1} {e.x2},0m  -{e.x2},{e.y0}c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0",height:61,width:61,heightElements:[7,10,45],widthElements:[2,58,60]},TEXT_ANNOTATION:{d:"m {mx}, {my} m 10,0 l -10,0 l 0,{e.y0} l 10,0",height:30,width:10,heightElements:[30],widthElements:[10]},MARKER_SUB_PROCESS:{d:"m{mx},{my} m 7,2 l 0,10 m -5,-5 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_PARALLEL:{d:"m{mx},{my} m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10",height:10,width:10,heightElements:[],widthElements:[]},MARKER_SEQUENTIAL:{d:"m{mx},{my} m 0,3 l 10,0 m -10,3 l 10,0 m -10,3 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_COMPENSATION:{d:"m {mx},{my} 7,-5 0,10 z m 7.1,-0.3 6.9,-4.7 0,10 -6.9,-4.7 z",height:10,width:21,heightElements:[],widthElements:[]},MARKER_LOOP:{d:"m {mx},{my} c 3.526979,0 6.386161,-2.829858 6.386161,-6.320661 0,-3.490806 -2.859182,-6.320661 -6.386161,-6.320661 -3.526978,0 -6.38616,2.829855 -6.38616,6.320661 0,1.745402 0.714797,3.325567 1.870463,4.469381 0.577834,0.571908 1.265885,1.034728 2.029916,1.35457 l -0.718163,-3.909793 m 0.718163,3.909793 -3.885211,0.802902",height:13.9,width:13.7,heightElements:[],widthElements:[]},MARKER_ADHOC:{d:"m {mx},{my} m 0.84461,2.64411 c 1.05533,-1.23780996 2.64337,-2.07882 4.29653,-1.97997996 2.05163,0.0805 3.85579,1.15803 5.76082,1.79107 1.06385,0.34139996 2.24454,0.1438 3.18759,-0.43767 0.61743,-0.33642 1.2775,-0.64078 1.7542,-1.17511 0,0.56023 0,1.12046 0,1.6807 -0.98706,0.96237996 -2.29792,1.62393996 -3.6918,1.66181996 -1.24459,0.0927 -2.46671,-0.2491 -3.59505,-0.74812 -1.35789,-0.55965 -2.75133,-1.33436996 -4.27027,-1.18121996 -1.37741,0.14601 -2.41842,1.13685996 -3.44288,1.96782996 z",height:4,width:15,heightElements:[],widthElements:[]},TASK_TYPE_SEND:{d:"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}",height:14,width:21,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_SCRIPT:{d:"m {mx},{my} c 9.966553,-6.27276 -8.000926,-7.91932 2.968968,-14.938 l -8.802728,0 c -10.969894,7.01868 6.997585,8.66524 -2.968967,14.938 z m -7,-12 l 5,0 m -4.5,3 l 4.5,0 m -3,3 l 5,0m -4,3 l 5,0",height:15,width:12.6,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_USER_1:{d:"m {mx},{my} c 0.909,-0.845 1.594,-2.049 1.594,-3.385 0,-2.554 -1.805,-4.62199999 -4.357,-4.62199999 -2.55199998,0 -4.28799998,2.06799999 -4.28799998,4.62199999 0,1.348 0.974,2.562 1.89599998,3.405 -0.52899998,0.187 -5.669,2.097 -5.794,4.7560005 v 6.718 h 17 v -6.718 c 0,-2.2980005 -5.5279996,-4.5950005 -6.0509996,-4.7760005 zm -8,6 l 0,5.5 m 11,0 l 0,-5"},TASK_TYPE_USER_2:{d:"m {mx},{my} m 2.162,1.009 c 0,2.4470005 -2.158,4.4310005 -4.821,4.4310005 -2.66499998,0 -4.822,-1.981 -4.822,-4.4310005 "},TASK_TYPE_USER_3:{d:"m {mx},{my} m -6.9,-3.80 c 0,0 2.25099998,-2.358 4.27399998,-1.177 2.024,1.181 4.221,1.537 4.124,0.965 -0.098,-0.57 -0.117,-3.79099999 -4.191,-4.13599999 -3.57499998,0.001 -4.20799998,3.36699999 -4.20699998,4.34799999 z"},TASK_TYPE_MANUAL:{d:"m {mx},{my} c 0.234,-0.01 5.604,0.008 8.029,0.004 0.808,0 1.271,-0.172 1.417,-0.752 0.227,-0.898 -0.334,-1.314 -1.338,-1.316 -2.467,-0.01 -7.886,-0.004 -8.108,-0.004 -0.014,-0.079 0.016,-0.533 0,-0.61 0.195,-0.042 8.507,0.006 9.616,0.002 0.877,-0.007 1.35,-0.438 1.353,-1.208 0.003,-0.768 -0.479,-1.09 -1.35,-1.091 -2.968,-0.002 -9.619,-0.013 -9.619,-0.013 v -0.591 c 0,0 5.052,-0.016 7.225,-0.016 0.888,-0.002 1.354,-0.416 1.351,-1.193 -0.006,-0.761 -0.492,-1.196 -1.361,-1.196 -3.473,-0.005 -10.86,-0.003 -11.0829995,-0.003 -0.022,-0.047 -0.045,-0.094 -0.069,-0.139 0.3939995,-0.319 2.0409995,-1.626 2.4149995,-2.017 0.469,-0.4870005 0.519,-1.1650005 0.162,-1.6040005 -0.414,-0.511 -0.973,-0.5 -1.48,-0.236 -1.4609995,0.764 -6.5999995,3.6430005 -7.7329995,4.2710005 -0.9,0.499 -1.516,1.253 -1.882,2.19 -0.37000002,0.95 -0.17,2.01 -0.166,2.979 0.004,0.718 -0.27300002,1.345 -0.055,2.063 0.629,2.087 2.425,3.312 4.859,3.318 4.6179995,0.014 9.2379995,-0.139 13.8569995,-0.158 0.755,-0.004 1.171,-0.301 1.182,-1.033 0.012,-0.754 -0.423,-0.969 -1.183,-0.973 -1.778,-0.01 -5.824,-0.004 -6.04,-0.004 10e-4,-0.084 0.003,-0.586 10e-4,-0.67 z"},TASK_TYPE_INSTANTIATING_SEND:{d:"m {mx},{my} l 0,8.4 l 12.6,0 l 0,-8.4 z l 6.3,3.6 l 6.3,-3.6"},TASK_TYPE_SERVICE:{d:"m {mx},{my} v -1.71335 c 0.352326,-0.0705 0.703932,-0.17838 1.047628,-0.32133 0.344416,-0.14465 0.665822,-0.32133 0.966377,-0.52145 l 1.19431,1.18005 1.567487,-1.57688 -1.195028,-1.18014 c 0.403376,-0.61394 0.683079,-1.29908 0.825447,-2.01824 l 1.622133,-0.01 v -2.2196 l -1.636514,0.01 c -0.07333,-0.35153 -0.178319,-0.70024 -0.323564,-1.04372 -0.145244,-0.34406 -0.321407,-0.6644 -0.522735,-0.96217 l 1.131035,-1.13631 -1.583305,-1.56293 -1.129598,1.13589 c -0.614052,-0.40108 -1.302883,-0.68093 -2.022633,-0.82247 l 0.0093,-1.61852 h -2.241173 l 0.0042,1.63124 c -0.353763,0.0736 -0.705369,0.17977 -1.049785,0.32371 -0.344415,0.14437 -0.665102,0.32092 -0.9635006,0.52046 l -1.1698628,-1.15823 -1.5667691,1.5792 1.1684265,1.15669 c -0.4026573,0.61283 -0.68308,1.29797 -0.8247287,2.01713 l -1.6588041,0.003 v 2.22174 l 1.6724648,-0.006 c 0.073327,0.35077 0.1797598,0.70243 0.3242851,1.04472 0.1452428,0.34448 0.3214064,0.6644 0.5227339,0.96066 l -1.1993431,1.19723 1.5840256,1.56011 1.1964668,-1.19348 c 0.6140517,0.40346 1.3028827,0.68232 2.0233517,0.82331 l 7.19e-4,1.69892 h 2.226848 z m 0.221462,-3.9957 c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z"},TASK_TYPE_SERVICE_FILL:{d:"m {mx},{my} c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z"},TASK_TYPE_BUSINESS_RULE_HEADER:{d:"m {mx},{my} 0,4 20,0 0,-4 z"},TASK_TYPE_BUSINESS_RULE_MAIN:{d:"m {mx},{my} 0,12 20,0 0,-12 zm 0,8 l 20,0 m -13,-4 l 0,8"},MESSAGE_FLOW_MARKER:{d:"m {mx},{my} m -10.5 ,-7 l 0,14 l 21,0 l 0,-14 z l 10.5,6 l 10.5,-6"}},this.getRawPath=function(e){return this.pathMap[e].d},this.getScaledPath=function(e,t){var n,i,o,r,a=this.pathMap[e];t.abspos?(o=t.abspos.x,r=t.abspos.y):(o=t.containerWidth*t.position.mx,r=t.containerHeight*t.position.my);var s={};if(t.position){for(var c=t.containerHeight/a.height*t.yScaleFactor,l=t.containerWidth/a.width*t.xScaleFactor,p=0;p<a.heightElements.length;p++)s["y"+p]=a.heightElements[p]*c;for(var h=0;h<a.widthElements.length;h++)s["x"+h]=a.widthElements[h]*l}return n=a.d,i={mx:o,my:r,e:s},String(n).replace(e2,function(e,t){var n;return n=i,t.replace(e5,function(e,t,i,o,r){t=t||o,n&&(t in n&&(n=n[t]),"function"==typeof n&&r&&(n=n()))}),n=(null==n||n==i?e:n)+""})}}]},{__depends__:[e3],bpmnImporter:["type",e9]}]},{__depends__:[to,ta,{__init__:["rootElementsBehavior"],rootElementsBehavior:["type",tl]}],__init__:["drilldownBreadcrumbs","drilldownOverlayBehavior","drilldownCentering","subprocessCompatibility"],drilldownBreadcrumbs:["type",tm],drilldownCentering:["type",tg],drilldownOverlayBehavior:["type",tb],subprocessCompatibility:["type",ty]},to,tI,e3],tz.prototype._moddleExtensions={};var tH=n(6384),tF="keyboard.keydown",tG="Keyboard binding is now implicit; explicit binding to an element got removed. For more information, see https://github.com/bpmn-io/diagram-js/issues/661";function tW(e,t){var n=this;this._config=e=e||{},this._eventBus=t,this._keydownHandler=this._keydownHandler.bind(this),this._keyupHandler=this._keyupHandler.bind(this),t.on("diagram.destroy",function(){n._fire("destroy"),n.unbind()}),e.bindTo&&console.error("unsupported configuration <keyboard.bindTo>",Error(tG));var i=e&&!1!==e.bind;t.on("canvas.init",function(e){n._target=e.svg,i&&n.bind(),n._fire("init")})}function tV(e,t){var n=this;e.on("editorActions.init",500,function(e){var i=e.editorActions;n.registerBindings(t,i)})}tW.$inject=["config.keyboard","eventBus"],tW.prototype._keydownHandler=function(e){this._keyHandler(e,tF)},tW.prototype._keyupHandler=function(e){this._keyHandler(e,"keyboard.keyup")},tW.prototype._keyHandler=function(e,t){!this._isEventIgnored(e)&&this._eventBus.fire(t||tF,{keyEvent:e})&&e.preventDefault()},tW.prototype._isEventIgnored=function(e){return!1},tW.prototype.bind=function(e){e&&console.error("unsupported argument <node>",Error(tG)),this.unbind(),e=this._node=this._target,s.B.bind(e,"keydown",this._keydownHandler),s.B.bind(e,"keyup",this._keyupHandler),this._fire("bind")},tW.prototype.getBinding=function(){return this._node},tW.prototype.unbind=function(){var e=this._node;e&&(this._fire("unbind"),s.B.unbind(e,"keydown",this._keydownHandler),s.B.unbind(e,"keyup",this._keyupHandler)),this._node=null},tW.prototype._fire=function(e){this._eventBus.fire("keyboard."+e,{node:this._node})},tW.prototype.addListener=function(e,t,n){(0,a.mf)(e)&&(n=t,t=e,e=1e3),this._eventBus.on(n||tF,e,t)},tW.prototype.removeListener=function(e,t){this._eventBus.off(t||tF,e)},tW.prototype.hasModifier=tH.aw,tW.prototype.isCmd=tH.JS,tW.prototype.isShift=tH.cY,tW.prototype.isKey=tH.ot,tV.$inject=["eventBus","keyboard"],tV.prototype.registerBindings=function(e,t){function n(n,i){t.isRegistered(n)&&e.addListener(i)}n("undo",function(e){var n=e.keyEvent;if((0,tH.YW)(n))return t.trigger("undo"),!0}),n("redo",function(e){var n=e.keyEvent;if((0,tH.LO)(n))return t.trigger("redo"),!0}),n("copy",function(e){var n=e.keyEvent;if((0,tH.wL)(n))return t.trigger("copy"),!0}),n("paste",function(e){var n=e.keyEvent;if((0,tH.fZ)(n))return t.trigger("paste"),!0}),n("stepZoom",function(e){var n=e.keyEvent;if((0,tH.ot)(["+","Add","="],n)&&(0,tH.JS)(n))return t.trigger("stepZoom",{value:1}),!0}),n("stepZoom",function(e){var n=e.keyEvent;if((0,tH.ot)(["-","Subtract"],n)&&(0,tH.JS)(n))return t.trigger("stepZoom",{value:-1}),!0}),n("zoom",function(e){var n=e.keyEvent;if((0,tH.ot)("0",n)&&(0,tH.JS)(n))return t.trigger("zoom",{value:1}),!0}),n("removeSelection",function(e){var n=e.keyEvent;if((0,tH.ot)(["Backspace","Delete","Del"],n))return t.trigger("removeSelection"),!0})};var tU={__init__:["keyboard","keyboardBindings"],keyboard:["type",tW],keyboardBindings:["type",tV]},tZ={moveSpeed:50,moveSpeedAccelerated:200};function tK(e,t,n){var i=this;this._config=(0,a.f0)({},tZ,e||{}),t.addListener(function(e){var n=e.keyEvent,o=i._config;if(t.isCmd(n)&&t.isKey(["ArrowLeft","Left","ArrowUp","Up","ArrowDown","Down","ArrowRight","Right"],n)){var r,a=t.isShift(n)?o.moveSpeedAccelerated:o.moveSpeed;switch(n.key){case"ArrowLeft":case"Left":r="left";break;case"ArrowUp":case"Up":r="up";break;case"ArrowRight":case"Right":r="right";break;case"ArrowDown":case"Down":r="down"}return i.moveCanvas({speed:a,direction:r}),!0}}),this.moveCanvas=function(e){var t=0,i=0,o=e.speed/Math.min(Math.sqrt(n.viewbox().scale),1);switch(e.direction){case"left":t=o;break;case"up":i=o;break;case"right":t=-o;break;case"down":i=-o}n.scroll({dx:t,dy:i})}}tK.$inject=["config.keyboardMove","keyboard","canvas"];var tJ={__depends__:[tU],__init__:["keyboardMove"],keyboardMove:["type",tK]},tq=/^djs-cursor-.*$/;function tX(e){var t=(0,s.Sh)(document.body);t.removeMatching(tq),e&&t.add("djs-cursor-"+e)}function tY(e,t){function n(){return!1}return t=t||"element.click",e.once(t,5e3,n),function(){e.off(t,n)}}function tQ(e){return{x:e.x+e.width/2,y:e.y+e.height/2}}function t0(e,t){return{x:e.x-t.x,y:e.y-t.y}}function t1(e,t){var n;function i(e){return function(e){if(!(0,s.oq)(e.target,".djs-draggable")){var t=e.button;if(!(t>=2)&&!e.ctrlKey&&!e.shiftKey&&!e.altKey)return n={button:t,start:tE(e)},s.B.bind(document,"mousemove",o),s.B.bind(document,"mouseup",r),!0}}(e.originalEvent)}function o(i){var o,r=n.start,a=n.button,s=tE(i),c=t0(s,r);!n.dragging&&Math.sqrt(Math.pow((o=c).x,2)+Math.pow(o.y,2))>15&&(n.dragging=!0,0===a&&tY(e),tX("grab")),n.dragging&&(c=t0(s,n.last||n.start),t.scroll({dx:c.x,dy:c.y}),n.last=s),i.preventDefault()}function r(e){s.B.unbind(document,"mousemove",o),s.B.unbind(document,"mouseup",r),n=null,tX(null)}e.on("canvas.focus.changed",function(t){t.focused?e.on("element.mousedown",500,i):e.off("element.mousedown",i)}),this.isActive=function(){return!!n}}t1.$inject=["eventBus","canvas"];var t2={__init__:["moveCanvas"],moveCanvas:["type",t1]};function t5(e){return Math.log(e)/Math.log(10)}function t3(e,t){return(Math.abs(t5(e.min))+Math.abs(t5(e.max)))/t}var t6=Math.sign||function(e){return e>=0?1:-1},t4={min:.2,max:4};function t9(e,t,n){e=e||{},this._enabled=!1,this._canvas=n,this._container=n._container,this._handleWheel=(0,a.ak)(this._handleWheel,this),this._totalDelta=0,this._scale=e.scale||.75;var i=this;t.on("canvas.focus.changed",function(t){i._init(t.focused&&!1!==e.enabled)})}t9.$inject=["config.zoomScroll","eventBus","canvas"],t9.prototype.scroll=function(e){this._canvas.scroll(e)},t9.prototype.reset=function(){this._canvas.zoom("fit-viewport")},t9.prototype.zoom=function(e,t){var n=t3(t4,20);this._totalDelta+=e,Math.abs(this._totalDelta)>.1&&(this._zoom(e,t,n),this._totalDelta=0)},t9.prototype._handleWheel=function(e){if(this._canvas.isFocused()){var t=this._container;e.preventDefault();var n,i=e.ctrlKey||tS()&&e.metaKey,o=e.shiftKey,r=-1*this._scale;if(i?r*=0===e.deltaMode?.02:.32:r*=0===e.deltaMode?1:16,i){var a=t.getBoundingClientRect(),s={x:e.clientX-a.left,y:e.clientY-a.top};n=Math.sqrt(Math.pow(e.deltaY,2)+Math.pow(e.deltaX,2))*t6(e.deltaY)*r,this.zoom(n,s)}else n=o?{dx:r*e.deltaY,dy:0}:{dx:r*e.deltaX,dy:r*e.deltaY},this.scroll(n)}},t9.prototype.stepZoom=function(e,t){var n=t3(t4,10);this._zoom(e,t,n)},t9.prototype._zoom=function(e,t,n){var i=this._canvas,o=Math.round(t5(i.zoom())/n)*n,r=Math.pow(10,o+=n*(e>0?1:-1));i.zoom(Math.max(t4.min,Math.min(t4.max,r)),t)},t9.prototype.toggle=function(e){var t=this._container,n=this._handleWheel,i=this._enabled;return void 0===e&&(e=!i),i!==e&&s.B[e?"bind":"unbind"](t,"wheel",n,!1),this._enabled=e,e},t9.prototype._init=function(e){this.toggle(e)};var t8={__init__:["zoomScroll"],zoomScroll:["type",t9]};function t7(e){tz.call(this,e)}function ne(e){return e&&e[e.length-1]}function nt(e){return e.y}function nn(e){return e.x}(0,o.Z)(t7,tz),t7.prototype._navigationModules=[tJ,t2,t8],t7.prototype._modules=[].concat(tz.prototype._modules,t7.prototype._navigationModules);var ni={left:nn,center:nn,right:function(e){return e.x+e.width},top:nt,middle:nt,bottom:function(e){return e.y+e.height}};function no(e,t){this._modeling=e,this._rules=t}no.$inject=["modeling","rules"],no.prototype._getOrientationDetails=function(e){var t="x",n="width";return -1!==["top","bottom","middle"].indexOf(e)&&(t="y",n="height"),{axis:t,dimension:n}},no.prototype._isType=function(e,t){return -1!==t.indexOf(e)},no.prototype._alignmentPosition=function(e,t){var n,i,o,r,s=this._getOrientationDetails(e),c=s.axis,l=s.dimension,p={},h={},u=!1;if(this._isType(e,["left","top"]))p[e]=t[0][c];else if(this._isType(e,["right","bottom"]))r=ne(t),p[e]=r[c]+r[l];else if(this._isType(e,["center","middle"])){if((0,a.Ed)(t,function(e){var t=e[c]+Math.round(e[l]/2);h[t]?h[t].elements.push(e):h[t]={elements:[e],center:t}}),i=(0,a.MR)(h,function(e){return e.elements.length>1&&(u=!0),e.elements.length}),u)return p[e]=ne(i).center,p;o=t[0],r=ne(t=(0,a.MR)(t,function(e){return e[c]+e[l]})),p[e]=(n=r,Math.round((o[c]+n[c]+n[l])/2))}return p},no.prototype.trigger=function(e,t){var n,i=this._modeling,o=(0,a.hX)(e,function(e){return!(e.waypoints||e.host||e.labelTarget)});if(n=this._rules.allowed("elements.align",{elements:o}),(0,a.kJ)(n)&&(o=n),!(o.length<2)&&n){var r=ni[t],s=(0,a.MR)(o,r),c=this._alignmentPosition(t,s);i.alignElements(s,c)}};let nr=new e8.Z;function na(e){this._scheduled={},e.on("diagram.destroy",()=>{Object.keys(this._scheduled).forEach(e=>{this.cancel(e)})})}na.$inject=["eventBus"],na.prototype.schedule=function(e,t=nr.next()){this.cancel(t);let n=this._schedule(e,t);return this._scheduled[t]=n,n.promise},na.prototype._schedule=function(e,t){let n=function(){let e={};return e.promise=new Promise((t,n)=>{e.resolve=t,e.reject=n}),e}();return{executionId:setTimeout(()=>{try{this._scheduled[t]=null;try{n.resolve(e())}catch(e){n.reject(e)}}catch(e){console.error("Scheduler#_schedule execution failed",e)}}),promise:n.promise}},na.prototype.cancel=function(e){let t=this._scheduled[e];t&&(this._cancel(t),this._scheduled[e]=null)},na.prototype._cancel=function(e){clearTimeout(e.executionId)};var ns=".entry";function nc(e,t,n,i){this._canvas=e,this._elementRegistry=t,this._eventBus=n,this._scheduler=i,this._current=null,this._init()}nc.$inject=["canvas","elementRegistry","eventBus","scheduler"],nc.prototype._init=function(){var e=this;this._eventBus.on("selection.changed",function(t){var n=t.newSelection,i=n.length?1===n.length?n[0]:n:null;i?e.open(i,!0):e.close()}),this._eventBus.on("elements.changed",function(t){var n=t.elements,i=e._current;if(i){var o=i.target,r=(0,a.kJ)(o)?o:[o];if(r.filter(function(e){return n.includes(e)}).length){e.close();var s=r.filter(function(t){return e._elementRegistry.get(t.id)});s.length&&e._updateAndOpen(s.length>1?s:s[0])}}}),this._eventBus.on("canvas.viewbox.changed",function(){e._updatePosition()}),this._eventBus.on("element.marker.update",function(t){if(e.isOpen()){var n=t.element,i=e._current;((0,a.kJ)(i.target)?i.target:[i.target]).includes(n)&&e._updateVisibility()}}),this._container=this._createContainer()},nc.prototype._createContainer=function(){var e=(0,s.H6)('<div class="djs-context-pad-parent"></div>');return this._canvas.getContainer().appendChild(e),e},nc.prototype.registerProvider=function(e,t){t||(t=e,e=1e3),this._eventBus.on("contextPad.getProviders",e,function(e){e.providers.push(t)})},nc.prototype.getEntries=function(e){var t=this._getProviders(),n=(0,a.kJ)(e)?"getMultiElementContextPadEntries":"getContextPadEntries",i={};return(0,a.Ed)(t,function(t){if((0,a.mf)(t[n])){var o=t[n](e);(0,a.mf)(o)?i=o(i):(0,a.Ed)(o,function(e,t){i[t]=e})}}),i},nc.prototype.trigger=function(e,t,n){var i,o,r=this,a=t.delegateTarget||t.target;if(!a)return t.preventDefault();if(i=(0,s.Lj)(a,"data-action"),o=t.originalEvent||t,"mouseover"===e){this._timeout=setTimeout(function(){r._mouseout=r.triggerEntry(i,"hover",o,n)},300);return}if("mouseout"===e){clearTimeout(this._timeout),this._mouseout&&(this._mouseout(),this._mouseout=null);return}return this.triggerEntry(i,e,o,n)},nc.prototype.triggerEntry=function(e,t,n,i){if(this.isShown()){var o=this._current.target,r=this._current.entries[e];if(r){var s=r.action;if(!1!==this._eventBus.fire("contextPad.trigger",{entry:r,event:n})){if((0,a.mf)(s)){if("click"===t)return s(n,o,i)}else if(s[t])return s[t](n,o,i);n.preventDefault()}}}},nc.prototype.open=function(e,t){!t&&this.isOpen(e)||(this.close(),this._updateAndOpen(e))},nc.prototype._getProviders=function(){var e=this._eventBus.createEvent({type:"contextPad.getProviders",providers:[]});return this._eventBus.fire(e),e.providers},nc.prototype._updateAndOpen=function(e){var t,n=this.getEntries(e),i=this._createHtml(e);(0,a.Ed)(n,function(e,n){var o,r=e.group||"default",c=(0,s.H6)(e.html||'<div class="entry" draggable="true"></div>');(0,s.Lj)(c,"data-action",n),(o=(0,s.IO)("[data-group="+(0,tp.D)(r)+"]",i))||(o=(0,s.H6)('<div class="group"></div>'),(0,s.Lj)(o,"data-group",r),i.appendChild(o)),o.appendChild(c),e.className&&function(e,t){var n=(0,s.Sh)(e);(t=(0,a.kJ)(t)?t:t.split(/\s+/g)).forEach(function(e){n.add(e)})}(c,e.className),e.title&&(0,s.Lj)(c,"title",e.title),e.imageUrl&&(t=(0,s.H6)("<img>"),(0,s.Lj)(t,"src",e.imageUrl),t.style.width="100%",t.style.height="100%",c.appendChild(t))}),(0,s.Sh)(i).add("open"),this._current={entries:n,html:i,target:e},this._updatePosition(),this._updateVisibility(),this._eventBus.fire("contextPad.open",{current:this._current})},nc.prototype._createHtml=function(e){var t=this,n=(0,s.H6)('<div class="djs-context-pad"></div>');return s.cl.bind(n,ns,"click",function(e){t.trigger("click",e)}),s.cl.bind(n,ns,"dragstart",function(e){t.trigger("dragstart",e)}),s.cl.bind(n,ns,"mouseover",function(e){t.trigger("mouseover",e)}),s.cl.bind(n,ns,"mouseout",function(e){t.trigger("mouseout",e)}),s.B.bind(n,"mousedown",function(e){e.stopPropagation()}),this._container.appendChild(n),this._eventBus.fire("contextPad.create",{target:e,pad:n}),n},nc.prototype.getPad=function(e){var t,n;return console.warn(Error("ContextPad#getPad is deprecated and will be removed in future library versions, cf. https://github.com/bpmn-io/diagram-js/pull/888")),{html:this.isOpen()&&(t=this._current.target,n=e,t=(0,a.kJ)(t)?t:[t],n=(0,a.kJ)(n)?n:[n],t.length===n.length&&(0,a.yW)(t,function(e){return n.includes(e)}))?this._current.html:this._createHtml(e)}},nc.prototype.close=function(){this.isOpen()&&(clearTimeout(this._timeout),this._container.innerHTML="",this._eventBus.fire("contextPad.close",{current:this._current}),this._current=null)},nc.prototype.isOpen=function(e){var t=this._current;if(!t)return!1;if(!e)return!0;var n=t.target;return(0,a.kJ)(e)===(0,a.kJ)(n)&&((0,a.kJ)(e)?e.length===n.length&&(0,a.yW)(e,function(e){return n.includes(e)}):n===e)},nc.prototype.isShown=function(){return this.isOpen()&&(0,s.Sh)(this._current.html).has("open")},nc.prototype.show=function(){this.isOpen()&&((0,s.Sh)(this._current.html).add("open"),this._updatePosition(),this._eventBus.fire("contextPad.show",{current:this._current}))},nc.prototype.hide=function(){this.isOpen()&&((0,s.Sh)(this._current.html).remove("open"),this._eventBus.fire("contextPad.hide",{current:this._current}))},nc.prototype._getPosition=function(e){if(!(0,a.kJ)(e)&&(0,eL.Ho)(e)){var t=this._canvas.viewbox(),n=e.waypoints[e.waypoints.length-1],i=n.x*t.scale-t.x*t.scale,o=n.y*t.scale-t.y*t.scale;return{left:i+8*this._canvas.zoom(),top:o}}var r=this._canvas.getContainer().getBoundingClientRect(),s=this._getTargetBounds(e);return{left:s.right-r.left+8*this._canvas.zoom(),top:s.top-r.top}},nc.prototype._updatePosition=function(){this._scheduler.schedule(()=>{if(this.isOpen()){var e=this._current.html,t=this._getPosition(this._current.target);"x"in t&&"y"in t?(e.style.left=t.x+"px",e.style.top=t.y+"px"):["top","right","bottom","left"].forEach(function(n){n in t&&(e.style[n]=t[n]+"px")})}},"ContextPad#_updatePosition")},nc.prototype._updateVisibility=function(){this._scheduler.schedule(()=>{if(this.isOpen()){var e=this,t=this._current.target;((0,a.kJ)(t)?t:[t]).some(function(t){return e._canvas.hasMarker(t,"djs-element-hidden")})?e.hide():e.show()}},"ContextPad#_updateVisibility")},nc.prototype._getTargetBounds=function(e){var t=this;return((0,a.kJ)(e)?e:[e]).map(function(e){return t._canvas.getGraphics(e)}).reduce(function(e,t){let n=t.getBoundingClientRect();return e.top=Math.min(e.top,n.top),e.right=Math.max(e.right,n.right),e.bottom=Math.max(e.bottom,n.bottom),e.left=Math.min(e.left,n.left),e.x=e.left,e.y=e.top,e.width=e.right-e.left,e.height=e.bottom-e.top,e},{top:1/0,right:-1/0,bottom:-1/0,left:1/0})};var nl={__depends__:[tB,{scheduler:["type",na]},to],contextPad:["type",nc]},np=n(9080),nh=n(3388),nu=n(9799),nd=n(1994);function nf(e){let{headerEntries:t,onSelect:n,selectedEntry:i,setSelectedEntry:o,title:r}=e,a=(0,nu.Ye)(()=>t.reduce((e,t)=>{let n=t.group||"default",i=e.find(e=>e.id===n);return i?i.entries.push(t):e.push({id:n,entries:[t]}),e},[]),[t]);return(0,nh.dy)`
    <div class="djs-popup-header">
      <h3 class="djs-popup-title" title=${r}>${r}</h3>
      ${a.map(e=>(0,nh.dy)`
        <ul key=${e.id} class="djs-popup-header-group" data-header-group=${e.id}>

          ${e.entries.map(e=>{var t;return(0,nh.dy)`
            <li key=${e.id}>
              <${e.action?"button":"span"}
                class=${t=e===i,(0,nd.Z)("entry",e.className,e.active?"active":"",e.disabled?"disabled":"",t?"selected":"")}
                onClick=${t=>e.action&&n(t,e)}
                title=${e.title||e.label}
                data-id=${e.id}
                onMouseEnter=${()=>e.action&&o(e)}
                onMouseLeave=${()=>e.action&&o(null)}
                onFocus=${()=>e.action&&o(e)}
                onBlur=${()=>e.action&&o(null)}
              >
                ${e.imageUrl&&(0,nh.dy)`<img class="djs-popup-entry-icon" src=${e.imageUrl} alt="" />`||e.imageHtml&&(0,nh.dy)`<div class="djs-popup-entry-icon" dangerouslySetInnerHTML=${{__html:e.imageHtml}} />`}
                ${e.label?(0,nh.dy)`
                  <span class="djs-popup-label">${e.label}</span>
                `:null}
              </${e.action?"button":"span"}>
            </li>
          `})}
        </ul>
      `)}
    </div>
  `}function nm(e){let{entry:t,selected:n,onMouseEnter:i,onMouseLeave:o,onAction:r}=e;return(0,nh.dy)`
    <li
      class=${(0,nd.Z)("entry",{selected:n})}
      data-id=${t.id}
      title=${t.title||t.label}
      tabIndex="0"
      onClick=${r}
      onFocus=${i}
      onBlur=${o}
      onMouseEnter=${i}
      onMouseLeave=${o}
      onDragStart=${e=>r(e,t,"dragstart")}
      draggable=${!0}
    >
      <div class="djs-popup-entry-content">
        <span
          class=${(0,nd.Z)("djs-popup-entry-name",t.className)}
        >
          ${t.imageUrl&&(0,nh.dy)`<img class="djs-popup-entry-icon" src=${t.imageUrl} alt="" />`||t.imageHtml&&(0,nh.dy)`<div class="djs-popup-entry-icon" dangerouslySetInnerHTML=${{__html:t.imageHtml}} />`}

          ${t.label?(0,nh.dy)`
            <span class="djs-popup-label">
              ${t.label}
            </span>
          `:null}
        </span>
        ${t.description&&(0,nh.dy)`
          <span
            class="djs-popup-entry-description"
            title=${t.description}
          >
            ${t.description}
          </span>
        `}
      </div>
      ${t.documentationRef&&(0,nh.dy)`
        <div class="djs-popup-entry-docs">
          <a
            href="${t.documentationRef}"
            onClick=${e=>e.stopPropagation()}
            title="Open element documentation"
            target="_blank"
            rel="noopener"
          >
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M10.6368 10.6375V5.91761H11.9995V10.6382C11.9995 10.9973 11.8623 11.3141 11.5878 11.5885C11.3134 11.863 10.9966 12.0002 10.6375 12.0002H1.36266C0.982345 12.0002 0.660159 11.8681 0.396102 11.6041C0.132044 11.34 1.52588e-05 11.0178 1.52588e-05 10.6375V1.36267C1.52588e-05 0.98236 0.132044 0.660173 0.396102 0.396116C0.660159 0.132058 0.982345 2.95639e-05 1.36266 2.95639e-05H5.91624V1.36267H1.36266V10.6375H10.6368ZM12 0H7.2794L7.27873 1.36197H9.68701L3.06507 7.98391L4.01541 8.93425L10.6373 2.31231V4.72059H12V0Z" fill="#818798"/>
            </svg>
          </a>
        </div>
      `}
    </li>
  `}function ng(e){let{selectedEntry:t,setSelectedEntry:n,entries:i,...o}=e,r=(0,nu.sO)(),a=(0,nu.Ye)(()=>(function(e){let t=[],n=e=>t.find(t=>e.id===t.id),i=e=>!!n(e),o=e=>"string"==typeof e?{id:e}:e;return e.forEach(e=>{let r=e.group?o(e.group):{id:"default"};i(r)?n(r).entries.push(e):t.push({...r,entries:[e]})}),t})(i),[i]);return(0,nu.bt)(()=>{let e=r.current;if(!e)return;let t=e.querySelector(".selected");t&&("function"==typeof t.scrollIntoViewIfNeeded?t.scrollIntoViewIfNeeded():t.scrollIntoView({scrollMode:"if-needed",block:"nearest"}))},[t]),(0,nh.dy)`
    <div class="djs-popup-results" ref=${r}>
      ${a.map(e=>(0,nh.dy)`
        ${e.name&&(0,nh.dy)`
          <div key=${e.id} class="entry-header" title=${e.name}>
            ${e.name}
          </div>
        `}
        <ul class="djs-popup-group" data-group=${e.id}>
          ${e.entries.map(e=>(0,nh.dy)`
            <${nm}
              key=${e.id}
              entry=${e}
              selected=${e===t}
              onMouseEnter=${()=>n(e)}
              onMouseLeave=${()=>n(null)}
              ...${o}
            />
          `)}
        </ul>
      `)}
    </div>
  `}function nv(e){let{onClose:t,onSelect:n,className:i,headerEntries:o,position:r,title:c,width:l,scale:p,search:h,emptyPlaceholder:u,searchFn:d,entries:f,onOpened:m,onClosed:g}=e,v=(0,nu.Ye)(()=>!!(0,a.$K)(h)&&f.length>5,[h,f]),[y,b]=(0,nu.eJ)(""),x=(0,nu.I4)((e,t)=>v?t.trim()?d(e.filter(({searchable:e})=>!1!==e),t,{keys:["label","search","description"]}).map(({item:e})=>e):e.filter(({rank:e=0})=>e>=0):e,[v]),[_,w]=(0,nu.eJ)(x(f,y)),[E,S]=(0,nu.eJ)(_[0]),k=(0,nu.I4)(e=>{S(e[0]),w(e)},[E,w,S]);(0,nu.d4)(()=>{k(x(f,y))},[y,f]);let C=(0,nu.I4)(e=>{let t=_.indexOf(E)+e;t<0&&(t=_.length-1),t>=_.length&&(t=0),S(_[t])},[_,E,S]),R=(0,nu.I4)(e=>"Enter"===e.key&&E?n(e,E):"ArrowUp"===e.key?(C(-1),e.preventDefault()):"ArrowDown"===e.key?(C(1),e.preventDefault()):void 0,[n,E,C]),P=(0,nu.I4)(e=>{(0,s.wB)(e.target,"input")&&b(()=>e.target.value)},[b]);(0,nu.d4)(()=>(m(),()=>{g()}),[]);let T=(0,nu.Ye)(()=>c||o.length>0,[c,o]);return(0,nh.dy)`
    <${ny}
      onClose=${t}
      onKeyup=${P}
      onKeydown=${R}
      className=${i}
      position=${r}
      width=${l}
      scale=${p}
    >
      ${T&&(0,nh.dy)`
        <${nf}
          headerEntries=${o}
          onSelect=${n}
          selectedEntry=${E}
          setSelectedEntry=${S}
          title=${c}
        />
      `}
      ${f.length>0&&(0,nh.dy)`
        <div class="djs-popup-body">

          ${v&&(0,nh.dy)`
          <div class="djs-popup-search">
            <svg class="djs-popup-search-icon" width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M9.0325 8.5H9.625L13.3675 12.25L12.25 13.3675L8.5 9.625V9.0325L8.2975 8.8225C7.4425 9.5575 6.3325 10 5.125 10C2.4325 10 0.25 7.8175 0.25 5.125C0.25 2.4325 2.4325 0.25 5.125 0.25C7.8175 0.25 10 2.4325 10 5.125C10 6.3325 9.5575 7.4425 8.8225 8.2975L9.0325 8.5ZM1.75 5.125C1.75 6.9925 3.2575 8.5 5.125 8.5C6.9925 8.5 8.5 6.9925 8.5 5.125C8.5 3.2575 6.9925 1.75 5.125 1.75C3.2575 1.75 1.75 3.2575 1.75 5.125Z" fill="#22242A"/>
            </svg>
            <input type="text" spellcheck=${!1} aria-label="${c}" />
          </div>
          `}

          <${ng}
            entries=${_}
            selectedEntry=${E}
            setSelectedEntry=${S}
            onAction=${n}
          />
        </div>
      `}
    ${u&&0===_.length&&(0,nh.dy)`
      <div class="djs-popup-no-results">${(0,a.mf)(u)?u(y):u}</div>
    `}
    </${ny}>
  `}function ny(e){let{onClose:t,onKeydown:n,onKeyup:i,className:o,children:r,position:a}=e,c=(0,nu.sO)();return(0,nu.bt)(()=>{if("function"!=typeof a)return;let e=c.current,t=a(e);e.style.left=`${t.x}px`,e.style.top=`${t.y}px`},[c.current,a]),(0,nu.bt)(()=>{let e=c.current;e&&(e.querySelector("input")||e).focus()},[]),(0,nu.d4)(()=>{let e=e=>{if("Escape"===e.key)return e.preventDefault(),t()},n=e=>{if(!(0,s.oq)(e.target,".djs-popup",!0))return t()};return document.documentElement.addEventListener("keydown",e),document.body.addEventListener("click",n),()=>{document.documentElement.removeEventListener("keydown",e),document.body.removeEventListener("click",n)}},[]),(0,nh.dy)`
    <div
      class=${(0,nd.Z)("djs-popup",o)}
      style=${{transform:`scale(${e.scale})`,width:`${e.width}px`,"transform-origin":"top left"}}
      onKeydown=${n}
      onKeyup=${i}
      ref=${c}
      tabIndex="-1"
    >
      ${r}
    </div>
  `}var nb=["contextPad.close","canvas.viewbox.changing","commandStack.changed"];function nx(e,t,n,i){this._eventBus=t,this._canvas=n,this._search=i,this._current=null;var o=(0,a.$K)(e&&e.scale)?e.scale:{min:1,max:1};this._config={scale:o},t.on("diagram.destroy",()=>{this.close()}),t.on("element.changed",e=>{let t=this.isOpen()&&this._current.target;e.element===t&&this.refresh()})}function n_(e){return e.reduce((e,t)=>e+function e(t){if((0,a.kJ)(t))return Math.max(...t.map(e));let n=Math.log(t.value.length);return t.match?(t.start?t.end?131.9:7.87:t.wordStart?2.19:1)*n:-.07*n}(t),0)}function nw(e=""){return(0,a.kJ)(e)?e.join(", "):e}function nE(e,t){let n;if(!e)return{tokens:[],matchedWords:{}};let i=[],o={},r=t.map(nS),a=RegExp([`(?<all>${r.join("\\s+")})`,...r].join("|"),"ig"),s=0;for(;n=a.exec(e);){let[r]=n,a=n.index,c=n.index+r.length,l=0===a,p=c===e.length,h=!!n.groups.all,u=l||/\s/.test(e.charAt(a-1)),d=p||/\s/.test(e.charAt(c));for(let a of(n.index>s&&i.push({value:e.slice(s,n.index),index:s}),i.push({value:r,index:n.index,match:!0,wordStart:u,wordEnd:d,start:l,end:p,all:h}),h?t:[r]))o[a.toLowerCase()]=!0;s=n.index+r.length}return s<e.length&&i.push({value:e.slice(s),index:s}),{tokens:i,matchedWords:o}}function nS(e){return e.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&")}nx.$inject=["config.popupMenu","eventBus","canvas","search"],nx.prototype._render=function(){let{position:e,providerId:t,entries:n,headerEntries:i,emptyPlaceholder:o,options:r}=this._current,a=Object.entries(n).map(([e,t])=>({id:e,...t})),s=Object.entries(i).map(([e,t])=>({id:e,...t})),c=e&&(t=>this._ensureVisible(t,e)),l=this._updateScale(this._current.container);(0,np.sY)((0,nh.dy)`
      <${nv}
        onClose=${e=>this.close(e)}
        onSelect=${(e,t,n)=>this.trigger(e,t,n)}
        position=${c}
        className=${t}
        entries=${a}
        headerEntries=${s}
        emptyPlaceholder=${o}
        scale=${l}
        onOpened=${this._onOpened.bind(this)}
        onClosed=${this._onClosed.bind(this)}
        searchFn=${this._search}
        ...${{...r}}
      />
    `,this._current.container)},nx.prototype.open=function(e,t,n,i){if(!e)throw Error("target is missing");if(!t)throw Error("providers for <"+t+"> not found");if(!n)throw Error("position is missing");this.isOpen()&&this.close();let{entries:o,headerEntries:r,emptyPlaceholder:a}=this._getContext(e,t);this._current={position:n,providerId:t,target:e,entries:o,headerEntries:r,emptyPlaceholder:a,container:this._createContainer({provider:t}),options:i},this._emit("open"),this._bindAutoClose(),this._render()},nx.prototype.refresh=function(){if(!this.isOpen())return;let{target:e,providerId:t}=this._current,{entries:n,headerEntries:i,emptyPlaceholder:o}=this._getContext(e,t);this._current={...this._current,entries:n,headerEntries:i,emptyPlaceholder:o},this._emit("refresh"),this._render()},nx.prototype._getContext=function(e,t){let n=this._getProviders(t);if(!n||!n.length)throw Error("provider for <"+t+"> not found");let i=this._getEntries(e,n),o=this._getHeaderEntries(e,n);return{entries:i,headerEntries:o,emptyPlaceholder:this._getEmptyPlaceholder(n),empty:!(Object.keys(i).length||Object.keys(o).length)}},nx.prototype.close=function(){this.isOpen()&&(this._emit("close"),this.reset(),this._canvas.restoreFocus(),this._current=null)},nx.prototype.reset=function(){let e=this._current.container;(0,np.sY)(null,e),(0,s.Od)(e)},nx.prototype._emit=function(e,t){this._eventBus.fire(`popupMenu.${e}`,t)},nx.prototype._onOpened=function(){this._emit("opened")},nx.prototype._onClosed=function(){this._emit("closed")},nx.prototype._createContainer=function(e){var t=this._canvas.getContainer();let n=(0,s.H6)(`<div class="djs-popup-parent djs-scrollable" data-popup=${e.provider}></div>`);return t.appendChild(n),n},nx.prototype._bindAutoClose=function(){this._eventBus.once(nb,this.close,this)},nx.prototype._unbindAutoClose=function(){this._eventBus.off(nb,this.close,this)},nx.prototype._updateScale=function(){var e,t,n=this._canvas.zoom(),i=this._config.scale,o=n;return!0!==i&&(!1===i?(e=1,t=1):(e=i.min,t=i.max),(0,a.$K)(e)&&n<e&&(o=e),(0,a.$K)(t)&&n>t&&(o=t)),o},nx.prototype._ensureVisible=function(e,t){var n=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect(),o={},r=t.x,a=t.y;return t.x+i.width>n.width&&(o.x=!0),t.y+i.height>n.height&&(o.y=!0),o.x&&o.y?(r=t.x-i.width,a=t.y-i.height):o.x?(r=t.x-i.width,a=t.y):o.y&&t.y<i.height?(r=t.x,a=10):o.y&&(r=t.x,a=t.y-i.height),t.y<n.top&&(a=t.y+i.height),{x:r,y:a}},nx.prototype.isEmpty=function(e,t){if(!e)throw Error("target is missing");if(!t)throw Error("provider ID is missing");let n=this._getProviders(t);return!n||!n.length||this._getContext(e,t).empty},nx.prototype.registerProvider=function(e,t,n){n||(n=t,t=1e3),this._eventBus.on("popupMenu.getProviders."+e,t,function(e){e.providers.push(n)})},nx.prototype._getProviders=function(e){var t=this._eventBus.createEvent({type:"popupMenu.getProviders."+e,providers:[]});return this._eventBus.fire(t),t.providers},nx.prototype._getEntries=function(e,t){var n={};return(0,a.Ed)(t,function(t){if(!t.getPopupMenuEntries){(0,a.Ed)(t.getEntries(e),function(e){var t=e.id;if(!t)throw Error("entry ID is missing");n[t]=(0,a.CE)(e,["id"])});return}var i=t.getPopupMenuEntries(e);(0,a.mf)(i)?n=i(n):(0,a.Ed)(i,function(e,t){n[t]=e})}),n},nx.prototype._getHeaderEntries=function(e,t){var n={};return(0,a.Ed)(t,function(t){if(!t.getPopupMenuHeaderEntries){if(!t.getHeaderEntries)return;(0,a.Ed)(t.getHeaderEntries(e),function(e){var t=e.id;if(!t)throw Error("entry ID is missing");n[t]=(0,a.CE)(e,["id"])});return}var i=t.getPopupMenuHeaderEntries(e);(0,a.mf)(i)?n=i(n):(0,a.Ed)(i,function(e,t){n[t]=e})}),n},nx.prototype._getEmptyPlaceholder=function(e){let t=e.find(e=>(0,a.mf)(e.getEmptyPlaceholder));return t&&t.getEmptyPlaceholder()},nx.prototype.isOpen=function(){return!!this._current},nx.prototype.trigger=function(e,t,n="click"){if(e.preventDefault(),!t){let n=(0,s.oq)(e.delegateTarget||e.target,".entry",!0),i=(0,s.Lj)(n,"data-id");t={id:i,...this._getEntry(i)}}let i=t.action;if(!1!==this._emit("trigger",{entry:t,event:e})){if((0,a.mf)(i)){if("click"===n)return i(e,t)}else if(i[n])return i[n](e,t)}},nx.prototype._getEntry=function(e){var t=this._current.entries[e]||this._current.headerEntries[e];if(!t)throw Error("entry not found");return t};var nk={search:["value",function(e,t,n){let{keys:i}=n;if(!(t=t.trim().toLowerCase()))throw Error("<pattern> must not be empty");let o=t.trim().toLowerCase().split(/\s+/);return e.flatMap(e=>{let t=function(e,t,n){let{matchedWords:i,tokens:o}=n.reduce((n,i)=>{let o=e[i],{tokens:r,matchedWords:s}=(0,a.kJ)(o)?o.reduce((e,n)=>{let{tokens:i,matchedWords:o}=nE(n,t);return{tokens:[...e.tokens,i],matchedWords:{...e.matchedWords,...o}}},{matchedWords:{},tokens:[]}):nE(o,t);return{tokens:{...n.tokens,[i]:r},matchedWords:{...n.matchedWords,...s}}},{matchedWords:{},tokens:{}});return Object.keys(i).length!==t.length?null:o}(e,o,i);return t?{item:e,tokens:t}:[]}).sort((e,t)=>{let n=0,o=1;for(let c of i){var r,a,s;let i=(r=e.tokens[c],n_(t.tokens[c])-n_(r));if(0!==i){n+=i*o,o*=.9;continue}let l=(a=e.item[c],s=t.item[c],nw(a).localeCompare(nw(s)));if(0!==l){n+=l*o,o*=.9;continue}}return n})}]},nC={__depends__:[nk],__init__:["popupMenu"],popupMenu:["type",nx]},nR={align:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2000 2000">
              <line x1="200" y1="150" x2="200" y2="1850" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
              <rect x="500" y="150" width="1300" height="700" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
              <rect x="500" y="1150" width="700" height="700" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`,bottom:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
            <line x1="150" y1="1650" x2="1650" y2="1650" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
            <rect x="150" y="350" width="600" height="1300" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
            <rect x="1050" y="850" width="600" height="800" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`,center:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
            <line x1="900" y1="150" x2="900" y2="1650" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
            <rect x="250" y="150" width="1300" height="600" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
            <rect x="500" y="1050" width="800" height="600" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`,left:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
            <line x1="100" y1="150" x2="100" y2="1650" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
            <rect x="100" y="150" width="1300" height="600" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
            <rect x="100" y="1050" width="800" height="600" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`,right:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
            <line x1="1650" y1="150" x2="1650" y2="1650" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
            <rect x="350" y="150" width="1300" height="600" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
            <rect x="850" y="1050" width="800" height="600" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`,top:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
            <line x1="150" y1="150" x2="1650" y2="150" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
            <rect x="150" y="150" width="600" height="1300" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
            <rect x="1050" y="150" width="600" height="800" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`,middle:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
            <line x1="150" y1="900" x2="1650" y2="900" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>
            <rect x="150" y="250" width="600" height="1300" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
            <rect x="1050" y="500" width="600" height="800" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
          </svg>`};function nP(e,t,n,i){e.registerProvider(900,this),this._contextPad=e,this._popupMenu=t,this._translate=n,this._canvas=i}nP.$inject=["contextPad","popupMenu","translate","canvas"],nP.prototype.getMultiElementContextPadEntries=function(e){var t={};return this._isAllowed(e)&&(0,a.f0)(t,this._getEntries(e)),t},nP.prototype._isAllowed=function(e){return!this._popupMenu.isEmpty(e,"align-elements")},nP.prototype._getEntries=function(){var e=this;return{"align-elements":{group:"align-elements",title:e._translate("Align elements"),html:`<div class="entry">${nR.align}</div>`,action:{click:function(t,n){var i=e._getMenuPosition(n);(0,a.f0)(i,{cursor:{x:t.x,y:t.y}}),e._popupMenu.open(n,"align-elements",i)}}}}},nP.prototype._getMenuPosition=function(e){var t=this._contextPad.getPad(e).html.getBoundingClientRect();return{x:t.left,y:t.bottom+5}};var nT=["left","center","right","top","middle","bottom"];function nj(e,t,n,i){this._alignElements=t,this._translate=n,this._popupMenu=e,this._rules=i,e.registerProvider("align-elements",this)}function nD(e){ts.call(this,e),this.init()}function nB(e){nD.call(this,e)}function nM(e,t,n,i){for(var o,r,s,c,l;s={x:(o=n).x-t.width/2,y:o.y-t.height/2,width:t.width,height:t.height},r=nL(e),e.host&&(r=r.concat(nL(e.host))),e.attachers&&(r=r.concat(e.attachers.reduce(function(e,t){return e.concat(nL(t))},[]))),c=r,l=(0,a.sE)(c,function(e){return e!==t&&"intersect"===(0,j.T8)(e,s,10)});)n=i(t,n,l);return n}function nA(e){return function(t,n,i){var o={x:n.x,y:n.y};return["x","y"].forEach(function(r){var a=e[r];if(a){var s="x"===r?"width":"height",c=a.margin,l=a.minDistance;c<0?o[r]=Math.min(i[r]+c-t[s]/2,n[r]-l+c):o[r]=Math.max(i[r]+i[s]+c+t[s]/2,n[r]+l+c)}}),o}}function nL(e){return e.outgoing.map(function(e){return e.target}).concat(e.incoming.map(function(e){return e.source}))}function nO(){return!0}function nN(e,t,n){e.on("autoPlace",100,function(e){var t,n,i,o,r=e.shape;return t=e.source,n||(n={}),i=n.defaultDistance||50,o=(0,j.wS)(t),{x:(0,j.JA)(t).right+i+r.width/2,y:o.y}}),e.on("autoPlace.end",function(e){n.scrollToElement(e.shape)}),this.append=function(n,i,o){e.fire("autoPlace.start",{source:n,shape:i});var r=e.fire("autoPlace",{source:n,shape:i}),a=t.appendShape(n,i,r,n.parent,o);return e.fire("autoPlace.end",{source:n,shape:a}),a}}function n$(e,t){e.on("autoPlace.end",500,function(e){t.select(e.shape)})}function nI(e,t){for((0,a.HD)(t)&&(t=[t]);e=e.parent;)if(eg(e,t))return e;return null}function nz(e,t){var n,i=nI(e,"bpmn:Process");if(i)return!0;var o=["bpmn:Participant","bpmn:Lane"];if(i=nI(e,o))return eB(i);if(eg(e,o))return eB(e);for(n=ev(e);n&&!em(n,"bpmn:Process");n=n.$parent);if(!t)return!0;var r=t.find(function(e){var t=ev(e);return t&&t.get("processRef")===n});return!r||eB(r)}function nH(e,t,n){var i,o,r,s,c,l,p,h,u,d,f,m,g,v,y,b=nz(e,n);return em(t,"bpmn:TextAnnotation")?(i=(0,j.JA)(e),o=b?{x:i.right+t.width/2,y:i.top-50-t.height/2}:{x:i.right+50+t.width/2,y:i.bottom+t.height/2},(0,eL.Ho)(e)&&(o=(0,j.wS)(e),b?(o.x+=100,o.y-=50):(o.x+=100,o.y+=50)),r={margin:b?-30:30,minDistance:20},nM(e,t,o,nA(b?{y:r}:{x:r}))):eg(t,["bpmn:DataObjectReference","bpmn:DataStoreReference"])?(s=(0,j.JA)(e),c=b?{x:s.right-10+t.width/2,y:s.bottom+40+t.width/2}:{x:s.left-40-t.width/2,y:s.bottom-10+t.height/2},l={margin:30,minDistance:30},nM(e,t,c,nA(b?{x:l}:{y:l}))):em(t,"bpmn:FlowNode")?(p=(0,j.JA)(e),h=(0,j.wS)(e),d=function(e,t){t||(t={});var n=t.defaultDistance||50,i=t.direction||"e",o=t.filter,r=t.getWeight||function(t){return t.source===e?1:-1},s=t.maxDistance||250,c=t.reference||"start";function l(e,t){return"n"===i?"start"===c?(0,j.JA)(e).top-(0,j.JA)(t).bottom:"center"===c?(0,j.JA)(e).top-(0,j.wS)(t).y:(0,j.JA)(e).top-(0,j.JA)(t).top:"w"===i?"start"===c?(0,j.JA)(e).left-(0,j.JA)(t).right:"center"===c?(0,j.JA)(e).left-(0,j.wS)(t).x:(0,j.JA)(e).left-(0,j.JA)(t).left:"s"===i?"start"===c?(0,j.JA)(t).top-(0,j.JA)(e).bottom:"center"===c?(0,j.wS)(t).y-(0,j.JA)(e).bottom:(0,j.JA)(t).bottom-(0,j.JA)(e).bottom:"start"===c?(0,j.JA)(t).left-(0,j.JA)(e).right:"center"===c?(0,j.wS)(t).x-(0,j.JA)(e).right:(0,j.JA)(t).right-(0,j.JA)(e).right}o||(o=nO);var p=e.incoming.filter(o).map(function(t){var n=r(t),i=n<0?l(t.source,e):l(e,t.source);return{id:t.source.id,distance:i,weight:n}}),h=e.outgoing.filter(o).map(function(t){var n=r(t),i=n>0?l(e,t.target):l(t.target,e);return{id:t.target.id,distance:i,weight:n}}),u=p.concat(h).reduce(function(e,t){return e[t.id+"__weight_"+t.weight]=t,e},{});return(0,a.u4)(u,function(e,t){var n=t.distance,i=t.weight;return n<0||n>s||(e[String(n)]||(e[String(n)]=0),e[String(n)]+=1*i,(!e.distance||e[e.distance]<e[String(n)])&&(e.distance=n)),e},{}).distance||n}(e,{filter:function(e){return em(e,"bpmn:SequenceFlow")},direction:(u=b?{directionHint:"e",minDistance:80,baseOrientation:"left",boundaryOrientation:"top",start:"top",end:"bottom"}:{directionHint:"s",minDistance:90,baseOrientation:"top",boundaryOrientation:"left",start:"left",end:"right"}).directionHint}),f=30,m=u.minDistance,g=u.baseOrientation,em(e,"bpmn:BoundaryEvent")&&-1!==(g=(0,j.T8)(e,e.host,-25)).indexOf(u.boundaryOrientation)&&(f*=-1),v=b?{x:p.right+d+t.width/2,y:h.y+nF(g,m,u)}:{x:h.x+nF(g,m,u),y:p.bottom+d+t.height/2},y={margin:f,minDistance:m},nM(e,t,v,nA(b?{y:y}:{x:y}))):void 0}function nF(e,t,n){return e.includes(n.start)?-1*t:e.includes(n.end)?t:0}function nG(e,t){e.on("autoPlace",function(e){var n=e.shape;return nH(e.source,n,t)})}nj.$inject=["popupMenu","alignElements","translate","rules"],nj.prototype.getPopupMenuEntries=function(e){var t={};return this._isAllowed(e)&&(0,a.f0)(t,this._getEntries(e)),t},nj.prototype._isAllowed=function(e){return this._rules.allowed("elements.align",{elements:e})},nj.prototype._getEntries=function(e){var t=this._alignElements,n=this._translate,i=this._popupMenu,o={};return(0,a.Ed)(nT,function(r){o["align-elements-"+r]={group:"align",title:n("Align elements "+r),className:"bjs-align-elements-menu-entry",imageHtml:nR[r],action:function(){t.trigger(e,r),i.close()}}}),o},nD.$inject=["eventBus"],(0,o.Z)(nD,ts),nD.prototype.addRule=function(e,t,n){var i=this;"string"==typeof e&&(e=[e]),e.forEach(function(e){i.canExecute(e,t,function(e,t,i){return n(e)},!0)})},nD.prototype.init=function(){},nB.$inject=["eventBus"],(0,o.Z)(nB,nD),nB.prototype.init=function(){this.addRule("elements.align",function(e){var t=e.elements,n=(0,a.hX)(t,function(e){return!(e.waypoints||e.host||e.labelTarget)});return!((n=v(n)).length<2)&&n})},nN.$inject=["eventBus","modeling","canvas"],n$.$inject=["eventBus","selection"],nG.$inject=["eventBus","elementRegistry"];var nW={__depends__:[{__init__:["autoPlaceSelectionBehavior"],autoPlace:["type",nN],autoPlaceSelectionBehavior:["type",n$]}],__init__:["bpmnAutoPlace"],bpmnAutoPlace:["type",nG]};function nV(e,t,n,i){ts.call(this,e),this._elementRegistry=t,this._modeling=n,this._rules=i;var o=this;this.postExecuted(["shape.create"],function(e){var t=e.context,n=t.hints||{},i=t.shape,r=t.parent||t.newParent;!1!==n.autoResize&&o._expand([i],r)}),this.postExecuted(["elements.move"],function(e){var t=e.context,n=(0,a.xH)((0,a.VO)(t.closure.topLevel)),i=t.hints,r=!i||i.autoResize;if(!1!==r){var s=(0,a.vM)(n,function(e){return e.parent.id});(0,a.Ed)(s,function(e,t){(0,a.kJ)(r)&&(e=e.filter(function(e){return(0,a.sE)(r,(0,a.KQ)({id:e.id}))})),o._expand(e,t)})}}),this.postExecuted(["shape.toggleCollapse"],function(e){var t=e.context,n=t.hints,i=t.shape;n&&!1===n.autoResize||i.collapsed||o._expand(i.children||[],i)}),this.postExecuted(["shape.resize"],function(e){var t=e.context,n=t.hints,i=t.shape,r=i.parent;(!n||!1!==n.autoResize)&&r&&o._expand([i],r)})}function nU(e){e.invoke(nV,this)}function nZ(e){nD.call(this,e);var t=this;this.addRule("element.autoResize",function(e){return t.canResize(e.elements,e.target)})}function nK(e,t){nZ.call(this,e),this._modeling=t}function nJ(e,t,n){var i,o,r=this,a=n.get("dragging",!1);a&&t.on("drag.start",function(n){t.once("drag.move",1500,function(t){!function(t){if(!t.hover){var n=t.originalEvent,i=r._findTargetGfx(n),o=i&&e.get(i);i&&o&&(t.stopPropagation(),a.hover({element:o,gfx:i}),a.move(n))}}(t)})}),t.on("element.hover",function(e){i=e.gfx,o=e.element}),t.on("element.hover",1500,function(e){o&&t.fire("element.out",{element:o,gfx:i})}),t.on("element.out",function(){i=null,o=null}),this._findTargetGfx=function(e){var t,n;if(e instanceof MouseEvent)return t=tE(e),n=document.elementFromPoint(t.x,t.y),(0,s.oq)(n,"svg, .djs-element",!0)}}nV.$inject=["eventBus","elementRegistry","modeling","rules"],(0,o.Z)(nV,ts),nV.prototype._getOptimalBounds=function(e,t){var n=this.getOffset(t),i=this.getPadding(t),o=(0,j.JA)(_(e)),r=(0,j.JA)(t),s={};return o.top-r.top<i.top&&(s.top=o.top-n.top),o.left-r.left<i.left&&(s.left=o.left-n.left),r.right-o.right<i.right&&(s.right=o.right+n.right),r.bottom-o.bottom<i.bottom&&(s.bottom=o.bottom+n.bottom),(0,j.z_)((0,a.f0)({},r,s))},nV.prototype._expand=function(e,t){if("string"==typeof t&&(t=this._elementRegistry.get(t)),this._rules.allowed("element.autoResize",{elements:e,target:t})){var n=this._getOptimalBounds(e,t);if(i=t,n.x!==i.x||n.y!==i.y||n.width!==i.width||n.height!==i.height){var i,o,r,s,c=(o=(0,a.ei)(t,["x","y","width","height"]),r=n,s="",o=(0,j.JA)(o),r=(0,j.JA)(r),o.top>r.top&&(s=s.concat("n")),o.right<r.right&&(s=s.concat("w")),o.bottom<r.bottom&&(s=s.concat("s")),o.left>r.left&&(s=s.concat("e")),s);this.resize(t,n,{autoResize:c});var l=t.parent;l&&this._expand([t],l)}}},nV.prototype.getOffset=function(e){return{top:60,bottom:60,left:100,right:100}},nV.prototype.getPadding=function(e){return{top:2,bottom:2,left:15,right:15}},nV.prototype.resize=function(e,t,n){this._modeling.resizeShape(e,t,null,n)},nU.$inject=["injector"],(0,o.Z)(nU,nV),nU.prototype.resize=function(e,t,n){em(e,"bpmn:Participant")?this._modeling.resizeLane(e,t,null,n):this._modeling.resizeShape(e,t,null,n)},nZ.$inject=["eventBus"],(0,o.Z)(nZ,nD),nZ.prototype.canResize=function(e,t){return!1},(0,o.Z)(nK,nZ),nK.$inject=["eventBus","modeling"],nK.prototype.canResize=function(e,t){if(em(t.di,"bpmndi:BPMNPlane")||!em(t,"bpmn:Participant")&&!em(t,"bpmn:Lane")&&!em(t,"bpmn:SubProcess"))return!1;var n=!0;return(0,a.Ed)(e,function(e){if(em(e,"bpmn:Lane")||(0,eL.j_)(e)){n=!1;return}}),n},nJ.$inject=["elementRegistry","eventBus","injector"];var nq=Math.round,nX="djs-drag-active";function nY(e){e.preventDefault()}function nQ(e,t,n,i){var o,r={threshold:5,trapClick:!0};function c(e){var n=t.viewbox(),i=t._container.getBoundingClientRect();return{x:n.x+(e.x-i.left)/n.scale,y:n.y+(e.y-i.top)/n.scale}}function l(t,n){n=n||o;var i=e.createEvent((0,a.f0)({},n.payload,n.data,{isTouch:n.isTouch}));return!1!==e.fire("drag."+t,i)&&e.fire(n.prefix+"."+t,i)}function p(e,i){var r=o.payload,s=o.displacement,p=o.globalStart,h=tE(e),u=t0(h,p),d=o.localStart,f=c(h),m=t0(f,d);if(!o.active&&(i||Math.sqrt(Math.pow(u.x,2)+Math.pow(u.y,2))>o.threshold)){if((0,a.f0)(r,{x:nq(d.x+s.x),y:nq(d.y+s.y),dx:0,dy:0},{originalEvent:e}),!1===l("start"))return v();o.active=!0,o.keepSelection||(r.previousSelection=n.get(),n.select(null)),o.cursor&&tX(o.cursor),t.addMarker(t.getRootElement(),nX)}tw(e),o.active&&((0,a.f0)(r,{x:nq(f.x+s.x),y:nq(f.y+s.y),dx:nq(m.x),dy:nq(m.y)},{originalEvent:e}),l("move"))}function h(e){var t=!0;o.active&&(e&&(o.payload.originalEvent=e,tw(e)),t=l("end")),!1===t&&l("rejected"),l("ended",y(!0!==t))}function u(e){(0,tH.ot)("Escape",e)&&(nY(e),v())}function d(t){o.active&&(setTimeout(tY(e),400),nY(t)),h(t)}function f(e){p(e)}function m(e){var t=o.payload;t.hoverGfx=e.gfx,t.hover=e.element,l("hover")}function g(e){l("out");var t=o.payload;t.hoverGfx=null,t.hover=null}function v(e){if(o){var t,n=o.active;n&&l("cancel"),t=y(e),n&&l("canceled",t)}}function y(r){l("cleanup"),tX(null),y=o.trapClick?d:h,s.B.unbind(document,"mousemove",p),s.B.unbind(document,"dragstart",nY),s.B.unbind(document,"selectstart",nY),s.B.unbind(document,"mousedown",y,!0),s.B.unbind(document,"mouseup",y,!0),s.B.unbind(document,"keyup",u),s.B.unbind(document,"touchstart",f,!0),s.B.unbind(document,"touchcancel",v,!0),s.B.unbind(document,"touchmove",p,!0),s.B.unbind(document,"touchend",h,!0),e.off("element.hover",m),e.off("element.out",g),t.removeMarker(t.getRootElement(),nX);var a,c,y,b=o.payload.previousSelection;return!1!==r&&b&&!n.get().length&&(a=b.filter(function(e){return i.get(e.id)})).length&&n.select(a),c=o,o=null,c}e.on("diagram.destroy",v),this.init=function(t,n,i,y){o&&v(!1),"string"==typeof n&&(y=i,i=n,n=null);var b,x,_,w,E,S,k=(y=(0,a.f0)({},r,y||{})).data||{};E=y.trapClick?d:h,t?(x=t_(t)||t,_=tE(t),tw(t),"dragstart"===x.type&&nY(x)):(x=null,_={x:0,y:0}),w=c(_),n||(n=w),b=x,S="undefined"!=typeof TouchEvent&&b instanceof TouchEvent,o=(0,a.f0)({prefix:i,data:k,payload:{},globalStart:_,displacement:t0(n,w),localStart:w,isTouch:S},y),y.manual||(S?(s.B.bind(document,"touchstart",f,!0),s.B.bind(document,"touchcancel",v,!0),s.B.bind(document,"touchmove",p,!0),s.B.bind(document,"touchend",h,!0)):(s.B.bind(document,"mousemove",p),s.B.bind(document,"dragstart",nY),s.B.bind(document,"selectstart",nY),s.B.bind(document,"mousedown",E,!0),s.B.bind(document,"mouseup",E,!0)),s.B.bind(document,"keyup",u),e.on("element.hover",m),e.on("element.out",g)),l("init"),y.autoActivate&&p(t,!0)},this.move=p,this.hover=m,this.out=g,this.end=h,this.cancel=v,this.context=function(){return o},this.setOptions=function(e){(0,a.f0)(r,e)}}nQ.$inject=["eventBus","canvas","selection","elementRegistry"];var n0={__depends__:[{__init__:["hoverFix"],hoverFix:["type",nJ]},tI],dragging:["type",nQ]};function n1(e,t,n){this._canvas=n,this._opts=(0,a.f0)({scrollThresholdIn:[20,20,20,20],scrollThresholdOut:[0,0,0,0],scrollRepeatTimeout:15,scrollStep:10},e);var i=this;t.on("drag.move",function(e){var t=i._toBorderPoint(e);i.startScroll(t)}),t.on(["drag.cleanup"],function(){i.stopScroll()})}function n2(e){this._commandStack=e.get("commandStack",!1)}n1.$inject=["config.autoScroll","eventBus","canvas"],n1.prototype.startScroll=function(e){var t,n,i,o=this._canvas,r=this._opts,a=this,s=o.getContainer().getBoundingClientRect(),c=[e.x,e.y,s.width-e.x,s.height-e.y];this.stopScroll();for(var l=0,p=0,h=0;h<4;h++)t=c[h],n=r.scrollThresholdOut[h],i=r.scrollThresholdIn[h],n<t&&t<i&&(0===h?l=r.scrollStep:1==h?p=r.scrollStep:2==h?l=-r.scrollStep:3==h&&(p=-r.scrollStep));(0!==l||0!==p)&&(o.scroll({dx:l,dy:p}),this._scrolling=setTimeout(function(){a.startScroll(e)},r.scrollRepeatTimeout))},n1.prototype.stopScroll=function(){clearTimeout(this._scrolling)},n1.prototype.setOptions=function(e){this._opts=(0,a.f0)({},this._opts,e)},n1.prototype._toBorderPoint=function(e){var t=this._canvas._container.getBoundingClientRect(),n=tE(e.originalEvent);return{x:n.x-t.left,y:n.y-t.top}},n2.$inject=["injector"],n2.prototype.allowed=function(e,t){var n=!0,i=this._commandStack;return i&&(n=i.canExecute(e,t)),void 0===n||n};var n5={__init__:["rules"],rules:["type",n2]},n3=n(8951),n6=n(6823),n4=Math.round,n9=Math.max;function n8(e,t){var n,i,o,r,a,s,c;return function(e,t){var n,i;for(n=0;i=e[n];n++)if(10>=(0,n3.tW)(i,t))return{point:e[n],bendpoint:!0,index:n};return null}(e,t)||(n=e,i=t,s=(a=(0,n6.Z)([["M",i.x,i.y],["m",0,-10],["a",10,10,0,1,1,0,20],["a",10,10,0,1,1,0,-20],["z"]],(o=[],n.forEach(function(e,t){o.push([0===t?"M":"L",e.x,e.y])}),o)))[0],c=a[a.length-1],s?s!==c?s.segment2!==c.segment2?{point:n[r=n9(s.segment2,c.segment2)-1],bendpoint:!0,index:r}:{point:{x:n4(s.x+c.x)/2,y:n4(s.y+c.y)/2},index:s.segment2}:{point:{x:n4(s.x),y:n4(s.y)},index:s.segment2}:null)}function n7(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function ie(e){return Math.atan((e[1].y-e[0].y)/(e[1].x-e[0].x))}function it(e,t){var n,i,o,r,a=t[0],s=t[1],c={x:s.x-a.x,y:s.y-a.y},l=(n=[a.x,a.y],i=[c.x,c.y],o=[e.x,e.y],-((r=[{n:n[0]-o[0],lambda:i[0]},{n:n[1]-o[1],lambda:i[1]}])[0].n*i[0]+r[1].n*i[1])/(r[0].lambda*i[0]+r[1].lambda*i[1]));return{x:a.x+l*c.x,y:a.y+l*c.y}}function ii(e,t){var n=it(e,t);return n7({x:n.x-e.x,y:n.y-e.y})}function io(e,t){return n7({x:e.x-t.x,y:e.y-t.y})}var ir="djs-bendpoint",ia="djs-segment-dragger";function is(e,t,n){var i,o,r,a;return n8(t,(o=tE(n),i={x:(r=e._container.getBoundingClientRect()).left,y:r.top},{x:(a=e.viewbox()).x+(o.x-i.x)/a.scale,y:a.y+(o.y-i.y)/a.scale}))}function ic(e,t){var n=(0,c.Ue)("g");(0,c.Sh)(n).add(ir),(0,c.R3)(e,n);var i=(0,c.Ue)("circle");(0,c.Lj)(i,{cx:0,cy:0,r:4}),(0,c.Sh)(i).add("djs-visual"),(0,c.R3)(n,i);var o=(0,c.Ue)("circle");return(0,c.Lj)(o,{cx:0,cy:0,r:10}),(0,c.Sh)(o).add("djs-hit"),(0,c.R3)(n,o),t&&(0,c.Sh)(n).add(t),n}function il(e,t,n){var i,o,r,a,s,l,p=(0,c.Ue)("g"),h=(0,n3.SO)(t,n),u=(0,n3.Or)(t,n);return(0,c.R3)(e,p),r=(0,c.Ue)("g"),(0,c.R3)(p,r),i=n.x-t.x,o=n.y-t.y,a="h"===u?ip(i):ip(o),s=(0,c.Ue)("rect"),(0,c.Lj)(s,{x:-9,y:-3,width:18,height:6}),(0,c.Sh)(s).add("djs-visual"),(0,c.R3)(r,s),l=(0,c.Ue)("rect"),(0,c.Lj)(l,{x:-a/2,y:-8.5,width:a,height:17}),(0,c.Sh)(l).add("djs-hit"),(0,c.R3)(r,l),er(r,"v"===u?90:0,0,0),(0,c.Sh)(p).add(ia),(0,c.Sh)(p).add("h"===u?"horizontal":"vertical"),eo(p,h.x,h.y),p}function ip(e){return Math.abs(Math.round(2*e/3))}function ih(e,t,n,i,o){function r(e,t,i){s.B.bind(e,t,function(e){n.triggerMouseEvent(t,e,i),e.stopPropagation()})}function l(e,n){var i=t.getLayer("overlays"),o=(0,s.IO)('.djs-bendpoints[data-element-id="'+(0,tp.D)(e.id)+'"]',i);return!o&&n&&(o=(0,c.Ue)("g"),(0,c.Lj)(o,{"data-element-id":e.id}),(0,c.Sh)(o).add("djs-bendpoints"),(0,c.R3)(i,o),r(o,"mousedown",e),r(o,"click",e),r(o,"dblclick",e)),o}function p(e,t){return(0,s.IO)('.djs-segment-dragger[data-segment-idx="'+e+'"]',t)}function h(e,t){t.waypoints.forEach(function(t,n){var i=ic(e);(0,c.R3)(e,i),eo(i,t.x,t.y)}),ic(e,"floating")}function u(e,t){for(var n,i,o,a=t.waypoints,s=1;s<a.length;s++)n=a[s-1],i=a[s],(0,n3.Or)(n,i)&&(o=il(e,n,i),(0,c.Lj)(o,{"data-segment-idx":s}),r(o,"mousemove",t))}function d(e){var t=l(e);return t||(h(t=l(e,!0),e),u(t,e)),t}function f(e){var t=l(e);t&&((0,a.Ed)((0,s.Kt)("."+ia,t),function(e){(0,c.Od)(e)}),(0,a.Ed)((0,s.Kt)("."+ir,t),function(e){(0,c.Od)(e)}),u(t,e),h(t,e))}e.on("connection.changed",function(e){f(e.element)}),e.on("connection.remove",function(e){var t=l(e.element);t&&(0,c.Od)(t)}),e.on("element.marker.update",function(e){var t,n=e.element;n.waypoints&&(t=d(n),e.add?(0,c.Sh)(t).add(e.marker):(0,c.Sh)(t).remove(e.marker))}),e.on("element.mousemove",function(e){var n,i,o,r,a=e.element,c=a.waypoints;if(c){if(o=l(a,!0),!(r=is(t,c,e.originalEvent)))return;n=(0,s.IO)(".floating",o),i=r.point,n&&eo(n,i.x,i.y),r.bendpoint||function(e,t,n){var i,o,r=p(t.index,e),a=n[t.index-1],c=n[t.index],l=t.point,h=(0,n3.SO)(a,c),u=(0,n3.Or)(a,c);r&&(i=(0,s.IO)(".djs-visual",r),o={x:l.x-h.x,y:l.y-h.y},"v"===u&&(o={x:o.y,y:o.x}),eo(i,o.x,o.y))}(o,r,c)}}),e.on("element.mousedown",function(e){if(tC(e)){var n=e.originalEvent,r=e.element;if(r.waypoints)return function(e,n){var r,a,s,c,l,p,h,u,d,f,m,g,v=n.waypoints,y=is(t,v,e);if(y)return(s=n.waypoints,g=y.index<=0||y.bendpoint?null:(r={start:s[y.index-1],end:s[y.index]},a=(0,n3.Or)(r.start,r.end))?ip("h"===a?r.end.x-r.start.x:r.end.y-r.start.y)/2:null,f=y.index,m=y.point,!(f<=0)&&!y.bendpoint&&(c=v[f-1],l=v[f],p=(0,n3.SO)(c,l),h=(0,n3.Or)(c,l),u=Math.abs(m.x-p.x),d=Math.abs(m.y-p.y),h&&u<=g&&d<=g))?o.start(e,n,y.index):i.start(e,n,y.index,!y.bendpoint),!0}(n,r)}}),e.on("selection.changed",function(e){var t=e.newSelection[0];t&&t.waypoints&&d(t)}),e.on("element.hover",function(e){var t=e.element;t.waypoints&&(d(t),n.registerEvent(e.gfx,"mousemove","element.mousemove"))}),e.on("element.out",function(e){n.unregisterEvent(e.gfx,"mousemove","element.mousemove")}),e.on("element.updateId",function(e){var t=e.element,n=e.newId;if(t.waypoints){var i=l(t);i&&(0,c.Lj)(i,{"data-element-id":n})}}),this.addHandles=d,this.updateHandles=f,this.getBendpointsContainer=l,this.getSegmentDragger=p}ih.$inject=["eventBus","canvas","interactionEvents","bendpointMove","connectionSegmentMove"];var iu=Math.round,id="reconnectStart",im="reconnectEnd",ig="updateWaypoints";function iv(e,t,n,i,o,r){this._injector=e,this.start=function(e,t,r,a){var s,c=n.getGraphics(t),l=t.source,p=t.target,h=t.waypoints,u=(s=a||0!==r?a||r!==h.length-1?ig:im:id)===ig?"connection.updateWaypoints":"connection.reconnect",d=o.allowed(u,{connection:t,source:l,target:p});!1===d&&(d=o.allowed(u,{connection:t,source:p,target:l})),!1!==d&&i.init(e,"bendpoint.move",{data:{connection:t,connectionGfx:c,context:{allowed:d,bendpointIndex:r,connection:t,source:l,target:p,insert:a,type:s}}})},t.on("bendpoint.move.hover",function(e){var t,n=e.context,i=n.connection,r=i.source,a=i.target,s=e.hover,c=n.type;if(n.hover=s,s){var l=c===ig?"connection.updateWaypoints":"connection.reconnect";if(t=n.allowed=o.allowed(l,{connection:i,source:c===id?s:r,target:c===im?s:a})){n.source=c===id?s:r,n.target=c===im?s:a;return}!1===t&&(t=n.allowed=o.allowed(l,{connection:i,source:c===im?s:a,target:c===id?s:r})),t&&(n.source=c===im?s:a,n.target=c===id?s:r)}}),t.on(["bendpoint.move.out","bendpoint.move.cleanup"],function(e){var t=e.context,n=t.type;t.hover=null,t.source=null,t.target=null,n!==ig&&(t.allowed=!1)}),t.on("bendpoint.move.end",function(e){var t=e.context,n=t.allowed,i=t.bendpointIndex,o=t.connection,a=t.insert,s=o.waypoints.slice(),c=t.source,l=t.target,p=t.type,h=t.hints||{},u={x:iu(e.x),y:iu(e.y)};if(!n)return!1;p===ig?(a?s.splice(i,0,u):s[i]=u,h.bendpointMove={insert:a,bendpointIndex:i},s=this.cropWaypoints(o,s),r.updateWaypoints(o,(0,j.Re)(s),h)):(p===id?(h.docking="source",iy(t)&&(h.docking="target",h.newWaypoints=s.reverse())):p===im&&(h.docking="target",iy(t)&&(h.docking="source",h.newWaypoints=s.reverse())),r.reconnect(o,c,l,u,h))},this)}function iy(e){var t=e.hover,n=e.source,i=e.target,o=e.type;return o===id?t&&i&&t===i&&n!==i:o===im?t&&n&&t===n&&n!==i:void 0}iv.$inject=["injector","eventBus","canvas","dragging","rules","modeling"],iv.prototype.cropWaypoints=function(e,t){var n=this._injector.get("connectionDocking",!1);if(!n)return t;var i=e.waypoints;return e.waypoints=t,e.waypoints=n.getCroppedWaypoints(e),t=e.waypoints,e.waypoints=i,t};var ib="updateWaypoints",ix="connect-ok",i_="connect-not-ok",iw="connect-hover",iE="djs-updating",iS="djs-dragging";function ik(e,t,n,i){this._injector=t;var o=t.get("connectionPreview",!1);n.on("bendpoint.move.start",function(e){var t=e.context,n=t.bendpointIndex,o=t.connection,r=t.insert,a=o.waypoints,s=a.slice();t.waypoints=a,r&&s.splice(n,0,{x:e.x,y:e.y}),o.waypoints=s;var l=t.draggerGfx=ic(i.getLayer("overlays"));(0,c.Sh)(l).add("djs-dragging"),i.addMarker(o,iS),i.addMarker(o,iE)}),n.on("bendpoint.move.hover",function(e){var t=e.context,n=t.allowed,o=t.hover,r=t.type;if(o){if(i.addMarker(o,iw),r===ib)return;n?(i.removeMarker(o,i_),i.addMarker(o,ix)):!1===n&&(i.removeMarker(o,ix),i.addMarker(o,i_))}}),n.on(["bendpoint.move.out","bendpoint.move.cleanup"],1100,function(e){var t=e.context,n=t.hover,o=t.target;n&&(i.removeMarker(n,iw),i.removeMarker(n,o?ix:i_))}),n.on("bendpoint.move.move",function(t){var n=t.context,i=n.allowed,r=n.bendpointIndex,a=n.draggerGfx,s=n.hover,c=n.type,l=n.connection,p=l.source,h=l.target,u=l.waypoints.slice(),d={x:t.x,y:t.y},f=n.hints||{},m={};o&&(f.connectionStart&&(m.connectionStart=f.connectionStart),f.connectionEnd&&(m.connectionEnd=f.connectionEnd),"reconnectStart"===c?iy(n)?(m.connectionEnd=m.connectionEnd||d,m.source=h,m.target=s||p,u=u.reverse()):(m.connectionStart=m.connectionStart||d,m.source=s||p,m.target=h):"reconnectEnd"===c?iy(n)?(m.connectionStart=m.connectionStart||d,m.source=s||h,m.target=p,u=u.reverse()):(m.connectionEnd=m.connectionEnd||d,m.source=p,m.target=s||h):(m.noCropping=!0,m.noLayout=!0,u[r]=d),c===ib&&(u=e.cropWaypoints(l,u)),m.waypoints=u,o.drawPreview(n,i,m)),eo(a,t.x,t.y)},this),n.on(["bendpoint.move.end","bendpoint.move.cancel"],1100,function(e){var t=e.context,n=t.connection,r=t.draggerGfx,a=t.hover,s=t.target,l=t.waypoints;n.waypoints=l,(0,c.Od)(r),i.removeMarker(n,iE),i.removeMarker(n,iS),a&&(i.removeMarker(a,ix),i.removeMarker(a,s?ix:i_)),o&&o.cleanUp(t)})}ik.$inject=["bendpointMove","injector","eventBus","canvas"];var iC="connect-hover",iR="djs-updating";function iP(e,t,n){return{x:"x"===t?n:e.x,y:"y"===t?n:e.y}}function iT(e){return"x"===e?"y":"x"}function ij(e,t,n){var i,o;return e.original?e.original:(i=(0,j.wS)(t),iP(e,o=iT(n),i[o]))}function iD(e,t,n,i,o,r){var a=e.get("connectionDocking",!1);function s(e,t){if(!a)return t;var n,i=e.waypoints;return e.waypoints=t,n=a.getCroppedWaypoints(e),e.waypoints=i,n}function l(e){o.update("connection",e.connection,e.connectionGfx)}this.start=function(e,t,o){var r,a,s,c,l=n.getGraphics(t),p=o-1,h=t.waypoints,u=h[p],d=h[o],f=is(n,h,e);(a=(0,n3.Or)(u,d))&&(s="v"===a?"x":"y",0===p&&(u=ij(u,t.source,s)),o===h.length-1&&(d=ij(d,t.target,s)),c=f?f.point:{x:(u.x+d.x)/2,y:(u.y+d.y)/2},r={connection:t,segmentStartIndex:p,segmentEndIndex:o,segmentStart:u,segmentEnd:d,axis:s,dragPosition:c},i.init(e,c,"connectionSegment.move",{cursor:"x"===s?"resize-ew":"resize-ns",data:{connection:t,connectionGfx:l,context:r}}))},t.on("connectionSegment.move.start",function(e){var t=e.context,i=e.connection,o=n.getLayer("overlays");t.originalWaypoints=i.waypoints.slice(),t.draggerGfx=il(o,t.segmentStart,t.segmentEnd),(0,c.Sh)(t.draggerGfx).add("djs-dragging"),n.addMarker(i,iR)}),t.on("connectionSegment.move.move",function(e){var t,n,i,o,r,a,c,p,h,u,d,f,m=e.context,g=m.connection,v=m.segmentStartIndex,y=m.segmentEndIndex,b=m.segmentStart,x=m.segmentEnd,_=m.axis,w=m.originalWaypoints.slice(),E=(t=e["d"+_],iP(b,_,b[_]+t)),S=(n=e["d"+_],iP(x,_,x[_]+n)),k=w.length,C=0;w[v]=E,w[y]=S,v<2&&(d=(0,j.T8)(g.source,E),1===v?"intersect"===d&&(w.shift(),w[0]=E,C--):"intersect"!==d&&(w.unshift(b),C++)),y>k-3&&(f=(0,j.T8)(g.target,S),y===k-2?"intersect"===f&&(w.pop(),w[w.length-1]=S):"intersect"!==f&&w.push(x)),m.newWaypoints=g.waypoints=s(g,w),i=C,r=(o=m.newWaypoints)[m.segmentStartIndex+i],a=o[m.segmentEndIndex+i],p=Math.max(r[c=iT(m.axis)],a[c]),h=Math.min(Math.max(Math.min(r[c],a[c])+20,e[c]),p-20),u=iP(r,c,h),eo(m.draggerGfx,u.x,u.y),m.newSegmentStartIndex=v+C,l(e)}),t.on("connectionSegment.move.hover",function(e){e.context.hover=e.hover,n.addMarker(e.hover,iC)}),t.on(["connectionSegment.move.out","connectionSegment.move.cleanup"],function(e){var t=e.context.hover;t&&n.removeMarker(t,iC)}),t.on("connectionSegment.move.cleanup",function(e){var t=e.context,i=t.connection;t.draggerGfx&&(0,c.Od)(t.draggerGfx),n.removeMarker(i,iR)}),t.on(["connectionSegment.move.cancel","connectionSegment.move.end"],function(e){var t=e.context;t.connection.waypoints=t.originalWaypoints,l(e)}),t.on("connectionSegment.move.end",function(e){var t,n,i=e.context,o=i.connection,a=i.newWaypoints,c=i.newSegmentStartIndex,l=(t=a=a.map(function(e){return{original:e.original,x:Math.round(e.x),y:Math.round(e.y)}}),n=0,{waypoints:t.filter(function(e,i){return!(0,n3.ZS)(t[i-1],t[i+1],e)||(n=i<=c?n-1:n,!1)}),segmentOffset:n}),p=s(o,l.waypoints),h=l.segmentOffset,u={segmentMove:{segmentStartIndex:i.segmentStartIndex,newSegmentStartIndex:c+h}};r.updateWaypoints(o,p,u)})}iD.$inject=["injector","eventBus","canvas","dragging","graphicsFactory","modeling"];var iB=Math.abs,iM=Math.round;function iA(e){return{x:e.x,y:e.y}}function iL(e){return{x:e.x+e.width,y:e.y+e.height}}function iO(e,t){return!e||isNaN(e.x)||isNaN(e.y)?t:{x:iM(e.x+e.width/2),y:iM(e.y+e.height/2)}}function iN(e,t){var n=e.snapped;return!!n&&("string"==typeof t?n[t]:n.x&&n.y)}function i$(e,t,n){if("string"!=typeof t)throw Error("axis must be in [x, y]");if("number"!=typeof n&&!1!==n)throw Error("value must be Number or false");var i,o=e[t],r=e.snapped=e.snapped||{};return!1===n?r[t]=!1:(r[t]=!0,i=n-o,e[t]+=i,e["d"+t]+=i),o}function iI(e){return e.children||[]}var iz=Math.abs,iH=Math.round;function iF(e){function t(e,t){if((0,a.kJ)(e)){for(var n=e.length;n--;)if(10>=iz(e[n]-t))return e[n]}else{var i=t%(e=+e);if(i<10)return t-i;if(i>e-10)return t-i+e}return t}function n(e,t){if(e.waypoints){var n;return n=function(e,t){for(var n,i=t.waypoints,o=1/0,r=0;r<i.length-1;r++){var a=ii(e,[i[r],i[r+1]]);a<o&&(o=a,n=r)}return[i[n],i[n+1]]}(t,e),it(t,n)}if(e.width)return{x:iH(e.width/2+e.x),y:iH(e.height/2+e.y)}}e.on("connectionSegment.move.move",1500,function(e){var i,o,r=function(e){var t=e.context,i=t.snapPoints,o=t.connection,r=o.waypoints,s=t.segmentStart,c=t.segmentStartIndex,l=t.segmentEnd,p=t.segmentEndIndex,h=t.axis;if(i)return i;var u=[r[c-1],s,l,r[p+1]];return c<2&&u.unshift(n(o.source,e)),p>r.length-3&&u.unshift(n(o.target,e)),t.snapPoints=i={horizontal:[],vertical:[]},(0,a.Ed)(u,function(e){e&&(e=e.original||e,"y"===h&&i.horizontal.push(e.y),"x"===h&&i.vertical.push(e.x))}),i}(e),s=e.x,c=e.y;if(r){i=t(r.vertical,s),o=t(r.horizontal,c);var l=s-i,p=c-o;(0,a.f0)(e,{dx:e.dx-l,dy:e.dy-p,x:i,y:o}),(l||-1!==r.vertical.indexOf(s))&&i$(e,"x",i),(p||-1!==r.horizontal.indexOf(c))&&i$(e,"y",o)}}),e.on(["connect.hover","connect.move","connect.end"],1500,function(e){var t=e.context.hover,i=t&&n(t,e);(0,eL.Ho)(t)&&i&&i.x&&i.y&&(i$(e,"x",i.x),i$(e,"y",i.y))}),e.on(["bendpoint.move.move","bendpoint.move.end"],1500,function(e){var i,o,r=e.context,s=function(e){var t=e.snapPoints,n=e.connection.waypoints,i=e.bendpointIndex;if(t)return t;var o=[n[i-1],n[i+1]];return e.snapPoints=t={horizontal:[],vertical:[]},(0,a.Ed)(o,function(e){e&&(e=e.original||e,t.horizontal.push(e.y),t.vertical.push(e.x))}),t}(r),c=r.hover,l=c&&n(c,e),p=e.x,h=e.y;if(s){i=t(l?s.vertical.concat([l.x]):s.vertical,p),o=t(l?s.horizontal.concat([l.y]):s.horizontal,h);var u=p-i,d=h-o;(0,a.f0)(e,{dx:e.dx-u,dy:e.dy-d,x:e.x-u,y:e.y-d}),(u||-1!==s.vertical.indexOf(p))&&i$(e,"x",i),(d||-1!==s.horizontal.indexOf(h))&&i$(e,"y",o)}})}function iG(e,t,n,i){function o(e,t){return i.allowed("connection.create",{source:e,target:t})}e.on("connect.hover",function(e){var t,n=e.context,i=n.start,r=e.hover;if(n.hover=r,t=n.canExecute=o(i,r),!(0,a.kK)(t)){if(!1!==t){n.source=i,n.target=r;return}t=n.canExecute=o(r,i),(0,a.kK)(t)||!1===t||(n.source=r,n.target=i)}}),e.on(["connect.out","connect.cleanup"],function(e){var t=e.context;t.hover=null,t.source=null,t.target=null,t.canExecute=!1}),e.on("connect.end",function(e){var t=e.context,i=t.canExecute,o=t.connectionStart,r={x:e.x,y:e.y},s=t.source,c=t.target;if(!i)return!1;var l=null,p={connectionStart:iW(t)?r:o,connectionEnd:iW(t)?o:r};(0,a.Kn)(i)&&(l=i),t.connection=n.connect(s,c,l,p)}),this.start=function(e,n,i,o){(0,a.Kn)(i)||(o=i,i=(0,j.wS)(n)),t.init(e,"connect",{autoActivate:o,data:{shape:n,context:{start:n,connectionStart:i}}})}}function iW(e){var t=e.hover,n=e.source,i=e.target;return t&&n&&t===n&&n!==i}iF.$inject=["eventBus"],iG.$inject=["eventBus","dragging","modeling","rules"];var iV="connect-ok",iU="connect-not-ok";function iZ(e,t,n){var i=e.get("connectionPreview",!1);i&&t.on("connect.move",function(e){var t=e.context,n=t.canExecute,o=t.hover,r=t.source,a=t.start,s=t.startPosition,c=t.target,l=t.connectionStart||s,p=t.connectionEnd||{x:e.x,y:e.y},h=l,u=p;iW(t)&&(h=p,u=l),i.drawPreview(t,n,{source:r||a,target:c||o,connectionStart:h,connectionEnd:u})}),t.on("connect.hover",900,function(e){var t=e.context,i=e.hover,o=t.canExecute;null!==o&&n.addMarker(i,o?iV:iU)}),t.on(["connect.out","connect.cleanup"],1100,function(e){var t=e.hover;t&&(n.removeMarker(t,iV),n.removeMarker(t,iU))}),i&&t.on("connect.cleanup",function(e){i.cleanUp(e.context)})}iZ.$inject=["injector","eventBus","canvas"];var iK={__depends__:[tI,n5,n0],__init__:["connectPreview"],connect:["type",iG],connectPreview:["type",iZ]};function iJ(e,t,n,i){this._canvas=t,this._graphicsFactory=n,this._elementFactory=i,this._connectionDocking=e.get("connectionDocking",!1),this._layouter=e.get("layouter",!1)}iJ.$inject=["injector","canvas","graphicsFactory","elementFactory"],iJ.prototype.drawPreview=function(e,t,n){n=n||{};var i,o,r,a=e.connectionPreviewGfx,s=e.getConnection,l=n.source,p=n.target,h=n.waypoints,u=n.connectionStart,d=n.connectionEnd,f=n.noLayout,m=n.noCropping,g=n.noNoop,v=this;if(a||(a=e.connectionPreviewGfx=this.createConnectionPreviewGfx()),(0,c.ZH)(a),s||(s=e.getConnection=(i=function(e,t,n){return v.getConnection(e,t,n)},o={},function(e){var t=JSON.stringify(e),n=o[t];return n||(n=o[t]=i.apply(null,arguments)),n})),t&&(r=s(t,l,p)),!r){g||this.drawNoopPreview(a,n);return}r.waypoints=h||[],this._layouter&&!f&&(r.waypoints=this._layouter.layoutConnection(r,{source:l,target:p,connectionStart:u,connectionEnd:d,waypoints:n.waypoints||r.waypoints})),r.waypoints&&r.waypoints.length||(r.waypoints=[l?(0,j.wS)(l):u,p?(0,j.wS)(p):d]),this._connectionDocking&&(l||p)&&!m&&(r.waypoints=this._connectionDocking.getCroppedWaypoints(r,l,p)),this._graphicsFactory.drawConnection(a,r,{stroke:"var(--element-dragger-color)"})},iJ.prototype.drawNoopPreview=function(e,t){var n=t.source,i=t.target,o=t.connectionStart||(0,j.wS)(n),r=t.connectionEnd||(0,j.wS)(i),a=this.cropWaypoints(o,r,n,i),s=this.createNoopConnection(a[0],a[1]);(0,c.R3)(e,s)},iJ.prototype.cropWaypoints=function(e,t,n,i){var o=this._graphicsFactory,r=n&&o.getShapePath(n),a=i&&o.getShapePath(i),s=o.getConnectionPath({waypoints:[e,t]});return[e=n&&(0,j.Hz)(r,s,!0)||e,t=i&&(0,j.Hz)(a,s,!1)||t]},iJ.prototype.cleanUp=function(e){e&&e.connectionPreviewGfx&&(0,c.Od)(e.connectionPreviewGfx)},iJ.prototype.getConnection=function(e){var t=(0,a.Kn)(e)?e:{};return this._elementFactory.createConnection(t)},iJ.prototype.createConnectionPreviewGfx=function(){var e=(0,c.Ue)("g");return(0,c.Lj)(e,{pointerEvents:"none"}),(0,c.Sh)(e).add("djs-dragger"),(0,c.R3)(this._canvas.getActiveLayer(),e),e},iJ.prototype.createNoopConnection=function(e,t){return m([e,t],{stroke:"#333",strokeDasharray:[1],strokeWidth:2,"pointer-events":"none"})};let iq=new e8.Z("ps");var iX=["marker-start","marker-mid","marker-end"],iY=["circle","ellipse","line","path","polygon","polyline","path","rect"];function iQ(e,t,n,i){this._elementRegistry=e,this._canvas=n,this._styles=i}iQ.$inject=["elementRegistry","eventBus","canvas","styles"],iQ.prototype.cleanUp=function(){console.warn("PreviewSupport#cleanUp is deprecated and will be removed in future versions. You do not need to manually clean up previews anymore. cf. https://github.com/bpmn-io/diagram-js/pull/906")},iQ.prototype.getGfx=function(e){return this._elementRegistry.getGraphics(e)},iQ.prototype.addDragger=function(e,t,n,i="djs-dragger"){n=n||this.getGfx(e);var o=(0,c.d9)(n),r=n.getBoundingClientRect();return this._cloneMarkers((0,en.s)(o),i),(0,c.Lj)(o,this._styles.cls(i,[],{x:r.top,y:r.left})),(0,c.R3)(t,o),(0,c.Lj)(o,"data-preview-support-element-id",e.id),o},iQ.prototype.addFrame=function(e,t){var n=(0,c.Ue)("rect",{class:"djs-resize-overlay",width:e.width,height:e.height,x:e.x,y:e.y});return(0,c.R3)(t,n),(0,c.Lj)(n,"data-preview-support-element-id",e.id),n},iQ.prototype._cloneMarkers=function(e,t="djs-dragger",n=e){var i=this;e.childNodes&&e.childNodes.forEach(e=>{i._cloneMarkers(e,t,n)}),-1!==iY.indexOf(e.nodeName)&&iX.forEach(function(o){if((0,c.Lj)(e,o)){var r,a,l=(r=i._canvas.getContainer(),a=(0,c.Lj)(e,o).match(/url\(['"]?#([^'"]*)['"]?\)/)[1],(0,s.IO)("marker#"+a,r||document));l&&i._cloneMarker(n,e,l,o,t)}})},iQ.prototype._cloneMarker=function(e,t,n,i,o="djs-dragger"){var r=[n.id,o,iq.next()].join("-"),a=(0,s.IO)("marker#"+n.id,e);e=e||this._canvas._svg;var l=a||(0,c.d9)(n);l.id=r,(0,c.Sh)(l).add(o);var p=(0,s.IO)(":scope > defs",e);p||(p=(0,c.Ue)("defs"),(0,c.R3)(e,p)),(0,c.R3)(p,l);var h="url(#"+l.id+")";(0,c.Lj)(t,i,h)};var i0={__init__:["previewSupport"],previewSupport:["type",iQ]};let i1="complex-preview";class i2{constructor(e,t,n){this._canvas=e,this._graphicsFactory=t,this._previewSupport=n,this._markers=[]}create(e){this.cleanUp();let{created:t=[],moved:n=[],removed:i=[],resized:o=[]}=e,r=this._canvas.getLayer(i1);t.filter(e=>!e.hidden).forEach(e=>{let t;(0,eL.Ho)(e)?(t=this._graphicsFactory._createContainer("connection",(0,c.Ue)("g")),this._graphicsFactory.drawConnection((0,en.s)(t),e)):(t=this._graphicsFactory._createContainer("shape",(0,c.Ue)("g")),this._graphicsFactory.drawShape((0,en.s)(t),e),eo(t,e.x,e.y)),this._previewSupport.addDragger(e,r,t)}),n.forEach(({element:e,delta:t})=>{this._previewSupport.addDragger(e,r,void 0,"djs-dragging"),this._canvas.addMarker(e,"djs-element-hidden"),this._markers.push([e,"djs-element-hidden"]);let n=this._previewSupport.addDragger(e,r);(0,eL.Ho)(e)?eo(n,t.x,t.y):eo(n,e.x+t.x,e.y+t.y)}),i.forEach(e=>{this._previewSupport.addDragger(e,r,void 0,"djs-dragging"),this._canvas.addMarker(e,"djs-element-hidden"),this._markers.push([e,"djs-element-hidden"])}),o.forEach(({shape:e,bounds:t})=>{this._canvas.addMarker(e,"djs-hidden"),this._markers.push([e,"djs-hidden"]),this._previewSupport.addDragger(e,r,void 0,"djs-dragging");let n=this._graphicsFactory._createContainer("shape",(0,c.Ue)("g"));this._graphicsFactory.drawShape((0,en.s)(n),e,{width:t.width,height:t.height}),eo(n,t.x,t.y),this._previewSupport.addDragger(e,r,n)})}cleanUp(){(0,c.ZH)(this._canvas.getLayer(i1)),this._markers.forEach(([e,t])=>this._canvas.removeMarker(e,t)),this._markers=[]}show(){this._canvas.showLayer(i1)}hide(){this._canvas.hideLayer(i1)}}i2.$inject=["canvas","graphicsFactory","previewSupport"];var i5=["top","bottom","left","right"];function i3(e,t){function n(e){if(!(!e$(e)||(0,eL.Ho)(e))){var n=function(e){var t=(0,j.wS)(e.label),n=i6((0,j.wS)(e),t);if(-1!==i5.indexOf(n)){var i=(o=(0,j.wS)(e),[].concat(e.incoming.map(function(e){return e.waypoints[e.waypoints.length-2]}),e.outgoing.map(function(e){return e.waypoints[1]})).map(function(e){return i6(o,e)}));if(e.host){var o,r,a,s,c,l=(a=e.host,s=(0,j.wS)(e),r=(c=(0,j.T8)(s,a)).indexOf("-")>=0?c.split("-"):[c],i5.filter(function(e){return -1===r.indexOf(e)}));i=i.concat(l)}var p=i5.filter(function(e){return -1===i.indexOf(e)});if(-1===p.indexOf(n))return p[0]}}(e);n&&function(e,n){var i,o=(0,j.wS)(e),r=e.label,a=(0,j.wS)(r);if(r.parent){var s=(0,j.JA)(e);switch(n){case"top":i={x:o.x,y:s.top-10-r.height/2};break;case"left":i={x:s.left-10-r.width/2,y:o.y};break;case"bottom":i={x:o.x,y:s.bottom+10+r.height/2};break;case"right":i={x:s.right+10+r.width/2,y:o.y}}var c=t0(i,a);t.moveShape(r,c)}}(e,n)}}ts.call(this,e),this.postExecuted(["connection.create","connection.layout","connection.updateWaypoints"],function(e){var t=e.context,i=t.connection,o=i.source,r=i.target;!1!==(t.hints||{}).createElementsBehavior&&(n(o),n(r))}),this.postExecuted(["label.create"],function(e){var t=e.context,i=t.shape;!1!==(t.hints||{}).createElementsBehavior&&n(i.labelTarget)}),this.postExecuted(["elements.create"],function(e){var t=e.context,i=t.elements;!1!==(t.hints||{}).createElementsBehavior&&i.forEach(function(e){n(e)})})}function i6(e,t){return(0,j.T8)(t,e,5)}function i4(e){ts.call(this,e),this.preExecute("shape.append",function(e){var t=e.source,n=e.shape;e.position||(em(n,"bpmn:TextAnnotation")?e.position={x:t.x+t.width/2+75,y:t.y-50-n.height/2}:e.position={x:t.x+t.width+80+n.width/2,y:t.y+t.height/2})},!0)}function i9(e,t){e.invoke(ts,this),this.postExecute("shape.move",function(e){var n=e.newParent,i=e.shape,o=(0,a.hX)(i.incoming.concat(i.outgoing),function(e){return em(e,"bpmn:Association")});(0,a.Ed)(o,function(e){t.moveConnection(e,{x:0,y:0},n)})},!0)}function i8(e,t){t.invoke(ts,this),this._bpmnReplace=e;var n=this;this.postExecuted("elements.create",500,function(e){var t=e.elements;1===(t=t.filter(function(e){var t=e.host;return i7(e,t)})).length&&t.map(function(e){return t.indexOf(e)}).forEach(function(i){var o=t[i];e.elements[i]=n._replaceShape(t[i],o)})},!0),this.preExecute("elements.move",500,function(e){var t=e.shapes,i=e.newHost;if(1===t.length){var o=t[0];i7(o,i)&&(e.shapes=[n._replaceShape(o,i)])}},!0)}function i7(e,t){return!(0,eL.j_)(e)&&eg(e,["bpmn:IntermediateThrowEvent","bpmn:IntermediateCatchEvent"])&&!!t}function oe(e,t){function n(e){return(0,a.hX)(e.attachers,function(e){return em(e,"bpmn:BoundaryEvent")})}ts.call(this,e),this.postExecute("connection.create",function(e){var i=e.context.source,o=e.context.target,r=n(o);em(i,"bpmn:EventBasedGateway")&&em(o,"bpmn:ReceiveTask")&&r.length>0&&t.removeElements(r)}),this.postExecute("connection.reconnect",function(e){var i=e.context.oldSource,o=e.context.newSource;em(i,"bpmn:Gateway")&&em(o,"bpmn:EventBasedGateway")&&(0,a.Ed)(o.outgoing,function(e){var i=e.target,o=n(i);em(i,"bpmn:ReceiveTask")&&o.length>0&&t.removeElements(o)})})}function ot(e,t,n){function i(e){t.updateProperties(e,{isForCompensation:!0})}function o(e){t.updateProperties(e,{isForCompensation:void 0})}ts.call(this,e),this.preExecute("shape.replace",function(e){let{newData:n,oldShape:i}=e;if(oi(e.oldShape)&&"bpmn:CompensateEventDefinition"!==n.eventDefinitionType||"bpmn:BoundaryEvent"!==n.type){let t=i.outgoing.find(({target:e})=>on(e));t&&t.target&&(e._connectionTarget=t.target)}else if(!oi(e.oldShape)&&"bpmn:CompensateEventDefinition"===n.eventDefinitionType&&"bpmn:BoundaryEvent"===n.type){let n=i.outgoing.find(({target:e})=>oo(e));n&&n.target&&(e._connectionTarget=n.target),function(e){let n=e.outgoing.filter(e=>em(e,"bpmn:SequenceFlow"));t.removeElements(n)}(i)}},!0),this.postExecuted("shape.replace",function(e){let{_connectionTarget:n,newShape:i}=e;n&&t.connect(i,n)},!0),this.preExecute("connection.create",function(e){let n=e.connection,o=e.source,r=e.target;oi(o)&&oo(r)&&(i(r),function(e,n){e.outgoing.filter(e=>em(e,"bpmn:Association")).filter(e=>on(e.target)&&!n.includes(e)).forEach(e=>t.removeConnection(e))}(o,[n]))},!0),this.postExecuted("connection.delete",function(e){let t=e.source,n=e.target;oi(t)&&on(n)&&o(n)},!0),this.postExecuted("connection.reconnect",function(e){let t=e.newTarget,n=e.oldSource,r=e.oldTarget;r!==t&&(on(r)&&o(r),oi(n)&&oo(t)&&i(t))},!0),this.postExecuted("element.updateProperties",function(e){let{element:i}=e;on(i)?(function(e){for(let i of e.incoming)n.canConnect(i.source,e)||t.removeConnection(i);for(let i of e.outgoing)n.canConnect(e,i.target)||t.removeConnection(i)}(i),function(e){let n=e.attachers.slice();n.length&&t.removeElements(n)}(i)):oo(i)&&function(e){let n=e.incoming.filter(e=>oi(e.source));t.removeElements(n)}(i)},!0)}function on(e){let t=ev(e);return t&&t.get("isForCompensation")}function oi(e){return e&&em(e,"bpmn:BoundaryEvent")&&eA(e,"bpmn:CompensateEventDefinition")}function oo(e){return e&&em(e,"bpmn:Activity")&&!eM(e)}function or(e){e.invoke(ts,this),this.preExecute("shape.create",1500,function(e){var t=e.context,n=t.parent,i=t.shape;em(n,"bpmn:Lane")&&!em(i,"bpmn:Lane")&&(t.parent=nI(n,"bpmn:Participant"))})}function oa(e,t){ts.call(this,e),this.preExecute("shape.create",function(e){var n=e.context.shape;if(em(n,"bpmn:DataObjectReference")&&"label"!==n.type){var i=t.create("bpmn:DataObject");n.businessObject.dataObjectRef=i}})}function os(e,t,n){function i(){var t=e.getRootElement();return em(t,"bpmn:Collaboration")?t:n.makeCollaboration()}ts.call(this,t),t.on(["create.start","shape.move.start"],2e3,function(t){var n=t.context,i=n.shape,o=e.getRootElement();if(em(i,"bpmn:Participant")&&em(o,"bpmn:Process")&&o.children.length){var r=o.children.filter(function(e){return!em(e,"bpmn:Group")&&!(0,eL.j_)(e)&&!(0,eL.Ho)(e)});if(r.length){var s,c,l,p,h=_(r),u=(s={width:(s=h).width+40+30,height:s.height+40},{x:-(c=Math.max(i.width,s.width))/2,y:-(l=Math.max(i.height,s.height))/2,width:c,height:l});(0,a.f0)(i,u),n.createConstraints=(p=h,{bottom:(p=(0,j.JA)(p)).top+i.height/2-20,left:p.right-i.width/2+20,top:p.bottom-i.height/2+20,right:p.left+i.width/2-20-30})}}}),t.on("create.start",2e3,function(n){var i=n.context.shape,o=e.getRootElement(),r=e.getGraphics(o);function a(e){e.element=o,e.gfx=r}em(i,"bpmn:Participant")&&em(o,"bpmn:Process")&&(t.on("element.hover",2e3,a),t.once("create.cleanup",function(){t.off("element.hover",a)}))}),this.preExecute("elements.create",2e3,function(e){var t,n=e.elements,o=e.parent,r=(0,a.sE)(n,function(e){return em(e,"bpmn:Participant")});r&&em(o,"bpmn:Process")&&(e.parent=i(),(t=e.hints=e.hints||{}).participant=r,t.process=o,t.processRef=ev(r).get("processRef"))},!0),this.preExecute("shape.create",function(e){var t=e.parent,n=e.shape;em(n,"bpmn:Participant")&&em(t,"bpmn:Process")&&(e.parent=i(),e.process=t,e.processRef=ev(n).get("processRef"))},!0),this.execute("shape.create",function(e){var t=e.hints||{},n=e.process||t.process,i=e.shape,o=t.participant;n&&(!o||i===o)&&ev(i).set("processRef",ev(n))},!0),this.revert("shape.create",function(e){var t=e.hints||{},n=e.process||t.process,i=e.processRef||t.processRef,o=e.shape,r=t.participant;n&&(!r||o===r)&&ev(o).set("processRef",i)},!0),this.postExecute("shape.create",function(e){var t=e.hints||{},i=e.process||e.hints.process,o=e.shape,r=t.participant;if(i){var a=i.children.slice();r?o===r&&n.moveElements(a,{x:0,y:0},r):n.moveElements(a,{x:0,y:0},o)}},!0)}(0,o.Z)(i3,ts),i3.$inject=["eventBus","modeling"],(0,o.Z)(i4,ts),i4.$inject=["eventBus"],(0,o.Z)(i9,ts),i9.$inject=["injector","modeling"],i8.$inject=["bpmnReplace","injector"],(0,o.Z)(i8,ts),i8.prototype._replaceShape=function(e,t){var n,i=(n=ev(e).eventDefinitions)&&n[0],o={type:"bpmn:BoundaryEvent",host:t};return i&&(o.eventDefinitionType=i.$type),this._bpmnReplace.replaceElement(e,o,{layoutConnection:!1})},oe.$inject=["eventBus","modeling"],(0,o.Z)(oe,ts),(0,o.Z)(ot,ts),ot.$inject=["eventBus","modeling","bpmnRules"],or.$inject=["injector"],(0,o.Z)(or,ts),oa.$inject=["eventBus","bpmnFactory"],(0,o.Z)(oa,ts),os.$inject=["canvas","eventBus","modeling"],(0,o.Z)(os,ts);var oc="__targetRef_placeholder";function ol(e,t){function n(e,n){var i=e.get("properties"),o=(0,a.sE)(i,function(e){return e.name===oc});return!o&&n&&P(i,o=t.create("bpmn:Property",{name:oc})),o}function i(e,t){var i,o=n(e);o&&(i=e.get("dataInputAssociations"),(0,a.sE)(i,function(e){return e!==t&&e.targetRef===o})||R(e.get("properties"),o))}function o(e){var t,o=e.context,r=o.connection,a=r.businessObject,s=r.target,c=s&&s.businessObject,l=o.newTarget,p=l&&l.businessObject,h=o.oldTarget||o.target,u=h&&h.businessObject,d=r.businessObject;u&&u!==c&&i(u,a),p&&p!==c&&i(p,a),c?(t=n(c,!0),d.targetRef=t):d.targetRef=null}ts.call(this,e),this.executed(["connection.create","connection.delete","connection.move","connection.reconnect"],op(o)),this.reverted(["connection.create","connection.delete","connection.move","connection.reconnect"],op(o))}function op(e){return function(t){if(em(t.context.connection,"bpmn:DataInputAssociation"))return e(t)}}function oh(e){this._bpmnUpdater=e}function ou(e,t,n,i){function o(e){return e.children.filter(function(e){return em(e,"bpmn:DataStoreReference")&&!e.labelTarget})}function r(e,i){var o=e.businessObject||e;if(i=i||n.filter(function(e){return em(e,"bpmn:Participant")&&ev(e).processRef})[0]){var r=i.businessObject||i;t.execute("dataStore.updateContainment",{dataStoreBo:o,dataStoreDi:ey(e),newSemanticParent:r.processRef||r,newDiParent:ey(i)})}}ts.call(this,i),t.registerHandler("dataStore.updateContainment",oh),this.preExecute("shape.create",function(e){var t=e.context,n=t.shape;em(n,"bpmn:DataStoreReference")&&"label"!==n.type&&(t.hints||(t.hints={}),t.hints.autoResize=!1)}),this.preExecute("elements.move",function(e){var t=e.context,n=t.shapes;n.filter(function(e){return em(e,"bpmn:DataStoreReference")}).length&&(t.hints||(t.hints={}),t.hints.autoResize=n.filter(function(e){return!em(e,"bpmn:DataStoreReference")}))}),this.postExecute("shape.create",function(e){var t=e.context.shape,n=t.parent;em(t,"bpmn:DataStoreReference")&&"label"!==t.type&&em(n,"bpmn:Collaboration")&&r(t)}),this.postExecute("shape.move",function(e){var t=e.context,n=t.shape,i=t.oldParent,o=n.parent;!em(i,"bpmn:Collaboration")&&em(n,"bpmn:DataStoreReference")&&"label"!==n.type&&em(o,"bpmn:Collaboration")&&r(n,em(i,"bpmn:Participant")?i:function(e,t){for(;e.parent;){if(em(e.parent,t))return e.parent;e=e.parent}}(i,"bpmn:Participant"))}),this.postExecute("shape.delete",function(t){var n=t.context.shape,i=e.getRootElement();eg(n,["bpmn:Participant","bpmn:SubProcess"])&&em(i,"bpmn:Collaboration")&&o(i).filter(function(e){return function(e,t){for(var n=e.businessObject||e,i=t.businessObject||t;n.$parent;){if(n.$parent===i.processRef||i)return!0;n=n.$parent}return!1}(e,n)}).forEach(function(e){r(e)})}),this.postExecute("canvas.updateRoot",function(e){var t=e.context,n=t.oldRoot,i=t.newRoot;o(n).forEach(function(e){em(i,"bpmn:Process")&&r(e,i)})})}ol.$inject=["eventBus","bpmnFactory"],(0,o.Z)(ol,ts),oh.$inject=["bpmnUpdater"],oh.prototype.execute=function(e){var t=e.dataStoreBo,n=e.dataStoreDi,i=e.newSemanticParent,o=e.newDiParent;return e.oldSemanticParent=t.$parent,e.oldDiParent=n.$parent,this._bpmnUpdater.updateSemanticParent(t,i),this._bpmnUpdater.updateDiParent(n,o),[]},oh.prototype.revert=function(e){var t=e.dataStoreBo,n=e.dataStoreDi,i=e.oldSemanticParent,o=e.oldDiParent;return this._bpmnUpdater.updateSemanticParent(t,i),this._bpmnUpdater.updateDiParent(n,o),[]},ou.$inject=["canvas","commandStack","elementRegistry","eventBus"],(0,o.Z)(ou,ts);var od=Math.max,of=Math.min;function om(e,t){return{top:e.top-t.top,right:e.right-t.right,bottom:e.bottom-t.bottom,left:e.left-t.left}}function og(e,t,n){var i=t[e],o=n.min&&n.min[e],r=n.max&&n.max[e];return(0,a.hj)(o)&&(i=(/top|left/.test(e)?of:od)(i,o)),(0,a.hj)(r)&&(i=(/top|left/.test(e)?od:of)(i,r)),i}function ov(e,t){return void 0!==e?e:20}function oy(e){return!e.waypoints&&"label"!==e.type}function ob(e,t){var n,i,o,r,s,c;if((n=void 0===e.length?(0,a.hX)(e.children,oy):e).length)return i=_(n),"object"==typeof t?(o=ov(t.left),r=ov(t.right),s=ov(t.top),c=ov(t.bottom)):o=r=s=c=ov(t),{x:i.x-o,y:i.y-s,width:i.width+o+r,height:i.height+s+c}}var ox=Math.abs,o_=["bpmn:Participant","bpmn:Process","bpmn:SubProcess"];function ow(e,t){return t=t||[],e.children.filter(function(e){em(e,"bpmn:Lane")&&(ow(e,t),t.push(e))}),t}function oE(e){return e.children.filter(function(e){return em(e,"bpmn:Lane")})}function oS(e){return nI(e,o_)||e}function ok(e,t){ts.call(this,e),this.postExecuted("shape.delete",500,function(e){var n,i,o,r,a,s,c,l,p,h,u,d=e.context,f=d.hints,m=d.shape,g=d.oldParent;em(m,"bpmn:Lane")&&(!f||!f.nested)&&(s=eB(m),c=oE(g),l=[],p=[],h=[],u=[],b(c,function(e){return s?e.y>m.y?p.push(e):l.push(e):e.x>m.x?u.push(e):h.push(e),e.children}),c.length&&(n=s?p.length&&l.length?m.height/2:m.height:u.length&&h.length?m.width/2:m.width,l.length&&(i=t.calculateAdjustments(l,"y",n,m.y-10),t.makeSpace(i.movingShapes,i.resizingShapes,{x:0,y:n},"s")),p.length&&(o=t.calculateAdjustments(p,"y",-n,m.y+m.height+10),t.makeSpace(o.movingShapes,o.resizingShapes,{x:0,y:-n},"n")),h.length&&(r=t.calculateAdjustments(h,"x",n,m.x-10),t.makeSpace(r.movingShapes,r.resizingShapes,{x:n,y:0},"e")),u.length&&(a=t.calculateAdjustments(u,"x",-n,m.x+m.width+10),t.makeSpace(a.movingShapes,a.resizingShapes,{x:-n,y:0},"w"))))})}function oC(e,t){t.invoke(ts,this),this._bpmnReplace=e;var n=this;this.postExecuted("elements.create",500,function(e){var t=e.elements;t.filter(function(e){var t=e.host;return oR(e,t)}).map(function(e){return t.indexOf(e)}).forEach(function(i){e.elements[i]=n._replaceShape(t[i])})},!0),this.preExecute("elements.move",500,function(e){var t=e.shapes,i=e.newHost;t.forEach(function(e,o){var r=e.host;oR(e,-1!==t.indexOf(r)?r:i)&&(t[o]=n._replaceShape(e))})},!0)}function oR(e,t){return!(0,eL.j_)(e)&&em(e,"bpmn:BoundaryEvent")&&!t}function oP(e,t,n){function i(e,i,o){var r,s,c,l,p,h,u,d,f=i.waypoints,m=e.outgoing.slice(),g=e.incoming.slice(),v=n8(f,r=(0,a.hj)(o.width)?(0,j.wS)(o):o);if(v){if(s=f.slice(0,v.index),c=f.slice(v.index+(v.bendpoint?1:0)),!s.length||!c.length)return;l=v.bendpoint?f[v.index]:r,1!==s.length&&oT(e,s[s.length-1])||s.push(oj(l)),1!==c.length&&oT(e,c[0])||c.unshift(oj(l))}p=i.source,h=i.target,t.canConnect(p,e,i)&&(n.reconnectEnd(i,e,s||r),u=i),t.canConnect(e,h,i)&&(u?d=n.connect(e,h,{type:i.type,waypoints:c}):(n.reconnectStart(i,e,c||r),d=i));var y=[].concat(u&&(0,a.hX)(g,function(e){return e.source===u.source})||[],d&&(0,a.hX)(m,function(e){return e.target===d.target})||[]);y.length&&n.removeElements(y)}ts.call(this,e),this.preExecute("elements.move",function(e){var n=e.newParent,i=e.shapes,o=e.delta,r=i[0];if(r&&n){n&&n.waypoints&&(e.newParent=n=n.parent);var s=(0,j.wS)(r),c={x:s.x+o.x,y:s.y+o.y},l=(0,a.sE)(n.children,function(e){return t.canInsert(i,e)&&n8(e.waypoints,c)});l&&(e.targetFlow=l,e.position=c)}},!0),this.postExecuted("elements.move",function(e){var t=e.shapes,n=e.targetFlow,o=e.position;n&&i(t[0],n,o)},!0),this.preExecute("shape.create",function(e){var n=e.parent,i=e.shape;t.canInsert(i,n)&&(e.targetFlow=n,e.parent=n.parent)},!0),this.postExecuted("shape.create",function(e){var t=e.shape,n=e.targetFlow,o=e.position;n&&i(t,n,o)},!0)}function oT(e,t){var n=t.x,i=t.y;return n>=e.x&&n<=e.x+e.width&&i>=e.y&&i<=e.y+e.height}function oj(e){return(0,a.f0)({},e)}function oD(e,t){ts.call(this,e),this.preExecuted("connection.create",function(e){var n=e.context,i=n.connection,o=n.source,r=n.target,a=n.hints;(!a||!1!==a.createElementsBehavior)&&oB(i)&&(em(o,"bpmn:EventBasedGateway")?r.incoming.filter(e=>e!==i&&oB(e)):r.incoming.filter(e=>e!==i&&oB(e)&&em(e.source,"bpmn:EventBasedGateway"))).forEach(function(e){t.removeConnection(e)})}),this.preExecuted("shape.replace",function(e){var n=e.context.newShape;em(n,"bpmn:EventBasedGateway")&&n.outgoing.filter(oB).reduce(function(e,t){return e.includes(t.target)?e:e.concat(t.target)},[]).forEach(function(e){e.incoming.filter(oB).forEach(function(i){let o=e.incoming.filter(oB).filter(function(e){return e.source===n});(i.source!==n||o.length>1)&&t.removeConnection(i)})})})}function oB(e){return em(e,"bpmn:SequenceFlow")}function oM(e,t,n){t.on(["create.hover","create.move","create.out","create.end","shape.move.hover","shape.move.move","shape.move.out","shape.move.end"],1500,function(t){var i=t.context.shape||t.shape,o=t.hover;em(o,"bpmn:Lane")&&!eg(i,["bpmn:Lane","bpmn:Participant"])&&(t.hover=oS(o),t.hoverGfx=e.getGraphics(t.hover));var r=n.getRootElement();o!==r&&(i.labelTarget||eg(i,["bpmn:Group","bpmn:TextAnnotation"]))&&(t.hover=r,t.hoverGfx=e.getGraphics(t.hover))}),t.on(["connect.hover","connect.out","connect.end","connect.cleanup","global-connect.hover","global-connect.out","global-connect.end","global-connect.cleanup"],1500,function(t){var n=t.hover;em(n,"bpmn:Lane")&&(t.hover=oS(n)||n,t.hoverGfx=e.getGraphics(t.hover))}),t.on(["bendpoint.move.hover"],1500,function(t){var n=t.context,i=t.hover,o=n.type;em(i,"bpmn:Lane")&&/reconnect/.test(o)&&(t.hover=oS(i)||i,t.hoverGfx=e.getGraphics(t.hover))}),t.on(["connect.start"],1500,function(e){var t=e.context,n=t.start;em(n,"bpmn:Lane")&&(t.start=oS(n)||n)}),t.on("shape.move.start",2e3,function(e){var t=e.shape;em(t,"bpmn:Lane")&&(e.shape=oS(t)||t)}),t.on("spaceTool.move",2e3,function(e){var t=e.hover;t&&em(t,"bpmn:Lane")&&(e.hover=oS(t))})}function oA(e,t,n,i,o,r){function a(e,t,i){var o,r,a=n.filter(function(e){return em(e,"bpmn:Group")}).filter(function(e){return e.businessObject!==i});t&&!a.some(function(e){var n=ev(e);return(n.categoryValueRef&&n.categoryValueRef.$parent)===t})&&(o=t.$parent)&&(R(o.get("rootElements"),t),t.$parent=null),e&&!a.some(function(t){return ev(t).categoryValueRef===e})&&(r=e.$parent)&&(R(r.get("categoryValue"),e),e.$parent=null)}function s(e,n){var i;return i=t.getDefinitions(),P(n.get("categoryValue"),e),e.$parent=n,P(i.get("rootElements"),n),n.$parent=i,e}function c(n,i){var o=ev(n),r=o.categoryValueRef;r||(r=o.categoryValueRef=i.categoryValue=i.categoryValue||e.create("bpmn:CategoryValue"));var a=r.$parent;a||(a=r.$parent=i.category=i.category||e.create("bpmn:Category")),s(r,a,t.getDefinitions())}function l(e,t){var n=t.category,i=t.categoryValue,o=ev(e);i?(o.categoryValueRef=null,a(i,n,o)):a(null,o.categoryValueRef.$parent,o)}function p(t,n){var i=e.create(t.$type);return r.copyElement(t,i,null,n)}o.invoke(ts,this),this.execute("label.create",function(e){var t=e.context,n=t.labelTarget;em(n,"bpmn:Group")&&c(n,t)}),this.revert("label.create",function(e){var t=e.context,n=t.labelTarget;em(n,"bpmn:Group")&&l(n,t)}),this.execute("shape.delete",function(e){var t=e.context,n=t.shape,i=ev(n);if(em(n,"bpmn:Group")&&!n.labelTarget){var o,r=t.categoryValue=i.categoryValueRef;r&&(o=t.category=r.$parent,a(r,o,i),i.categoryValueRef=null)}}),this.reverted("shape.delete",function(e){var t=e.context,n=t.shape;if(em(n,"bpmn:Group")&&!n.labelTarget){var i=t.category,o=t.categoryValue,r=ev(n);o&&(r.categoryValueRef=o,s(o,i))}}),this.execute("shape.create",function(e){var t=e.context,n=t.shape;em(n,"bpmn:Group")&&!n.labelTarget&&ev(n).categoryValueRef&&c(n,t)}),this.reverted("shape.create",function(e){var t=e.context,n=t.shape;em(n,"bpmn:Group")&&!n.labelTarget&&ev(n).categoryValueRef&&l(n,t)}),i.on("copyPaste.copyElement",770,function(e){var t=e.descriptor,n=e.element;if(em(n,"bpmn:Group")&&!n.labelTarget){var i=ev(n);if(i.categoryValueRef){var o=i.categoryValueRef;t.categoryValue=p(o,!0),o.$parent&&(t.category=p(o.$parent,!0))}}}),i.on("copyPaste.pasteElement",770,function(e){var t=e.descriptor,n=t.businessObject,i=t.categoryValue,o=t.category;i&&(i=n.categoryValueRef=p(i)),o&&(i.$parent=p(o)),delete t.category,delete t.categoryValue})}function oL(e,t,n,i){var o,r,a,s;return 0==(o=(i.y-n.y)*(t.x-e.x)-(i.x-n.x)*(t.y-e.y))?null:(r=e.y-n.y,a=e.x-n.x,s=((i.x-n.x)*r-(i.y-n.y)*a)/o,{x:Math.round(e.x+s*(t.x-e.x)),y:Math.round(e.y+s*(t.y-e.y))})}function oO(e){function t(e,t,n){var i,o={x:n.x,y:n.y-50},r={x:n.x-50,y:n.y},a=oL(e,t,n,o),s=oL(e,t,n,r);i=a&&s?oN(a,n)>oN(s,n)?s:a:a||s,e.original=i}e.on("bpmnElement.added",function(e){var n,i=e.element;i.waypoints&&(t((n=i.waypoints)[0],n[1],(0,j.wS)(i.source)),t(n[n.length-1],n[n.length-2],(0,j.wS)(i.target)))})}function oN(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function o$(e){ts.call(this,e);var t=["bpmn:Participant","bpmn:Lane"];this.executed(["shape.move","shape.create","shape.resize"],function(e){var n=e.context.shape,i=ev(n),o=ey(n);if(eg(i,t)){var r=o.get("isHorizontal");void 0===r&&(r=!0),o.set("isHorizontal",r)}})}ok.$inject=["eventBus","spaceTool"],(0,o.Z)(ok,ts),oC.$inject=["bpmnReplace","injector"],(0,o.Z)(oC,ts),oC.prototype._replaceShape=function(e){var t,n,i=(t=ev(e).eventDefinitions)&&t[0];return n=i?{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:i.$type}:{type:"bpmn:IntermediateThrowEvent"},this._bpmnReplace.replaceElement(e,n,{layoutConnection:!1})},(0,o.Z)(oP,ts),oP.$inject=["eventBus","bpmnRules","modeling"],oD.$inject=["eventBus","modeling"],(0,o.Z)(oD,ts),oM.$inject=["elementRegistry","eventBus","canvas"],oA.$inject=["bpmnFactory","bpmnjs","elementRegistry","eventBus","injector","moddleCopy"],(0,o.Z)(oA,ts),oO.$inject=["eventBus"],o$.$inject=["eventBus"],(0,o.Z)(o$,ts);var oI=Math.sqrt,oz=Math.min,oH=Math.max,oF=Math.abs;function oG(e){return Math.pow(e,2)}function oW(e,t){return oI(oG(e.x-t.x)+oG(e.y-t.y))}function oV(e,t,n){return e>=oz(t,n)-oU&&e<=oH(t,n)+oU}var oU=.1;function oZ(e,t){return oF(e.x-t.x)<=oU&&oF(e.y-t.y)<=oU}function oK(e,t,n,i){var o,r,a,s,c=0,l=0,p={point:e,delta:{x:0,y:0}},h=function(e,t){var n,i,o,r,a,s,c,l,p,h,u,d=0;for(d=0;d<t.length-1;d++){if(oZ(o=t[d],r=t[d+1])?c=[o]:(s=oz(oW(e,o),oW(e,r)),c=function(e,t,n,i){var o=t.x-e.x,r=t.y-e.y,a=n.x-e.x,s=n.y-e.y,c=o*o+r*r,l=(o*a+r*s)/c,p=l*l-(a*a+s*s-i*i)/c;if(p<0&&p>-.000001&&(p=0),p<0)return[];var h=oI(p),u=-l+h,d=-l-h,f={x:e.x-o*u,y:e.y-r*u};return 0===p?[f]:[f,{x:e.x-o*d,y:e.y-r*d}].filter(function(n){return oV(n.x,e.x,t.x)&&oV(n.y,e.y,t.y)})}(o,r,e,s)),c.length<1)throw Error("expected between [1, 2] circle -> line intersections");1===c.length&&(l={type:"bendpoint",position:c[0],segmentIndex:d,bendpointIndex:oZ(o,c[0])?d:d+1}),2===c.length&&(l={type:"segment",position:(n=c[0],i=c[1],a={x:(n.x+i.x)/2,y:(n.y+i.y)/2}),segmentIndex:d,relativeLocation:oW(o,a)/oW(o,r)}),p=oW(l.position,e),(!u||h>p)&&(u=l,h=p)}return u}(e,n),u=h.segmentIndex,d=function(e,t,n,i){var o=n.segmentIndex,r=t.length-e.length;if(i.segmentMove){var a=i.segmentMove.segmentStartIndex,s=i.segmentMove.newSegmentStartIndex;return o===a?s:o>=s?o+r<s?s:o+r:o}if(i.bendpointMove){var c,l=i.bendpointMove.insert,p=i.bendpointMove.bendpointIndex;return 0===r?o:(o>=p&&(c=l?o+1:o-1),o<p&&(c=o,l&&"bendpoint"!==n.type&&p-1===o&&oJ(t,p)<n.relativeLocation&&c++),c)}return 0===r?o:i.connectionStart&&0===o?0:i.connectionEnd&&o===e.length-2?t.length-2:Math.floor((t.length-2)/2)}(n,t,h,i);if(d<0||d>t.length-2||null===d)return p;var f=[n[u],n[u+1]],m=[t[d],t[d+1]],g=h.position,v=(o=io(f[0],f[1]),r=io(f[0],g),0===o?0:r/o),y=(a=ie(f),ie(m)-a);if("bendpoint"===h.type){var b=t.length-n.length,x=h.bendpointIndex,_=n[x];if(-1!==t.indexOf(_))return p;if(0===b){var w=t[x];return{delta:{x:c=w.x-h.position.x,y:l=w.y-h.position.y},point:{x:e.x+c,y:e.y+l}}}b<0&&0!==x&&x<n.length-1&&(v=oJ(n,x))}var E={x:(m[1].x-m[0].x)*v+m[0].x,y:(m[1].y-m[0].y)*v+m[0].y},S=(s={x:e.x-g.x,y:e.y-g.y},y?{x:Math.cos(y)*s.x-Math.sin(y)*s.y,y:Math.sin(y)*s.x+Math.cos(y)*s.y}:s);return c=E.x+S.x-e.x,l=E.y+S.y-e.y,{point:(0,j.ex)(E),delta:(0,j.ex)({x:c,y:l})}}function oJ(e,t){var n=io(e[t-1],e[t]);return n/(n+io(e[t],e[t+1]))}function oq(e,t,n){var i=tQ(t),o=tQ(n),r=t0(e,i),a={x:r.x*(n.width/t.width),y:r.y*(n.height/t.height)};return(0,j.ex)({x:o.x+a.x,y:o.y+a.y})}function oX(e,t,n){var i=tQ(e),o=tQ(t),r=tQ(n),a=t0(e,i),s=t0(i,o),c=function(e,t,n){var i=(0,j.JA)(t),o=(0,j.JA)(n);if(i.right!==o.right&&i.left!==o.left||i.top!==o.top&&i.bottom!==o.bottom)return null;var r,a,s=(0,j.T8)(t,e);if("top"===s)r={x:0,y:o.bottom-i.bottom};else if("bottom"===s)r={x:0,y:o.top-i.top};else if("right"===s)r={x:o.left-i.left,y:0};else{if("left"!==s)return null;r={x:o.right-i.right,y:0}}return(a={x:e.x+r.x,y:e.y+r.y},(0,j.T8)(n,a)!==s)?null:r}(i,t,n);if(c)return c;var l={x:s.x*(n.width/t.width),y:s.y*(n.height/t.height)},p={x:r.x+l.x,y:r.y+l.y};return(0,j.ex)({x:p.x+a.x-e.x,y:p.y+a.y-e.y})}var oY="name",oQ="text";function o0(e,t,n,i){function o(e){var n=e.context,o=n.element,r=n.properties;if(oY in r&&t.updateLabel(o,r[oY]),oQ in r&&em(o,"bpmn:TextAnnotation")){var a=i.getTextAnnotationBounds({x:o.x,y:o.y,width:o.width,height:o.height},r[oQ]||"");t.updateLabel(o,r.text,a)}}ts.call(this,e),this.postExecute("element.updateProperties",o),this.postExecute("element.updateModdleProperties",e=>{ev(e.context.element)===e.context.moddleElement&&o(e)}),this.postExecute(["shape.create","connection.create"],function(e){var n=e.context;if(!1!==(n.hints||{}).createElementsBehavior){var i=n.shape||n.connection;!(0,eL.j_)(i)&&eN(i)&&eH(i)&&t.updateLabel(i,eH(i))}}),this.postExecute("shape.delete",function(e){var n=e.context,i=n.labelTarget,o=n.hints||{};i&&!1!==o.unsetLabel&&t.updateLabel(i,null,null,{removeShape:!1})}),this.postExecute(["connection.layout","connection.updateWaypoints"],function(e){var n,i,o,r,s,c,l=e.context;if(!1!==(l.hints||{}).labelBehavior){var p,h=l.connection.label;h&&h.parent&&(o=(i=(n=e.context).connection).label,r=(0,a.f0)({},n.hints),s=n.newWaypoints||i.waypoints,c=n.oldWaypoints,void 0===r.startChanged&&(r.startChanged=!!r.connectionStart),void 0===r.endChanged&&(r.endChanged=!!r.connectionEnd),p=oK((0,j.wS)(o),s,c,r).delta,t.moveShape(h,p))}}),this.postExecute(["shape.replace"],function(e){var t=e.context,n=t.newShape,i=t.oldShape,o=ev(n);o&&eN(o)&&i.label&&n.label&&(n.label.x=i.label.x,n.label.y=i.label.y)}),this.postExecute("shape.resize",function(e){var n=e.context,i=n.shape,o=n.newBounds,r=n.oldBounds;if(e$(i)){var s,c,l=i.label,p=(c=oq(s=function(e,t){if(t.length){var n,i=(n=t.map(function(t){return{line:t,distance:ii(e,t)}}),(0,a.MR)(n,"distance")[0].line);return it(e,i)}}((0,j.wS)(l),[[{x:r.x,y:r.y},{x:r.x+(r.width||0),y:r.y}],[{x:r.x+(r.width||0),y:r.y},{x:r.x+(r.width||0),y:r.y+(r.height||0)}],[{x:r.x,y:r.y+(r.height||0)},{x:r.x+(r.width||0),y:r.y+(r.height||0)}],[{x:r.x,y:r.y},{x:r.x,y:r.y+(r.height||0)}]]),r,o),(0,j.ex)(t0(c,s)));t.moveShape(l,p)}})}function o1(e,t){function n(e,t){var n=e.context,i=n.connection,o=(0,a.f0)({},n.hints),r=n.newWaypoints||i.waypoints,s=n.oldWaypoints;return void 0===o.startChanged&&(o.startChanged=!!o.connectionStart),void 0===o.endChanged&&(o.endChanged=!!o.connectionEnd),oK(t,r,s,o).point}ts.call(this,e),this.postExecute(["connection.layout","connection.updateWaypoints"],function(e){var i=e.context.connection,o=i.outgoing;i.incoming.forEach(function(i){var o=n(e,i.waypoints[i.waypoints.length-1]),r=[].concat(i.waypoints.slice(0,-1),[o]);t.updateWaypoints(i,r)}),o.forEach(function(i){var o=[].concat([n(e,i.waypoints[0])],i.waypoints.slice(1));t.updateWaypoints(i,o)})}),this.postExecute(["connection.move"],function(e){var n=e.context,i=n.connection,o=i.outgoing,r=i.incoming,a=n.delta;r.forEach(function(e){var n=e.waypoints[e.waypoints.length-1],i={x:n.x+a.x,y:n.y+a.y},o=[].concat(e.waypoints.slice(0,-1),[i]);t.updateWaypoints(e,o)}),o.forEach(function(e){var n=e.waypoints[0],i=[].concat([{x:n.x+a.x,y:n.y+a.y}],e.waypoints.slice(1));t.updateWaypoints(e,i)})})}function o2(e,t,n){var i=o9(e),o=o8(i,t),r=i[0];return o.length?o[o.length-1]:oq(r.original||r,n,t)}function o5(e,t,n){var i=o9(e),o=o8(i,t),r=i[i.length-1];return o.length?o[0]:oq(r.original||r,n,t)}function o3(e,t,n){var i=o9(e),o=o4(t,n),r=i[0];return oq(r.original||r,o,t)}function o6(e,t,n){var i=o9(e),o=o4(t,n),r=i[i.length-1];return oq(r.original||r,o,t)}function o4(e,t){return{x:e.x-t.x,y:e.y-t.y,width:e.width,height:e.height}}function o9(e){var t=e.waypoints;if(!t.length)throw Error("connection#"+e.id+": no waypoints");return t}function o8(e,t){var n=(0,a.UI)(e,o7);return(0,a.hX)(n,function(e){return"intersect"===(0,j.T8)(t,e,1)})}function o7(e){return e.original||e}function re(e,t){ts.call(this,e),this.postExecute("shape.replace",function(e){var n=e.oldShape,i=e.newShape;if(!(!(em(n,"bpmn:Participant")&&eD(n)&&em(i,"bpmn:Participant"))||eD(i))){var o,r,a,s=(o=x([n],!1),r=[],a=[],o.forEach(function(e){e!==n&&(e.incoming.forEach(function(e){em(e,"bpmn:MessageFlow")&&r.push(e)}),e.outgoing.forEach(function(e){em(e,"bpmn:MessageFlow")&&a.push(e)}))},[]),{incoming:r,outgoing:a});s.incoming.forEach(function(e){var o=o5(e,i,n);t.reconnectEnd(e,i,o)}),s.outgoing.forEach(function(e){var o=o2(e,i,n);t.reconnectStart(e,i,o)})}},!0)}(0,o.Z)(o0,ts),o0.$inject=["eventBus","modeling","bpmnFactory","textRenderer"],(0,o.Z)(o1,ts),o1.$inject=["eventBus","modeling"],re.$inject=["eventBus","modeling"],(0,o.Z)(re,ts);let rt=["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:EscalationEventDefinition","bpmn:ConditionalEventDefinition","bpmn:SignalEventDefinition"];function rn(e){let t=ev(e);if(!em(t,"bpmn:BoundaryEvent")&&!(em(t,"bpmn:StartEvent")&&eM(t.$parent)))return!1;let n=t.get("eventDefinitions");return!!n&&!!n.length&&rt.some(e=>em(n[0],e))}function ri(e){return em(e,"bpmn:BoundaryEvent")?"cancelActivity":"isInterrupting"}function ro(e,t){e.invoke(ts,this),this.postExecuted("shape.replace",function(e){let n=e.context.oldShape,i=e.context.newShape,o=e.context.hints;if(!rn(i))return;let r=ri(i);if(o.targetElement&&void 0!==o.targetElement[r])return;let a=ev(n).get(r);a!==ev(i).get(r)&&t.updateProperties(i,{[r]:a})})}function rr(e,t){ts.call(this,e),this.preExecute("shape.resize",function(e){var n=e.shape,i=ey(n),o=i&&i.get("label");o&&o.get("bounds")&&t.updateModdleProperties(n,o,{bounds:void 0})},!0)}function ra(e,t,n){ts.call(this,e),this.preExecute("shape.delete",function(e){var i=e.context.shape;if(1===i.incoming.length&&1===i.outgoing.length){var o=i.incoming[0],r=i.outgoing[0];if(em(o,"bpmn:SequenceFlow")&&em(r,"bpmn:SequenceFlow")&&t.canConnect(o.source,r.target,o)){var a,s,c,l=(a=o.waypoints,s=r.waypoints,(c=oL(rs(a[a.length-2]),rs(a[a.length-1]),rs(s[1]),rs(s[0])))?[].concat(a.slice(0,a.length-1),[c],s.slice(1)):[rs(a[0]),rs(s[s.length-1])]);n.reconnectEnd(o,r.target,l)}}})}function rs(e){return e.original||e}function rc(e,t){ts.call(this,e),this.preExecute("shape.delete",function(e){var t=e.shape,n=t.parent;em(t,"bpmn:Participant")&&(e.collaborationRoot=n)},!0),this.postExecute("shape.delete",function(e){var n=e.collaborationRoot;if(n&&!n.businessObject.participants.length){var i=t.makeProcess(),o=n.children.slice();t.moveElements(o,{x:0,y:0},i)}},!0)}function rl(e,t,n,i){ts.call(this,e);var o=i.get("dragging",!1);function r(e){var i,o,r=e.source,a=e.target;e.parent&&(em(e,"bpmn:SequenceFlow")&&(n.canConnectSequenceFlow(r,a)||(o=!0),n.canConnectMessageFlow(r,a)&&(i="bpmn:MessageFlow")),em(e,"bpmn:MessageFlow")&&(n.canConnectMessageFlow(r,a)||(o=!0),n.canConnectSequenceFlow(r,a)&&(i="bpmn:SequenceFlow")),o&&t.removeConnection(e),i&&t.connect(r,a,{type:i,waypoints:e.waypoints.slice()}))}this.postExecuted("elements.move",function(e){var t=e.closure.allConnections;(0,a.Ed)(t,r)},!0),this.preExecute("connection.reconnect",function(e){var i,r,a,s,c,l=e.context,p=l.connection,h=l.newSource||p.source,u=l.newTarget||p.target;(s=n.canConnect(h,u))&&s.type!==p.type&&(c=t.connect(h,u,{type:s.type,associationDirection:s.associationDirection,waypoints:p.waypoints.slice()}),p.parent&&t.removeConnection(p),l.connection=c,!o||(a=(r=o.context())&&r.payload.previousSelection)&&a.length&&-1!==(i=a.indexOf(p))&&a.splice(i,1,c))}),this.postExecuted("element.updateProperties",function(e){var n,i=e.context,o=i.properties,r=i.element,s=r.businessObject;o.default&&(n=(0,a.sE)(r.outgoing,(0,a.KQ)({id:r.businessObject.default.id})))&&t.updateProperties(n,{conditionExpression:void 0}),o.conditionExpression&&s.sourceRef.default===s&&t.updateProperties(r.source,{default:void 0})})}function rp(e,t,n,i,o,r){i.invoke(ts,this),this._bpmnReplace=e,this._elementRegistry=n,this._selection=r,this.postExecuted(["elements.create"],500,function(e){var n=e.context,i=n.parent,o=n.elements,r=(0,a.u4)(o,function(e,n){var o=t.canReplace([n],n.host||n.parent||i);return o?e.concat(o.replacements):e},[]);r.length&&this._replaceElements(o,r)},this),this.postExecuted(["elements.move"],500,function(e){var n=e.context,i=n.newParent,o=n.newHost,r=[];(0,a.Ed)(n.closure.topLevel,function(e){r=eM(e)?r.concat(e.children):r.concat(e)}),1===r.length&&o&&(i=o);var s=t.canReplace(r,i);s&&this._replaceElements(r,s.replacements,o)},this),this.postExecute(["shape.replace"],1500,function(e){var n,i=e.context,o=i.oldShape,r=i.newShape,a=o.attachers;a&&a.length&&(n=t.canReplace(a,r),this._replaceElements(a,n.replacements))},this),this.postExecuted(["shape.replace"],1500,function(e){var t=e.context,n=t.oldShape,i=t.newShape;o.unclaimId(n.businessObject.id,n.businessObject),o.updateProperties(i,{id:n.id})})}ro.$inject=["injector","modeling"],(0,o.Z)(ro,ts),(0,o.Z)(rr,ts),rr.$inject=["eventBus","modeling"],(0,o.Z)(ra,ts),ra.$inject=["eventBus","bpmnRules","modeling"],rc.$inject=["eventBus","modeling"],(0,o.Z)(rc,ts),(0,o.Z)(rl,ts),rl.$inject=["eventBus","modeling","bpmnRules","injector"],(0,o.Z)(rp,ts),rp.prototype._replaceElements=function(e,t){var n=this._elementRegistry,i=this._bpmnReplace,o=this._selection;(0,a.Ed)(t,function(t){var o={type:t.newElementType},r=n.get(t.oldElementId),a=e.indexOf(r);e[a]=i.replaceElement(r,o,{select:!1})}),t&&o.select(e)},rp.$inject=["bpmnReplace","bpmnRules","elementRegistry","injector","modeling","selection"];var rh={width:140,height:120},ru={width:300,height:60},rd={width:60,height:300},rf={width:300,height:150},rm={width:150,height:300},rg={width:140,height:120},rv={width:50,height:30};function ry(e){e.on("resize.start",1500,function(e){var t,n,i,o,r,a,s,c,l,p,h,u=e.context,d=u.shape,f=u.direction,m=u.balanced;(em(d,"bpmn:Lane")||em(d,"bpmn:Participant"))&&(u.resizeConstraints=(t=oS(d),n=!0,i=!0,o=ow(t,[t]),r=(0,j.JA)(d),a={},s={},l=(c=eB(d))?ru:rd,/n/.test(f)?s.top=r.bottom-l.height:/e/.test(f)?s.right=r.left+l.width:/s/.test(f)?s.bottom=r.top+l.height:/w/.test(f)&&(s.left=r.right-l.width),o.forEach(function(e){var t=(0,j.JA)(e);c?(t.top<r.top-10&&(n=!1),t.bottom>r.bottom+10&&(i=!1)):(t.left<r.left-10&&(n=!1),t.right>r.right+10&&(i=!1)),/n/.test(f)&&(m&&10>rb(r.top-t.bottom)&&rw(a,"top",t.top+l.height,r_),5>rb(r.top-t.top)&&rw(s,"top",t.bottom-l.height,rx)),/e/.test(f)&&(m&&10>rb(r.right-t.left)&&rw(a,"right",t.right-l.width,rx),5>rb(r.right-t.right)&&rw(s,"right",t.left+l.width,r_)),/s/.test(f)&&(m&&10>rb(r.bottom-t.top)&&rw(a,"bottom",t.bottom-l.height,rx),5>rb(r.bottom-t.bottom)&&rw(s,"bottom",t.top+l.height,r_)),/w/.test(f)&&(m&&10>rb(r.left-t.right)&&rw(a,"left",t.left+l.width,r_),5>rb(r.left-t.left)&&rw(s,"left",t.right-l.width,rx))}),p=t.children.filter(function(e){return!e.hidden&&!e.waypoints&&(em(e,"bpmn:FlowElement")||em(e,"bpmn:Artifact"))}),h=c?rE:rS,p.forEach(function(e){var t=(0,j.JA)(e);/n/.test(f)&&(!c||n)&&rw(s,"top",t.top-h.top,rx),/e/.test(f)&&(c||i)&&rw(s,"right",t.right+h.right,r_),/s/.test(f)&&(!c||i)&&rw(s,"bottom",t.bottom+h.bottom,r_),/w/.test(f)&&(c||n)&&rw(s,"left",t.left-h.left,rx)}),{min:s,max:a})),em(d,"bpmn:SubProcess")&&eD(d)&&(u.minDimensions=rg),em(d,"bpmn:TextAnnotation")&&(u.minDimensions=rv)})}ry.$inject=["eventBus"];var rb=Math.abs,rx=Math.min,r_=Math.max;function rw(e,t,n,i){var o=e[t];e[t]=void 0===o?n:i(n,o)}var rE={top:20,left:50,right:20,bottom:20},rS={top:50,left:20,right:20,bottom:20};function rk(e,t){e.on("resize.start",1501,function(e){var t=e.context,n=t.shape;(em(n,"bpmn:Lane")||em(n,"bpmn:Participant"))&&(t.balanced=!tR(e))}),e.on("resize.end",1001,function(e){var n=e.context,i=n.shape,o=n.canExecute,r=n.newBounds;if(em(i,"bpmn:Lane")||em(i,"bpmn:Participant"))return o&&(r=(0,j.aR)(r),t.resizeLane(i,r,n.balanced)),!1})}function rC(e,t,n,i,o){function r(e){var t;return eg(e,["bpmn:ReceiveTask","bpmn:SendTask"])||(t=["bpmn:ErrorEventDefinition","bpmn:EscalationEventDefinition","bpmn:MessageEventDefinition","bpmn:SignalEventDefinition"],(0,a.kJ)(t)||(t=[t]),(0,a.G)(t,function(t){return eA(e,t)}))}function s(t){var n=e.getDefinitions().get("rootElements");return!!(0,a.sE)(n,(0,a.KQ)({id:t.id}))}function c(e){return em(e,"bpmn:ErrorEventDefinition")?"errorRef":em(e,"bpmn:EscalationEventDefinition")?"escalationRef":em(e,"bpmn:MessageEventDefinition")?"messageRef":em(e,"bpmn:SignalEventDefinition")?"signalRef":void 0}function l(e){if(eg(e,["bpmn:ReceiveTask","bpmn:SendTask"]))return e.get("messageRef");var t=e.get("eventDefinitions")[0];return t.get(c(t))}n.invoke(ts,this),this.executed(["shape.create","element.updateProperties","element.updateModdleProperties"],function(t){var n=t.shape||t.element;if(r(n)){var i=l(ev(n));i&&!s(i)&&(P(e.getDefinitions().get("rootElements"),i),t.addedRootElement=i)}},!0),this.reverted(["shape.create","element.updateProperties","element.updateModdleProperties"],function(t){var n=t.addedRootElement;n&&R(e.getDefinitions().get("rootElements"),n)},!0),t.on("copyPaste.copyElement",function(e){var t=e.descriptor,n=e.element;if(!n.labelTarget&&r(n)){var i=l(ev(n));i&&(t.referencedRootElement=i)}}),t.on("copyPaste.pasteElement",500,function(e){var t=e.descriptor,n=t.businessObject,r=t.referencedRootElement;r&&(s(r)||(r=i.copyElement(r,o.create(r.$type))),function(e,t){if(eg(e,["bpmn:ReceiveTask","bpmn:SendTask"]))return e.set("messageRef",t);var n=e.get("eventDefinitions")[0];n.set(c(n),t)}(n,r),delete t.referencedRootElement)})}rk.$inject=["eventBus","modeling"],rC.$inject=["bpmnjs","eventBus","injector","moddleCopy","bpmnFactory"],(0,o.Z)(rC,ts);var rR=Math.max;function rP(e){e.on("spaceTool.getMinDimensions",function(e){var t=e.shapes,n=e.axis,i=e.start,o={};return(0,a.Ed)(t,function(e){var t=e.id;em(e,"bpmn:Participant")&&(o[t]=function(e,t,n){var i,o,r,a,s=eB(e);if(!oE(e).length)return s?rf:rm;var c="x"===t;return c?s?rf:{width:(o=rT(oE(e),n,c),i=e.width-o.width+rd.width,rR(rm.width,i)),height:rm.height}:s?{width:rf.width,height:(a=rT(oE(e),n,c),r=e.height-a.height+ru.height,rR(rf.height,r))}:rm}(e,n,i)),em(e,"bpmn:Lane")&&(o[t]=eB(e)?ru:rd),em(e,"bpmn:SubProcess")&&eD(e)&&(o[t]=rg),em(e,"bpmn:TextAnnotation")&&(o[t]=rv),em(e,"bpmn:Group")&&(o[t]=rh)}),o})}function rT(e,t,n){var i,o,r;for(i=0;i<e.length;i++)if(o=e[i],!n&&t>=o.y&&t<=o.y+o.height||n&&t>=o.x&&t<=o.x+o.width){if((r=oE(o)).length)return rT(r,t,n);return o}}rP.$inject=["eventBus"];var rj={x:180,y:160};function rD(e,t,n,i,o,r,s){ts.call(this,t),this._canvas=e,this._eventBus=t,this._modeling=n,this._elementFactory=i,this._bpmnFactory=o,this._bpmnjs=r,this._elementRegistry=s;var c=this;function l(e){return em(e,"bpmn:SubProcess")&&!eD(e)}function p(t){var n=t.shape,i=t.newRootElement,o=ev(n);i=c._addDiagram(i||o),t.newRootElement=e.addRootElement(i)}function h(t){var n=ev(t.shape);c._removeDiagram(n);var i=t.newRootElement=s.get(tu(n));e.removeRootElement(i)}this.executed("shape.create",function(e){l(e.shape)&&p(e)},!0),this.postExecuted("shape.create",function(e){var t=e.shape,n=e.newRootElement;n&&t.children&&(c._showRecursively(t.children),c._moveChildrenToShape(t,n))},!0),this.reverted("shape.create",function(e){l(e.shape)&&h(e)},!0),this.preExecuted("shape.delete",function(e){var t=e.shape;if(l(t)){var i=s.get(tu(t));i&&n.removeElements(i.children.slice())}},!0),this.executed("shape.delete",function(e){l(e.shape)&&h(e)},!0),this.reverted("shape.delete",function(e){l(e.shape)&&p(e)},!0),this.preExecuted("shape.replace",function(t){var n=t.oldShape,i=t.newShape;l(n)&&l(i)&&(t.oldRoot=e.removeRootElement(tu(n)))},!0),this.postExecuted("shape.replace",function(t){var i=t.newShape,o=t.oldRoot,r=e.findRoot(tu(i));if(o&&r){var a=o.children;n.moveElements(a,{x:0,y:0},r)}},!0),this.executed("element.updateProperties",function(e){var t=e.element;if(em(t,"bpmn:SubProcess")){var n=e.properties,i=e.oldProperties.id,o=n.id;if(i!==o){if(td(t)){s.updateId(t,o+th),s.updateId(i,o);return}s.get(i+th)&&s.updateId(i+th,o+th)}}},!0),this.reverted("element.updateProperties",function(e){var t=e.element;if(em(t,"bpmn:SubProcess")){var n=e.properties,i=e.oldProperties.id,o=n.id;if(i!==o){if(td(t)){s.updateId(t,i+th),s.updateId(o,i);return}var r=s.get(o+th);r&&s.updateId(r,i+th)}}},!0),t.on("element.changed",function(e){var n=e.element;if(td(n)){var i=s.get(tf(n.id));i&&i!==n&&t.fire("element.changed",{element:i})}}),this.executed("shape.toggleCollapse",400,function(e){var t=e.shape;em(t,"bpmn:SubProcess")&&(eD(t)?h(e):(p(e),c._showRecursively(t.children)))},!0),this.reverted("shape.toggleCollapse",400,function(e){var t=e.shape;em(t,"bpmn:SubProcess")&&(eD(t)?h(e):(p(e),c._showRecursively(t.children)))},!0),this.postExecuted("shape.toggleCollapse",600,function(e){var t=e.shape;if(em(t,"bpmn:SubProcess")){var n=e.newRootElement;n&&(eD(t)?c._moveChildrenToShape(n,t):c._moveChildrenToShape(t,n))}},!0),t.on("copyPaste.createTree",function(e){var t=e.element,n=e.children;if(l(t)){var i=tu(t),o=s.get(i);o&&n.push.apply(n,o.children)}}),t.on("copyPaste.copyElement",function(e){var t=e.descriptor,n=e.element,i=e.elements,o=n.parent;if(em(ey(o),"bpmndi:BPMNPlane")){var r=tf(o.id),s=(0,a.sE)(i,function(e){return e.id===r});s&&(t.parent=s.id)}}),t.on("copyPaste.pasteElement",function(e){var t=e.descriptor;t.parent&&(l(t.parent)||t.parent.hidden)&&(t.hidden=!0)})}function rB(e,t){e.invoke(ts,this),this.postExecuted("shape.replace",function(e){var n=e.context.oldShape,i=e.context.newShape;if(!(!em(i,"bpmn:SubProcess")||em(i,"bpmn:AdHocSubProcess"))&&(em(n,"bpmn:Task")||em(n,"bpmn:CallActivity"))&&eD(i)){var o={x:i.x+i.width/6,y:i.y+i.height/2};t.createShape({type:"bpmn:StartEvent"},o,i)}})}function rM(e){ts.call(this,e),this.preExecute("connection.create",function(e){let{target:t}=e;em(t,"bpmn:TextAnnotation")&&(e.parent=t.parent)},!0),this.preExecute(["shape.create","shape.resize","elements.move"],function(e){let t=e.shapes||[e.shape];1===t.length&&em(t[0],"bpmn:TextAnnotation")&&(e.hints=e.hints||{},e.hints.autoResize=!1)},!0)}function rA(e,t){ts.call(this,e),this.postExecuted("shape.toggleCollapse",1500,function(e){var n=e.shape;if(!eD(n)){var i=x(n);i.forEach(function(e){var t=e.incoming.slice(),n=e.outgoing.slice();(0,a.Ed)(t,function(e){o(e,!0)}),(0,a.Ed)(n,function(e){o(e,!1)})})}function o(e,o){(-1===i.indexOf(e.source)||-1===i.indexOf(e.target))&&(o?t.reconnectEnd(e,n,(0,j.wS)(n)):t.reconnectStart(e,n,(0,j.wS)(n)))}},!0)}function rL(e,t,n){ts.call(this,e),this.executed(["shape.toggleCollapse"],500,function(e){var t,n=e.context.shape;em(n,"bpmn:SubProcess")&&(n.collapsed?ey(n).isExpanded=!1:((t=n.children).length&&t.forEach(function(e){"label"!==e.type||e.businessObject.name||(e.hidden=!0)}),ey(n).isExpanded=!0))}),this.reverted(["shape.toggleCollapse"],500,function(e){var t=e.context.shape;t.collapsed?ey(t).isExpanded=!1:ey(t).isExpanded=!0}),this.postExecuted(["shape.toggleCollapse"],500,function(e){var i,o,r=e.context.shape,a=t.getDefaultSize(r);r.collapsed?o={x:r.x+(r.width-a.width)/2,y:r.y+(r.height-a.height)/2,width:a.width,height:a.height}:((i=ob(r.children.filter(function(e){return!e.hidden}).concat([r])))?(a.width=Math.max(i.width,a.width),a.height=Math.max(i.height,a.height),a.x=i.x+(i.width-a.width)/2,a.y=i.y+(i.height-a.height)/2):(a.x=r.x+(r.width-a.width)/2,a.y=r.y+(r.height-a.height)/2),o=a),n.resizeShape(r,o,null,{autoResize:!r.collapsed&&"nwse"})})}function rO(e,t,n,i){t.invoke(ts,this),this.preExecute("shape.delete",function(e){var t=e.context.shape,o=t.businessObject;(0,eL.j_)(t)||(em(t,"bpmn:Participant")&&eD(t)&&n.ids.unclaim(o.processRef.id),i.unclaimId(o.id,o))}),this.preExecute("connection.delete",function(e){var t=e.context.connection.businessObject;i.unclaimId(t.id,t)}),this.preExecute("canvas.updateRoot",function(){var t=e.getRootElement(),i=t.businessObject;em(t,"bpmn:Collaboration")&&n.ids.unclaim(i.id)})}function rN(e,t){ts.call(this,e),this.preExecute("connection.delete",function(e){var n=e.context.connection,i=n.source;(function(e,t){if(!em(e,"bpmn:SequenceFlow"))return!1;var n=ev(t),i=ev(e);return n.get("default")===i})(n,i)&&t.updateProperties(i,{default:null})})}function r$(e,t){ts.call(this,e);var n,i=["spaceTool","lane.add","lane.resize","lane.split","elements.create","elements.delete","elements.move","shape.create","shape.delete","shape.move","shape.resize"];this.preExecute(i,5e3,function(e){(n=n||new rI).enter()}),this.postExecuted(i,500,function(e){!function(){if(!n)throw Error("out of bounds release");n.leave()&&(t.updateLaneRefs(n.flowNodes,n.lanes),n=null)}()}),this.preExecute(["shape.create","shape.move","shape.delete","shape.resize"],function(e){var t=e.context.shape,i=function(){if(!n)throw Error("out of bounds release");return n}();!t.labelTarget&&(em(t,"bpmn:Lane")&&i.addLane(t),em(t,"bpmn:FlowNode")&&i.addFlowNode(t))})}function rI(){this.flowNodes=[],this.lanes=[],this.counter=0,this.addLane=function(e){this.lanes.push(e)},this.addFlowNode=function(e){this.flowNodes.push(e)},this.enter=function(){this.counter++},this.leave=function(){return this.counter--,!this.counter}}function rz(e,t){ts.call(this,e),this.postExecuted("elements.create",function(e){for(let n of e.context.elements)(function(e){let t=ev(e);return t&&t.isForCompensation})(n)&&!(n.incoming.filter(e=>{var t;return(t=e.source)&&em(t,"bpmn:BoundaryEvent")&&eA(t,"bpmn:CompensateEventDefinition")}).length>0)&&t.updateProperties(n,{isForCompensation:void 0})})}function rH(e,t){var n=(0,j.T8)(e,t,-15);return"intersect"!==n?n:null}function rF(e){nD.call(this,e)}function rG(e){return!e||(0,eL.j_)(e)}function rW(e){do{if(em(e,"bpmn:Process"))return ev(e);if(em(e,"bpmn:Participant"))return ev(e).processRef||ev(e)}while(e=e.parent)}function rV(e){return em(e,"bpmn:TextAnnotation")}function rU(e){return em(e,"bpmn:Group")&&!e.labelTarget}function rZ(e){return em(e,"bpmn:BoundaryEvent")&&rq(e,"bpmn:CompensateEventDefinition")}function rK(e){return ev(e).isForCompensation}function rJ(e){for(var t=e;t=t.parent;){if(em(t,"bpmn:FlowElementsContainer"))return ev(t);if(em(t,"bpmn:Participant"))return ev(t).processRef}return null}function rq(e,t){var n=ev(e);return!!(0,a.sE)(n.eventDefinitions||[],function(e){return em(e,t)})}function rX(e,t){return(ev(e).eventDefinitions||[]).every(function(e){return em(e,t)})}function rY(e,t){return -1!==(function(e){for(var t=[];e;)(e=e.parent)&&t.push(e);return t})(t).indexOf(e)}function rQ(e,t,n){if(rG(e)||rG(t))return null;if(!em(n,"bpmn:DataAssociation")){if(an(e,t))return{type:"bpmn:MessageFlow"};if(ai(e,t))return{type:"bpmn:SequenceFlow"}}return ao(e,t)||(at(e,t)?{type:"bpmn:Association",associationDirection:"One"}:!!ae(e,t)&&{type:"bpmn:Association",associationDirection:"None"})}function r0(e,t){return!!((0,eL.j_)(e)||rU(e))||(!em(t,"bpmn:Participant")||!!eD(t))&&(em(e,"bpmn:Participant")?em(t,"bpmn:Process")||em(t,"bpmn:Collaboration"):eg(e,["bpmn:DataInput","bpmn:DataOutput"])&&e.parent?t===e.parent:em(e,"bpmn:Lane")?em(t,"bpmn:Participant")||em(t,"bpmn:Lane"):(!em(e,"bpmn:BoundaryEvent")||!!(ev(e).cancelActivity&&(r2(e)||r5(e))))&&(em(e,"bpmn:FlowElement")&&!em(e,"bpmn:DataStoreReference")?em(t,"bpmn:FlowElementsContainer")?eD(t):eg(t,["bpmn:Participant","bpmn:Lane"]):em(e,"bpmn:DataStoreReference")&&em(t,"bpmn:Collaboration")?(0,a.G)(ev(t).get("participants"),function(e){return!!e.get("processRef")}):eg(e,["bpmn:Artifact","bpmn:DataAssociation","bpmn:DataStoreReference"])?eg(t,["bpmn:Collaboration","bpmn:Lane","bpmn:Participant","bpmn:Process","bpmn:SubProcess"]):!!em(e,"bpmn:MessageFlow")&&(em(t,"bpmn:Collaboration")||e.source.parent==t||e.target.parent==t)))}function r1(e){return em(e,"bpmn:Lane")}function r2(e){var t=ev(e);return t&&!(t.eventDefinitions&&t.eventDefinitions.length)}function r5(e){return r3(e,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])}function r3(e,t){return t.some(function(t){return rq(e,t)})}function r6(e,t,n,i){if(Array.isArray(e)||(e=[e]),1!==e.length)return!1;var o=e[0];return!((0,eL.j_)(o)||!(!(0,eL.j_)(o)&&em(o,"bpmn:BoundaryEvent")||em(o,"bpmn:IntermediateThrowEvent")&&r2(o)||em(o,"bpmn:IntermediateCatchEvent")&&r5(o))||eM(t)||!em(t,"bpmn:Activity")||rK(t)||i&&!rH(i,t))&&!(em(t,"bpmn:ReceiveTask")&&(0,a.sE)(t.incoming,function(e){return em(e.source,"bpmn:EventBasedGateway")}))&&"attach"}function r4(e,t,n){if(!t)return!1;var i={replacements:[]};return(0,a.Ed)(e,function(e){!eM(t)&&em(e,"bpmn:StartEvent")&&"label"!==e.type&&r0(e,t)&&(e&&!1!==ev(e).isInterrupting||i.replacements.push({oldElementId:e.id,newElementType:"bpmn:StartEvent"}),(eA(e,"bpmn:ErrorEventDefinition")||eA(e,"bpmn:EscalationEventDefinition")||eA(e,"bpmn:CompensateEventDefinition"))&&i.replacements.push({oldElementId:e.id,newElementType:"bpmn:StartEvent"}),r3(e,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])&&em(t,"bpmn:SubProcess")&&i.replacements.push({oldElementId:e.id,newElementType:"bpmn:StartEvent"})),!em(t,"bpmn:Transaction")&&rq(e,"bpmn:CancelEventDefinition")&&"label"!==e.type&&(em(e,"bpmn:EndEvent")&&r0(e,t)&&i.replacements.push({oldElementId:e.id,newElementType:"bpmn:EndEvent"}),em(e,"bpmn:BoundaryEvent")&&r6(e,t,null,n)&&i.replacements.push({oldElementId:e.id,newElementType:"bpmn:BoundaryEvent"}))}),!!i.replacements.length&&i}function r9(e,t){return!(0,a.G)(e,r1)&&(!t||e.every(function(e){return r0(e,t)}))}function r8(e,t,n,i){return!!t&&(!!((0,eL.j_)(e)||rU(e))||!(n===t||n&&rY(n,t))&&(r0(e,t,i)||ar(e,t,i)))}function r7(e,t){return em(e,"bpmn:SubProcess")?eD(e)&&(!t||t.width>=100&&t.height>=80):!!(em(e,"bpmn:Lane")||em(e,"bpmn:Participant")||rV(e)||rU(e))}function ae(e,t){var n,i;return!(rY(t,e)||rY(e,t))&&(n=rV(e),i=rV(t),(!!n||!!i)&&n!==i||!!ao(e,t))}function at(e,t){return rJ(e)===rJ(t)&&rZ(e)&&em(t,"bpmn:Activity")&&!t.attachers.includes(e)&&!eM(t)}function an(e,t){var n;return(!as(e)||!!as(t))&&em(e,"bpmn:InteractionNode")&&!em(e,"bpmn:BoundaryEvent")&&(!em(e,"bpmn:Event")||em(e,"bpmn:ThrowEvent")&&rX(e,"bpmn:MessageEventDefinition"))&&em(n=t,"bpmn:InteractionNode")&&!rK(n)&&(!em(n,"bpmn:Event")||em(n,"bpmn:CatchEvent")&&rX(n,"bpmn:MessageEventDefinition"))&&!(em(n,"bpmn:BoundaryEvent")&&!rq(n,"bpmn:MessageEventDefinition"))&&rW(e)!==rW(t)}function ai(e,t){var n;return em(e,"bpmn:FlowNode")&&!em(e,"bpmn:EndEvent")&&!eM(e)&&!(em(e,"bpmn:IntermediateThrowEvent")&&rq(e,"bpmn:LinkEventDefinition"))&&!rZ(e)&&!rK(e)&&em(n=t,"bpmn:FlowNode")&&!em(n,"bpmn:StartEvent")&&!em(n,"bpmn:BoundaryEvent")&&!eM(n)&&!(em(n,"bpmn:IntermediateCatchEvent")&&rq(n,"bpmn:LinkEventDefinition"))&&!rK(n)&&rJ(e)===rJ(t)&&!(em(e,"bpmn:EventBasedGateway")&&!(em(t,"bpmn:ReceiveTask")||em(t,"bpmn:IntermediateCatchEvent")&&(rq(t,"bpmn:MessageEventDefinition")||rq(t,"bpmn:TimerEventDefinition")||rq(t,"bpmn:ConditionalEventDefinition")||rq(t,"bpmn:SignalEventDefinition"))))}function ao(e,t){return eg(e,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&eg(t,["bpmn:Activity","bpmn:ThrowEvent"])?{type:"bpmn:DataInputAssociation"}:!!(eg(t,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&eg(e,["bpmn:Activity","bpmn:CatchEvent"]))&&{type:"bpmn:DataOutputAssociation"}}function ar(e,t,n){if(!t)return!1;if(Array.isArray(e)){if(1!==e.length)return!1;e=e[0]}return t.source!==e&&t.target!==e&&eg(t,["bpmn:SequenceFlow","bpmn:MessageFlow"])&&!(0,eL.j_)(t)&&em(e,"bpmn:FlowNode")&&!em(e,"bpmn:BoundaryEvent")&&r0(e,t.parent,n)}function aa(e,t){var n;return!!(0,eL.j_)(t)||!em(t,"bpmn:Lane")||(n=t.parent,!!e&&!!n&&-1!==e.indexOf(n))}function as(e){return nI(e,"bpmn:Process")||nI(e,"bpmn:Collaboration")}function ac(e,t){e.on("saveXML.start",2e3,function(){var e=t.getRootElements();(0,a.Ed)(e,function(e){var t,n,i=ey(e);t=x([e],!1),t=(0,a.hX)(t,function(t){return t!==e&&!t.labelTarget}),n=(0,a.UI)(t,ey),i.set("planeElement",n)})})}function al(e){ts.call(this,e);var t=this;this.preExecute(["shape.create","connection.create"],function(e){var n=e.context,i=n.shape||n.connection,o=n.parent,r=t.getOrdering(i,o);r&&(void 0!==r.parent&&(n.parent=r.parent),n.parentIndex=r.index)}),this.preExecute(["shape.move","connection.move"],function(e){var n=e.context,i=n.shape||n.connection,o=n.newParent||i.parent,r=t.getOrdering(i,o);r&&(void 0!==r.parent&&(n.newParent=r.parent),n.newParentIndex=r.index)})}function ap(e,t){al.call(this,e);var n=[{type:"bpmn:SubProcess",order:{level:6}},{type:"bpmn:SequenceFlow",order:{level:9,containers:["bpmn:Participant","bpmn:FlowElementsContainer"]}},{type:"bpmn:DataAssociation",order:{level:9,containers:["bpmn:Collaboration","bpmn:FlowElementsContainer"]}},{type:"bpmn:TextAnnotation",order:{level:9}},{type:"bpmn:MessageFlow",order:{level:9,containers:["bpmn:Collaboration"]}},{type:"bpmn:Association",order:{level:6,containers:["bpmn:Participant","bpmn:FlowElementsContainer","bpmn:Collaboration"]}},{type:"bpmn:BoundaryEvent",order:{level:8}},{type:"bpmn:Group",order:{level:10,containers:["bpmn:Collaboration","bpmn:FlowElementsContainer"]}},{type:"bpmn:FlowElement",order:{level:5}},{type:"bpmn:Participant",order:{level:-2}},{type:"bpmn:Lane",order:{level:-1}}];function i(e){var t=e.order;if(t||(e.order=t=function(e){if(e.labelTarget)return{level:10};var t=(0,a.sE)(n,function(t){return eg(e,[t.type])});return t&&t.order||{level:1}}(e)),!t)throw Error(`no order for <${e.id}>`);return t}this.getOrdering=function(e,n){if(e.labelTarget||em(e,"bpmn:TextAnnotation"))return{parent:t.findRoot(n)||t.getRootElement(),index:-1};var o=i(e);o.containers&&(n=function(e,t,n){for(var i=t;i&&!eg(i,n);)i=i.parent;if(!i)throw Error(`no parent for <${e.id}> in <${t&&t.id}>`);return i}(e,n,o.containers));var r=n.children.indexOf(e),s=(0,a.cx)(n.children,function(t){return(!!e.labelTarget||!t.labelTarget)&&o.level<i(t).level});return -1!==s&&-1!==r&&r<s&&(s-=1),{index:s,parent:n}}}function ah(){}(0,o.Z)(rD,ts),rD.prototype._moveChildrenToShape=function(e,t){var n,i=this._modeling,o=e.children;if(o){var r=(o=o.concat(o.reduce(function(t,n){return n.label&&n.label.parent!==e?t.concat(n.label):t},[]))).filter(function(e){return!e.hidden});if(!r.length){i.moveElements(o,{x:0,y:0},t,{autoResize:!1});return}var a=_(r);if(t.x){var s=(0,j.wS)(t),c=(0,j.wS)(a);n={x:s.x-c.x,y:s.y-c.y}}else n={x:rj.x-a.x,y:rj.y-a.y};i.moveElements(o,n,t,{autoResize:!1})}},rD.prototype._showRecursively=function(e,t){var n=this,i=[];return e.forEach(function(e){e.hidden=!!t,i=i.concat(e),e.children&&(i=i.concat(n._showRecursively(e.children,e.collapsed||t)))}),i},rD.prototype._addDiagram=function(e){var t=this._bpmnjs.getDefinitions().diagrams;return e.businessObject||(e=this._createNewDiagram(e)),t.push(e.di.$parent),e},rD.prototype._createNewDiagram=function(e){var t=this._bpmnFactory,n=this._elementFactory,i=t.create("bpmndi:BPMNPlane",{bpmnElement:e}),o=t.create("bpmndi:BPMNDiagram",{plane:i});return i.$parent=o,n.createRoot({id:tu(e),type:e.$type,di:i,businessObject:e,collapsed:!0})},rD.prototype._removeDiagram=function(e){var t=this._bpmnjs.getDefinitions().diagrams,n=(0,a.sE)(t,function(t){return t.plane.bpmnElement.id===e.id});return t.splice(t.indexOf(n),1),n},rD.$inject=["canvas","eventBus","modeling","elementFactory","bpmnFactory","bpmnjs","elementRegistry"],rB.$inject=["injector","modeling"],(0,o.Z)(rB,ts),(0,o.Z)(rM,ts),rM.$inject=["eventBus"],(0,o.Z)(rA,ts),rA.$inject=["eventBus","modeling"],(0,o.Z)(rL,ts),rL.$inject=["eventBus","elementFactory","modeling"],(0,o.Z)(rO,ts),rO.$inject=["canvas","injector","moddle","modeling"],(0,o.Z)(rN,ts),rN.$inject=["eventBus","modeling"],r$.$inject=["eventBus","modeling"],(0,o.Z)(r$,ts),(0,o.Z)(rz,ts),rz.$inject=["eventBus","modeling"],(0,o.Z)(rF,nD),rF.$inject=["eventBus"],rF.prototype.init=function(){this.addRule("connection.start",function(e){var t;return rG(t=e.source)?null:eg(t,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference","bpmn:Group","bpmn:TextAnnotation"])}),this.addRule("connection.create",function(e){var t=e.source,n=e.target,i=e.hints||{},o=i.targetParent;if(i.targetAttach)return!1;o&&(n.parent=o);try{return rQ(t,n)}finally{o&&(n.parent=null)}}),this.addRule("connection.reconnect",function(e){var t=e.connection;return rQ(e.source,e.target,t)}),this.addRule("connection.updateWaypoints",function(e){return{type:e.connection.type}}),this.addRule("shape.resize",function(e){return r7(e.shape,e.newBounds)}),this.addRule("elements.create",function(e){var t=e.elements,n=e.position,i=e.target;return(!(0,eL.Ho)(i)||!!ar(t,i,n))&&(0,a.yW)(t,function(e){return(0,eL.Ho)(e)?rQ(e.source,e.target,e):e.host?r6(e,e.host,null,n):r8(e,i,null,n)})}),this.addRule("elements.move",function(e){var t=e.target,n=e.shapes,i=e.position;return r6(n,t,null,i)||r4(n,t,i)||r9(n,t,i)||ar(n,t,i)}),this.addRule("shape.create",function(e){return r8(e.shape,e.target,e.source,e.position)}),this.addRule("shape.attach",function(e){return r6(e.shape,e.target,null,e.position)}),this.addRule("element.copy",function(e){var t=e.element;return aa(e.elements,t)})},rF.prototype.canConnectMessageFlow=an,rF.prototype.canConnectSequenceFlow=ai,rF.prototype.canConnectDataAssociation=ao,rF.prototype.canConnectAssociation=ae,rF.prototype.canConnectCompensationAssociation=at,rF.prototype.canMove=r9,rF.prototype.canAttach=r6,rF.prototype.canReplace=r4,rF.prototype.canDrop=r0,rF.prototype.canInsert=ar,rF.prototype.canCreate=r8,rF.prototype.canConnect=rQ,rF.prototype.canResize=r7,rF.prototype.canCopy=aa,ac.$inject=["eventBus","canvas"],al.prototype.getOrdering=function(e,t){return null},(0,o.Z)(al,ts),ap.$inject=["eventBus","canvas"],(0,o.Z)(ap,al),ah.prototype.get=function(){return this._data},ah.prototype.set=function(e){this._data=e},ah.prototype.clear=function(){var e=this._data;return delete this._data,e},ah.prototype.isEmpty=function(){return!this._data};var au="drop-not-ok",ad="attach-ok",af="new-parent",am="create";function ag(e,t,n,i,o){function r(t,n){[ad,"drop-ok",au,af].forEach(function(i){i===n?e.addMarker(t,i):e.removeMarker(t,i)})}function s(){var e=t.context();e&&e.prefix===am&&t.cancel()}n.on(["create.move","create.hover"],function(e){var t=e.context,n=t.elements,i=e.hover,s=t.source,c=t.hints||{};if(!i){t.canExecute=!1,t.target=null;return}av(e);var l={x:e.x,y:e.y},p=t.canExecute=i&&function(e,t,n,i,r){if(!t)return!1;e=(0,a.hX)(e,function(t){var n=t.labelTarget;return!t.parent&&!((0,eL.j_)(t)&&-1!==e.indexOf(n))});var s=(0,a.sE)(e,function(e){return!(0,eL.Ho)(e)}),c=!1,l=!1,p=!1;ay(e)&&(c=o.allowed("shape.attach",{position:n,shape:s,target:t})),c||(p=ay(e)?o.allowed("shape.create",{position:n,shape:s,source:i,target:t}):o.allowed("elements.create",{elements:e,position:n,target:t}));var h=r.connectionTarget;return p||c?(s&&i&&(l=o.allowed("connection.create",{source:h===i?s:i,target:h===i?i:s,hints:{targetParent:t,targetAttach:c}})),{attach:c,connect:l}):(null===p||null===c)&&null}(n,i,l,s,c);i&&null!==p&&(t.target=i,p&&p.attach?r(i,ad):r(i,p?af:au))}),n.on(["create.end","create.out","create.cleanup"],function(e){var t=e.hover;t&&r(t,null)}),n.on("create.end",function(e){var t=e.context,n=t.source,o=t.shape,r=t.elements,s=t.target,c=t.canExecute,l=c&&c.attach,p=c&&c.connect,h=t.hints||{};if(!1===c||!s)return!1;av(e);var u={x:e.x,y:e.y};p?o=i.appendShape(n,o,u,s,{attach:l,connection:!0===p?{}:p,connectionTarget:h.connectionTarget}):(r=i.createElements(r,u,s,(0,a.f0)({},h,{attach:l})),o=(0,a.sE)(r,function(e){return!(0,eL.Ho)(e)})),(0,a.f0)(t,{elements:r,shape:o}),(0,a.f0)(e,{elements:r,shape:o})}),n.on("create.init",function(){n.on("elements.changed",s),n.once(["create.cancel","create.end"],2e3,function(){n.off("elements.changed",s)})}),this.start=function(e,n,i){(0,a.kJ)(n)||(n=[n]);var o=(0,a.sE)(n,function(e){return!(0,eL.Ho)(e)});if(o){i=(0,a.f0)({elements:n,hints:{},shape:o},i||{}),(0,a.Ed)(n,function(e){(0,a.hj)(e.x)||(e.x=0),(0,a.hj)(e.y)||(e.y=0)});var r=_((0,a.hX)(n,function(e){return!e.hidden}));(0,a.Ed)(n,function(e){(0,eL.Ho)(e)&&(e.waypoints=(0,a.UI)(e.waypoints,function(e){return{x:e.x-r.x-r.width/2,y:e.y-r.y-r.height/2}})),(0,a.f0)(e,{x:e.x-r.x-r.width/2,y:e.y-r.y-r.height/2})}),t.init(e,am,{cursor:"grabbing",autoActivate:!0,data:{shape:o,elements:n,context:i}})}}}function av(e){var t=e.context.createConstraints;t&&(t.left&&(e.x=Math.max(e.x,t.left)),t.right&&(e.x=Math.min(e.x,t.right)),t.top&&(e.y=Math.max(e.y,t.top)),t.bottom&&(e.y=Math.min(e.y,t.bottom)))}function ay(e){return e&&1===e.length&&!(0,eL.Ho)(e[0])}function ab(e,t,n,i,o){t.on("create.move",750,function(t){var r,a,s,l=t.hover,p=t.context,h=p.elements,u=p.dragGroup;u||(u=p.dragGroup=(r=(0,c.Ue)("g"),(0,c.Lj)(r,o.cls("djs-drag-group",["no-events"])),a=(0,c.Ue)("g"),h.forEach(function(e){var t;e.hidden||(e.waypoints?(t=n._createContainer("connection",a),n.drawConnection((0,en.s)(t),e)):(t=n._createContainer("shape",a),n.drawShape((0,en.s)(t),e),eo(t,e.x,e.y)),i.addDragger(e,r,t))}),r)),l?(u.parentNode||(s=e.getActiveLayer(),(0,c.R3)(s,u)),eo(u,t.x,t.y)):(0,c.Od)(u)}),t.on("create.cleanup",function(e){var t=e.context.dragGroup;t&&(0,c.Od)(t)})}ag.$inject=["canvas","dragging","eventBus","modeling","rules"],ab.$inject=["canvas","eventBus","graphicsFactory","previewSupport","styles"];var ax={__depends__:[n0,i0,n5,tI],__init__:["create","createPreview"],create:["type",ag],createPreview:["type",ab]};function a_(e){var t=this;function n(e){t._lastMoveEvent=e}this._lastMoveEvent=null,e.on("canvas.init",function(e){(t._svg=e.svg).addEventListener("mousemove",n)}),e.on("canvas.destroy",function(){t._lastMouseEvent=null,t._svg.removeEventListener("mousemove",n)})}a_.$inject=["eventBus"],a_.prototype.getLastMoveEvent=function(){var e;return this._lastMoveEvent||((e=document.createEvent("MouseEvent")).initMouseEvent&&e.initMouseEvent("mousemove",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),e)};var aw={__init__:["mouse"],mouse:["type",a_]};function aE(e,t,n,i,o,r,s,c){this._canvas=e,this._create=t,this._clipboard=n,this._elementFactory=i,this._eventBus=o,this._modeling=r,this._mouse=s,this._rules=c,o.on("copyPaste.copyElement",function(e){var t=e.descriptor,n=e.element,i=e.elements;t.priority=1,t.id=n.id,(0,a.sE)(i,function(e){return e===n.parent})&&(t.parent=n.parent.id),n.host&&(t.priority=2,t.host=n.host.id),(0,eL.Ho)(n)&&(t.priority=3,t.source=n.source.id,t.target=n.target.id,t.waypoints=(0,a.UI)(n.waypoints,function(e){return(e=aS(e)).original&&(e.original=aS(e.original)),e})),(0,eL.j_)(n)&&(t.priority=4,t.labelTarget=n.labelTarget.id),(0,a.Ed)(["x","y","width","height"],function(e){(0,a.hj)(n[e])&&(t[e]=n[e])}),t.hidden=n.hidden,t.collapsed=n.collapsed}),o.on("copyPaste.pasteElements",function(e){var t=e.hints;(0,a.f0)(t,{createElementsBehavior:!1})})}function aS(e){return(0,a.f0)({},e)}function ak(e,t,n){(0,a.kJ)(n)||(n=[n]),(0,a.Ed)(n,function(n){(0,a.o8)(e[n])||(t[n]=e[n])})}function aC(e,t,n){function i(t,i){var o=e.create(t.$type);return n.copyElement(t,o,null,i)}t.on("copyPaste.copyElement",750,function(e){var t=e.descriptor,n=e.element,o=ev(n);if((0,eL.j_)(n))return t;var r=t.businessObject=i(o,!0),a=t.di=i(ey(n),!0);a.bpmnElement=r,ak(r,t,"name"),ak(a,t,"isExpanded"),o.default&&(t.default=o.default.id)});var o="-bpmn-js-refs";t.on("copyPaste.pasteElement",function(e){var t=e.cache,n=e.descriptor,o=n.businessObject,r=n.di;if((0,eL.j_)(n)){n.businessObject=ev(t[n.labelTarget]),n.di=ey(t[n.labelTarget]);return}o=n.businessObject=i(o),(r=n.di=i(r)).bpmnElement=o,ak(n,o,["isExpanded","name"]),n.type=o.$type}),t.on("copyPaste.copyElement",750,function(e){var t=e.descriptor,n=e.element;if(em(n,"bpmn:Participant")){var o=ev(n);o.processRef&&(t.processRef=i(o.processRef,!0))}}),t.on("copyPaste.pasteElement",function(e){var t=e.descriptor,n=t.processRef;n&&(t.processRef=i(n))}),t.on("copyPaste.pasteElement",750,function(e){var t,n,i,r=e.cache,s=e.descriptor;t=r[o]=r[o]||{},n=ev(s),s.default&&(t[s.default]={element:n,property:"default"}),s.host&&(ev(s).attachedToRef=ev(r[s.host])),i=(0,a.CE)(t,(0,a.u4)(t,function(e,t,i){var o=t.element,r=t.property;return i===s.id&&(o.set(r,n),e.push(s.id)),e},[])),r[o]=i})}aE.$inject=["canvas","create","clipboard","elementFactory","eventBus","modeling","mouse","rules"],aE.prototype.copy=function(e){var t,n;return(0,a.kJ)(e)||(e=e?[e]:[]),n=!1===(t=this._eventBus.fire("copyPaste.canCopyElements",{elements:e}))?{}:this.createTree((0,a.kJ)(t)?t:e),this._clipboard.set(n),this._eventBus.fire("copyPaste.elementsCopied",{elements:e,tree:n}),n},aE.prototype.paste=function(e){var t=this._clipboard.get();if(!this._clipboard.isEmpty()){var n=e&&e.hints||{};this._eventBus.fire("copyPaste.pasteElements",{hints:n});var i=this._createElements(t);if(e&&e.element&&e.point)return this._paste(i,e.element,e.point,n);this._create.start(this._mouse.getLastMoveEvent(),i,{hints:n||{}})}},aE.prototype._paste=function(e,t,n,i){(0,a.Ed)(e,function(e){(0,a.hj)(e.x)||(e.x=0),(0,a.hj)(e.y)||(e.y=0)});var o=_(e);return(0,a.Ed)(e,function(e){(0,eL.Ho)(e)&&(e.waypoints=(0,a.UI)(e.waypoints,function(e){return{x:e.x-o.x-o.width/2,y:e.y-o.y-o.height/2}})),(0,a.f0)(e,{x:e.x-o.x-o.width/2,y:e.y-o.y-o.height/2})}),this._modeling.createElements(e,n,t,(0,a.f0)({},i))},aE.prototype._createElements=function(e){var t=this,n=this._eventBus,i={},o=[];return(0,a.Ed)(e,function(e,r){r=parseInt(r,10),e=(0,a.MR)(e,"priority"),(0,a.Ed)(e,function(e){var r,s=(0,a.f0)({},(0,a.CE)(e,["priority"]));if(i[e.parent]?s.parent=i[e.parent]:delete s.parent,n.fire("copyPaste.pasteElement",{cache:i,descriptor:s}),(0,eL.Ho)(s)){s.source=i[e.source],s.target=i[e.target],r=i[e.id]=t.createConnection(s),o.push(r);return}if((0,eL.j_)(s)){s.labelTarget=i[s.labelTarget],r=i[e.id]=t.createLabel(s),o.push(r);return}s.host&&(s.host=i[s.host]),r=i[e.id]=t.createShape(s),o.push(r)})}),o},aE.prototype.createConnection=function(e){return this._elementFactory.createConnection((0,a.CE)(e,["id"]))},aE.prototype.createLabel=function(e){return this._elementFactory.createLabel((0,a.CE)(e,["id"]))},aE.prototype.createShape=function(e){return this._elementFactory.createShape((0,a.CE)(e,["id"]))},aE.prototype.hasRelations=function(e,t){var n,i;return!((0,eL.Ho)(e)&&(n=(0,a.sE)(t,(0,a.KQ)({id:e.source.id})),i=(0,a.sE)(t,(0,a.KQ)({id:e.target.id})),!n||!i)||(0,eL.j_)(e)&&!(0,a.sE)(t,(0,a.KQ)({id:e.labelTarget.id})))},aE.prototype.createTree=function(e){var t=this._rules,n=this,i={},o=[];function r(e,t){var n,i,r=(0,a.sE)(o,function(t){return e===t.element});if(!r){o.push({element:e,depth:t});return}r.depth<t&&(-1!==(i=(n=o).indexOf(r))&&n.splice(i,1),o=n).push({element:r.element,depth:t})}return b(v(e),function(e,t,i){if(!(0,eL.j_)(e)){(0,a.Ed)(e.labels,function(e){r(e,i)}),(0,a.Ed)([e.attachers,e.incoming,e.outgoing],function(e){e&&e.length&&(0,a.Ed)(e,function(e){(0,a.Ed)(e.labels,function(e){r(e,i)}),r(e,i)})}),r(e,i);var o=[];return e.children&&(o=e.children.slice()),n._eventBus.fire("copyPaste.createTree",{element:e,children:o}),o}}),e=(0,a.UI)(o,function(e){return e.element}),o=(0,a.UI)(o,function(t){return t.descriptor={},n._eventBus.fire("copyPaste.copyElement",{descriptor:t.descriptor,element:t.element,elements:e}),t}),o=(0,a.MR)(o,function(e){return e.descriptor.priority}),e=(0,a.UI)(o,function(e){return e.element}),(0,a.Ed)(o,function(o){var r,a,s,c,l,p=o.depth;if(!n.hasRelations(o.element,e)||(c=o.element,l=e,!t.allowed("element.copy",{element:c,elements:l}))){r=o.element,-1===(s=(a=e).indexOf(r))||a.splice(s,1);return}i[p]||(i[p]=[]),i[p].push(o.descriptor)}),i},aC.$inject=["bpmnFactory","eventBus","moddleCopy"];let aR=["artifacts","dataInputAssociations","dataOutputAssociations","default","flowElements","lanes","incoming","outgoing","categoryValue"],aP=["errorRef","escalationRef","messageRef","signalRef"];function aT(e,t,n){this._bpmnFactory=t,this._eventBus=e,this._moddle=n,e.on("moddleCopy.canCopyProperties",e=>{let{propertyNames:t}=e;if(t&&t.length)return(0,a.MR)(t,e=>"extensionElements"===e)}),e.on("moddleCopy.canCopyProperty",e=>{let{parent:t,property:n,propertyName:i}=e,o=(0,a.Kn)(t)&&t.$descriptor;return i&&aP.includes(i)?n:!(i&&aR.includes(i))&&(!i||!o||!!(0,a.sE)(o.properties,(0,a.KQ)({name:i})))&&void 0}),e.on("moddleCopy.canSetCopiedProperty",e=>{let{property:t}=e;if(em(t,"bpmn:ExtensionElements")&&(!t.values||!t.values.length))return!1})}function aj(e,t){return(0,a.u4)(e.properties,(e,n)=>t&&n.default?e:e.concat(n.name),[])}aT.$inject=["eventBus","bpmnFactory","moddle"],aT.prototype.copyElement=function(e,t,n,i=!1){n&&!(0,a.kJ)(n)&&(n=[n]),n=n||aj(e.$descriptor);let o=this._eventBus.fire("moddleCopy.canCopyProperties",{propertyNames:n,sourceElement:e,targetElement:t,clone:i});return!1===o||((0,a.kJ)(o)&&(n=o),(0,a.Ed)(n,n=>{let o;(0,a.e$)(e,n)&&(o=e.get(n));let r=this.copyProperty(o,t,n,i);(0,a.$K)(r)&&!1!==this._eventBus.fire("moddleCopy.canSetCopiedProperty",{parent:t,property:r,propertyName:n})&&t.set(n,r)})),t},aT.prototype.copyProperty=function(e,t,n,i=!1){let o=this._eventBus.fire("moddleCopy.canCopyProperty",{parent:t,property:e,propertyName:n,clone:i});if(!1===o)return;if(o)return(0,a.Kn)(o)&&o.$type&&!o.$parent&&(o.$parent=t),o;let r=this._moddle.getPropertyDescriptor(t,n);if(!r.isReference){if(r.isId)return e&&this._copyId(e,t,i);if((0,a.kJ)(e))return(0,a.u4)(e,(e,o)=>{let r=this.copyProperty(o,t,n,i);return r?e.concat(r):e},[]);if((0,a.Kn)(e)&&e.$type){if(this._moddle.getElementDescriptor(e).isGeneric)return;return(o=this._bpmnFactory.create(e.$type)).$parent=t,o=this.copyElement(e,o,null,i)}return e}},aT.prototype._copyId=function(e,t,n=!1){return n?e:this._moddle.ids.assigned(e)?void 0:(this._moddle.ids.claim(e,t),e)};var aD={__depends__:[{__depends__:[{clipboard:["type",ah]},ax,aw,n5],__init__:["copyPaste"],copyPaste:["type",aE]}],__init__:["bpmnCopyPaste","moddleCopy"],bpmnCopyPaste:["type",aC],moddleCopy:["type",aT]},aB=Math.round;function aM(e,t){this._modeling=e,this._eventBus=t}function aA(e,t){t.on("replace.end",500,function(t){let{newElement:n,hints:i={}}=t;!1!==i.select&&e.select(n)})}aM.$inject=["modeling","eventBus"],aM.prototype.replaceElement=function(e,t,n){if(e.waypoints)return null;var i=this._modeling,o=this._eventBus;o.fire("replace.start",{element:e,attrs:t,hints:n});var r=t.width||e.width,s=t.height||e.height,c=t.x||e.x,l=t.y||e.y,p=aB(c+r/2),h=aB(l+s/2),u=i.replaceShape(e,(0,a.f0)({},t,{x:p,y:h,width:r,height:s}),n);return o.fire("replace.end",{element:e,newElement:u,hints:n}),u},aA.$inject=["selection","eventBus"];var aL=["cancelActivity","instantiate","eventGatewayType","triggeredByEvent","isInterrupting"];function aO(e,t,n,i,o,r){this.replaceElement=function(s,c,l){l=l||{};var p,h,u,d,f,m,g,v=c.type,y=s.businessObject;if(aN(y)&&("bpmn:SubProcess"===v||"bpmn:AdHocSubProcess"===v)&&(d=s&&(0,a.e$)(s,"collapsed")?s.collapsed:!eD(s),u=c&&((0,a.e$)(c,"collapsed")||(0,a.e$)(c,"isExpanded"))?(0,a.e$)(c,"collapsed")?c.collapsed:!c.isExpanded:d,d!==u))return i.toggleCollapse(s),s;var b=e.create(v),x={type:v,businessObject:b};x.di={},"bpmn:ExclusiveGateway"===v&&(x.di.isMarkerVisible=!0),f=s.di,m=x.di,g=["fill","stroke","background-color","border-color","color"],(0,a.kJ)(g)||(g=[g]),(0,a.Ed)(g,function(e){(0,a.o8)(f[e])||(m[e]=f[e])});var _=(p=aj(y.$descriptor),h=aj(b.$descriptor,!0),p.filter(function(e){return h.includes(e)}));(0,a.f0)(b,(0,a.ei)(c,aL));var w=(0,a.hX)(_,function(e){return"eventDefinitions"===e?a$(s,c.eventDefinitionType):"loopCharacteristics"===e?!eM(b):!(0,a.e$)(b,e)&&("processRef"!==e||!1!==c.isExpanded)&&"triggeredByEvent"!==e&&("isForCompensation"!==e||!eM(b))});if(b=n.copyElement(y,b,w),c.eventDefinitionType&&!a$(b,c.eventDefinitionType)&&(x.eventDefinitionType=c.eventDefinitionType,x.eventDefinitionAttrs=c.eventDefinitionAttrs),em(y,"bpmn:Activity")){if(aN(y))x.isExpanded=eD(s);else if(c&&(0,a.e$)(c,"isExpanded")){x.isExpanded=c.isExpanded;var E=t.getDefaultSize(b,{isExpanded:x.isExpanded});x.width=E.width,x.height=E.height,x.x=s.x-(x.width-s.width)/2,x.y=s.y-(x.height-s.height)/2}eD(s)&&!em(y,"bpmn:Task")&&x.isExpanded&&(x.width=s.width,x.height=s.height)}if(aN(y)&&!aN(b)&&(l.moveChildren=!1),em(y,"bpmn:Participant")){!0===c.isExpanded?b.processRef=e.create("bpmn:Process"):l.moveChildren=!1;var S=eB(s);ey(s).isHorizontal||(ey(x).isHorizontal=S),x.width=S?s.width:t.getDefaultSize(x).width,x.height=S?t.getDefaultSize(x).height:s.height}return r.allowed("shape.resize",{shape:b})||(x.height=t.getDefaultSize(x).height,x.width=t.getDefaultSize(x).width),b.name=y.name,eg(y,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&eg(b,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&(b.default=y.default),c.host&&!em(y,"bpmn:BoundaryEvent")&&em(b,"bpmn:BoundaryEvent")&&(x.host=c.host),("bpmn:DataStoreReference"===x.type||"bpmn:DataObjectReference"===x.type)&&(x.x=s.x+(s.width-x.width)/2),o.replaceElement(s,x,{...l,targetElement:c})}}function aN(e){return em(e,"bpmn:SubProcess")}function a$(e,t){var n=ev(e);return t&&n.get("eventDefinitions").some(function(e){return em(e,t)})}aO.$inject=["bpmnFactory","elementFactory","moddleCopy","modeling","replace","rules"];var aI={__depends__:[aD,{__init__:["replace","replaceSelectionBehavior"],replaceSelectionBehavior:["type",aA],replace:["type",aM]},tI],bpmnReplace:["type",aO]};function az(e){this._eventBus=e,this._tools=[],this._active=null}az.$inject=["eventBus"],az.prototype.registerTool=function(e,t){var n=this._tools;if(!t)throw Error('A tool has to be registered with it\'s "events"');n.push(e),this.bindEvents(e,t)},az.prototype.isActive=function(e){return e&&this._active===e},az.prototype.length=function(e){return this._tools.length},az.prototype.setActive=function(e){var t=this._eventBus;this._active!==e&&(this._active=e,t.fire("tool-manager.update",{tool:e}))},az.prototype.bindEvents=function(e,t){var n=this._eventBus,i=[];n.on(t.tool+".init",function(t){if(!t.context.reactivate&&this.isActive(e)){this.setActive(null);return}this.setActive(e)},this),(0,a.Ed)(t,function(e){i.push(e+".ended"),i.push(e+".canceled")}),n.on(i,250,function(e){var t;!(!this._active||(t=e.originalEvent&&e.originalEvent.target)&&(0,s.oq)(t,'.group[data-group="tools"]'))&&this.setActive(null)},this)};var aH={__depends__:[n0],__init__:["toolManager"],toolManager:["type",az]};function aF(e,t){return -1!==e.indexOf(t)}var aG=Math.abs,aW=Math.round,aV={x:"width",y:"height"},aU="crosshair",aZ={n:"top",w:"left",s:"bottom",e:"right"},aK={n:"s",w:"e",s:"n",e:"w"};function aJ(e,t,n,i,o,r,a){this._canvas=e,this._dragging=t,this._eventBus=n,this._modeling=i,this._rules=o,this._toolManager=r,this._mouse=a;var s=this;r.registerTool("space",{tool:"spaceTool.selection",dragging:"spaceTool"}),n.on("spaceTool.selection.end",function(e){n.once("spaceTool.selection.ended",function(){s.activateMakeSpace(e.originalEvent)})}),n.on("spaceTool.move",1500,function(e){var t=e.context,n=t.initialized;n||(n=t.initialized=s.init(e,t)),n&&aX(e)}),n.on("spaceTool.end",function(e){var t=e.context,i=t.axis,o=t.direction,r=t.movingShapes,a=t.resizingShapes,c=t.start;if(t.initialized){aX(e);var l={x:0,y:0};l[i]=aW(e["d"+i]),s.makeSpace(r,a,l,o,c),n.once("spaceTool.ended",function(e){s.activateSelection(e.originalEvent,!0,!0)})}})}function aq(e){return{top:e.top-20,right:e.right+20,bottom:e.bottom+20,left:e.left-20}}function aX(e){var t,n,i=e.context.spaceToolConstraints;i&&((0,a.hj)(i.left)&&(t=Math.max(e.x,i.left),e.dx=e.dx+t-e.x,e.x=t),(0,a.hj)(i.right)&&(t=Math.min(e.x,i.right),e.dx=e.dx+t-e.x,e.x=t),(0,a.hj)(i.top)&&(n=Math.max(e.y,i.top),e.dy=e.dy+n-e.y,e.y=n),(0,a.hj)(i.bottom)&&(n=Math.min(e.y,i.bottom),e.dy=e.dy+n-e.y,e.y=n))}function aY(e,t){return -1!==e.indexOf(t)}aJ.$inject=["canvas","dragging","eventBus","modeling","rules","toolManager","mouse"],aJ.prototype.activateSelection=function(e,t,n){this._dragging.init(e,"spaceTool.selection",{autoActivate:t,cursor:aU,data:{context:{reactivate:n}},trapClick:!1})},aJ.prototype.activateMakeSpace=function(e){this._dragging.init(e,"spaceTool",{autoActivate:!0,cursor:aU,data:{context:{}}})},aJ.prototype.makeSpace=function(e,t,n,i,o){return this._modeling.createSpace(e,t,n,i,o)},aJ.prototype.init=function(e,t){var n=aG(e.dx)>aG(e.dy)?"x":"y",i=e["d"+n],o=e[n]-i;if(5>aG(i))return!1;i<0&&(i*=-1),tR(e)&&(i*=-1);var r=function(e,t){if("x"===e){if(t>0)return"e";if(t<0)return"w"}if("y"===e){if(t>0)return"s";if(t<0)return"n"}return null}(n,i),s=this._canvas.getRootElement();!tP(e)&&e.hover&&(s=e.hover);var c=[...x(s,!0),...s.attachers||[]],l=this.calculateAdjustments(c,n,i,o),p=this._eventBus.fire("spaceTool.getMinDimensions",{axis:n,direction:r,shapes:l.resizingShapes,start:o}),h=function(e,t,n,i,o){var r=e.movingShapes,s=e.resizingShapes;if(s.length){var c,l,p={};return(0,a.Ed)(s,function(e){var h,u,d,f,m,g=e.attachers,v=e.children,y=(0,j.JA)(e),b=(0,a.hX)(v,function(e){return!(0,eL.Ho)(e)&&!(0,eL.j_)(e)&&!aY(r,e)&&!aY(s,e)}),x=(0,a.hX)(v,function(e){return!(0,eL.Ho)(e)&&!(0,eL.j_)(e)&&aY(r,e)}),w=[],E=[];b.length&&(u=aq((0,j.JA)(_(b))),h=i-y[aZ[n]]+u[aZ[n]],"n"===n?p.bottom=l=(0,a.hj)(l)?Math.min(l,h):h:"w"===n?p.right=l=(0,a.hj)(l)?Math.min(l,h):h:"s"===n?p.top=c=(0,a.hj)(c)?Math.max(c,h):h:"e"===n&&(p.left=c=(0,a.hj)(c)?Math.max(c,h):h)),x.length&&(h=i-aq((0,j.JA)(_(x)))[aZ[aK[n]]]+y[aZ[aK[n]]],"n"===n?p.bottom=l=(0,a.hj)(l)?Math.min(l,h):h:"w"===n?p.right=l=(0,a.hj)(l)?Math.min(l,h):h:"s"===n?p.top=c=(0,a.hj)(c)?Math.max(c,h):h:"e"===n&&(p.left=c=(0,a.hj)(c)?Math.max(c,h):h)),g&&g.length&&(g.forEach(function(e){aY(r,e)?w.push(e):E.push(e)}),w.length&&(d=(0,j.JA)(_(w.map(j.wS))),f=y[aZ[aK[n]]]-(d[aZ[aK[n]]]-i)),E.length&&(m=(0,j.JA)(_(E.map(j.wS)))[aZ[n]]-(y[aZ[n]]-i)),"n"===n?(h=Math.min(f||1/0,m||1/0),p.bottom=l=(0,a.hj)(l)?Math.min(l,h):h):"w"===n?(h=Math.min(f||1/0,m||1/0),p.right=l=(0,a.hj)(l)?Math.min(l,h):h):"s"===n?(h=Math.max(f||-1/0,m||-1/0),p.top=c=(0,a.hj)(c)?Math.max(c,h):h):"e"===n&&(h=Math.max(f||-1/0,m||-1/0),p.left=c=(0,a.hj)(c)?Math.max(c,h):h));var S=o&&o[e.id];S&&("n"===n?(h=i+e[aV[t]]-S[aV[t]],p.bottom=l=(0,a.hj)(l)?Math.min(l,h):h):"w"===n?(h=i+e[aV[t]]-S[aV[t]],p.right=l=(0,a.hj)(l)?Math.min(l,h):h):"s"===n?(h=i-e[aV[t]]+S[aV[t]],p.top=c=(0,a.hj)(c)?Math.max(c,h):h):"e"===n&&(h=i-e[aV[t]]+S[aV[t]],p.left=c=(0,a.hj)(c)?Math.max(c,h):h))}),p}}(l,n,r,o,p);return(0,a.f0)(t,l,{axis:n,direction:r,spaceToolConstraints:h,start:o}),tX("resize-"+("x"===n?"ew":"ns")),!0},aJ.prototype.calculateAdjustments=function(e,t,n,i){var o=this._rules,r=[],s=[],c=[],l=[];function p(e){r.includes(e)||r.push(e);var t=e.label;t&&!r.includes(t)&&r.push(t)}(0,a.Ed)(e,function(e){if(!(!e.parent||(0,eL.j_)(e))){if((0,eL.Ho)(e)){l.push(e);return}var r=e[t],a=r+e[aV[t]];if(e.host&&(n>0&&(0,j.wS)(e)[t]>i||n<0&&(0,j.wS)(e)[t]<i)){c.push(e);return}if(n>0&&r>i||n<0&&a<i){p(e);return}if(r<i&&a>i&&o.allowed("shape.resize",{shape:e})){s.includes(e)||s.push(e);return}}}),(0,a.Ed)(r,function(e){var t=e.attachers;t&&(0,a.Ed)(t,function(e){p(e)})});var h=r.concat(s);return(0,a.Ed)(c,function(e){var t=e.host;aY(h,t)&&p(e)}),h=r.concat(s),(0,a.Ed)(l,function(e){var t=e.source,n=e.target,i=e.label;aY(h,t)&&aY(h,n)&&i&&p(i)}),{movingShapes:r,resizingShapes:s}},aJ.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateSelection(e,!!e)},aJ.prototype.isActive=function(){var e=this._dragging.context();return!!e&&/^spaceTool/.test(e.prefix)};var aQ="djs-dragging",a0="djs-resizing",a1=Math.max;function a2(e,t,n,i,o){function r(e,t){(0,a.Ed)(e,function(e){o.addDragger(e,t),n.addMarker(e,aQ)})}e.on("spaceTool.selection.start",function(e){var t=n.getLayer("space"),o=e.context,r=(0,c.Ue)("g");(0,c.Lj)(r,i.cls("djs-crosshair-group",["no-events"])),(0,c.R3)(t,r);var a=(0,c.Ue)("path");(0,c.Lj)(a,"d","M 0,-10000 L 0,10000"),(0,c.Sh)(a).add("djs-crosshair"),(0,c.R3)(r,a);var s=(0,c.Ue)("path");(0,c.Lj)(s,"d","M -10000,0 L 10000,0"),(0,c.Sh)(s).add("djs-crosshair"),(0,c.R3)(r,s),o.crosshairGroup=r}),e.on("spaceTool.selection.move",function(e){eo(e.context.crosshairGroup,e.x,e.y)}),e.on("spaceTool.selection.cleanup",function(e){var t=e.context.crosshairGroup;t&&(0,c.Od)(t)}),e.on("spaceTool.move",250,function(e){var s=e.context,l=s.line,p=s.axis,h=s.movingShapes,u=s.resizingShapes;if(s.initialized){if(!s.dragGroup){var d=n.getLayer("space");l=(0,c.Ue)("path"),(0,c.Lj)(l,"d","M0,0 L0,0"),(0,c.Sh)(l).add("djs-crosshair"),(0,c.R3)(d,l),s.line=l;var f=(0,c.Ue)("g");(0,c.Lj)(f,i.cls("djs-drag-group",["no-events"])),(0,c.R3)(n.getActiveLayer(),f),r(h,f),r(s.movingConnections=t.filter(function(e){var t=!1;(0,a.Ed)(h,function(n){(0,a.Ed)(n.outgoing,function(n){e===n&&(t=!0)})});var n=!1;(0,a.Ed)(h,function(t){(0,a.Ed)(t.incoming,function(t){e===t&&(n=!0)})});var i=!1;(0,a.Ed)(u,function(t){(0,a.Ed)(t.outgoing,function(t){e===t&&(i=!0)})});var o=!1;return(0,a.Ed)(u,function(t){(0,a.Ed)(t.incoming,function(t){e===t&&(o=!0)})}),(0,eL.Ho)(e)&&(t||i)&&(n||o)}),f),s.dragGroup=f}if(!s.frameGroup){var m=(0,c.Ue)("g");(0,c.Lj)(m,i.cls("djs-frame-group",["no-events"])),(0,c.R3)(n.getActiveLayer(),m);var g=[];(0,a.Ed)(u,function(e){var t=o.addFrame(e,m),i=t.getBBox();g.push({element:t,initialBounds:i}),n.addMarker(e,a0)}),s.frameGroup=m,s.frames=g}var v={x:"M"+e.x+", -10000 L"+e.x+", 10000",y:"M -10000, "+e.y+" L 10000, "+e.y};(0,c.Lj)(l,{d:v[p]});var y={x:e.dx,y:e.dy};y[({x:"y",y:"x"})[s.axis]]=0,eo(s.dragGroup,y.x,y.y),(0,a.Ed)(s.frames,function(e){var t,n,i=e.element,o=e.initialBounds;"e"===s.direction?(0,c.Lj)(i,{width:a1(o.width+y.x,5)}):(t=a1(o.width-y.x,5),(0,c.Lj)(i,{width:t,x:o.x+o.width-t})),"s"===s.direction?(0,c.Lj)(i,{height:a1(o.height+y.y,5)}):(n=a1(o.height-y.y,5),(0,c.Lj)(i,{height:n,y:o.y+o.height-n}))})}}),e.on("spaceTool.cleanup",function(e){var t=e.context,i=t.movingShapes,o=t.movingConnections,r=t.resizingShapes,s=t.line,l=t.dragGroup,p=t.frameGroup;(0,a.Ed)(i,function(e){n.removeMarker(e,aQ)}),(0,a.Ed)(o,function(e){n.removeMarker(e,aQ)}),l&&((0,c.Od)(s),(0,c.Od)(l)),(0,a.Ed)(r,function(e){n.removeMarker(e,a0)}),p&&(0,c.Od)(p)})}function a5(e,t){e.invoke(aJ,this),this._canvas=t}a2.$inject=["eventBus","elementRegistry","canvas","styles","previewSupport"],a5.$inject=["injector","canvas"],(0,o.Z)(a5,aJ),a5.prototype.calculateAdjustments=function(e,t,n,i){var o=this._canvas.getRootElement(),r=e[0]===o?null:e[0],s=[];r&&(s=(0,a.VO)(w(o.children.filter(e=>em(e,"bpmn:Artifact")),_(r))));let c=[...e,...s];var l=aJ.prototype.calculateAdjustments.call(this,c,t,n,i);return l.resizingShapes=l.resizingShapes.filter(function(e){return!(em(e,"bpmn:TextAnnotation")||em(e,"bpmn:Participant")&&!ev(e).processRef&&("y"===t&&eB(e)||"x"===t&&!eB(e)))}),l};var a3={__depends__:[{__init__:["spaceToolPreview"],__depends__:[n0,n5,aH,i0,aw],spaceTool:["type",aJ],spaceToolPreview:["type",a2]}],spaceTool:["type",a5]};function a6(e,t){this._handlerMap={},this._stack=[],this._stackIdx=-1,this._currentExecution={actions:[],dirty:[],trigger:null},this._injector=t,this._eventBus=e,this._uid=1,e.on(["diagram.destroy","diagram.clear"],function(){this.clear(!1)},this)}function a4(e,t){var n;if("function"!=typeof t)throw Error("removeFn iterator must be a function");if(e){for(;n=e[0];)t(n);return e}}function a9(e,t,n){ts.call(this,t);var i=e.get("movePreview",!1);t.on("shape.move.start",1400,function(e){var t=e.context,n=t.shapes,i=t.validatedShapes;t.shapes=a8(n),t.validatedShapes=a8(i)}),i&&t.on("shape.move.start",250,function(e){var t=e.context,n=t.shapes,o=[];(0,a.Ed)(n,function(e){(0,a.Ed)(e.labels,function(n){n.hidden||-1!==t.shapes.indexOf(n)||o.push(n),e.labelTarget&&o.push(e)})}),(0,a.Ed)(o,function(e){i.makeDraggable(t,e,!0)})}),this.preExecuted("elements.move",1400,function(e){var t=e.context.closure,n=t.enclosedElements,i=[];(0,a.Ed)(n,function(e){(0,a.Ed)(e.labels,function(e){n[e.id]||i.push(e)})}),t.addAll(i)}),this.preExecute(["connection.delete","shape.delete"],function(e){var t=e.context;a4((t.connection||t.shape).labels,function(e){n.removeShape(e,{nested:!0})})}),this.execute("shape.delete",function(e){var t=e.context,n=t.shape,i=n.labelTarget;i&&(t.labelTargetIndex=T(i.labels,n),t.labelTarget=i,n.labelTarget=null)}),this.revert("shape.delete",function(e){var t=e.context,n=t.shape,i=t.labelTarget,o=t.labelTargetIndex;i&&(P(i.labels,n,o),n.labelTarget=i)})}function a8(e){return(0,a.hX)(e,function(t){return -1===e.indexOf(t.labelTarget)})}a6.$inject=["eventBus","injector"],a6.prototype.execute=function(e,t){if(!e)throw Error("command required");this._currentExecution.trigger="execute";let n={command:e,context:t};this._pushAction(n),this._internalExecute(n),this._popAction()},a6.prototype.canExecute=function(e,t){let n=this._getHandler(e),i=this._fire(e,"canExecute",{command:e,context:t});if(void 0===i){if(!n)return!1;n.canExecute&&(i=n.canExecute(t))}return i},a6.prototype.clear=function(e){this._stack.length=0,this._stackIdx=-1,!1!==e&&this._fire("changed",{trigger:"clear"})},a6.prototype.undo=function(){let e=this._getUndoAction(),t;if(e){for(this._currentExecution.trigger="undo",this._pushAction(e);e&&(this._internalUndo(e),(t=this._getUndoAction())&&t.id===e.id);)e=t;this._popAction()}},a6.prototype.redo=function(){let e=this._getRedoAction(),t;if(e){for(this._currentExecution.trigger="redo",this._pushAction(e);e&&(this._internalExecute(e,!0),(t=this._getRedoAction())&&t.id===e.id);)e=t;this._popAction()}},a6.prototype.register=function(e,t){this._setHandler(e,t)},a6.prototype.registerHandler=function(e,t){if(!e||!t)throw Error("command and handlerCls must be defined");let n=this._injector.instantiate(t);this.register(e,n)},a6.prototype.canUndo=function(){return!!this._getUndoAction()},a6.prototype.canRedo=function(){return!!this._getRedoAction()},a6.prototype._getRedoAction=function(){return this._stack[this._stackIdx+1]},a6.prototype._getUndoAction=function(){return this._stack[this._stackIdx]},a6.prototype._internalUndo=function(e){let t=e.command,n=e.context,i=this._getHandler(t);this._atomicDo(()=>{this._fire(t,"revert",e),i.revert&&this._markDirty(i.revert(n)),this._revertedAction(e),this._fire(t,"reverted",e)})},a6.prototype._fire=function(e,t,n){let i;arguments.length<3&&(n=t,t=null);let o=t?[e+"."+t,t]:[e];for(let e of(n=this._eventBus.createEvent(n),o))if(i=this._eventBus.fire("commandStack."+e,n),n.cancelBubble)break;return i},a6.prototype._createId=function(){return this._uid++},a6.prototype._atomicDo=function(e){let t=this._currentExecution;t.atomic=!0;try{e()}finally{t.atomic=!1}},a6.prototype._internalExecute=function(e,t){let n=e.command,i=e.context,o=this._getHandler(n);if(!o)throw Error("no command handler registered for <"+n+">");this._pushAction(e),t||(this._fire(n,"preExecute",e),o.preExecute&&o.preExecute(i),this._fire(n,"preExecuted",e)),this._atomicDo(()=>{this._fire(n,"execute",e),o.execute&&this._markDirty(o.execute(i)),this._executedAction(e,t),this._fire(n,"executed",e)}),t||(this._fire(n,"postExecute",e),o.postExecute&&o.postExecute(i),this._fire(n,"postExecuted",e)),this._popAction()},a6.prototype._pushAction=function(e){let t=this._currentExecution,n=t.actions,i=n[0];if(t.atomic)throw Error("illegal invocation in <execute> or <revert> phase (action: "+e.command+")");e.id||(e.id=i&&i.id||this._createId()),n.push(e)},a6.prototype._popAction=function(){let e=this._currentExecution,t=e.trigger,n=e.actions,i=e.dirty;n.pop(),n.length||(this._eventBus.fire("elements.changed",{elements:(0,a.uw)("id",i.reverse())}),i.length=0,this._fire("changed",{trigger:t}),e.trigger=null)},a6.prototype._markDirty=function(e){let t=this._currentExecution;e&&(e=(0,a.kJ)(e)?e:[e],t.dirty=t.dirty.concat(e))},a6.prototype._executedAction=function(e,t){let n=++this._stackIdx;t||this._stack.splice(n,this._stack.length,e)},a6.prototype._revertedAction=function(e){this._stackIdx--},a6.prototype._getHandler=function(e){return this._handlerMap[e]},a6.prototype._setHandler=function(e,t){if(!e||!t)throw Error("command and handler required");if(this._handlerMap[e])throw Error("overriding handler for command <"+e+">");this._handlerMap[e]=t},(0,o.Z)(a9,ts),a9.$inject=["injector","eventBus","modeling"];var a7="attach-ok";function se(e,t,n,i,o){ts.call(this,t);var r=e.get("movePreview",!1);t.on("shape.move.start",1401,function(e){var t,n,i=e.context,o=i.shapes,r=i.validatedShapes;i.shapes=(t=st(o),(0,a.qZ)("id",o,t)),i.validatedShapes=(n=(0,a.vM)(r,"id"),(0,a.hX)(r,function(e){for(;e;){if(e.host&&n[e.host.id])return!1;e=e.parent}return!0}))}),r&&t.on("shape.move.start",251,function(e){var t=e.context,n=st(t.shapes);(0,a.Ed)(n,function(e){r.makeDraggable(t,e,!0),(0,a.Ed)(e.labels,function(e){r.makeDraggable(t,e,!0)})})}),r&&t.on("shape.move.start",function(e){var i=e.context.shapes;if(1===i.length){var o=i[0].host;o&&(n.addMarker(o,a7),t.once(["shape.move.out","shape.move.cleanup"],function(){n.removeMarker(o,a7)}))}}),this.preExecuted("elements.move",1401,function(e){var t=e.context,n=t.closure,i=st(t.shapes);(0,a.Ed)(i,function(e){n.add(e,n.topLevel[e.host.id])})}),this.postExecuted("elements.move",function(e){var t,n=e.context,i=n.shapes,r=n.newHost;r&&1!==i.length||(t=r?i:(0,a.hX)(i,function(e){var t=e.host;return!!e.host&&-1===i.indexOf(t)}),(0,a.Ed)(t,function(e){o.updateAttachment(e,r)}))}),this.postExecuted("elements.move",function(e){var t=e.context.shapes;(0,a.Ed)(t,function(e){(0,a.Ed)(e.attachers,function(e){(0,a.Ed)(e.outgoing.slice(),function(e){i.allowed("connection.reconnect",{connection:e,source:e.source,target:e.target})||o.removeConnection(e)}),(0,a.Ed)(e.incoming.slice(),function(e){i.allowed("connection.reconnect",{connection:e,source:e.source,target:e.target})||o.removeConnection(e)})})})}),this.postExecute("shape.create",function(e){var t=e.context,n=t.shape,i=t.host;i&&o.updateAttachment(n,i)}),this.postExecute("shape.replace",function(e){var t=e.context,n=t.oldShape,r=t.newShape;a4(n.attachers,function(e){"attach"===i.allowed("elements.move",{target:r,shapes:[e]})?o.updateAttachment(e,r):o.removeShape(e)}),r.attachers.length&&(0,a.Ed)(r.attachers,function(e){var t=oX(e,n,r);o.moveShape(e,t,e.parent)})}),this.postExecute("shape.resize",function(e){var t=e.context,n=t.shape,i=t.oldBounds,r=t.newBounds,s=n.attachers;!1!==(t.hints||{}).attachSupport&&(0,a.Ed)(s,function(e){var t=oX(e,i,r);o.moveShape(e,t,e.parent),(0,a.Ed)(e.labels,function(e){o.moveShape(e,t,e.parent)})})}),this.preExecute("shape.delete",function(e){var t=e.context.shape;a4(t.attachers,function(e){o.removeShape(e)}),t.host&&o.updateAttachment(t,null)})}function st(e){return(0,a.xH)((0,a.UI)(e,function(e){return e.attachers||[]}))}function sn(e){this._model=e}function si(e,t,n){ts.call(this,e),this._bpmnFactory=t;var i=this;function o(e){var t=e.context.oldRoot.children;(0,a.Ed)(t,function(e){em(e,"bpmn:BaseElement")&&i.updateParent(e)})}function r(e){var t=e.context.shape;em(t,"bpmn:BaseElement")&&i.updateBounds(t)}function s(e){i.updateConnection(e.context)}function c(e){i.updateConnectionWaypoints(e.context.connection)}function l(e){i.updateAttachment(e.context)}function p(e){let{element:n}=e.context,i=eH(n),o=ey(n),r=o&&o.get("label");eN(n)||td(n)||(i&&!r?o.set("label",t.create("bpmndi:BPMNLabel")):!i&&r&&o.set("label",void 0))}this.executed(["connection.layout","connection.create"],function(e){var t,i=e.context,o=i.hints||{};i.cropped||!1===o.createElementsBehavior||((t=i.connection).waypoints=n.getCroppedWaypoints(t),i.cropped=!0)}),this.reverted(["connection.layout"],function(e){delete e.context.cropped}),this.executed(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],so(function(e){var t=e.context;i.updateParent(t.shape||t.connection,t.oldParent)})),this.reverted(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],so(function(e){var t=e.context,n=t.shape||t.connection,o=t.parent||t.newParent;i.updateParent(n,o)})),this.executed(["canvas.updateRoot"],o),this.reverted(["canvas.updateRoot"],o),this.executed(["shape.move","shape.create","shape.resize"],so(function(e){"label"!==e.context.shape.type&&r(e)})),this.reverted(["shape.move","shape.create","shape.resize"],so(function(e){"label"!==e.context.shape.type&&r(e)})),e.on("shape.changed",function(e){"label"===e.element.type&&r({context:{shape:e.element}})}),this.executed(["connection.create","connection.move","connection.delete","connection.reconnect"],so(s)),this.reverted(["connection.create","connection.move","connection.delete","connection.reconnect"],so(s)),this.executed(["connection.layout","connection.move","connection.updateWaypoints"],so(c)),this.reverted(["connection.layout","connection.move","connection.updateWaypoints"],so(c)),this.executed("connection.reconnect",so(function(e){var t=e.context,n=t.connection,i=t.oldSource,o=t.newSource,r=ev(n),a=ev(i),s=ev(o);r.conditionExpression&&!eg(s,["bpmn:Activity","bpmn:ExclusiveGateway","bpmn:InclusiveGateway"])&&(t.oldConditionExpression=r.conditionExpression,delete r.conditionExpression),i!==o&&a.default===r&&(t.oldDefault=a.default,delete a.default)})),this.reverted("connection.reconnect",so(function(e){var t=e.context,n=t.connection,i=t.oldSource,o=t.newSource,r=ev(n),a=ev(i),s=ev(o);t.oldConditionExpression&&(r.conditionExpression=t.oldConditionExpression),t.oldDefault&&(a.default=t.oldDefault,delete s.default)})),this.executed(["element.updateAttachment"],so(l)),this.reverted(["element.updateAttachment"],so(l)),this.executed("element.updateLabel",so(p)),this.reverted("element.updateLabel",so(p))}function so(e){return function(t){var n=t.context;em(n.shape||n.connection||n.element,"bpmn:BaseElement")&&e(t)}}function sr(e,t){X.call(this),this._bpmnFactory=e,this._moddle=t}function sa(e,t,n){return void 0===t[n]?t:(e[n]=t[n],(0,a.CE)(t,[n]))}function ss(e,t){this._modeling=e,this._canvas=t}function sc(e){this._modeling=e}function sl(e,t){this._canvas=e,this._layouter=t}(0,o.Z)(se,ts),se.$inject=["injector","eventBus","canvas","rules","modeling"],sn.$inject=["moddle"],sn.prototype._needsId=function(e){return eg(e,["bpmn:RootElement","bpmn:FlowElement","bpmn:MessageFlow","bpmn:DataAssociation","bpmn:Artifact","bpmn:Participant","bpmn:Lane","bpmn:LaneSet","bpmn:Process","bpmn:Collaboration","bpmndi:BPMNShape","bpmndi:BPMNEdge","bpmndi:BPMNDiagram","bpmndi:BPMNPlane","bpmn:Property","bpmn:CategoryValue"])},sn.prototype._ensureId=function(e){var t;if(e.id){this._model.ids.claim(e.id,e);return}t=(em(e,"bpmn:Activity")?"Activity":em(e,"bpmn:Event")?"Event":em(e,"bpmn:Gateway")?"Gateway":eg(e,["bpmn:SequenceFlow","bpmn:MessageFlow"])?"Flow":(e.$type||"").replace(/^[^:]*:/g,""))+"_",!e.id&&this._needsId(e)&&(e.id=this._model.ids.nextPrefixed(t,e))},sn.prototype.create=function(e,t){var n=this._model.create(e,t||{});return this._ensureId(n),n},sn.prototype.createDiLabel=function(){return this.create("bpmndi:BPMNLabel",{bounds:this.createDiBounds()})},sn.prototype.createDiShape=function(e,t){return this.create("bpmndi:BPMNShape",(0,a.f0)({bpmnElement:e,bounds:this.createDiBounds()},t))},sn.prototype.createDiBounds=function(e){return this.create("dc:Bounds",e)},sn.prototype.createDiWaypoints=function(e){var t=this;return(0,a.UI)(e,function(e){return t.createDiWaypoint(e)})},sn.prototype.createDiWaypoint=function(e){return this.create("dc:Point",(0,a.ei)(e,["x","y"]))},sn.prototype.createDiEdge=function(e,t){return this.create("bpmndi:BPMNEdge",(0,a.f0)({bpmnElement:e,waypoint:this.createDiWaypoints([])},t))},sn.prototype.createDiPlane=function(e,t){return this.create("bpmndi:BPMNPlane",(0,a.f0)({bpmnElement:e},t))},(0,o.Z)(si,ts),si.$inject=["eventBus","bpmnFactory","connectionDocking"],si.prototype.updateAttachment=function(e){var t=e.shape,n=t.businessObject,i=t.host;n.attachedToRef=i&&i.businessObject},si.prototype.updateParent=function(e,t){if(!((0,eL.j_)(e)||em(e,"bpmn:DataStoreReference")&&e.parent&&em(e.parent,"bpmn:Collaboration"))){var n=e.parent,i=e.businessObject,o=ey(e),r=n&&n.businessObject,a=ey(n);em(e,"bpmn:FlowNode")&&this.updateFlowNodeRefs(i,r,t&&t.businessObject),em(e,"bpmn:DataOutputAssociation")&&(r=e.source?e.source.businessObject:null),em(e,"bpmn:DataInputAssociation")&&(r=e.target?e.target.businessObject:null),this.updateSemanticParent(i,r),em(e,"bpmn:DataObjectReference")&&i.dataObjectRef&&this.updateSemanticParent(i.dataObjectRef,r),this.updateDiParent(o,a)}},si.prototype.updateBounds=function(e){var t=ey(e),n=function(e){if(em(e,"bpmn:Activity")){var t=ey(e);if(t){var n=t.get("label");if(n)return n.get("bounds")}}}(e);if(n){var i=t0(n,t.get("bounds"));(0,a.f0)(n,{x:e.x+i.x,y:e.y+i.y})}var o=(0,eL.j_)(e)?this._getLabel(t):t,r=o.bounds;r||(r=this._bpmnFactory.createDiBounds(),o.set("bounds",r)),(0,a.f0)(r,{x:e.x,y:e.y,width:e.width,height:e.height})},si.prototype.updateFlowNodeRefs=function(e,t,n){n!==t&&(em(n,"bpmn:Lane")&&R(n.get("flowNodeRef"),e),em(t,"bpmn:Lane")&&P(t.get("flowNodeRef"),e))},si.prototype.updateDiConnection=function(e,t,n){var i=ey(e),o=ey(t),r=ey(n);i.sourceElement&&i.sourceElement.bpmnElement!==ev(t)&&(i.sourceElement=t&&o),i.targetElement&&i.targetElement.bpmnElement!==ev(n)&&(i.targetElement=n&&r)},si.prototype.updateDiParent=function(e,t){if(t&&!em(t,"bpmndi:BPMNPlane")&&(t=t.$parent),e.$parent!==t){var n=(t||e.$parent).get("planeElement");t?(n.push(e),e.$parent=t):(R(n,e),e.$parent=null)}},si.prototype.getLaneSet=function(e){var t,n;return em(e,"bpmn:Lane")?(t=e.childLaneSet)||(t=this._bpmnFactory.create("bpmn:LaneSet"),e.childLaneSet=t,t.$parent=e):(em(e,"bpmn:Participant")&&(e=e.processRef),(t=(n=e.get("laneSets"))[0])||((t=this._bpmnFactory.create("bpmn:LaneSet")).$parent=e,n.push(t))),t},si.prototype.updateSemanticParent=function(e,t,n){if(!(e.$parent===t||(em(e,"bpmn:DataInput")||em(e,"bpmn:DataOutput"))&&(em(t,"bpmn:Participant")&&"processRef"in t&&(t=t.processRef),"ioSpecification"in t&&t.ioSpecification===e.$parent))){if(em(e,"bpmn:Lane"))t&&(t=this.getLaneSet(t)),o="lanes";else if(em(e,"bpmn:FlowElement")){if(t){if(em(t,"bpmn:Participant"))t=t.processRef;else if(em(t,"bpmn:Lane"))do t=t.$parent.$parent;while(em(t,"bpmn:Lane"))}o="flowElements"}else if(em(e,"bpmn:Artifact")){for(;t&&!em(t,"bpmn:Process")&&!em(t,"bpmn:SubProcess")&&!em(t,"bpmn:Collaboration");){if(em(t,"bpmn:Participant")){t=t.processRef;break}t=t.$parent}o="artifacts"}else if(em(e,"bpmn:MessageFlow"))o="messageFlows";else if(em(e,"bpmn:Participant")){o="participants";var i,o,r,a=e.processRef;a&&(r=function(e){for(;e&&!em(e,"bpmn:Definitions");)e=e.$parent;return e}(e.$parent||t),e.$parent&&(R(r.get("rootElements"),a),a.$parent=null),t&&(P(r.get("rootElements"),a),a.$parent=r))}else em(e,"bpmn:DataOutputAssociation")?o="dataOutputAssociations":em(e,"bpmn:DataInputAssociation")&&(o="dataInputAssociations");if(!o)throw Error(`no parent for <${e.id}> in <${t.id}>`);if(e.$parent&&R(i=e.$parent.get(o),e),t?((i=t.get(o)).push(e),e.$parent=t):e.$parent=null,n){var s=n.get(o);R(i,e),t&&(s||(s=[],t.set(o,s)),s.push(e))}}},si.prototype.updateConnectionWaypoints=function(e){ey(e).set("waypoint",this._bpmnFactory.createDiWaypoints(e.waypoints))},si.prototype.updateConnection=function(e){var t,n=e.connection,i=ev(n),o=n.source,r=ev(o),a=n.target,s=ev(n.target);if(em(i,"bpmn:DataAssociation"))em(i,"bpmn:DataInputAssociation")?(i.get("sourceRef")[0]=r,t=e.parent||e.newParent||s,this.updateSemanticParent(i,s,t)):em(i,"bpmn:DataOutputAssociation")&&(t=e.parent||e.newParent||r,this.updateSemanticParent(i,r,t),i.targetRef=s);else{var c=em(i,"bpmn:SequenceFlow");i.sourceRef!==r&&(c&&(R(i.sourceRef&&i.sourceRef.get("outgoing"),i),r&&r.get("outgoing")&&r.get("outgoing").push(i)),i.sourceRef=r),i.targetRef!==s&&(c&&(R(i.targetRef&&i.targetRef.get("incoming"),i),s&&s.get("incoming")&&s.get("incoming").push(i)),i.targetRef=s)}this.updateConnectionWaypoints(n),this.updateDiConnection(n,o,a)},si.prototype._getLabel=function(e){return e.label||(e.label=this._bpmnFactory.createDiLabel()),e.label},(0,o.Z)(sr,X),sr.$inject=["bpmnFactory","moddle"],sr.prototype._baseCreate=X.prototype.create,sr.prototype.create=function(e,t){if("label"===e){var n=t.di||this._bpmnFactory.createDiLabel();return this._baseCreate(e,(0,a.f0)({type:"label",di:n},eO,t))}return this.createElement(e,t)},sr.prototype.createElement=function(e,t){var n,i,o,r,s,c,l=(t=(0,a.f0)({},t||{})).businessObject,p=t.di;if(!l){if(!t.type)throw Error("no shape type specified");eu(l=this._bpmnFactory.create(t.type))}if(!eg(p,["bpmndi:BPMNShape","bpmndi:BPMNEdge","bpmndi:BPMNDiagram","bpmndi:BPMNPlane"])){var h=(0,a.f0)({},p||{},{id:l.id+"_di"});p="root"===e?this._bpmnFactory.createDiPlane(l,h):"connection"===e?this._bpmnFactory.createDiEdge(l,h):this._bpmnFactory.createDiShape(l,h)}return em(l,"bpmn:Group")&&(t=(0,a.f0)({isFrame:!0},t)),(n=l,i=t,o=["processRef","isInterrupting","associationDirection","isForCompensation"],(0,a.Ed)(o,function(e){i=sa(n,i,e)}),t=i).isExpanded&&(t=sa(p,t,"isExpanded")),eg(l,["bpmn:Lane","bpmn:Participant"])&&(t=sa(p,t,"isHorizontal")),em(l,"bpmn:SubProcess")&&(t.collapsed=!eD(l,p)),em(l,"bpmn:ExclusiveGateway")&&((0,a.e$)(p,"isMarkerVisible")?void 0===p.isMarkerVisible&&(p.isMarkerVisible=!1):p.isMarkerVisible=!0),(0,a.$K)(t.triggeredByEvent)&&(l.triggeredByEvent=t.triggeredByEvent,delete t.triggeredByEvent),(0,a.$K)(t.cancelActivity)&&(l.cancelActivity=t.cancelActivity,delete t.cancelActivity),t.eventDefinitionType&&(s=l.get("eventDefinitions")||[],c=this._bpmnFactory.create(t.eventDefinitionType,t.eventDefinitionAttrs),"bpmn:ConditionalEventDefinition"===t.eventDefinitionType&&(c.condition=this._bpmnFactory.create("bpmn:FormalExpression")),s.push(c),c.$parent=l,l.eventDefinitions=s,delete t.eventDefinitionType),r=this.getDefaultSize(l,p),t=(0,a.f0)({id:l.id},r,t,{businessObject:l,di:p}),this._baseCreate(e,t)},sr.prototype.getDefaultSize=function(e,t){var n=ev(e);if(t=t||ey(e),em(n,"bpmn:SubProcess"))return eD(n,t)?{width:350,height:200}:{width:100,height:80};if(em(n,"bpmn:Task"))return{width:100,height:80};if(em(n,"bpmn:Gateway"))return{width:50,height:50};if(em(n,"bpmn:Event"))return{width:36,height:36};if(em(n,"bpmn:Participant")){var i=void 0===t.isHorizontal||!0===t.isHorizontal;return eD(n,t)?i?{width:600,height:250}:{width:250,height:600}:i?{width:400,height:60}:{width:60,height:400}}return em(n,"bpmn:Lane")?{width:400,height:100}:em(n,"bpmn:DataObjectReference")?{width:36,height:50}:em(n,"bpmn:DataStoreReference")?{width:50,height:50}:em(n,"bpmn:TextAnnotation")?{width:100,height:30}:em(n,"bpmn:Group")?{width:300,height:300}:{width:100,height:80}},sr.prototype.createParticipantShape=function(e){return(0,a.Kn)(e)||(e={isExpanded:e}),!1!==(e=(0,a.f0)({type:"bpmn:Participant"},e||{})).isExpanded&&(e.processRef=this._bpmnFactory.create("bpmn:Process")),this.createShape(e)},ss.$inject=["modeling","canvas"],ss.prototype.preExecute=function(e){var t=this._modeling,n=e.elements,i=e.alignment;(0,a.Ed)(n,function(e){var n={x:0,y:0};(0,a.$K)(i.left)?n.x=i.left-e.x:(0,a.$K)(i.right)?n.x=i.right-e.width-e.x:(0,a.$K)(i.center)?n.x=i.center-Math.round(e.width/2)-e.x:(0,a.$K)(i.top)?n.y=i.top-e.y:(0,a.$K)(i.bottom)?n.y=i.bottom-e.height-e.y:(0,a.$K)(i.middle)&&(n.y=i.middle-Math.round(e.height/2)-e.y),t.moveElements([e],n,e.parent)})},ss.prototype.postExecute=function(e){},sc.$inject=["modeling"],sc.prototype.preExecute=function(e){var t=e.source;if(!t)throw Error("source required");var n=e.target||t.parent,i=e.shape,o=e.hints||{};i=e.shape=this._modeling.createShape(i,e.position,n,{attach:o.attach}),e.shape=i},sc.prototype.postExecute=function(e){var t,n,i=e.hints||{};t=e.source,n=e.shape,(0,a.G)(t.outgoing,function(e){return e.target===n})||(i.connectionTarget===e.source?this._modeling.connect(e.shape,e.source,e.connection):this._modeling.connect(e.source,e.shape,e.connection))},sl.$inject=["canvas","layouter"],sl.prototype.execute=function(e){var t=e.connection,n=e.source,i=e.target,o=e.parent,r=e.parentIndex,a=e.hints;if(!n||!i)throw Error("source and target required");if(!o)throw Error("parent required");return t.source=n,t.target=i,t.waypoints||(t.waypoints=this._layouter.layoutConnection(t,a)),this._canvas.addConnection(t,o,r),t},sl.prototype.revert=function(e){var t=e.connection;return this._canvas.removeConnection(t),t.source=null,t.target=null,t};var sp=Math.round;function sh(e){this._modeling=e}sh.$inject=["modeling"],sh.prototype.preExecute=function(e){var t=e.elements,n=e.parent,i=e.parentIndex,o=e.position,r=e.hints,s=this._modeling;(0,a.Ed)(t,function(e){(0,a.hj)(e.x)||(e.x=0),(0,a.hj)(e.y)||(e.y=0)});var c=_((0,a.hX)(t,function(e){return!e.hidden}));(0,a.Ed)(t,function(e){(0,eL.Ho)(e)&&(e.waypoints=(0,a.UI)(e.waypoints,function(e){return{x:sp(e.x-c.x-c.width/2+o.x),y:sp(e.y-c.y-c.height/2+o.y)}})),(0,a.f0)(e,{x:sp(e.x-c.x-c.width/2+o.x),y:sp(e.y-c.y-c.height/2+o.y)})});var l=v(t),p={};(0,a.Ed)(t,function(e){if((0,eL.Ho)(e)){p[e.id]=(0,a.hj)(i)?s.createConnection(p[e.source.id],p[e.target.id],i,e,e.parent||n,r):s.createConnection(p[e.source.id],p[e.target.id],e,e.parent||n,r);return}var t=(0,a.f0)({},r);-1===l.indexOf(e)&&(t.autoResize=!1),(0,eL.j_)(e)&&(t=(0,a.CE)(t,["attach"])),p[e.id]=(0,a.hj)(i)?s.createShape(e,(0,a.ei)(e,["x","y","width","height"]),e.parent||n,i,t):s.createShape(e,(0,a.ei)(e,["x","y","width","height"]),e.parent||n,t)}),e.elements=(0,a.VO)(p)};var su=Math.round;function sd(e){this._canvas=e}function sf(e){sd.call(this,e)}sd.$inject=["canvas"],sd.prototype.execute=function(e){var t=e.shape,n=e.position,i=e.parent,o=e.parentIndex;if(!i)throw Error("parent required");if(!n)throw Error("position required");return void 0!==n.width?(0,a.f0)(t,n):(0,a.f0)(t,{x:n.x-su(t.width/2),y:n.y-su(t.height/2)}),this._canvas.addShape(t,i,o),t},sd.prototype.revert=function(e){var t=e.shape;return this._canvas.removeShape(t),t},(0,o.Z)(sf,sd),sf.$inject=["canvas"];var sm=sd.prototype.execute;sf.prototype.execute=function(e){var t=e.shape;return["width","height"].forEach(function(e){void 0===t[e]&&(t[e]=0)}),t.labelTarget=e.labelTarget,sm.call(this,e)};var sg=sd.prototype.revert;function sv(e,t){this._canvas=e,this._modeling=t}function sy(e,t){this._modeling=e,this._elementRegistry=t}function sb(e,t){this._canvas=e,this._modeling=t}function sx(e){this._modeling=e}sf.prototype.revert=function(e){return e.shape.labelTarget=null,sg.call(this,e)},sv.$inject=["canvas","modeling"],sv.prototype.preExecute=function(e){var t=this._modeling,n=e.connection;a4(n.incoming,function(e){t.removeConnection(e,{nested:!0})}),a4(n.outgoing,function(e){t.removeConnection(e,{nested:!0})})},sv.prototype.execute=function(e){var t=e.connection,n=t.parent;return e.parent=n,e.parentIndex=T(n.children,t),e.source=t.source,e.target=t.target,this._canvas.removeConnection(t),t.source=null,t.target=null,t},sv.prototype.revert=function(e){var t=e.connection,n=e.parent,i=e.parentIndex;return t.source=e.source,t.target=e.target,P(n.children,t,i),this._canvas.addConnection(t,n),t},sy.$inject=["modeling","elementRegistry"],sy.prototype.postExecute=function(e){var t=this._modeling,n=this._elementRegistry,i=e.elements;(0,a.Ed)(i,function(e){n.get(e.id)&&(e.waypoints?t.removeConnection(e):t.removeShape(e))})},sb.$inject=["canvas","modeling"],sb.prototype.preExecute=function(e){var t=this._modeling,n=e.shape;a4(n.incoming,function(e){t.removeConnection(e,{nested:!0})}),a4(n.outgoing,function(e){t.removeConnection(e,{nested:!0})}),a4(n.children,function(e){(0,eL.Ho)(e)?t.removeConnection(e,{nested:!0}):t.removeShape(e,{nested:!0})})},sb.prototype.execute=function(e){var t=this._canvas,n=e.shape,i=n.parent;return e.oldParent=i,e.oldParentIndex=T(i.children,n),t.removeShape(n),n},sb.prototype.revert=function(e){var t=this._canvas,n=e.shape,i=e.oldParent,o=e.oldParentIndex;return P(i.children,n,o),t.addShape(n,i),n},sx.$inject=["modeling"];var s_={x:"y",y:"x"};function sw(e,t){this._layouter=e,this._canvas=t}function sE(){}function sS(){this.allShapes={},this.allConnections={},this.enclosedElements={},this.enclosedConnections={},this.topLevel={}}function sk(e){this._modeling=e}function sC(e){this._helper=new sk(e)}function sR(e){this._modeling=e,this._helper=new sk(e)}function sP(e){this._modeling=e}function sT(e){return e.original||e}function sj(e,t){this._modeling=e,this._rules=t}function sD(e){this._modeling=e}function sB(e){this._modeling=e}function sM(e){return(0,a.f0)({},e)}function sA(e){switch(e){case"n":case"s":return"y";case"w":case"e":return"x"}}function sL(e,t,n){var i=sA(n);return/e|s/.test(n)?e[i]>t:/n|w/.test(n)?e[i]<t:void 0}function sO(e,t){return -1!==e.indexOf(t)}function sN(e){this._modeling=e}function s$(e){this._modeling=e}function sI(e,t){return R(e&&e.attachers,t)}function sz(e,t,n){if(e){var i=e.attachers;i||(e.attachers=i=[]),P(i,t,n)}}function sH(){}function sF(e,t,n){this._eventBus=e,this._elementFactory=t,this._commandStack=n;var i=this;e.on("diagram.init",function(){i.registerHandlers(n)})}function sG(e){this._elementRegistry=e}function sW(e,t){(0,a.Ed)(t,function(t,n){e.set(n,t)})}sx.prototype.preExecute=function(e){var t=this._modeling,n=e.groups,i=e.axis,o=e.dimension;function r(e,t){e.range.min=Math.min(t[i],e.range.min),e.range.max=Math.max(t[i]+t[o],e.range.max)}function s(e){return e[i]+e[o]/2}var c,l=n[0],p=n.length-1,h=n[p],u=0;(0,a.Ed)(n,function(e,c){var l,h,d,f,m;if(e.elements.length<2){c&&c!==n.length-1&&(r(e,e.elements[0]),u+=(f=e.range).max-f.min);return}h=(l=(0,a.MR)(e.elements,i))[0],c===p&&(h=l[l.length-1]),d=s(h),e.range=null,(0,a.Ed)(l,function(n){var a;if((a={y:0})[i]=d-s(n),a[i]&&(a[s_[i]]=0,t.moveElements([n],a,n.parent)),null===e.range){e.range={min:n[i],max:n[i]+n[o]};return}r(e,n)}),c&&c!==n.length-1&&(u+=(m=e.range).max-m.min)}),(c=Math.round((Math.abs(h.range.min-l.range.max)-u)/(n.length-1)))<n.length-1||(0,a.Ed)(n,function(e,r){var s,p={};e!==l&&e!==h&&(s=n[r-1],e.range.max=0,(0,a.Ed)(e.elements,function(n,r){p[s_[i]]=0,p[i]=s.range.max-n[i]+c,e.range.min!==n[i]&&(p[i]+=n[i]-e.range.min),p[i]&&t.moveElements([n],p,n.parent),e.range.max=Math.max(n[i]+n[o],r?e.range.max:0)}))})},sx.prototype.postExecute=function(e){},sw.$inject=["layouter","canvas"],sw.prototype.execute=function(e){var t=e.connection,n=t.waypoints;return(0,a.f0)(e,{oldWaypoints:n}),t.waypoints=this._layouter.layoutConnection(t,e.hints),t},sw.prototype.revert=function(e){var t=e.connection;return t.waypoints=e.oldWaypoints,t},sE.prototype.execute=function(e){var t=e.connection,n=e.delta,i=e.newParent||t.parent,o=e.newParentIndex,r=t.parent;return e.oldParent=r,e.oldParentIndex=R(r.children,t),P(i.children,t,o),t.parent=i,(0,a.Ed)(t.waypoints,function(e){e.x+=n.x,e.y+=n.y,e.original&&(e.original.x+=n.x,e.original.y+=n.y)}),t},sE.prototype.revert=function(e){var t=e.connection,n=t.parent,i=e.oldParent,o=e.oldParentIndex,r=e.delta;return R(n.children,t),P(i.children,t,o),t.parent=i,(0,a.Ed)(t.waypoints,function(e){e.x-=r.x,e.y-=r.y,e.original&&(e.original.x-=r.x,e.original.y-=r.y)}),t},sS.prototype.add=function(e,t){return this.addAll([e],t)},sS.prototype.addAll=function(e,t){var n=function(e,t,n){(0,a.o8)(t)&&(t=!0),(0,a.Kn)(t)&&(n=t,t=!0);var i=k((n=n||{}).allShapes),o=k(n.allConnections),r=k(n.enclosedElements),s=k(n.enclosedConnections),c=k(n.topLevel,t&&(0,a.vM)(e,function(e){return e.id}));function l(e){c[e.source.id]&&c[e.target.id]&&(c[e.id]=[e]),i[e.source.id]&&i[e.target.id]&&(s[e.id]=r[e.id]=e),o[e.id]=e}return b(e,function(e){if(r[e.id]=e,!e.waypoints)return i[e.id]=e,(0,a.Ed)(e.incoming,l),(0,a.Ed)(e.outgoing,l),e.children;s[e.id]=o[e.id]=e}),{allShapes:i,allConnections:o,topLevel:c,enclosedConnections:s,enclosedElements:r}}(e,!!t,this);return(0,a.f0)(this,n),this},sk.prototype.moveRecursive=function(e,t,n){return e?this.moveClosure(this.getClosure(e),t,n):[]},sk.prototype.moveClosure=function(e,t,n,i,o){var r=this._modeling,s=e.allShapes,c=e.allConnections,l=e.enclosedConnections,p=e.topLevel,h=!1;o&&o.parent===n&&(h=!0),(0,a.Ed)(s,function(e){r.moveShape(e,t,p[e.id]&&!h&&n,{recurse:!1,layout:!1})}),(0,a.Ed)(c,function(e){var i=!!s[e.source.id],o=!!s[e.target.id];l[e.id]&&i&&o?r.moveConnection(e,t,p[e.id]&&!h&&n):r.layoutConnection(e,{connectionStart:i&&o3(e,e.source,t),connectionEnd:o&&o6(e,e.target,t)})})},sk.prototype.getClosure=function(e){return new sS().addAll(e,!0)},sC.$inject=["modeling"],sC.prototype.preExecute=function(e){e.closure=this._helper.getClosure(e.shapes)},sC.prototype.postExecute=function(e){var t,n=e.hints;n&&n.primaryShape&&(t=n.primaryShape,n.oldParent=t.parent),this._helper.moveClosure(e.closure,e.delta,e.newParent,e.newHost,t)},sR.$inject=["modeling"],sR.prototype.execute=function(e){var t=e.shape,n=e.delta,i=e.newParent||t.parent,o=e.newParentIndex,r=t.parent;return e.oldBounds=(0,a.ei)(t,["x","y","width","height"]),e.oldParent=r,e.oldParentIndex=R(r.children,t),P(i.children,t,o),(0,a.f0)(t,{parent:i,x:t.x+n.x,y:t.y+n.y}),t},sR.prototype.postExecute=function(e){var t=e.shape,n=e.delta,i=e.hints,o=this._modeling;!1!==i.layout&&((0,a.Ed)(t.incoming,function(e){o.layoutConnection(e,{connectionEnd:o6(e,t,n)})}),(0,a.Ed)(t.outgoing,function(e){o.layoutConnection(e,{connectionStart:o3(e,t,n)})})),!1!==i.recurse&&this.moveChildren(e)},sR.prototype.revert=function(e){var t=e.shape,n=e.oldParent,i=e.oldParentIndex,o=e.delta;return P(n.children,t,i),(0,a.f0)(t,{parent:n,x:t.x-o.x,y:t.y-o.y}),t},sR.prototype.moveChildren=function(e){var t=e.delta,n=e.shape;this._helper.moveRecursive(n.children,t,null)},sR.prototype.getNewParent=function(e){return e.newParent||e.shape.parent},sP.$inject=["modeling"],sP.prototype.execute=function(e){var t=e.newSource,n=e.newTarget,i=e.connection,o=e.dockingOrPoints;if(!t&&!n)throw Error("newSource or newTarget required");return(0,a.kJ)(o)&&(e.oldWaypoints=i.waypoints,i.waypoints=o),t&&(e.oldSource=i.source,i.source=t),n&&(e.oldTarget=i.target,i.target=n),i},sP.prototype.postExecute=function(e){var t=e.connection,n=e.newSource,i=e.newTarget,o=e.dockingOrPoints,r=e.hints||{},s={};r.connectionStart&&(s.connectionStart=r.connectionStart),r.connectionEnd&&(s.connectionEnd=r.connectionEnd),!1!==r.layoutConnection&&(n&&(!i||"source"===r.docking)&&(s.connectionStart=s.connectionStart||sT((0,a.kJ)(o)?o[0]:o)),i&&(!n||"target"===r.docking)&&(s.connectionEnd=s.connectionEnd||sT((0,a.kJ)(o)?o[o.length-1]:o)),r.newWaypoints&&(s.waypoints=r.newWaypoints),this._modeling.layoutConnection(t,s))},sP.prototype.revert=function(e){var t=e.oldSource,n=e.oldTarget,i=e.oldWaypoints,o=e.connection;return t&&(o.source=t),n&&(o.target=n),i&&(o.waypoints=i),o},sj.$inject=["modeling","rules"],sj.prototype.preExecute=function(e){var t,n,i=this,o=this._modeling,r=this._rules,s=e.oldShape,c=e.newData,l=e.hints||{};function p(e,t,n){return r.allowed("connection.reconnect",{connection:n,source:e,target:t})}var h={x:c.x,y:c.y},u={x:s.x,y:s.y,width:s.width,height:s.height};n=e.newShape=e.newShape||i.createShape(c,h,s.parent,l),s.host&&o.updateAttachment(n,s.host),!1!==l.moveChildren&&(t=s.children.slice(),o.moveElements(t,{x:0,y:0},n,l));var d=s.incoming.slice(),f=s.outgoing.slice();(0,a.Ed)(d,function(e){p(e.source,n,e)&&i.reconnectEnd(e,n,o5(e,n,u),l)}),(0,a.Ed)(f,function(e){p(n,e.target,e)&&i.reconnectStart(e,n,o2(e,n,u),l)})},sj.prototype.postExecute=function(e){var t=e.oldShape;this._modeling.removeShape(t)},sj.prototype.execute=function(e){},sj.prototype.revert=function(e){},sj.prototype.createShape=function(e,t,n,i){return this._modeling.createShape(e,t,n,i)},sj.prototype.reconnectStart=function(e,t,n,i){this._modeling.reconnectStart(e,t,n,i)},sj.prototype.reconnectEnd=function(e,t,n,i){this._modeling.reconnectEnd(e,t,n,i)},sD.$inject=["modeling"],sD.prototype.execute=function(e){var t=e.shape,n=e.newBounds,i=e.minBounds;if(void 0===n.x||void 0===n.y||void 0===n.width||void 0===n.height)throw Error("newBounds must have {x, y, width, height} properties");if(i&&(n.width<i.width||n.height<i.height))throw Error("width and height cannot be less than minimum height and width");if(!i&&n.width<10||n.height<10)throw Error("width and height cannot be less than 10px");return e.oldBounds={width:t.width,height:t.height,x:t.x,y:t.y},(0,a.f0)(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t},sD.prototype.postExecute=function(e){var t=this._modeling,n=e.shape,i=e.oldBounds;!1!==(e.hints||{}).layout&&((0,a.Ed)(n.incoming,function(e){t.layoutConnection(e,{connectionEnd:o5(e,n,i)})}),(0,a.Ed)(n.outgoing,function(e){t.layoutConnection(e,{connectionStart:o2(e,n,i)})}))},sD.prototype.revert=function(e){var t=e.shape,n=e.oldBounds;return(0,a.f0)(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t},sB.$inject=["modeling"],sB.prototype.preExecute=function(e){var t,n=e.delta,i=e.direction,o=e.movingShapes,r=e.resizingShapes,s=e.start,c={};this.moveShapes(o,n),(0,a.Ed)(r,function(e){c[e.id]={x:e.x,y:e.y,height:e.height,width:e.width}}),this.resizeShapes(r,n,i),this.updateConnectionWaypoints((t=[],(0,a.Ed)(o.concat(r),function(e){var n=e.incoming,i=e.outgoing;(0,a.Ed)(n.concat(i),function(e){var n=e.source,i=e.target;(aF(o,n)||aF(o,i)||aF(r,n)||aF(r,i))&&!aF(t,e)&&t.push(e)})}),t),n,i,s,o,r,c)},sB.prototype.execute=function(){},sB.prototype.revert=function(){},sB.prototype.moveShapes=function(e,t){var n=this;(0,a.Ed)(e,function(e){n._modeling.moveShape(e,t,null,{autoResize:!1,layout:!1,recurse:!1})})},sB.prototype.resizeShapes=function(e,t,n){var i=this;(0,a.Ed)(e,function(e){var o=function(e,t,n){var i=e.x,o=e.y,r=e.width,a=e.height,s=n.x,c=n.y;switch(t){case"n":return{x:i,y:o+c,width:r,height:a-c};case"s":return{x:i,y:o,width:r,height:a+c};case"w":return{x:i+s,y:o,width:r-s,height:a};case"e":return{x:i,y:o,width:r+s,height:a};default:throw Error("unknown direction: "+t)}}(e,n,t);i._modeling.resizeShape(e,o,null,{attachSupport:!1,autoResize:!1,layout:!1})})},sB.prototype.updateConnectionWaypoints=function(e,t,n,i,o,r,s){var c=this,l=o.concat(r);(0,a.Ed)(e,function(e){var p=e.source,h=e.target,u=(0,a.UI)(e.waypoints,function(e){return(e=sM(e)).original&&(e.original=sM(e.original)),e}),d=sA(n),f={};sO(l,p)&&sO(l,h)?(u=(0,a.UI)(u,function(e){return sL(e,i,n)&&(e[d]=e[d]+t[d]),e.original&&sL(e.original,i,n)&&(e.original[d]=e.original[d]+t[d]),e}),c._modeling.updateWaypoints(e,u,{labelBehavior:!1})):(sO(l,p)||sO(l,h))&&(sO(o,p)?f.connectionStart=o3(e,p,t):sO(o,h)?f.connectionEnd=o6(e,h,t):sO(r,p)?f.connectionStart=o2(e,p,s[p.id]):sO(r,h)&&(f.connectionEnd=o5(e,h,s[h.id])),c._modeling.layoutConnection(e,f))})},sN.$inject=["modeling"],sN.prototype.execute=function(e){var t=e.shape,n=t.children;e.oldChildrenVisibility=function e(t){var n={};return(0,a.Ed)(t,function(t){n[t.id]=t.hidden,t.children&&(n=(0,a.f0)({},n,e(t.children)))}),n}(n),t.collapsed=!t.collapsed;var i=function e(t,n){var i=[];return(0,a.Ed)(t,function(t){t.hidden=n,i=i.concat(t),t.children&&(i=i.concat(e(t.children,t.collapsed||n)))}),i}(n,t.collapsed);return[t].concat(i)},sN.prototype.revert=function(e){var t=e.shape,n=e.oldChildrenVisibility,i=function e(t,n){var i=[];return(0,a.Ed)(t,function(t){t.hidden=n[t.id],i=i.concat(t),t.children&&(i=i.concat(e(t.children,n)))}),i}(t.children,n);return t.collapsed=!t.collapsed,[t].concat(i)},s$.$inject=["modeling"],s$.prototype.execute=function(e){var t=e.shape,n=e.newHost,i=t.host;return e.oldHost=i,e.attacherIdx=sI(i,t),sz(n,t),t.host=n,t},s$.prototype.revert=function(e){var t=e.shape,n=e.newHost,i=e.oldHost,o=e.attacherIdx;return t.host=i,sI(n,t),sz(i,t,o),t},sH.prototype.execute=function(e){var t=e.connection,n=e.newWaypoints;return e.oldWaypoints=t.waypoints,t.waypoints=n,t},sH.prototype.revert=function(e){var t=e.connection,n=e.oldWaypoints;return t.waypoints=n,t},sF.$inject=["eventBus","elementFactory","commandStack"],sF.prototype.getHandlers=function(){return{"shape.append":sc,"shape.create":sd,"shape.delete":sb,"shape.move":sR,"shape.resize":sD,"shape.replace":sj,"shape.toggleCollapse":sN,spaceTool:sB,"label.create":sf,"connection.create":sl,"connection.delete":sv,"connection.move":sE,"connection.layout":sw,"connection.updateWaypoints":sH,"connection.reconnect":sP,"elements.create":sh,"elements.move":sC,"elements.delete":sy,"elements.distribute":sx,"elements.align":ss,"element.updateAttachment":s$}},sF.prototype.registerHandlers=function(e){(0,a.Ed)(this.getHandlers(),function(t,n){e.registerHandler(n,t)})},sF.prototype.moveShape=function(e,t,n,i,o){"object"==typeof i&&(o=i,i=null);var r={shape:e,delta:t,newParent:n,newParentIndex:i,hints:o||{}};this._commandStack.execute("shape.move",r)},sF.prototype.updateAttachment=function(e,t){this._commandStack.execute("element.updateAttachment",{shape:e,newHost:t})},sF.prototype.moveElements=function(e,t,n,i){var o,r=(i=i||{}).attach,a=n;!0===r?(o=n,a=n.parent):!1===r&&(o=null);var s={shapes:e,delta:t,newParent:a,newHost:o,hints:i};this._commandStack.execute("elements.move",s)},sF.prototype.moveConnection=function(e,t,n,i,o){"object"==typeof i&&(o=i,i=void 0);var r={connection:e,delta:t,newParent:n,newParentIndex:i,hints:o||{}};this._commandStack.execute("connection.move",r)},sF.prototype.layoutConnection=function(e,t){this._commandStack.execute("connection.layout",{connection:e,hints:t||{}})},sF.prototype.createConnection=function(e,t,n,i,o,r){"object"==typeof n&&(r=o,o=i,i=n,n=void 0);var a={source:e,target:t,parent:o,parentIndex:n,connection:i=this._create("connection",i),hints:r};return this._commandStack.execute("connection.create",a),a.connection},sF.prototype.createShape=function(e,t,n,i,o){"number"!=typeof i&&(o=i,i=void 0);var r,a,s=(o=o||{}).attach;e=this._create("shape",e),s?(r=n.parent,a=n):r=n;var c={position:t,shape:e,parent:r,parentIndex:i,host:a,hints:o};return this._commandStack.execute("shape.create",c),c.shape},sF.prototype.createElements=function(e,t,n,i,o){(0,a.kJ)(e)||(e=[e]),"number"!=typeof i&&(o=i,i=void 0);var r={position:t,elements:e,parent:n,parentIndex:i,hints:o=o||{}};return this._commandStack.execute("elements.create",r),r.elements},sF.prototype.createLabel=function(e,t,n,i){n=this._create("label",n);var o={labelTarget:e,position:t,parent:i||e.parent,shape:n};return this._commandStack.execute("label.create",o),o.shape},sF.prototype.appendShape=function(e,t,n,i,o){o=o||{};var r={source:e,position:n,target:i,shape:t=this._create("shape",t),connection:o.connection,connectionParent:o.connectionParent,hints:o};return this._commandStack.execute("shape.append",r),r.shape},sF.prototype.removeElements=function(e){this._commandStack.execute("elements.delete",{elements:e})},sF.prototype.distributeElements=function(e,t,n){this._commandStack.execute("elements.distribute",{groups:e,axis:t,dimension:n})},sF.prototype.removeShape=function(e,t){this._commandStack.execute("shape.delete",{shape:e,hints:t||{}})},sF.prototype.removeConnection=function(e,t){this._commandStack.execute("connection.delete",{connection:e,hints:t||{}})},sF.prototype.replaceShape=function(e,t,n){var i={oldShape:e,newData:t,hints:n||{}};return this._commandStack.execute("shape.replace",i),i.newShape},sF.prototype.alignElements=function(e,t){this._commandStack.execute("elements.align",{elements:e,alignment:t})},sF.prototype.resizeShape=function(e,t,n,i){this._commandStack.execute("shape.resize",{shape:e,newBounds:t,minBounds:n,hints:i})},sF.prototype.createSpace=function(e,t,n,i,o){this._commandStack.execute("spaceTool",{delta:n,direction:i,movingShapes:e,resizingShapes:t,start:o})},sF.prototype.updateWaypoints=function(e,t,n){this._commandStack.execute("connection.updateWaypoints",{connection:e,newWaypoints:t,hints:n||{}})},sF.prototype.reconnect=function(e,t,n,i,o){this._commandStack.execute("connection.reconnect",{connection:e,newSource:t,newTarget:n,dockingOrPoints:i,hints:o||{}})},sF.prototype.reconnectStart=function(e,t,n,i){i||(i={}),this.reconnect(e,t,e.target,n,(0,a.f0)(i,{docking:"source"}))},sF.prototype.reconnectEnd=function(e,t,n,i){i||(i={}),this.reconnect(e,e.source,t,n,(0,a.f0)(i,{docking:"target"}))},sF.prototype.connect=function(e,t,n,i){return this.createConnection(e,t,n||{},e.parent,i)},sF.prototype._create=function(e,t){return t instanceof V?t:this._elementFactory.create(e,t)},sF.prototype.toggleCollapse=function(e,t){this._commandStack.execute("shape.toggleCollapse",{shape:e,hints:t||{}})},sG.$inject=["elementRegistry"],sG.prototype.execute=function(e){var t,n=e.element,i=e.moddleElement,o=e.properties;if(!i)throw Error("<moddleElement> required");var r=e.changed||this._getVisualReferences(i).concat(n),s=e.oldProperties||(t=(0,a.XP)(o),(0,a.u4)(t,function(e,t){return e[t]=i.get(t),e},{}));return sW(i,o),e.oldProperties=s,e.changed=r,r},sG.prototype.revert=function(e){var t=e.oldProperties,n=e.moddleElement,i=e.changed;return sW(n,t),i},sG.prototype._getVisualReferences=function(e){var t=this._elementRegistry;return em(e,"bpmn:DataObject")?t.filter(function(t){return em(t,"bpmn:DataObjectReference")&&ev(t).dataObjectRef===e}):[]};var sV="default",sU={width:0,height:0};function sZ(e,t,n,i){this._elementRegistry=e,this._moddle=t,this._modeling=n,this._textRenderer=i}function sK(e,t){return"id"in e&&e.id!==t.id}function sJ(e,t){var n=e.businessObject,i=ey(e);(0,a.Ed)(t,function(e,t){"di"!==t?n.set(t,e):i&&(0,a.Ed)(e,function(e,t){i.set(t,e)})})}sZ.$inject=["elementRegistry","moddle","modeling","textRenderer"],sZ.prototype.execute=function(e){var t,n,i,o,r,s=e.element,c=[s];if(!s)throw Error("element required");var l=this._elementRegistry,p=this._moddle.ids,h=s.businessObject,u=(t=e.properties,n=(0,a.f0)({},t),sq.forEach(function(e){e in t&&(n[e]=ev(n[e]))}),n),d=e.oldProperties||(i=(0,a.XP)(u),o=s.businessObject,r=ey(s),(0,a.u4)(i,function(e,t){var n;return"di"!==t?e[t]=o.get(t):e[t]=(n=(0,a.XP)(u.di),(0,a.u4)(n,function(e,t){return e[t]=r&&r.get(t),e},{})),e},{}));return sK(u,h)&&(p.unclaim(h.id),l.updateId(s,u.id),p.claim(u.id,h)),sV in u&&(u[sV]&&c.push(l.get(u[sV].id)),h[sV]&&c.push(l.get(h[sV].id))),sJ(s,u),e.oldProperties=d,e.changed=c,c},sZ.prototype.postExecute=function(e){var t=e.element.label,n=t&&ev(t).name;if(n){var i=this._textRenderer.getExternalLabelBounds(t,n);this._modeling.resizeShape(t,i,sU)}},sZ.prototype.revert=function(e){var t=e.element,n=e.properties,i=e.oldProperties,o=t.businessObject,r=this._elementRegistry,a=this._moddle.ids;return sJ(t,i),sK(n,o)&&(a.unclaim(n.id),r.updateId(t,i.id),a.claim(i.id,o)),e.changed};var sq=["default"];function sX(e,t){this._canvas=e,this._modeling=t}function sY(e,t){this._modeling=e,this._spaceTool=t}function sQ(e){this._modeling=e}function s0(e,t){this._modeling=e,this._spaceTool=t}sX.$inject=["canvas","modeling"],sX.prototype.execute=function(e){var t=this._canvas,n=e.newRoot,i=n.businessObject,o=t.getRootElement(),r=o.businessObject,a=r.$parent,s=ey(o);return t.setRootElement(n),t.removeRootElement(o),P(a.rootElements,i),i.$parent=a,R(a.rootElements,r),r.$parent=null,o.di=null,s.bpmnElement=i,n.di=s,e.oldRoot=o,[]},sX.prototype.revert=function(e){var t=this._canvas,n=e.newRoot,i=n.businessObject,o=e.oldRoot,r=o.businessObject,a=i.$parent,s=ey(n);return t.setRootElement(o),t.removeRootElement(n),R(a.rootElements,i),i.$parent=null,P(a.rootElements,r),r.$parent=a,n.di=null,s.bpmnElement=r,o.di=s,[]},sY.$inject=["modeling","spaceTool"],sY.prototype.preExecute=function(e){var t,n,i,o,r,s=this._spaceTool,c=this._modeling,l=e.shape,p=e.location,h=oS(l),u=h===l,d=u?l:l.parent,f=oE(d),m=eB(l);if(m?"left"===p?p="top":"right"===p&&(p="bottom"):"top"===p?p="left":"bottom"===p&&(p="right"),!f.length){var g=m?{x:l.x+30,y:l.y,width:l.width-30,height:l.height}:{x:l.x,y:l.y+30,width:l.width,height:l.height-30};c.createShape({type:"bpmn:Lane",isHorizontal:m},g,d)}var v=[];b(h,function(e){return(v.push(e),e.label&&v.push(e.label),e===l)?[]:(0,a.hX)(e.children,function(e){return e!==l})}),"top"===p?(t=-120,i=(n=l.y)+10,o="n",r="y"):"left"===p?(t=-120,i=(n=l.x)+10,o="w",r="x"):"bottom"===p?(t=120,i=(n=l.y+l.height)-10,o="s",r="y"):"right"===p&&(t=120,i=(n=l.x+l.width)-10,o="e",r="x");var y=s.calculateAdjustments(v,r,t,i),x=m?{x:0,y:t}:{x:t,y:0};s.makeSpace(y.movingShapes,y.resizingShapes,x,o,i);var _=m?{x:l.x+(u?30:0),y:n-("top"===p?120:0),width:l.width-(u?30:0),height:120}:{x:n-("left"===p?120:0),y:l.y+(u?30:0),width:120,height:l.height-(u?30:0)};e.newLane=c.createShape({type:"bpmn:Lane",isHorizontal:m},_,d)},sQ.$inject=["modeling"],sQ.prototype.preExecute=function(e){var t,n,i,o,r=this._modeling,a=e.shape,s=e.count,c=oE(a),l=c.length;if(l>s)throw Error(`more than <${s}> child lanes`);var p=eB(a),h=p?a.height:a.width,u=Math.round(h/s);for(o=0;o<s;o++)t=o===s-1?h-u*o:u,n=p?{x:a.x+30,y:a.y+o*u,width:a.width-30,height:t}:{x:a.x+o*u,y:a.y+30,width:t,height:a.height-30},o<l?r.resizeShape(c[o],n):(i={type:"bpmn:Lane",isHorizontal:p},r.createShape(i,n,a))},s0.$inject=["modeling","spaceTool"],s0.prototype.preExecute=function(e){var t=e.shape,n=e.newBounds;!1!==e.balanced?this.resizeBalanced(t,n):this.resizeSpace(t,n)},s0.prototype.resizeBalanced=function(e,t){var n,i,o,r,a,s,c,l,p=this._modeling,h=(i=em(n=oS(e),"bpmn:Process")?[]:[n],o=ow(n,i),r=(0,j.JA)(e),a=(0,j.JA)(t),s=om((0,j.JA)(t),(0,j.JA)(e)),c=[],l=eB(e),o.forEach(function(t){if(t!==e){var n,i=l?0:s.top,o=l?s.right:0,p=l?0:s.bottom,h=l?s.left:0,u=(0,j.JA)(t);s.top&&(10>ox(u.bottom-r.top)&&(p=a.top-u.bottom),5>ox(u.top-r.top)&&(i=a.top-u.top)),s.left&&(10>ox(u.right-r.left)&&(o=a.left-u.right),5>ox(u.left-r.left)&&(h=a.left-u.left)),s.bottom&&(10>ox(u.top-r.bottom)&&(i=a.bottom-u.top),5>ox(u.bottom-r.bottom)&&(p=a.bottom-u.bottom)),s.right&&(10>ox(u.left-r.right)&&(h=a.right-u.left),5>ox(u.right-r.right)&&(o=a.right-u.right)),(i||o||p||h)&&c.push({shape:t,newBounds:(n={top:i,right:o,bottom:p,left:h},{x:t.x+(n.left||0),y:t.y+(n.top||0),width:t.width-(n.left||0)+(n.right||0),height:t.height-(n.top||0)+(n.bottom||0)})})}}),c);p.resizeShape(e,t),h.forEach(function(e){p.resizeShape(e.shape,e.newBounds)})},s0.prototype.resizeSpace=function(e,t){var n,i,o,r,a,s=this._spaceTool,c=(0,j.JA)(e),l=om((0,j.JA)(t),c),p=oS(e),h=[],u=[];b(p,function(e){return h.push(e),(em(e,"bpmn:Lane")||em(e,"bpmn:Participant"))&&u.push(e),e.children}),(l.bottom||l.top)&&(n=l.bottom||l.top,i=e.y+(l.bottom?e.height:0)+(l.bottom?-10:10),o=l.bottom?"s":"n",r=l.top>0||l.bottom<0?-n:n,a=s.calculateAdjustments(h,"y",r,i),s.makeSpace(a.movingShapes,a.resizingShapes,{x:0,y:n},o)),(l.left||l.right)&&(n=l.right||l.left,i=e.x+(l.right?e.width:0)+(l.right?-10:100),o=l.right?"e":"w",r=l.left>0||l.right<0?-n:n,a=s.calculateAdjustments(u,"x",r,i),s.makeSpace(a.movingShapes,a.resizingShapes,{x:n,y:0},o))};var s1="flowNodeRef",s2="lanes";function s5(e){this._elementRegistry=e}function s3(e){this._moddle=e}s5.$inject=["elementRegistry"],s5.prototype._computeUpdates=function(e,t){var n=[],i=[],o={},r=[];function a(e){-1===n.indexOf(e)&&(r.push(e),n.push(e))}return t.forEach(function(e){var t=oS(e);t&&-1===n.indexOf(t)&&(t.children.filter(function(e){return em(e,"bpmn:FlowNode")}).forEach(a),n.push(t))}),e.forEach(a),r.forEach(function(e){var t,n=e.businessObject,r=n.get(s2).slice(),a=e.parent?(o[(t=oS(e)).id]||(o[t.id]=ow(t)),o[t.id]).filter(function(t){var n,i;return n=(0,j.JA)(t),(i={x:e.x+e.width/2,y:e.y+e.height/2}).x>n.left&&i.x<n.right&&i.y>n.top&&i.y<n.bottom}).map(function(e){return e.businessObject}):[];i.push({flowNode:n,remove:r,add:a})}),t.forEach(function(e){var t=e.businessObject;e.parent||t.get(s1).forEach(function(e){i.push({flowNode:e,remove:[t],add:[]})})}),i},s5.prototype.execute=function(e){var t=e.updates;return t||(t=e.updates=this._computeUpdates(e.flowNodeShapes,e.laneShapes)),t.forEach(function(e){var t=e.flowNode,n=t.get(s2);e.remove.forEach(function(e){R(n,e),R(e.get(s1),t)}),e.add.forEach(function(e){P(n,e),P(e.get(s1),t)})}),[]},s5.prototype.revert=function(e){return e.updates.forEach(function(e){var t=e.flowNode,n=t.get(s2);e.add.forEach(function(e){R(n,e),R(e.get(s1),t)}),e.remove.forEach(function(e){P(n,e),P(e.get(s1),t)})}),[]},s3.$inject=["moddle"],s3.prototype.execute=function(e){var t=this._moddle.ids,n=e.id,i=e.element;return e.claiming?t.claim(n,i):t.unclaim(n),[]},s3.prototype.revert=function(e){var t=this._moddle.ids,n=e.id,i=e.element;return e.claiming?t.unclaim(n):t.claim(n,i),[]};var s6={fill:void 0,stroke:void 0};function s4(e){this._commandStack=e,this._normalizeColor=function(e){if(e){if((0,a.HD)(e)){var t,n=((t=document.createElement("canvas").getContext("2d")).fillStyle="transparent",t.fillStyle=e,/^#[0-9a-fA-F]{6}$/.test(t.fillStyle)?t.fillStyle:null);if(n)return n}throw Error(`invalid color value: ${e}`)}}}s4.$inject=["commandStack"],s4.prototype.postExecute=function(e){var t=e.elements,n=e.colors||s6,i=this,o={};"fill"in n&&(0,a.f0)(o,{"background-color":this._normalizeColor(n.fill)}),"stroke"in n&&(0,a.f0)(o,{"border-color":this._normalizeColor(n.stroke)}),(0,a.Ed)(t,function(e){var t=(0,eL.Ho)(e)?(0,a.ei)(o,["border-color"]):o,n=ey(e);if("border-color"in t&&(t.stroke=t["border-color"]),"background-color"in t&&(t.fill=t["background-color"]),(0,eL.j_)(e))i._commandStack.execute("element.updateModdleProperties",{element:e,moddleElement:n.label,properties:{color:o["border-color"]}});else{if(!eg(n,["bpmndi:BPMNEdge","bpmndi:BPMNShape"]))return;i._commandStack.execute("element.updateProperties",{element:e,properties:{di:t}})}})};var s9={width:0,height:0};function s8(e,t,n){function i(e,t){var n=e.label||e,i=e.labelTarget||e;return!function(e,t){var n=e.businessObject,i=ez(n);if(i){if("categoryValueRef"===i){if(!n[i])return;n[i].value=t}else n[i]=t}}(n,t,i!==n),[n,i]}this.preExecute=function(t){var n=t.element,i=n.businessObject,o=t.newLabel;if(!(0,eL.j_)(n)&&eN(n)&&!e$(n)&&!s7(o)){var r=eI(n);r={x:r.x,y:r.y+7},e.createLabel(n,r,{id:i.id+"_label",businessObject:i,di:n.di})}},this.execute=function(e){return e.oldLabel=eH(e.element),i(e.element,e.newLabel)},this.revert=function(e){return i(e.element,e.oldLabel)},this.postExecute=function(n){var i=n.element,o=i.label||i,r=n.newLabel,a=n.newBounds,s=n.hints||{};if((0,eL.j_)(o)||em(o,"bpmn:TextAnnotation")){if((0,eL.j_)(o)&&s7(r)){!1!==s.removeShape&&e.removeShape(o,{unsetLabel:!1});return}var c=eH(i);void 0===a&&(a=t.getExternalLabelBounds(o,c)),a&&e.resizeShape(o,a,s9)}}}function s7(e){return!e||!e.trim()}function ce(e,t,n,i){sF.call(this,e,t,n),this._bpmnRules=i}function ct(){}s8.$inject=["modeling","textRenderer","bpmnFactory"],(0,o.Z)(ce,sF),ce.$inject=["eventBus","elementFactory","commandStack","bpmnRules"],ce.prototype.getHandlers=function(){var e=sF.prototype.getHandlers.call(this);return e["element.updateModdleProperties"]=sG,e["element.updateProperties"]=sZ,e["canvas.updateRoot"]=sX,e["lane.add"]=sY,e["lane.resize"]=s0,e["lane.split"]=sQ,e["lane.updateRefs"]=s5,e["id.updateClaim"]=s3,e["element.setColor"]=s4,e["element.updateLabel"]=s8,e},ce.prototype.updateLabel=function(e,t,n,i){this._commandStack.execute("element.updateLabel",{element:e,newLabel:t,newBounds:n,hints:i||{}})},ce.prototype.connect=function(e,t,n,i){var o=this._bpmnRules;if(n||(n=o.canConnect(e,t)),n)return this.createConnection(e,t,n,e.parent,i)},ce.prototype.updateModdleProperties=function(e,t,n){this._commandStack.execute("element.updateModdleProperties",{element:e,moddleElement:t,properties:n})},ce.prototype.updateProperties=function(e,t){this._commandStack.execute("element.updateProperties",{element:e,properties:t})},ce.prototype.resizeLane=function(e,t,n){this._commandStack.execute("lane.resize",{shape:e,newBounds:t,balanced:n})},ce.prototype.addLane=function(e,t){var n={shape:e,location:t};return this._commandStack.execute("lane.add",n),n.newLane},ce.prototype.splitLane=function(e,t){this._commandStack.execute("lane.split",{shape:e,count:t})},ce.prototype.makeCollaboration=function(){var e=this._create("root",{type:"bpmn:Collaboration"});return this._commandStack.execute("canvas.updateRoot",{newRoot:e}),e},ce.prototype.makeProcess=function(){var e=this._create("root",{type:"bpmn:Process"});return this._commandStack.execute("canvas.updateRoot",{newRoot:e}),e},ce.prototype.updateLaneRefs=function(e,t){this._commandStack.execute("lane.updateRefs",{flowNodeShapes:e,laneShapes:t})},ce.prototype.claimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t,claiming:!0})},ce.prototype.unclaimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t})},ce.prototype.setColor=function(e,t){e.length||(e=[e]),this._commandStack.execute("element.setColor",{elements:e,colors:t})},ct.prototype.layoutConnection=function(e,t){return[(t=t||{}).connectionStart||(0,j.wS)(t.source||e.source),t.connectionEnd||(0,j.wS)(t.target||e.target)]};var cn=Math.round,ci={"h:h":20,"v:v":20,"h:v":-10,"v:h":-10};function co(e,t,n){var i,o,r=(0,j.T8)(t,e,5),a=n.split(":")[0],s=cn((t.x-e.x)/2+e.x),c=cn((t.y-e.y)/2+e.y),l=({t:/top/,r:/right/,b:/bottom/,l:/left/,h:/left|right/,v:/top|bottom/})[a].test(r),p=/h|r|l/.test(a),h=!1,u=!1;return l?(i=p?{x:s,y:e.y}:{x:e.x,y:c},o=p?"h:h":"v:v"):(h=!({t:/top/,r:/right/,b:/bottom/,l:/left/,h:/./,v:/./})[a].test(r),o=p?"h:v":"v:h",h?p?(u=c===e.y,i={x:e.x+20*(/l/.test(a)?-1:1),y:u?c+20:c}):i={x:(u=s===e.x)?s+20:s,y:e.y+20*(/t/.test(a)?-1:1)}:i={x:s,y:c}),{waypoints:ca(e,i,o).concat(i),directions:o,turnNextDirections:u}}function cr(e){return e.split(":").reverse().join(":")}function ca(e,t,n){var i;if(i=n=n||"h:h",!/^h|v|t|r|b|l:h|v|t|r|b|l$/.test(i))throw Error("unknown directions: <"+n+">: must be specified as <start>:<end> with start/end in { h,v,t,r,b,l }");if(cl(n)){var o,r,a,s,c=co(e,t,n),l={waypoints:(o=co(t,e,cr(n))).waypoints.slice().reverse(),directions:cr(o.directions),turnNextDirections:o.turnNextDirections},p=(r=c.directions.split(":")[1],a=l.directions.split(":")[0],c.turnNextDirections&&(r="h"==r?"v":"h"),l.turnNextDirections&&(a="h"==a?"v":"h"),s=r+":"+a,{waypoints:ca(c.waypoints[c.waypoints.length-1],l.waypoints[0],s),directions:s});return[].concat(c.waypoints,p.waypoints,l.waypoints)}return function(e,t,n){var i=cn((t.x-e.x)/2+e.x),o=cn((t.y-e.y)/2+e.y);if("h:v"===n)return[{x:t.x,y:e.y}];if("v:h"===n)return[{x:e.x,y:t.y}];if("h:h"===n)return[{x:i,y:e.y},{x:i,y:t.y}];if("v:v"===n)return[{x:e.x,y:o},{x:t.x,y:o}];throw Error("invalid directions: can only handle varians of [hv]:[hv]")}(e,t,n)}function cs(e,t,n){var i,o,r;return i=t[e],o=n[e],r=n[e]+n[({x:"width",y:"height"})[e]],i>=o&&i<=r}function cc(e,t,n,i){if(i.length<3||!(i.length>4)&&(0,a.sE)(i,function(e,t){var n=i[t-1];return n&&3>(0,n3.tW)(e,n)}))return null;var o,r=i[0],s=i.slice();return(s[0]=n,s[1]=function(e,t,n){switch((0,n3.Or)(t,e)){case"v":return{x:n.x,y:e.y};case"h":return{x:e.x,y:n.y}}return{x:e.x,y:e.y}}(s[1],r,n),(o=function(e,t,n){var i;for(i=e.length-2;0!==i;i--)if((0,n3.qr)(e[i],t,20)||(0,n3.qr)(e[i],n,20))return e.slice(i);return e}(s,e,t))!==s&&(s=cc(e,t,n,o)),s&&(0,n3.Or)(s))?null:s}function cl(e){return e&&/t|r|b|l/.test(e)}function cp(e,t,n,i){if("h"===n&&(n=/left/.test(i)?"l":"r"),"v"===n&&(n=/top/.test(i)?"t":"b"),"t"===n)return{original:e,x:e.x,y:t.y};if("r"===n)return{original:e,x:t.x+t.width,y:e.y};if("b"===n)return{original:e,x:e.x,y:t.y+t.height};if("l"===n)return{original:e,x:t.x,y:e.y};throw Error("unexpected dockingDirection: <"+n+">")}function ch(e){return e.reduce(function(t,n,i){var o=t[t.length-1],r=e[i+1];return(0,n3.ZS)(o,r,n,0)||t.push(n),t},[])}var cu={default:["h:h"],fromGateway:["v:h"],toGateway:["h:v"],loop:{fromTop:["t:r"],fromRight:["r:b"],fromLeft:["l:t"],fromBottom:["b:l"]},boundaryLoop:{alternateHorizontalSide:"b",alternateVerticalSide:"l",default:"v"},messageFlow:["straight","v:v"],subProcess:["straight","h:h"],isHorizontal:!0},cd={default:["v:v"],fromGateway:["h:v"],toGateway:["v:h"],loop:{fromTop:["t:l"],fromRight:["r:t"],fromLeft:["l:b"],fromBottom:["b:r"]},boundaryLoop:{alternateHorizontalSide:"t",alternateVerticalSide:"r",default:"h"},messageFlow:["straight","h:h"],subProcess:["straight","v:v"],isHorizontal:!1},cf={top:"bottom","top-right":"bottom-left","top-left":"bottom-right",right:"left",bottom:"top","bottom-right":"top-left","bottom-left":"top-right",left:"right"},cm={top:"t",right:"r",bottom:"b",left:"l"};function cg(e){this._elementRegistry=e}function cv(e,t){return e?e.original||e:(0,j.wS)(t)}function cy(e,t){return em(t,"bpmn:Activity")&&em(e,"bpmn:BoundaryEvent")&&t.businessObject.isForCompensation}function cb(e){return em(e,"bpmn:SubProcess")&&eD(e)}function cx(e){var t=/right|left/.exec(e);return t&&t[0]}function c_(e){var t=/top|bottom/.exec(e);return t&&t[0]}function cw(e){return"right"===e||"left"===e}function cE(e,t,n,i){return!(cS(e,i,n,40)||cS(e,i,{x:n.x+n.width,y:n.y+n.height},40)||cS(e,i,(0,j.wS)(t),40))}function cS(e,t,n,i){return Math.abs(t[e]-n[e])<i}function ck(e){return(0,a.f0)({original:e.point.original||e.point},e.actual)}function cC(e,t){this._elementRegistry=e,this._graphicsFactory=t}(0,o.Z)(cg,ct),cg.prototype.layoutConnection=function(e,t){t||(t={});var n,i,o,r,s=t.source||e.source,c=t.target||e.target,l=t.waypoints||e.waypoints,p=t.connectionStart,h=t.connectionEnd,u=this._elementRegistry;if(p||(p=cv(l&&l[0],s)),h||(h=cv(l&&l[l.length-1],c)),(em(e,"bpmn:Association")||em(e,"bpmn:DataAssociation"))&&l&&!cy(s,c))return[].concat([p],l.slice(1,-1),[h]);var d=nz(s,u)?cu:cd;return em(e,"bpmn:MessageFlow")?o={preferredLayouts:d.messageFlow,preserveDocking:em(c,"bpmn:Participant")?"source":em(s,"bpmn:Participant")?"target":cb(c)?"source":cb(s)||em(c,"bpmn:Event")?"target":em(s,"bpmn:Event")?"source":null}:(em(e,"bpmn:SequenceFlow")||cy(s,c))&&(o=s===c?{preferredLayouts:"top"===(i=(n=e.waypoints)&&n.length&&(0,j.T8)(n[0],s))?d.loop.fromTop:"right"===i?d.loop.fromRight:"left"===i?d.loop.fromLeft:d.loop.fromBottom}:em(s,"bpmn:BoundaryEvent")?{preferredLayouts:function(e,t,n,i){var o,r,a,s,c,l,p,h=(0,j.wS)(e),u=(0,j.wS)(t),d=(p=e.host,(0,j.T8)((0,j.wS)(e),p,-10)),f=e.host===t,m=-1!==["top","right","bottom","left"].indexOf(d),g=(0,j.T8)(u,h,{x:e.width/2+t.width/2,y:e.height/2+t.height/2});return f?[cm[m?d:i.isHorizontal?c_(d):cx(d)]+":"+(m?cw(d)?cE("y",e,t,n)?"h":i.boundaryLoop.alternateHorizontalSide:cE("x",e,t,n)?"v":i.boundaryLoop.alternateVerticalSide:i.boundaryLoop.default)]:[function(e,t,n,i){if(n)return cm[e];var o=c_(e),r=cx(e),a=c_(t),s=cx(t);if(i){if(o===a||cf[r]===s)return cm[o]}else if(r===s||cf[o]===a)return cm[r];return cm[i?r:o]}(d,g,m,i.isHorizontal)+":"+(o=d,r=g,a=m,s=i.isHorizontal,a?cw(o)?(c=cf[cx(o)],-1!==r.indexOf(c)||o===r)?"h":"v":(l=cf[c_(o)],-1!==r.indexOf(l)||o===r)?"v":"h":s?c_(o)===c_(r)?"h":"v":cx(o)===cx(r)?"v":"h")]}(s,c,h,d)}:cb(s)||cb(c)?{preferredLayouts:d.subProcess,preserveDocking:cb(s)?"target":"source"}:em(s,"bpmn:Gateway")?{preferredLayouts:d.fromGateway}:em(c,"bpmn:Gateway")?{preferredLayouts:d.toGateway}:{preferredLayouts:d.default}),o&&(r=ch(function(e,t,n,i,o,r){var s,c,l,p,h,u,d,f,m,g,v,y,b,x,_,w,E,S,k,C;return((0,a.kJ)(n)&&(o=n,r=i,n=(0,j.wS)(e),i=(0,j.wS)(t)),r=(0,a.f0)({preferredLayouts:[]},r),o=o||[],(s=-1!==r.preferredLayouts.indexOf("straight")&&(x=n,_=i,w=r,k={},(S=(0,j.T8)(e,t),/^(top|bottom|left|right)$/.test(S))?(/top|bottom/.test(S)&&(E="x"),/left|right/.test(S)&&(E="y"),"target"===w.preserveDocking)?cs(E,_,e)?(k[E]=_[E],[{x:void 0!==k.x?k.x:x.x,y:void 0!==k.y?k.y:x.y,original:{x:void 0!==k.x?k.x:x.x,y:void 0!==k.y?k.y:x.y}},{x:_.x,y:_.y}]):null:cs(E,x,t)?(k[E]=x[E],[{x:x.x,y:x.y},{x:void 0!==k.x?k.x:_.x,y:void 0!==k.y?k.y:_.y,original:{x:void 0!==k.x?k.x:_.x,y:void 0!==k.y?k.y:_.y}}]):null:null))||(s=r.connectionEnd&&((C=cc(t,e,i,C=o.slice().reverse()))?C.reverse():null))||(s=r.connectionStart&&cc(e,t,n,o)))?s:!r.connectionStart&&!r.connectionEnd&&o&&o.length?o:(c=n,l=i,h=(p=r)&&p.preferredLayouts||[],d=ci[u=(0,a.zu)(h,"straight")[0]||"h:h"]||0,m=function(e,t){if(cl(t))return t;switch(e){case"intersect":return"t:t";case"top":case"bottom":return"v:v";case"left":case"right":return"h:h";default:return t}}(f=(0,j.T8)(e,t,d),u),c=c||(0,j.wS)(e),l=l||(0,j.wS)(t),(b=ca(v=cp(c,e,(g=m.split(":"))[0],{top:"bottom",bottom:"top",left:"right",right:"left","top-left":"bottom-right","bottom-right":"top-left","top-right":"bottom-left","bottom-left":"top-right"}[f]),y=cp(l,t,g[1],f),m)).unshift(v),b.push(y),ch(b))}(s,c,p,h,l,o=(0,a.f0)(o,t)))),r||[p,h]},cg.$inject=["elementRegistry"],cC.$inject=["elementRegistry","graphicsFactory"],cC.prototype.getCroppedWaypoints=function(e,t,n){t=t||e.source,n=n||e.target;var i=this.getDockingPoint(e,t,!0),o=this.getDockingPoint(e,n),r=e.waypoints.slice(i.idx+1,o.idx);return r.unshift(ck(i)),r.push(ck(o)),r},cC.prototype.getDockingPoint=function(e,t,n){var i,o,r=e.waypoints;return i=n?0:r.length-1,{point:o=r[i],actual:this._getIntersection(t,e,n)||o,idx:i}},cC.prototype._getIntersection=function(e,t,n){var i=this._getShapePath(e),o=this._getConnectionPath(t);return(0,j.Hz)(i,o,n)},cC.prototype._getConnectionPath=function(e){return this._graphicsFactory.getConnectionPath(e)},cC.prototype._getShapePath=function(e){return this._graphicsFactory.getShapePath(e)},cC.prototype._getGfx=function(e){return this._elementRegistry.getGraphics(e)};var cR={__init__:["modeling","bpmnUpdater"],__depends__:[{__init__:["adaptiveLabelPositioningBehavior","appendBehavior","associationBehavior","attachEventBehavior","boundaryEventBehavior","compensateBoundaryEventBehaviour","createBehavior","createDataObjectBehavior","createParticipantBehavior","dataInputAssociationBehavior","dataStoreBehavior","deleteLaneBehavior","detachEventBehavior","dropOnFlowBehavior","eventBasedGatewayBehavior","fixHoverBehavior","groupBehavior","importDockingFix","isHorizontalFix","labelBehavior","layoutConnectionBehavior","messageFlowBehavior","nonInterruptingBehavior","removeElementBehavior","removeEmbeddedLabelBoundsBehavior","removeParticipantBehavior","replaceConnectionBehavior","replaceElementBehaviour","resizeBehavior","resizeLaneBehavior","rootElementReferenceBehavior","spaceToolBehavior","subProcessPlaneBehavior","subProcessStartEventBehavior","textAnnotationBehavior","toggleCollapseConnectionBehaviour","toggleElementCollapseBehaviour","unclaimIdBehavior","updateFlowNodeRefsBehavior","unsetDefaultFlowBehavior","setCompensationActivityAfterPasteBehavior"],adaptiveLabelPositioningBehavior:["type",i3],appendBehavior:["type",i4],associationBehavior:["type",i9],attachEventBehavior:["type",i8],boundaryEventBehavior:["type",oe],compensateBoundaryEventBehaviour:["type",ot],createBehavior:["type",or],createDataObjectBehavior:["type",oa],createParticipantBehavior:["type",os],dataInputAssociationBehavior:["type",ol],dataStoreBehavior:["type",ou],deleteLaneBehavior:["type",ok],detachEventBehavior:["type",oC],dropOnFlowBehavior:["type",oP],eventBasedGatewayBehavior:["type",oD],fixHoverBehavior:["type",oM],groupBehavior:["type",oA],importDockingFix:["type",oO],isHorizontalFix:["type",o$],labelBehavior:["type",o0],layoutConnectionBehavior:["type",o1],messageFlowBehavior:["type",re],nonInterruptingBehavior:["type",ro],removeElementBehavior:["type",ra],removeEmbeddedLabelBoundsBehavior:["type",rr],removeParticipantBehavior:["type",rc],replaceConnectionBehavior:["type",rl],replaceElementBehaviour:["type",rp],resizeBehavior:["type",ry],resizeLaneBehavior:["type",rk],rootElementReferenceBehavior:["type",rC],spaceToolBehavior:["type",rP],subProcessPlaneBehavior:["type",rD],subProcessStartEventBehavior:["type",rB],textAnnotationBehavior:["type",rM],toggleCollapseConnectionBehaviour:["type",rA],toggleElementCollapseBehaviour:["type",rL],unclaimIdBehavior:["type",rO],unsetDefaultFlowBehavior:["type",rN],updateFlowNodeRefsBehavior:["type",r$],setCompensationActivityAfterPasteBehavior:["type",rz]},{__depends__:[n5],__init__:["bpmnRules"],bpmnRules:["type",rF]},{__init__:["bpmnDiOrdering"],bpmnDiOrdering:["type",ac]},{__init__:["bpmnOrderingProvider"],bpmnOrderingProvider:["type",ap]},aI,{commandStack:["type",a6]},{__init__:["labelSupport"],labelSupport:["type",a9]},{__depends__:[n5],__init__:["attachSupport"],attachSupport:["type",se]},tI,ta,a3],bpmnFactory:["type",sn],bpmnUpdater:["type",si],elementFactory:["type",sr],modeling:["type",ce],layouter:["type",cg],connectionDocking:["type",cC]};let cP=Math.round;function cT(e,t,n,i,o,r){this._complexPreview=e,this._connectionDocking=t,this._elementFactory=n,this._eventBus=i,this._layouter=o,this._rules=r}cT.prototype.create=function(e,t,n){let i=this._complexPreview,o=this._connectionDocking,r=this._elementFactory,s=this._eventBus,c=this._layouter,l=this._rules,p=r.createShape((0,a.f0)({type:t},n)),h=s.fire("autoPlace",{source:e,shape:p});if(!h)return;(0,a.f0)(p,{x:h.x-cP(p.width/2),y:h.y-cP(p.height/2)});let u=l.allowed("connection.create",{source:e,target:p,hints:{targetParent:e.parent}}),d=null;u&&((d=r.createConnection(u)).waypoints=c.layoutConnection(d,{source:e,target:p}),d.waypoints=o.getCroppedWaypoints(d,e,p)),i.create({created:[p,d].filter(e=>!(0,a.kK)(e))})},cT.prototype.cleanUp=function(){this._complexPreview.cleanUp()},cT.$inject=["complexPreview","connectionDocking","elementFactory","eventBus","layouter","rules"];var cj=Math.min,cD=Math.max;function cB(e){e.preventDefault()}function cM(e){e.stopPropagation()}function cA(e){this.container=e.container,this.parent=(0,s.H6)('<div class="djs-direct-editing-parent"><div class="djs-direct-editing-content" contenteditable="true"></div></div>'),this.content=(0,s.IO)("[contenteditable]",this.parent),this.keyHandler=e.keyHandler||function(){},this.resizeHandler=e.resizeHandler||function(){},this.autoResize=(0,a.ak)(this.autoResize,this),this.handlePaste=(0,a.ak)(this.handlePaste,this)}function cL(e,t){this._eventBus=e,this._canvas=t,this._providers=[],this._textbox=new cA({container:t.getContainer(),keyHandler:(0,a.ak)(this._handleKey,this),resizeHandler:(0,a.ak)(this._handleResize,this)})}cA.prototype.create=function(e,t,n,i){var o=this.parent,r=this.content,c=this.container;i=this.options=i||{},t=this.style=t||{};var l=(0,a.ei)(t,["width","height","maxWidth","maxHeight","minWidth","minHeight","left","top","backgroundColor","position","overflow","border","wordWrap","textAlign","outline","transform"]);(0,a.f0)(o.style,{width:e.width+"px",height:e.height+"px",maxWidth:e.maxWidth+"px",maxHeight:e.maxHeight+"px",minWidth:e.minWidth+"px",minHeight:e.minHeight+"px",left:e.x+"px",top:e.y+"px",backgroundColor:"#ffffff",position:"absolute",overflow:"visible",border:"1px solid #ccc",boxSizing:"border-box",wordWrap:"normal",textAlign:"center",outline:"none"},l);var p=(0,a.ei)(t,["fontFamily","fontSize","fontWeight","lineHeight","padding","paddingTop","paddingRight","paddingBottom","paddingLeft"]);return(0,a.f0)(r.style,{boxSizing:"border-box",width:"100%",outline:"none",wordWrap:"break-word"},p),i.centerVertically&&(0,a.f0)(r.style,{position:"absolute",top:"50%",transform:"translate(0, -50%)"},p),r.innerText=n,s.B.bind(r,"keydown",this.keyHandler),s.B.bind(r,"mousedown",cM),s.B.bind(r,"paste",this.handlePaste),i.autoResize&&s.B.bind(r,"input",this.autoResize),i.resizable&&this.resizable(t),c.appendChild(o),this.setSelection(r.lastChild,r.lastChild&&r.lastChild.length),o},cA.prototype.handlePaste=function(e){var t,n=this.options,i=this.style;if(e.preventDefault(),t=e.clipboardData?e.clipboardData.getData("text/plain"):window.clipboardData.getData("Text"),this.insertText(t),n.autoResize){var o=this.autoResize(i);o&&this.resizeHandler(o)}},cA.prototype.insertText=function(e){e=e.replace(/\r\n|\r|\n/g,"\n"),!document.execCommand("insertText",!1,e)&&this._insertTextIE(e)},cA.prototype._insertTextIE=function(e){var t,n,i,o=this.getSelection(),r=o.startContainer,a=o.endContainer,c=o.startOffset,l=o.endOffset,p=o.commonAncestorContainer,h=(t=p.childNodes,[].slice.call(t));if(p.nodeType===Node.TEXT_NODE){var u=r.textContent;r.textContent=u.substring(0,c)+e+u.substring(l),n=r,i=c+e.length}else if(r===this.content&&a===this.content){var d=document.createTextNode(e);this.content.insertBefore(d,h[c]),n=d,i=d.textContent.length}else{var f=h.indexOf(r),m=h.indexOf(a);h.forEach(function(t,n){n===f?t.textContent=r.textContent.substring(0,c)+e+a.textContent.substring(l):n>f&&n<=m&&(0,s.Od)(t)}),n=r,i=c+e.length}n&&void 0!==i&&setTimeout(function(){self.setSelection(n,i)})},cA.prototype.autoResize=function(){var e=this.parent,t=this.content,n=parseInt(this.style.fontSize)||12;if(t.scrollHeight>e.offsetHeight||t.scrollHeight<e.offsetHeight-n){var i=e.getBoundingClientRect(),o=t.scrollHeight;e.style.height=o+"px",this.resizeHandler({width:i.width,height:i.height,dx:0,dy:o-i.height})}},cA.prototype.resizable=function(){var e=this,t=this.parent,n=this.resizeHandle,i=parseInt(this.style.minWidth)||0,o=parseInt(this.style.minHeight)||0,r=parseInt(this.style.maxWidth)||1/0,c=parseInt(this.style.maxHeight)||1/0;if(!n){n=this.resizeHandle=(0,s.H6)('<div class="djs-direct-editing-resize-handle"></div>');var l,p,h,u,d=function(n){cB(n),cM(n);var a=cj(cD(h+n.clientX-l,i),r),s=cj(cD(u+n.clientY-p,o),c);t.style.width=a+"px",t.style.height=s+"px",e.resizeHandler({width:h,height:u,dx:n.clientX-l,dy:n.clientY-p})},f=function(e){cB(e),cM(e),s.B.unbind(document,"mousemove",d,!1),s.B.unbind(document,"mouseup",f,!1)};s.B.bind(n,"mousedown",function(e){cB(e),cM(e),l=e.clientX,p=e.clientY;var n=t.getBoundingClientRect();h=n.width,u=n.height,s.B.bind(document,"mousemove",d),s.B.bind(document,"mouseup",f)})}(0,a.f0)(n.style,{position:"absolute",bottom:"0px",right:"0px",cursor:"nwse-resize",width:"0",height:"0",borderTop:(parseInt(this.style.fontSize)/4||3)+"px solid transparent",borderRight:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderBottom:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderLeft:(parseInt(this.style.fontSize)/4||3)+"px solid transparent"}),t.appendChild(n)},cA.prototype.destroy=function(){var e=this.parent,t=this.content,n=this.resizeHandle;t.innerText="",e.removeAttribute("style"),t.removeAttribute("style"),s.B.unbind(t,"keydown",this.keyHandler),s.B.unbind(t,"mousedown",cM),s.B.unbind(t,"input",this.autoResize),s.B.unbind(t,"paste",this.handlePaste),n&&(n.removeAttribute("style"),(0,s.Od)(n)),(0,s.Od)(e)},cA.prototype.getValue=function(){return this.content.innerText.trim()},cA.prototype.getSelection=function(){return window.getSelection().getRangeAt(0)},cA.prototype.setSelection=function(e,t){var n=document.createRange();null===e?n.selectNodeContents(this.content):(n.setStart(e,t),n.setEnd(e,t));var i=window.getSelection();i.removeAllRanges(),i.addRange(n)},cL.$inject=["eventBus","canvas"],cL.prototype.registerProvider=function(e){this._providers.push(e)},cL.prototype.isActive=function(e){return!!(this._active&&(!e||this._active.element===e))},cL.prototype.cancel=function(){this._active&&(this._fire("cancel"),this.close())},cL.prototype._fire=function(e,t){this._eventBus.fire("directEditing."+e,t||{active:this._active})},cL.prototype.close=function(){this._textbox.destroy(),this._fire("deactivate"),this._active=null,this.resizable=void 0,this._canvas.restoreFocus&&this._canvas.restoreFocus()},cL.prototype.complete=function(){var e=this._active;if(e){var t,n=e.context.bounds,i=this.$textbox.getBoundingClientRect(),o=this.getValue();(o!==e.context.text||i.height!==n.height||i.width!==n.width)&&(t=this._textbox.container.getBoundingClientRect(),e.provider.update(e.element,o,e.context.text,{x:i.left-t.left,y:i.top-t.top,width:i.width,height:i.height})),this._fire("complete"),this.close()}},cL.prototype.getValue=function(){return this._textbox.getValue()},cL.prototype._handleKey=function(e){e.stopPropagation();var t=e.keyCode||e.charCode;return 27===t?(e.preventDefault(),this.cancel()):13!==t||e.shiftKey?void 0:(e.preventDefault(),this.complete())},cL.prototype._handleResize=function(e){this._fire("resize",e)},cL.prototype.activate=function(e){this.isActive()&&this.cancel();var t,n=(0,a.sE)(this._providers,function(n){return(t=n.activate(e))?n:null});return t&&(this.$textbox=this._textbox.create(t.bounds,t.style,t.text,t.options),this._active={element:e,context:t,provider:n},t.options&&t.options.resizable&&(this.resizable=!0),this._fire("activate")),!!t};var cO={__depends__:[tB],__init__:["directEditing"],directEditing:["type",cL]},cN=[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message start event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer start event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional start event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal start event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],c$=[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}}],cI=[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message intermediate catch event",actionName:"replace-with-message-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message intermediate throw event",actionName:"replace-with-message-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-message",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer intermediate catch event",actionName:"replace-with-timer-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation intermediate throw event",actionName:"replace-with-escalation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-escalation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional intermediate catch event",actionName:"replace-with-conditional-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Link intermediate catch event",actionName:"replace-with-link-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-link",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Link intermediate throw event",actionName:"replace-with-link-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-link",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Compensation intermediate throw event",actionName:"replace-with-compensation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-compensation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal intermediate catch event",actionName:"replace-with-signal-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal intermediate throw event",actionName:"replace-with-signal-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-signal",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],cz=[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message end event",actionName:"replace-with-message-end",className:"bpmn-icon-end-event-message",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Escalation end event",actionName:"replace-with-escalation-end",className:"bpmn-icon-end-event-escalation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Error end event",actionName:"replace-with-error-end",className:"bpmn-icon-end-event-error",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel end event",actionName:"replace-with-cancel-end",className:"bpmn-icon-end-event-cancel",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Compensation end event",actionName:"replace-with-compensation-end",className:"bpmn-icon-end-event-compensation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal end event",actionName:"replace-with-signal-end",className:"bpmn-icon-end-event-signal",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Terminate end event",actionName:"replace-with-terminate-end",className:"bpmn-icon-end-event-terminate",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:TerminateEventDefinition"}}],cH=[{label:"Exclusive gateway",actionName:"replace-with-exclusive-gateway",className:"bpmn-icon-gateway-xor",target:{type:"bpmn:ExclusiveGateway"}},{label:"Parallel gateway",actionName:"replace-with-parallel-gateway",className:"bpmn-icon-gateway-parallel",target:{type:"bpmn:ParallelGateway"}},{label:"Inclusive gateway",actionName:"replace-with-inclusive-gateway",className:"bpmn-icon-gateway-or",target:{type:"bpmn:InclusiveGateway"}},{label:"Complex gateway",actionName:"replace-with-complex-gateway",className:"bpmn-icon-gateway-complex",target:{type:"bpmn:ComplexGateway"}},{label:"Event-based gateway",actionName:"replace-with-event-based-gateway",className:"bpmn-icon-gateway-eventbased",target:{type:"bpmn:EventBasedGateway",instantiate:!1,eventGatewayType:"Exclusive"}}],cF=[{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Event sub-process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}},{label:"Ad-hoc sub-process",actionName:"replace-with-ad-hoc-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:AdHocSubProcess",isExpanded:!0}},{label:"Sub-process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}}],cG=[{label:"Sub-process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Event sub-process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}},{label:"Ad-hoc sub-process (collapsed)",actionName:"replace-with-collapsed-ad-hoc-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:AdHocSubProcess",isExpanded:!1}}],cW=[{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Sub-process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Ad-hoc sub-process",actionName:"replace-with-ad-hoc-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:AdHocSubProcess",isExpanded:!0}},{label:"Event sub-process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}}],cV=[{label:"Task",actionName:"replace-with-task",className:"bpmn-icon-task",target:{type:"bpmn:Task"}},{label:"User task",actionName:"replace-with-user-task",className:"bpmn-icon-user",target:{type:"bpmn:UserTask"}},{label:"Service task",actionName:"replace-with-service-task",className:"bpmn-icon-service",target:{type:"bpmn:ServiceTask"}},{label:"Send task",actionName:"replace-with-send-task",className:"bpmn-icon-send",target:{type:"bpmn:SendTask"}},{label:"Receive task",actionName:"replace-with-receive-task",className:"bpmn-icon-receive",target:{type:"bpmn:ReceiveTask"}},{label:"Manual task",actionName:"replace-with-manual-task",className:"bpmn-icon-manual",target:{type:"bpmn:ManualTask"}},{label:"Business rule task",actionName:"replace-with-rule-task",className:"bpmn-icon-business-rule",target:{type:"bpmn:BusinessRuleTask"}},{label:"Script task",actionName:"replace-with-script-task",className:"bpmn-icon-script",target:{type:"bpmn:ScriptTask"}},{label:"Call activity",actionName:"replace-with-call-activity",className:"bpmn-icon-call-activity",target:{type:"bpmn:CallActivity"}},{label:"Sub-process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}},{label:"Sub-process (expanded)",actionName:"replace-with-expanded-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Ad-hoc sub-process (collapsed)",actionName:"replace-with-collapsed-ad-hoc-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:AdHocSubProcess",isExpanded:!1}},{label:"Ad-hoc sub-process (expanded)",actionName:"replace-with-ad-hoc-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:AdHocSubProcess",isExpanded:!0}}],cU=[{label:"Data store reference",actionName:"replace-with-data-store-reference",className:"bpmn-icon-data-store",target:{type:"bpmn:DataStoreReference"}}],cZ=[{label:"Data object reference",actionName:"replace-with-data-object-reference",className:"bpmn-icon-data-object",target:{type:"bpmn:DataObjectReference"}}],cK=[{label:"Message boundary event",actionName:"replace-with-message-boundary",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",cancelActivity:!0}},{label:"Timer boundary event",actionName:"replace-with-timer-boundary",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",cancelActivity:!0}},{label:"Escalation boundary event",actionName:"replace-with-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",cancelActivity:!0}},{label:"Conditional boundary event",actionName:"replace-with-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",cancelActivity:!0}},{label:"Error boundary event",actionName:"replace-with-error-boundary",className:"bpmn-icon-intermediate-event-catch-error",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ErrorEventDefinition",cancelActivity:!0}},{label:"Cancel boundary event",actionName:"replace-with-cancel-boundary",className:"bpmn-icon-intermediate-event-catch-cancel",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CancelEventDefinition",cancelActivity:!0}},{label:"Signal boundary event",actionName:"replace-with-signal-boundary",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",cancelActivity:!0}},{label:"Compensation boundary event",actionName:"replace-with-compensation-boundary",className:"bpmn-icon-intermediate-event-catch-compensation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CompensateEventDefinition",cancelActivity:!0}},{label:"Message boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-message-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",cancelActivity:!1}},{label:"Timer boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",cancelActivity:!1}},{label:"Escalation boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",cancelActivity:!1}},{label:"Conditional boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",cancelActivity:!1}},{label:"Signal boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",cancelActivity:!1}}],cJ=[{label:"Message start event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",isInterrupting:!0}},{label:"Timer start event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",isInterrupting:!0}},{label:"Conditional start event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",isInterrupting:!0}},{label:"Signal start event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",isInterrupting:!0}},{label:"Error start event",actionName:"replace-with-error-start",className:"bpmn-icon-start-event-error",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ErrorEventDefinition",isInterrupting:!0}},{label:"Escalation start event",actionName:"replace-with-escalation-start",className:"bpmn-icon-start-event-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",isInterrupting:!0}},{label:"Compensation start event",actionName:"replace-with-compensation-start",className:"bpmn-icon-start-event-compensation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:CompensateEventDefinition",isInterrupting:!0}},{label:"Message start event (non-interrupting)",actionName:"replace-with-non-interrupting-message-start",className:"bpmn-icon-start-event-non-interrupting-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",isInterrupting:!1}},{label:"Timer start event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-start",className:"bpmn-icon-start-event-non-interrupting-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",isInterrupting:!1}},{label:"Conditional start event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-start",className:"bpmn-icon-start-event-non-interrupting-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",isInterrupting:!1}},{label:"Signal start event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-start",className:"bpmn-icon-start-event-non-interrupting-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",isInterrupting:!1}},{label:"Escalation start event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-start",className:"bpmn-icon-start-event-non-interrupting-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",isInterrupting:!1}}],cq=[{label:"Sequence flow",actionName:"replace-with-sequence-flow",className:"bpmn-icon-connection"},{label:"Default flow",actionName:"replace-with-default-flow",className:"bpmn-icon-default-flow"},{label:"Conditional flow",actionName:"replace-with-conditional-flow",className:"bpmn-icon-conditional-flow"}],cX=[{label:"Expanded pool/participant",actionName:"replace-with-expanded-pool",className:"bpmn-icon-participant",target:{type:"bpmn:Participant",isExpanded:!0}},{label:function(e){var t="Empty pool/participant";return e.children&&e.children.length&&(t+=" (removes content)"),t},actionName:"replace-with-collapsed-pool",className:"bpmn-icon-lane",target:{type:"bpmn:Participant",isExpanded:!1}}],cY={"bpmn:MessageEventDefinition":[{label:"Message start event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message intermediate catch event",actionName:"replace-with-message-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message intermediate throw event",actionName:"replace-with-message-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-message",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message end event",actionName:"replace-with-message-end",className:"bpmn-icon-end-event-message",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}}],"bpmn:TimerEventDefinition":[{label:"Timer start event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Timer intermediate catch event",actionName:"replace-with-timer-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}}],"bpmn:ConditionalEventDefinition":[{label:"Conditional start event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Conditional intermediate catch event",actionName:"replace-with-conditional-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}}],"bpmn:SignalEventDefinition":[{label:"Signal start event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal intermediate catch event",actionName:"replace-with-signal-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal intermediate throw event",actionName:"replace-with-signal-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-signal",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal end event",actionName:"replace-with-signal-end",className:"bpmn-icon-end-event-signal",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],"bpmn:ErrorEventDefinition":[{label:"Error start event",actionName:"replace-with-error-start",className:"bpmn-icon-start-event-error",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Error end event",actionName:"replace-with-error-end",className:"bpmn-icon-end-event-error",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}}],"bpmn:EscalationEventDefinition":[{label:"Escalation start event",actionName:"replace-with-escalation-start",className:"bpmn-icon-start-event-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Escalation intermediate throw event",actionName:"replace-with-escalation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-escalation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Escalation end event",actionName:"replace-with-escalation-end",className:"bpmn-icon-end-event-escalation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}}],"bpmn:CompensateEventDefinition":[{label:"Compensation start event",actionName:"replace-with-compensation-start",className:"bpmn-icon-start-event-compensation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Compensation intermediate throw event",actionName:"replace-with-compensation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-compensation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Compensation end event",actionName:"replace-with-compensation-end",className:"bpmn-icon-end-event-compensation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}}]},cQ={"start-event-non-interrupting":`
  <svg viewBox="0 0 2048 2048" xmlns="http://www.w3.org/2000/svg">
    <g transform="translate(0 995.64)">
      <path d="m1899 28.357c21.545 567.43-598.38 1023.5-1133.6 835.92-548.09-147.21-801.57-873.95-463.59-1330 302.62-480.3 1071.7-507.54 1407.6-49.847 122.14 153.12 190.07 348.07 189.59 543.91z" fill="none" stroke="currentColor" stroke-dasharray="418.310422, 361.2328165" stroke-linecap="round" stroke-width="100"/>
    </g>
  </svg>`,"intermediate-event-non-interrupting":`
  <svg viewBox="0 0 2048 2048" xmlns="http://www.w3.org/2000/svg">
     <g transform="translate(0 995.64)" fill="none" stroke="currentColor" stroke-linecap="round">
        <circle cx="1024" cy="28.357" r="875" stroke-dasharray="418.310422, 361.2328165" stroke-width="100"/>
        <circle cx="1024" cy="28.357" r="685" stroke-dasharray="348.31044857,261.23283643" stroke-dashoffset="500" stroke-width="100"/>
     </g>
  </svg>`};function c0(e,t,n,i,o,r,a,s){this._bpmnFactory=e,this._popupMenu=t,this._modeling=n,this._moddle=i,this._bpmnReplace=o,this._rules=r,this._translate=a,this._moddleCopy=s,this._register()}function c1(e,t,n,i,o,r,a,s,c,l,p,h,u){e=e||{},i.registerProvider(this),this._contextPad=i,this._modeling=o,this._elementFactory=r,this._connect=a,this._create=s,this._popupMenu=c,this._canvas=l,this._rules=p,this._translate=h,this._eventBus=n,this._appendPreview=u,!1!==e.autoPlace&&(this._autoPlace=t.get("autoPlace",!1)),n.on("create.end",250,function(e){var t=e.context.shape;if(tR(e)&&i.isOpen(t)){var n=i.getEntries(t);n.replace&&n.replace.action.click(e,t)}}),n.on("contextPad.close",function(){u.cleanUp()})}function c2(e,t,n){var i=e.$instanceOf(t),o=!1,r=e.eventDefinitions||[];return(0,a.Ed)(r,function(e){e.$type===n&&(o=!0)}),i&&o}c0.$inject=["bpmnFactory","popupMenu","modeling","moddle","bpmnReplace","rules","translate","moddleCopy"],c0.prototype._register=function(){this._popupMenu.registerProvider("bpmn-replace",this)},c0.prototype.getPopupMenuEntries=function(e){var t=e.businessObject,n=this._rules,i=[],o=[];if((0,a.kJ)(e)||!n.allowed("shape.replace",{element:e}))return{};var r=function(t){var n=t.target,i=ev(e),o=i.eventDefinitions&&i.eventDefinitions[0],r=i.$type===n.type,a=(o&&o.$type)===n.eventDefinitionType,s=!!n.triggeredByEvent==!!i.triggeredByEvent,c=void 0===n.isExpanded||n.isExpanded===eD(e);return!r||!a||!s||!c};return em(t,"bpmn:DataObjectReference")?this._createEntries(e,cU):em(t,"bpmn:DataStoreReference")&&!em(e.parent,"bpmn:Collaboration")?this._createEntries(e,cZ):(em(t,"bpmn:Event")&&!em(t,"bpmn:BoundaryEvent")&&(i=cY[t.get("eventDefinitions")[0]?.$type]||[],!eM(t.$parent)&&em(t.$parent,"bpmn:SubProcess")&&(i=(0,a.hX)(i,function(e){return"bpmn:StartEvent"!==e.target.type}))),em(t,"bpmn:StartEvent")&&!em(t.$parent,"bpmn:SubProcess"))?(o=(0,a.hX)(cN.concat(i),r),this._createEntries(e,o)):em(t,"bpmn:Participant")?(o=(0,a.hX)(cX,function(t){return eD(e)!==t.target.isExpanded}),this._createEntries(e,o)):em(t,"bpmn:StartEvent")&&eM(t.$parent)?(o=(0,a.hX)(cJ.concat(i),function(e){var n=!1!==e.target.isInterrupting,i=t.isInterrupting===n;return r(e)||!r(e)&&!i}),this._createEntries(e,o)):em(t,"bpmn:StartEvent")&&!eM(t.$parent)&&em(t.$parent,"bpmn:SubProcess")?(o=(0,a.hX)(c$.concat(i),r),this._createEntries(e,o)):em(t,"bpmn:EndEvent")?(o=(0,a.hX)(cz.concat(i),function(e){return!!("bpmn:CancelEventDefinition"!=e.target.eventDefinitionType||em(t.$parent,"bpmn:Transaction"))&&r(e)}),this._createEntries(e,o)):em(t,"bpmn:BoundaryEvent")?(o=(0,a.hX)(cK,function(e){var n=e.target;if("bpmn:CancelEventDefinition"==n.eventDefinitionType&&!em(t.attachedToRef,"bpmn:Transaction"))return!1;var i=!1!==n.cancelActivity,o=t.cancelActivity==i;return r(e)||!r(e)&&!o}),this._createEntries(e,o)):em(t,"bpmn:IntermediateCatchEvent")||em(t,"bpmn:IntermediateThrowEvent")?(o=(0,a.hX)(cI.concat(i),r),this._createEntries(e,o)):em(t,"bpmn:Gateway")?(o=(0,a.hX)(cH,r),this._createEntries(e,o)):em(t,"bpmn:Transaction")||eM(t)&&eD(e)?(o=(0,a.hX)(cW,r),this._createEntries(e,o)):em(t,"bpmn:AdHocSubProcess")&&eD(e)?(o=(0,a.hX)(cG,r),this._createEntries(e,o)):em(t,"bpmn:SubProcess")&&eD(e)?(o=(0,a.hX)(cF,r),this._createEntries(e,o)):em(t,"bpmn:SubProcess")&&!eD(e)?(o=(0,a.hX)(cV,function(t){return t.target.type===e.type==(!0===t.target.isExpanded)}),this._createEntries(e,o)):em(t,"bpmn:SequenceFlow")?this._createSequenceFlowEntries(e,cq):em(t,"bpmn:FlowNode")?(o=(0,a.hX)(cV,r),this._createEntries(e,o)):{}},c0.prototype.getPopupMenuHeaderEntries=function(e){var t={};return em(e,"bpmn:Activity")&&!eM(e)&&(t={...t,...this._getLoopCharacteristicsHeaderEntries(e)}),em(e,"bpmn:DataObjectReference")&&(t={...t,...this._getCollectionHeaderEntries(e)}),em(e,"bpmn:Participant")&&(t={...t,...this._getParticipantMultiplicityHeaderEntries(e)}),rn(e)&&(t={...t,...this._getNonInterruptingHeaderEntries(e)}),t},c0.prototype._createEntries=function(e,t){var n={},i=this;return(0,a.Ed)(t,function(t){n[t.actionName]=i._createEntry(t,e)}),n},c0.prototype._createSequenceFlowEntries=function(e,t){var n=ev(e),i={},o=this._modeling,r=this._moddle,s=this;return(0,a.Ed)(t,function(t){switch(t.actionName){case"replace-with-default-flow":n.sourceRef.default!==n&&(em(n.sourceRef,"bpmn:ExclusiveGateway")||em(n.sourceRef,"bpmn:InclusiveGateway")||em(n.sourceRef,"bpmn:ComplexGateway")||em(n.sourceRef,"bpmn:Activity"))&&(i={...i,[t.actionName]:s._createEntry(t,e,function(){o.updateProperties(e.source,{default:n})})});break;case"replace-with-conditional-flow":!n.conditionExpression&&em(n.sourceRef,"bpmn:Activity")&&(i={...i,[t.actionName]:s._createEntry(t,e,function(){var t=r.create("bpmn:FormalExpression",{body:""});o.updateProperties(e,{conditionExpression:t})})});break;default:em(n.sourceRef,"bpmn:Activity")&&n.conditionExpression&&(i={...i,[t.actionName]:s._createEntry(t,e,function(){o.updateProperties(e,{conditionExpression:void 0})})}),(em(n.sourceRef,"bpmn:ExclusiveGateway")||em(n.sourceRef,"bpmn:InclusiveGateway")||em(n.sourceRef,"bpmn:ComplexGateway")||em(n.sourceRef,"bpmn:Activity"))&&n.sourceRef.default===n&&(i={...i,[t.actionName]:s._createEntry(t,e,function(){o.updateProperties(e.source,{default:void 0})})})}}),i},c0.prototype._createEntry=function(e,t,n){var i=this._translate,o=this._bpmnReplace.replaceElement,r=e.label;return r&&"function"==typeof r&&(r=r(t)),n=n||function(){return o(t,e.target)},{label:i(r),className:e.className,action:n}},c0.prototype._getLoopCharacteristicsHeaderEntries=function(e){var t,n,i,o=this,r=this._translate;function a(t,n){if(n.active){o._modeling.updateProperties(e,{loopCharacteristics:void 0});return}var i=e.businessObject.get("loopCharacteristics");i&&em(i,n.options.loopCharacteristics)?o._modeling.updateModdleProperties(e,i,{isSequential:n.options.isSequential}):(i=o._moddle.create(n.options.loopCharacteristics,{isSequential:n.options.isSequential}),o._modeling.updateProperties(e,{loopCharacteristics:i}))}var s=ev(e).loopCharacteristics;return s&&(t=s.isSequential,n=void 0===s.isSequential,i=void 0!==s.isSequential&&!s.isSequential),{"toggle-parallel-mi":{className:"bpmn-icon-parallel-mi-marker",title:r("Parallel multi-instance"),active:i,action:a,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!1}},"toggle-sequential-mi":{className:"bpmn-icon-sequential-mi-marker",title:r("Sequential multi-instance"),active:t,action:a,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!0}},"toggle-loop":{className:"bpmn-icon-loop-marker",title:r("Loop"),active:n,action:a,options:{loopCharacteristics:"bpmn:StandardLoopCharacteristics"}}}},c0.prototype._getCollectionHeaderEntries=function(e){var t=this,n=this._translate,i=e.businessObject.dataObjectRef;if(!i)return{};var o=i.isCollection;return{"toggle-is-collection":{className:"bpmn-icon-parallel-mi-marker",title:n("Collection"),active:o,action:function(n,o){t._modeling.updateModdleProperties(e,i,{isCollection:!o.active})}}}},c0.prototype._getParticipantMultiplicityHeaderEntries=function(e){var t=this,n=this._bpmnFactory,i=this._translate,o=e.businessObject.participantMultiplicity;return{"toggle-participant-multiplicity":{className:"bpmn-icon-parallel-mi-marker",title:i("Participant multiplicity"),active:!!o,action:function(i,o){var r;o.active||(r=n.create("bpmn:ParticipantMultiplicity")),t._modeling.updateProperties(e,{participantMultiplicity:r})}}}},c0.prototype._getNonInterruptingHeaderEntries=function(e){let t=this._translate,n=ev(e),i=this,o=ri(e),r=em(e,"bpmn:BoundaryEvent")?cQ["intermediate-event-non-interrupting"]:cQ["start-event-non-interrupting"],a=!n[o];return{"toggle-non-interrupting":{imageHtml:r,title:t("Toggle non-interrupting"),active:a,action:function(){i._modeling.updateProperties(e,{[o]:!!a})}}}},c1.$inject=["config.contextPad","injector","eventBus","contextPad","modeling","elementFactory","connect","create","popupMenu","canvas","rules","translate","appendPreview"],c1.prototype.getMultiElementContextPadEntries=function(e){var t=this._modeling,n={};return this._isDeleteAllowed(e)&&(0,a.f0)(n,{delete:{group:"edit",className:"bpmn-icon-trash",title:this._translate("Delete"),action:{click:function(e,n){t.removeElements(n.slice())}}}}),n},c1.prototype._isDeleteAllowed=function(e){var t=this._rules.allowed("elements.delete",{elements:e});return(0,a.kJ)(t)?(0,a.yW)(e,e=>t.includes(e)):t},c1.prototype.getContextPadEntries=function(e){var t=this._contextPad,n=this._modeling,i=this._elementFactory,o=this._connect,r=this._create,s=this._popupMenu,c=this._autoPlace,l=this._translate,p=this._appendPreview,h={};if("label"===e.type)return this._isDeleteAllowed([e])&&(0,a.f0)(h,m()),h;var u=e.businessObject;function d(e,t){o.start(e,t)}function f(e,t){n.removeElements([t])}function m(){return{delete:{group:"edit",className:"bpmn-icon-trash",title:l("Delete"),action:{click:f}}}}function g(e,t,n,o){function s(t,n){var s=i.createShape((0,a.f0)({type:e},o));r.start(t,s,{source:n})}var l=c?function(t,n){var r=i.createShape((0,a.f0)({type:e},o));c.append(n,r)}:s;return{group:"model",className:t,title:n,action:{dragstart:s,click:l,hover:c?function(t,n){return p.create(n,e,o),()=>{p.cleanUp()}}:null}}}function v(e){return function(i,o){n.splitLane(o,e),t.open(o,!0)}}if(eg(u,["bpmn:Lane","bpmn:Participant"])&&eD(e)){var y=oE(e);(0,a.f0)(h,{"lane-insert-above":{group:"lane-insert-above",className:"bpmn-icon-lane-insert-above",title:l("Add lane above"),action:{click:function(e,t){n.addLane(t,"top")}}}}),y.length<2&&((eB(e)?e.height>=120:e.width>=120)&&(0,a.f0)(h,{"lane-divide-two":{group:"lane-divide",className:"bpmn-icon-lane-divide-two",title:l("Divide into two lanes"),action:{click:v(2)}}}),(eB(e)?e.height>=180:e.width>=180)&&(0,a.f0)(h,{"lane-divide-three":{group:"lane-divide",className:"bpmn-icon-lane-divide-three",title:l("Divide into three lanes"),action:{click:v(3)}}})),(0,a.f0)(h,{"lane-insert-below":{group:"lane-insert-below",className:"bpmn-icon-lane-insert-below",title:l("Add lane below"),action:{click:function(e,t){n.addLane(t,"bottom")}}}})}return!em(u,"bpmn:FlowNode")||(em(u,"bpmn:EventBasedGateway")?(0,a.f0)(h,{"append.receive-task":g("bpmn:ReceiveTask","bpmn-icon-receive-task",l("Append receive task")),"append.message-intermediate-event":g("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-message",l("Append message intermediate catch event"),{eventDefinitionType:"bpmn:MessageEventDefinition"}),"append.timer-intermediate-event":g("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-timer",l("Append timer intermediate catch event"),{eventDefinitionType:"bpmn:TimerEventDefinition"}),"append.condition-intermediate-event":g("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-condition",l("Append conditional intermediate catch event"),{eventDefinitionType:"bpmn:ConditionalEventDefinition"}),"append.signal-intermediate-event":g("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-signal",l("Append signal intermediate catch event"),{eventDefinitionType:"bpmn:SignalEventDefinition"})}):c2(u,"bpmn:BoundaryEvent","bpmn:CompensateEventDefinition")?(0,a.f0)(h,{"append.compensation-activity":g("bpmn:Task","bpmn-icon-task",l("Append compensation activity"),{isForCompensation:!0})}):em(u,"bpmn:EndEvent")||u.isForCompensation||c2(u,"bpmn:IntermediateThrowEvent","bpmn:LinkEventDefinition")||eM(u)||(0,a.f0)(h,{"append.end-event":g("bpmn:EndEvent","bpmn-icon-end-event-none",l("Append end event")),"append.gateway":g("bpmn:ExclusiveGateway","bpmn-icon-gateway-none",l("Append gateway")),"append.append-task":g("bpmn:Task","bpmn-icon-task",l("Append task")),"append.intermediate-event":g("bpmn:IntermediateThrowEvent","bpmn-icon-intermediate-event-none",l("Append intermediate/boundary event"))})),s.isEmpty(e,"bpmn-replace")||(0,a.f0)(h,{replace:{group:"edit",className:"bpmn-icon-screw-wrench",title:l("Change element"),action:{click:function(e,n){var i,o=(0,a.f0)({x:(i=t.getPad(n).html.getBoundingClientRect()).left,y:i.bottom+5},{cursor:{x:e.x,y:e.y}});s.open(n,"bpmn-replace",o,{title:l("Change element"),width:300,search:!0})}}}}),em(u,"bpmn:SequenceFlow")&&(0,a.f0)(h,{"append.text-annotation":g("bpmn:TextAnnotation","bpmn-icon-text-annotation",l("Add text annotation"))}),em(u,"bpmn:MessageFlow")&&(0,a.f0)(h,{"append.text-annotation":g("bpmn:TextAnnotation","bpmn-icon-text-annotation",l("Add text annotation"))}),eg(u,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference"])&&(0,a.f0)(h,{"append.text-annotation":g("bpmn:TextAnnotation","bpmn-icon-text-annotation",l("Add text annotation")),connect:{group:"connect",className:"bpmn-icon-connection-multi",title:l("Connect to other element"),action:{click:d,dragstart:d}}}),em(u,"bpmn:TextAnnotation")&&(0,a.f0)(h,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:l("Connect using association"),action:{click:d,dragstart:d}}}),eg(u,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&(0,a.f0)(h,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:l("Connect using data input association"),action:{click:d,dragstart:d}}}),em(u,"bpmn:Group")&&(0,a.f0)(h,{"append.text-annotation":g("bpmn:TextAnnotation","bpmn-icon-text-annotation",l("Add text annotation"))}),this._isDeleteAllowed([e])&&(0,a.f0)(h,m()),h};var c5={horizontal:["x","width"],vertical:["y","height"]};function c3(e,t){this._modeling=e,this._filters=[],this.registerFilter(function(e){var n=t.allowed("elements.distribute",{elements:e});return(0,a.kJ)(n)?n:n?e:[]})}function c6(e){nD.call(this,e)}c3.$inject=["modeling","rules"],c3.prototype.registerFilter=function(e){if("function"!=typeof e)throw Error("the filter has to be a function");this._filters.push(e)},c3.prototype.trigger=function(e,t){var n,i,o=this._modeling;if(!(e.length<3)&&(this._setOrientation(t),i=this._filterElements(e),!((n=this._createGroups(i)).length<=2)))return o.distributeElements(n,this._axis,this._dimension),n},c3.prototype._filterElements=function(e){var t=this._filters,n=this._axis,i=this._dimension,o=[].concat(e);return t.length?((0,a.Ed)(t,function(e){o=e(o,n,i)}),o):e},c3.prototype._createGroups=function(e){var t=[],n=this,i=this._axis,o=this._dimension;if(!i)throw Error('must have a defined "axis" and "dimension"');var r=(0,a.MR)(e,i);return(0,a.Ed)(r,function(e,r){var a,s=n._findRange(e,i,o),c=t[t.length-1];c&&n._hasIntersection(c.range,s)?t[t.length-1].elements.push(e):(a={range:s,elements:[e]},t.push(a))}),t},c3.prototype._setOrientation=function(e){var t=c5[e];this._axis=t[0],this._dimension=t[1]},c3.prototype._hasIntersection=function(e,t){return Math.max(e.min,e.max)>=Math.min(t.min,t.max)&&Math.min(e.min,e.max)<=Math.max(t.min,t.max)},c3.prototype._findRange=function(e){var t=e[this._axis];return{min:t+5,max:t+e[this._dimension]-5}},c6.$inject=["eventBus"],(0,o.Z)(c6,nD),c6.prototype.init=function(){this.addRule("elements.distribute",function(e){var t=e.elements;return!((t=v(t=(0,a.hX)(t,function(e){var t=eg(e,["bpmn:Association","bpmn:BoundaryEvent","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:Lane","bpmn:MessageFlow","bpmn:SequenceFlow","bpmn:TextAnnotation"]);return!(e.labelTarget||t)}))).length<3)&&t})};var c4={horizontal:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
                <polyline points="450 400 450 150 1350 150 1350 400" style="fill:none;stroke:currentColor;stroke-width:100;stroke-linejoin:round;"/>
                <rect x="150" y="450" width="600" height="1200" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
                <rect x="1050" y="450" width="600" height="800" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
              </svg>`,vertical:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">
              <polyline points="400 1350 150 1350 150 450 400 450" style="fill:none;stroke:currentColor;stroke-width:100;stroke-linejoin:round;"/>
              <rect x="450" y="150" width="1200" height="600" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>
              <rect x="450" y="1050" width="800" height="600" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>
            </svg>`};function c9(e,t,n,i){this._distributeElements=t,this._translate=n,this._popupMenu=e,this._rules=i,e.registerProvider("align-elements",900,this)}c9.$inject=["popupMenu","distributeElements","translate","rules"],c9.prototype.getPopupMenuEntries=function(e){var t={};return this._isAllowed(e)&&(0,a.f0)(t,this._getEntries(e)),t},c9.prototype._isAllowed=function(e){return this._rules.allowed("elements.distribute",{elements:e})},c9.prototype._getEntries=function(e){var t=this._distributeElements,n=this._translate,i=this._popupMenu;return{"distribute-elements-horizontal":{group:"distribute",title:n("Distribute elements horizontally"),className:"bjs-align-elements-menu-entry",imageHtml:c4.horizontal,action:function(n,o){t.trigger(e,"horizontal"),i.close()}},"distribute-elements-vertical":{group:"distribute",title:n("Distribute elements vertically"),imageHtml:c4.vertical,action:function(n,o){t.trigger(e,"vertical"),i.close()}}}};var c8="is not a registered action";function c7(e,t){this._actions={};var n=this;e.on("diagram.init",function(){n._registerDefaultActions(t),e.fire("editorActions.init",{editorActions:n})})}function le(e,t){return Error(e+" "+t)}function lt(e){e.invoke(c7,this)}function ln(e){e.on(["create.init","shape.move.init"],function(e){var t=e.context;eg(e.shape,["bpmn:Participant","bpmn:SubProcess","bpmn:TextAnnotation"])&&(t.gridSnappingContext||(t.gridSnappingContext={}),t.gridSnappingContext.snapLocation="top-left")})}c7.$inject=["eventBus","injector"],c7.prototype._registerDefaultActions=function(e){var t=e.get("commandStack",!1),n=e.get("modeling",!1),i=e.get("selection",!1),o=e.get("zoomScroll",!1),r=e.get("copyPaste",!1),s=e.get("canvas",!1),c=e.get("rules",!1),l=e.get("keyboardMove",!1),p=e.get("keyboardMoveSelection",!1);t&&(this.register("undo",function(){t.undo()}),this.register("redo",function(){t.redo()})),r&&i&&this.register("copy",function(){var e=i.get();if(e.length)return r.copy(e)}),r&&this.register("paste",function(){r.paste()}),o&&this.register("stepZoom",function(e){o.stepZoom(e.value)}),s&&this.register("zoom",function(e){s.zoom(e.value)}),n&&i&&c&&this.register("removeSelection",function(){var e=i.get();if(e.length){var t,o=c.allowed("elements.delete",{elements:e});!1!==o&&(t=(0,a.kJ)(o)?o:e).length&&n.removeElements(t.slice())}}),l&&this.register("moveCanvas",function(e){l.moveCanvas(e)}),p&&this.register("moveSelection",function(e){p.moveSelection(e.direction,e.accelerated)})},c7.prototype.trigger=function(e,t){if(!this._actions[e])throw le(e,c8);return this._actions[e](t)},c7.prototype.register=function(e,t){var n=this;if("string"==typeof e)return this._registerAction(e,t);(0,a.Ed)(e,function(e,t){n._registerAction(t,e)})},c7.prototype._registerAction=function(e,t){if(this.isRegistered(e))throw le(e,"is already registered");this._actions[e]=t},c7.prototype.unregister=function(e){if(!this.isRegistered(e))throw le(e,c8);this._actions[e]=void 0},c7.prototype.getActions=function(){return Object.keys(this._actions)},c7.prototype.isRegistered=function(e){return!!this._actions[e]},(0,o.Z)(lt,c7),lt.$inject=["injector"],lt.prototype._registerDefaultActions=function(e){c7.prototype._registerDefaultActions.call(this,e);var t=e.get("canvas",!1),n=e.get("elementRegistry",!1),i=e.get("selection",!1),o=e.get("spaceTool",!1),r=e.get("lassoTool",!1),s=e.get("handTool",!1),c=e.get("globalConnect",!1),l=e.get("distributeElements",!1),p=e.get("alignElements",!1),h=e.get("directEditing",!1),u=e.get("searchPad",!1),d=e.get("modeling",!1),f=e.get("contextPad",!1);t&&n&&i&&this._registerAction("selectElements",function(){var e=t.getRootElement(),o=n.filter(function(t){return t!==e});return i.select(o),o}),o&&this._registerAction("spaceTool",function(){o.toggle()}),r&&this._registerAction("lassoTool",function(){r.toggle()}),s&&this._registerAction("handTool",function(){s.toggle()}),c&&this._registerAction("globalConnectTool",function(){c.toggle()}),i&&l&&this._registerAction("distributeElements",function(e){var t=i.get(),n=e.type;t.length&&l.trigger(t,n)}),i&&p&&this._registerAction("alignElements",function(e){var t=i.get(),n=[],o=e.type;t.length&&(n=(0,a.hX)(t,function(e){return!em(e,"bpmn:Lane")}),p.trigger(n,o))}),i&&d&&this._registerAction("setColor",function(e){var t=i.get();t.length&&d.setColor(t,e)}),i&&h&&this._registerAction("directEditing",function(){var e=i.get();e.length&&h.activate(e[0])}),u&&this._registerAction("find",function(){u.toggle()}),t&&d&&this._registerAction("moveToOrigin",function(){var e,i,o=t.getRootElement();e=_(i=em(o,"bpmn:Collaboration")?n.filter(function(e){return em(e.parent,"bpmn:Collaboration")}):n.filter(function(e){return e!==o&&!em(e.parent,"bpmn:SubProcess")})),d.moveElements(i,{x:-e.x,y:-e.y},o)}),i&&f&&this._registerAction("replaceElement",function(e){f.triggerEntry("replace","click",e)})},ln.$inject=["eventBus"];var li=n(3630);function lo(e,t,n){var i=!n||!1!==n.active;this._eventBus=t;var o=this;t.on("diagram.init",800,function(){o.setActive(i)}),t.on(["create.move","create.end","bendpoint.move.move","bendpoint.move.end","connect.move","connect.end","connectionSegment.move.move","connectionSegment.move.end","resize.move","resize.end","shape.move.move","shape.move.end"],1200,function(t){var n=t.originalEvent;if(!(!o.active||n&&(0,tH.JS)(n))){var i=t.context,r=i.gridSnappingContext;r||(r=i.gridSnappingContext={}),["x","y"].forEach(function(n){var i,r,s,c,l,p={},h=(i=t.context,r=t.shape,c=(s=i.gridSnappingContext).snapLocation,(l=s.snapOffset)&&(0,a.hj)(l[n])||(l||(l=s.snapOffset={}),(0,a.hj)(l[n])||(l[n]=0),r&&(e.get(r.id)||("x"===n?l[n]+=r[n]+r.width/2:l[n]+=r[n]+r.height/2),c&&("x"===n?/left/.test(c)?l[n]-=r.width/2:/right/.test(c)&&(l[n]+=r.width/2):/top/.test(c)?l[n]-=r.height/2:/bottom/.test(c)&&(l[n]+=r.height/2)))),l[n]);h&&(p.offset=h);var u=function(e,t){var n=e.context,i=n.createConstraints,o=n.resizeConstraints||{},r=n.gridSnappingContext,a=r.snapConstraints;if(a&&a[t])return a[t];a||(a=r.snapConstraints={}),a[t]||(a[t]={});var s=n.direction;i&&("x"===t?(a.x.min=i.left,a.x.max=i.right):(a.y.min=i.top,a.y.max=i.bottom));var c=o.min,l=o.max;return c&&("x"===t?la(s)?a.x.max=c.left:a.x.min=c.right:lr(s)?a.y.max=c.top:a.y.min=c.bottom),l&&("x"===t?la(s)?a.x.min=l.left:a.x.max=l.right:lr(s)?a.y.min=l.top:a.y.max=l.bottom),a[t]}(t,n);u&&(0,a.f0)(p,u),iN(t,n)||o.snapEvent(t,n,p)})}})}function lr(e){return -1!==e.indexOf("n")}function la(e){return -1!==e.indexOf("w")}function ls(e,t){ts.call(this,e),this._gridSnapping=t;var n=this;this.preExecute("shape.resize",function(e){var t=e.context,i=(t.hints||{}).autoResize;if(i){var o=t.shape,r=t.newBounds;(0,a.HD)(i)?t.newBounds=n.snapComplex(r,i):t.newBounds=n.snapSimple(o,r)}})}function lc(e,t){e.on(["spaceTool.move","spaceTool.end"],2e3,function(e){var n,i=e.context;i.initialized&&("x"===i.axis?(n=t.snapValue(e.dx),e.x=e.x+n-e.dx,e.dx=n):(n=t.snapValue(e.dy),e.y=e.y+n-e.dy,e.dy=n))})}function ll(e,t,n){e.on("autoPlace",2e3,function(e){var i=e.source,o=(0,j.wS)(i),r=e.shape,a=nH(i,r,n);return["x","y"].forEach(function(e){var n={};a[e]!==o[e]&&(a[e]>o[e]?n.min=a[e]:n.max=a[e],em(r,"bpmn:TextAnnotation")&&("x"===e?n.offset=-r.width/2:n.offset=-r.height/2),a[e]=t.snapValue(a[e],n))}),a})}function lp(e,t,n){t.on(["create.start","shape.move.start"],1750,function(t){var i=t.context,o=i.shape,r=e.getRootElement();em(o,"bpmn:Participant")&&em(r,"bpmn:Process")&&r.children.length&&i.createConstraints&&(o.width=n.snapValue(o.width,{min:o.width}),o.height=n.snapValue(o.height,{min:o.height}))})}function lh(e,t,n){ts.call(this,e),this._gridSnapping=t;var i=this;this.postExecuted(["connection.create","connection.layout"],3e3,function(e){var t=e.context,o=t.connection,r=t.hints||{},a=o.waypoints;!r.connectionStart&&!r.connectionEnd&&!1!==r.createElementsBehavior&&a.length>3&&n.updateWaypoints(o,i.snapMiddleSegments(a))})}function lu(e,t){this._interactionEvents=t;var n=this;e.on(["interactionEvents.createHit","interactionEvents.updateHit"],function(e){var t=e.element,i=e.gfx;return em(t,"bpmn:Lane")?n._createParticipantHit(t,i):em(t,"bpmn:Participant")?eD(t)?n._createParticipantHit(t,i):n._createDefaultHit(t,i):em(t,"bpmn:SubProcess")?eD(t)?n._createSubProcessHit(t,i):n._createDefaultHit(t,i):void 0})}function ld(e){e.invoke(tV,this)}lo.prototype.snapEvent=function(e,t,n){var i=this.snapValue(e[t],n);i$(e,t,i)},lo.prototype.getGridSpacing=function(){return li.N},lo.prototype.snapValue=function(e,t){var n,i,o=0;return t&&t.offset&&(o=t.offset),e+=o,e=(0,li.q)(e,li.N),t&&t.min&&(n=t.min,(0,a.hj)(n)&&(e=Math.max(e,n=(0,li.q)(n+o,li.N,"ceil")))),t&&t.max&&(i=t.max,(0,a.hj)(i)&&(e=Math.min(e,i=(0,li.q)(i+o,li.N,"floor")))),e-=o},lo.prototype.isActive=function(){return this.active},lo.prototype.setActive=function(e){this.active=e,this._eventBus.fire("gridSnapping.toggle",{active:e})},lo.prototype.toggleActive=function(){this.setActive(!this.active)},lo.$inject=["elementRegistry","eventBus","config.gridSnapping"],ls.$inject=["eventBus","gridSnapping","modeling"],(0,o.Z)(ls,ts),ls.prototype.snapSimple=function(e,t){var n=this._gridSnapping;return t.width=n.snapValue(t.width,{min:t.width}),t.height=n.snapValue(t.height,{min:t.height}),t.x=e.x+e.width/2-t.width/2,t.y=e.y+e.height/2-t.height/2,t},ls.prototype.snapComplex=function(e,t){return/w|e/.test(t)&&(e=this.snapHorizontally(e,t)),/n|s/.test(t)&&(e=this.snapVertically(e,t)),e},ls.prototype.snapHorizontally=function(e,t){var n=this._gridSnapping,i=/w/.test(t),o=/e/.test(t),r={};return r.width=n.snapValue(e.width,{min:e.width}),o&&(i?(r.x=n.snapValue(e.x,{max:e.x}),r.width+=n.snapValue(e.x-r.x,{min:e.x-r.x})):e.x=e.x+e.width-r.width),(0,a.f0)(e,r),e},ls.prototype.snapVertically=function(e,t){var n=this._gridSnapping,i=/n/.test(t),o=/s/.test(t),r={};return r.height=n.snapValue(e.height,{min:e.height}),i&&(o?(r.y=n.snapValue(e.y,{max:e.y}),r.height+=n.snapValue(e.y-r.y,{min:e.y-r.y})):e.y=e.y+e.height-r.height),(0,a.f0)(e,r),e},lc.$inject=["eventBus","gridSnapping"],ll.$inject=["eventBus","gridSnapping","elementRegistry"],lp.$inject=["canvas","eventBus","gridSnapping"],lh.$inject=["eventBus","gridSnapping","modeling"],(0,o.Z)(lh,ts),lh.prototype.snapMiddleSegments=function(e){var t,n=this._gridSnapping;e=e.slice();for(var i=1;i<e.length-2;i++)t=function(e,t,n){var i=(0,n3.Or)(t,n),o={};return"h"===i&&(o.y=e.snapValue(t.y)),"v"===i&&(o.x=e.snapValue(t.x)),("x"in o||"y"in o)&&(t=(0,a.f0)({},t,o),n=(0,a.f0)({},n,o)),[t,n]}(n,e[i],e[i+1]),e[i]=t[0],e[i+1]=t[1];return e},lu.$inject=["eventBus","interactionEvents"],lu.prototype._createDefaultHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createDefaultHit(e,t),!0},lu.prototype._createParticipantHit=function(e,t){this._interactionEvents.removeHits(t),this._interactionEvents.createBoxHit(t,"no-move",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"click-stroke",{width:e.width,height:e.height});var n=eB(e)?{width:30,height:e.height}:{width:e.width,height:30};return this._interactionEvents.createBoxHit(t,"all",n),!0},lu.prototype._createSubProcessHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createBoxHit(t,"no-move",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"click-stroke",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"all",{width:e.width,height:30}),!0},(0,o.Z)(ld,tV),ld.$inject=["injector"],ld.prototype.registerBindings=function(e,t){function n(n,i){t.isRegistered(n)&&e.addListener(i)}tV.prototype.registerBindings.call(this,e,t),n("selectElements",function(n){var i=n.keyEvent;if(e.isKey(["a","A"],i)&&e.isCmd(i))return t.trigger("selectElements"),!0}),n("find",function(n){var i=n.keyEvent;if(e.isKey(["f","F"],i)&&e.isCmd(i))return t.trigger("find"),!0}),n("spaceTool",function(n){var i=n.keyEvent;if(!e.hasModifier(i)&&e.isKey(["s","S"],i))return t.trigger("spaceTool"),!0}),n("lassoTool",function(n){var i=n.keyEvent;if(!e.hasModifier(i)&&e.isKey(["l","L"],i))return t.trigger("lassoTool"),!0}),n("handTool",function(n){var i=n.keyEvent;if(!e.hasModifier(i)&&e.isKey(["h","H"],i))return t.trigger("handTool"),!0}),n("globalConnectTool",function(n){var i=n.keyEvent;if(!e.hasModifier(i)&&e.isKey(["c","C"],i))return t.trigger("globalConnectTool"),!0}),n("directEditing",function(n){var i=n.keyEvent;if(!e.hasModifier(i)&&e.isKey(["e","E"],i))return t.trigger("directEditing"),!0}),n("replaceElement",function(n){var i=n.keyEvent;if(!e.hasModifier(i)&&e.isKey(["r","R"],i))return t.trigger("replaceElement",i),!0})};var lf={moveSpeed:1,moveSpeedAccelerated:10},lm="left",lg="right",lv="down",ly={ArrowLeft:lm,Left:lm,ArrowUp:"up",Up:"up",ArrowRight:lg,Right:lg,ArrowDown:lv,Down:lv},lb={left:function(e){return{x:-e,y:0}},up:function(e){return{x:0,y:-e}},right:function(e){return{x:e,y:0}},down:function(e){return{x:0,y:e}}};function lx(e,t,n,i,o){var r=this;this._config=(0,a.f0)({},lf,e||{}),t.addListener(1500,function(e){var n=e.keyEvent,i=ly[n.key];if(!(!i||t.isCmd(n))){var o=t.isShift(n);return r.moveSelection(i,o),!0}}),this.moveSelection=function(e,t){var r=o.get();if(r.length){var a=this._config[t?"moveSpeedAccelerated":"moveSpeed"],s=lb[e](a);i.allowed("elements.move",{shapes:r})&&n.moveElements(r,s)}}}function l_(e,t,n,i){this._dragging=i,this._rules=t;var o=this;e.on("resize.start",function(e){var t,n,i;n=(t=e.context).resizeConstraints,i=t.minBounds,void 0===n&&(void 0===i&&(i=o.computeMinResizeBox(t)),t.resizeConstraints={min:(0,j.JA)(i)})}),e.on("resize.move",function(e){var t,n,i,r,a,s,c,l={x:e.dx,y:e.dy};n=(t=e.context).shape,i=t.direction,r=t.resizeConstraints,t.delta=l,a=l.x,s=l.y,c={x:n.x,y:n.y,width:n.width,height:n.height},-1!==i.indexOf("n")?(c.y=n.y+s,c.height=n.height-s):-1!==i.indexOf("s")&&(c.height=n.height+s),-1!==i.indexOf("e")?c.width=n.width+a:-1!==i.indexOf("w")&&(c.x=n.x+a,c.width=n.width-a),t.newBounds=function(e,t){if(!t)return e;var n=(0,j.JA)(e);return(0,j.z_)({top:og("top",n,t),right:og("right",n,t),bottom:og("bottom",n,t),left:og("left",n,t)})}(c,r),t.canExecute=o.canResize(t)}),e.on("resize.end",function(e){!function(e){var t,i=e.shape,o=e.canExecute,r=e.newBounds;if(o){if(t=r=(0,j.aR)(r),i.x===t.x&&i.y===t.y&&i.width===t.width&&i.height===t.height)return;n.resizeShape(i,r)}}(e.context)})}function lw(e,t){var n=(0,j.wS)(e),i=(0,j.JA)(e),o={x:n.x,y:n.y};return -1!==t.indexOf("n")?o.y=i.top:-1!==t.indexOf("s")&&(o.y=i.bottom),-1!==t.indexOf("e")?o.x=i.right:-1!==t.indexOf("w")&&(o.x=i.left),o}lx.$inject=["config.keyboardMoveSelection","keyboard","modeling","rules","selection"],l_.prototype.canResize=function(e){var t=this._rules,n=(0,a.ei)(e,["newBounds","shape","delta","direction"]);return t.allowed("shape.resize",n)},l_.prototype.activate=function(e,t,n){var i,o,r,s=this._dragging;if("string"==typeof n&&(n={direction:n}),!(r=(o=(0,a.f0)({shape:t},n)).direction))throw Error("must provide a direction (n|w|s|e|nw|se|ne|sw)");s.init(e,lw(t,r),"resize",{autoActivate:!0,cursor:(i="resize-","n"===r||"s"===r?i+"ns":"e"===r||"w"===r?i+"ew":"nw"===r||"se"===r?i+"nwse":i+"nesw"),data:{shape:t,context:o}})},l_.prototype.computeMinResizeBox=function(e){var t,n,i,o,r,a,s=e.shape,c=e.direction;return r=e.minDimensions||{width:10,height:10},a=ob(s,e.childrenBoxPadding),t=(0,j.JA)(s),n={top:/n/.test(c)?t.bottom-r.height:t.top,left:/w/.test(c)?t.right-r.width:t.left,bottom:/s/.test(c)?t.top+r.height:t.bottom,right:/e/.test(c)?t.left+r.width:t.right},i=a?(0,j.JA)(a):n,o={top:of(n.top,i.top),left:of(n.left,i.left),bottom:od(n.bottom,i.bottom),right:od(n.right,i.right)},(0,j.z_)(o)},l_.$inject=["eventBus","rules","modeling","dragging"];var lE="djs-resizing",lS="resize-not-ok";function lk(e,t,n){e.on("resize.move",500,function(e){var i,o,r,a;o=(i=e.context).shape,r=i.newBounds,(a=i.frame)||(a=i.frame=n.addFrame(o,t.getActiveLayer()),t.addMarker(o,lE)),r.width>5&&(0,c.Lj)(a,{x:r.x,width:r.width}),r.height>5&&(0,c.Lj)(a,{y:r.y,height:r.height}),i.canExecute?(0,c.Sh)(a).remove(lS):(0,c.Sh)(a).add(lS)}),e.on("resize.cleanup",function(e){var n,i;i=(n=e.context).shape,n.frame&&(0,c.Od)(n.frame),t.removeMarker(i,lE)})}lk.$inject=["eventBus","canvas","previewSupport"];var lC="djs-resizer",lR=["n","w","s","e","nw","ne","se","sw"];function lP(e,t,n,i){this._resize=i,this._canvas=t;var o=this;e.on("selection.changed",function(e){var t=e.newSelection;o.removeResizers(),1===t.length&&(0,a.Ed)(t,(0,a.ak)(o.addResizer,o))}),e.on("shape.changed",function(e){var t=e.element;n.isSelected(t)&&(o.removeResizers(),o.addResizer(t))})}lP.prototype.makeDraggable=function(e,t,n){var i=this._resize;function o(t){tC(t)&&i.activate(t,e,n)}s.B.bind(t,"mousedown",o),s.B.bind(t,"touchstart",o)},lP.prototype._createResizer=function(e,t,n,i){var o,r=this._getResizersParent(),a=(o={x:0,y:0},-1!==i.indexOf("e")?o.x=6:-1!==i.indexOf("w")&&(o.x=-6),-1!==i.indexOf("s")?o.y=6:-1!==i.indexOf("n")&&(o.y=-6),o),s=(0,c.Ue)("g");(0,c.Sh)(s).add(lC),(0,c.Sh)(s).add(lC+"-"+e.id),(0,c.Sh)(s).add(lC+"-"+i),(0,c.R3)(r,s);var l=(0,c.Ue)("rect");(0,c.Lj)(l,{x:-4+a.x,y:-4+a.y,width:8,height:8}),(0,c.Sh)(l).add(lC+"-visual"),(0,c.R3)(s,l);var p=(0,c.Ue)("rect");return(0,c.Lj)(p,{x:-10+a.x,y:-10+a.y,width:20,height:20}),(0,c.Sh)(p).add(lC+"-hit"),(0,c.R3)(s,p),ei(s,t,n),s},lP.prototype.createResizer=function(e,t){var n=lw(e,t),i=this._createResizer(e,n.x,n.y,t);this.makeDraggable(e,i,t)},lP.prototype.addResizer=function(e){var t=this;!(0,eL.Ho)(e)&&this._resize.canResize({shape:e})&&(0,a.Ed)(lR,function(n){t.createResizer(e,n)})},lP.prototype.removeResizers=function(){var e=this._getResizersParent();(0,c.ZH)(e)},lP.prototype._getResizersParent=function(){return this._canvas.getLayer("resizers")},lP.$inject=["eventBus","canvas","selection","resize"];var lT={__depends__:[n5,n0,i0],__init__:["resize","resizePreview","resizeHandles"],resize:["type",l_],resizePreview:["type",lk],resizeHandles:["type",lP]};function lj(e,t,n,i,o,r,a){function s(e,t){(t||eg(e,["bpmn:Task","bpmn:TextAnnotation","bpmn:Participant"])||lD(e))&&i.activate(e)}this._bpmnFactory=t,this._canvas=n,this._modeling=o,this._textRenderer=a,i.registerProvider(this),e.on("element.dblclick",function(e){s(e.element,!0)}),e.on(["autoPlace.start","canvas.viewbox.changing","drag.init","element.mousedown","popupMenu.open","root.set","selection.changed"],function(){i.isActive()&&i.complete()}),e.on(["shape.remove","connection.remove"],2e3,function(e){i.isActive(e.element)&&i.cancel()}),e.on(["commandStack.changed"],function(e){i.isActive()&&i.cancel()}),e.on("directEditing.activate",function(e){r.removeResizers()}),e.on("create.end",500,function(e){var t=e.context,n=t.shape,i=e.context.canExecute;e.isTouch||!i||t.hints&&!1===t.hints.createElementsBehavior||s(n)}),e.on("autoPlace.end",500,function(e){s(e.shape)})}function lD(e){return em(e,"bpmn:SubProcess")&&!eD(e)}lj.$inject=["eventBus","bpmnFactory","canvas","directEditing","modeling","resizeHandles","textRenderer"],lj.prototype.activate=function(e){var t=eH(e);if(void 0!==t){var n={text:t},i=this.getEditingBBox(e);(0,a.f0)(n,i);var o={},r=n.style||{};return(0,a.f0)(r,{backgroundColor:null,border:null}),(eg(e,["bpmn:Task","bpmn:Participant","bpmn:Lane","bpmn:CallActivity"])||lD(e))&&(0,a.f0)(o,{centerVertically:!0}),eN(e)&&((0,a.f0)(o,{autoResize:!0}),(0,a.f0)(r,{backgroundColor:"#ffffff",border:"1px solid #ccc"})),em(e,"bpmn:TextAnnotation")&&((0,a.f0)(o,{resizable:!0,autoResize:!0}),(0,a.f0)(r,{backgroundColor:"#ffffff",border:"1px solid #ccc"})),(0,a.f0)(n,{options:o,style:r}),n}},lj.prototype.getEditingBBox=function(e){var t=this._canvas,n=e.label||e,i=t.getAbsoluteBBox(n),o={x:i.x+i.width/2,y:i.y+i.height/2},r={x:i.x,y:i.y},s=t.zoom(),c=this._textRenderer.getDefaultStyle(),l=this._textRenderer.getExternalStyle(),p=l.fontSize*s,h=l.lineHeight,u=c.fontSize*s,d=c.lineHeight,f={fontFamily:this._textRenderer.getDefaultStyle().fontFamily,fontWeight:this._textRenderer.getDefaultStyle().fontWeight};if(em(e,"bpmn:Lane")||em(e,"bpmn:Participant")&&eD(e)){var m=eB(e),g=m?{width:i.height,height:30*s,x:i.x-i.height/2+15*s,y:o.y-30*s/2}:{width:i.width,height:30*s};(0,a.f0)(r,g),(0,a.f0)(f,{fontSize:u+"px",lineHeight:d,paddingTop:7*s+"px",paddingBottom:7*s+"px",paddingLeft:5*s+"px",paddingRight:5*s+"px",transform:m?"rotate(-90deg)":null})}if(em(e,"bpmn:Participant")&&!eD(e)){var v=eB(e),y=v?{width:i.width,height:i.height}:{width:i.height,height:i.width,x:o.x-i.height/2,y:o.y-i.width/2};(0,a.f0)(r,y),(0,a.f0)(f,{fontSize:u+"px",lineHeight:d,paddingTop:7*s+"px",paddingBottom:7*s+"px",paddingLeft:5*s+"px",paddingRight:5*s+"px",transform:v?null:"rotate(-90deg)"})}(eg(e,["bpmn:Task","bpmn:CallActivity"])||lD(e))&&((0,a.f0)(r,{width:i.width,height:i.height}),(0,a.f0)(f,{fontSize:u+"px",lineHeight:d,paddingTop:7*s+"px",paddingBottom:7*s+"px",paddingLeft:5*s+"px",paddingRight:5*s+"px"})),em(e,"bpmn:SubProcess")&&eD(e)&&((0,a.f0)(r,{width:i.width,x:i.x}),(0,a.f0)(f,{fontSize:u+"px",lineHeight:d,paddingTop:7*s+"px",paddingBottom:7*s+"px",paddingLeft:5*s+"px",paddingRight:5*s+"px"}));var b=90*s,x=7*s,_=4*s;if(n.labelTarget&&((0,a.f0)(r,{width:b,height:i.height+x+_,x:o.x-b/2,y:i.y-x}),(0,a.f0)(f,{fontSize:p+"px",lineHeight:h,paddingTop:x+"px",paddingBottom:_+"px"})),eN(n)&&!e$(n)&&!(0,eL.j_)(n)){var w=eI(e),E=t.getAbsoluteBBox({x:w.x,y:w.y,width:0,height:0}),S=p+x+_;(0,a.f0)(r,{width:b,height:S,x:E.x-b/2,y:E.y-S/2}),(0,a.f0)(f,{fontSize:p+"px",lineHeight:h,paddingTop:x+"px",paddingBottom:_+"px"})}return em(e,"bpmn:TextAnnotation")&&((0,a.f0)(r,{width:i.width,height:i.height,minWidth:30*s,minHeight:10*s}),(0,a.f0)(f,{textAlign:"left",paddingTop:5*s+"px",paddingBottom:7*s+"px",paddingLeft:7*s+"px",paddingRight:5*s+"px",fontSize:u+"px",lineHeight:d})),{bounds:r,style:f}},lj.prototype.update=function(e,t,n,i){var o,r,a;em(e,"bpmn:TextAnnotation")&&(r=this._canvas.getAbsoluteBBox(e),o={x:e.x,y:e.y,width:e.width/r.width*i.width,height:e.height/r.height*i.height}),(a=t)&&a.trim()||(t=null),this._modeling.updateLabel(e,t,o)};var lB="djs-element-hidden",lM="djs-label-hidden";function lA(e,t,n){var i,o,r,a=this,s=t.getDefaultLayer();e.on("directEditing.activate",function(e){var l=e.active;if(em(i=l.element.label||l.element,"bpmn:TextAnnotation")){o=t.getAbsoluteBBox(i),r=(0,c.Ue)("g");var p=n.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:i.width,containerHeight:i.height,position:{mx:0,my:0}}),h=a.path=(0,c.Ue)("path");(0,c.Lj)(h,{d:p,strokeWidth:2,stroke:ey(i).get("stroke")||"black"}),(0,c.R3)(r,h),(0,c.R3)(s,r),eo(r,i.x,i.y)}em(i,"bpmn:TextAnnotation")||i.labelTarget?t.addMarker(i,lB):(em(i,"bpmn:Task")||em(i,"bpmn:CallActivity")||em(i,"bpmn:SubProcess")||em(i,"bpmn:Participant")||em(i,"bpmn:Lane"))&&t.addMarker(i,lM)}),e.on("directEditing.resize",function(e){if(em(i,"bpmn:TextAnnotation")){var t=e.height,r=e.dy,s=Math.max(i.height/o.height*(t+r),0),l=n.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:i.width,containerHeight:s,position:{mx:0,my:0}});(0,c.Lj)(a.path,{d:l})}}),e.on(["directEditing.complete","directEditing.cancel"],function(e){var n=e.active;n&&(t.removeMarker(n.element.label||n.element,lB),t.removeMarker(i,lM)),i=void 0,o=void 0,r&&((0,c.Od)(r),r=void 0)})}lA.$inject=["eventBus","canvas","pathMap"];var lL=new e8.Z("tt");function lO(e,t){e.style.display=!1===t?"none":""}var lN="djs-tooltip",l$="."+lN;function lI(e,t){this._eventBus=e,this._canvas=t,this._ids=lL,this._tooltipDefaults={show:{minZoom:.7,maxZoom:5}},this._tooltips={},this._tooltipRoot=(n=t.getContainer(),i=(0,s.H6)('<div class="djs-tooltip-container" />'),(0,s.i5)(i,{position:"absolute",width:"0",height:"0"}),n.insertBefore(i,n.firstChild),i);var n,i,o=this;s.cl.bind(this._tooltipRoot,l$,"mousedown",function(e){e.stopPropagation()}),s.cl.bind(this._tooltipRoot,l$,"mouseover",function(e){o.trigger("mouseover",e)}),s.cl.bind(this._tooltipRoot,l$,"mouseout",function(e){o.trigger("mouseout",e)}),this._init()}function lz(e,t,n){function i(e,n,i){t.add({position:{x:e.x+5,y:e.y+5},type:"error",timeout:i||2e3,html:"<div>"+n+"</div>"})}e.on(["shape.move.rejected","create.rejected"],function(e){var t=e.context,o=t.shape;em(t.target,"bpmn:Collaboration")&&(em(o,"bpmn:FlowNode")?i(e,n("flow elements must be children of pools/participants")):em(o,"bpmn:DataObjectReference")&&i(e,n("Data object must be placed within a pool/participant.")))})}function lH(e,t){this._eventBus=e,this.offset=5;var n=t.cls("djs-outline",["no-fill"]),i=this;function o(e){var t=(0,c.Ue)("rect");return(0,c.Lj)(t,(0,a.f0)({x:0,y:0,rx:4,width:100,height:100},n)),t}e.on(["shape.added","shape.changed"],500,function(e){var t=e.element,n=e.gfx,r=(0,s.IO)(".djs-outline",n);r||(r=i.getOutline(t)||o(n),(0,c.R3)(n,r)),i.updateShapeOutline(r,t)}),e.on(["connection.added","connection.changed"],function(e){var t=e.element,n=e.gfx,r=(0,s.IO)(".djs-outline",n);r||(r=o(n),(0,c.R3)(n,r)),i.updateConnectionOutline(r,t)})}function lF(e,t,n){this._canvas=t;var i=this;e.on("element.changed",function(e){n.isSelected(e.element)&&i._updateMultiSelectionOutline(n.get())}),e.on("selection.changed",function(e){var t=e.newSelection;i._updateMultiSelectionOutline(t)})}lI.$inject=["eventBus","canvas"],lI.prototype.add=function(e){if(!e.position)throw Error("must specifiy tooltip position");if(!e.html)throw Error("must specifiy tooltip html");var t=this._ids.next();return e=(0,a.f0)({},this._tooltipDefaults,e,{id:t}),this._addTooltip(e),e.timeout&&this.setTimeout(e),t},lI.prototype.trigger=function(e,t){var n=t.delegateTarget||t.target,i=this.get((0,s.Lj)(n,"data-tooltip-id"));i&&("mouseover"===e&&i.timeout&&this.clearTimeout(i),"mouseout"===e&&i.timeout&&(i.timeout=1e3,this.setTimeout(i)))},lI.prototype.get=function(e){return"string"!=typeof e&&(e=e.id),this._tooltips[e]},lI.prototype.clearTimeout=function(e){if(e=this.get(e)){var t=e.removeTimer;t&&(clearTimeout(t),e.removeTimer=null)}},lI.prototype.setTimeout=function(e){if(e=this.get(e)){this.clearTimeout(e);var t=this;e.removeTimer=setTimeout(function(){t.remove(e)},e.timeout)}},lI.prototype.remove=function(e){var t=this.get(e);t&&((0,s.Od)(t.html),(0,s.Od)(t.htmlContainer),delete t.htmlContainer,delete this._tooltips[t.id])},lI.prototype.show=function(){lO(this._tooltipRoot)},lI.prototype.hide=function(){lO(this._tooltipRoot,!1)},lI.prototype._updateRoot=function(e){var t=e.scale||1,n=e.scale||1,i="matrix("+t+",0,0,"+n+","+-1*e.x*t+","+-1*e.y*n+")";this._tooltipRoot.style.transform=i,this._tooltipRoot.style["-ms-transform"]=i},lI.prototype._addTooltip=function(e){var t,n=e.id,i=e.html,o=this._tooltipRoot;i.get&&i.constructor.prototype.jquery&&(i=i.get(0)),(0,a.HD)(i)&&(i=(0,s.H6)(i)),t=(0,s.H6)('<div data-tooltip-id="'+n+'" class="'+lN+'">'),(0,s.i5)(t,{position:"absolute"}),t.appendChild(i),e.type&&(0,s.Sh)(t).add("djs-tooltip-"+e.type),e.className&&(0,s.Sh)(t).add(e.className),e.htmlContainer=t,o.appendChild(t),this._tooltips[n]=e,this._updateTooltip(e)},lI.prototype._updateTooltip=function(e){var t,n,i,o=e.position;t=e.htmlContainer,n=o.x,i=o.y,(0,s.i5)(t,{left:n+"px",top:i+"px"})},lI.prototype._updateTooltipVisibilty=function(e){(0,a.Ed)(this._tooltips,function(t){var n=t.show,i=t.htmlContainer,o=!0;n&&((n.minZoom>e.scale||n.maxZoom<e.scale)&&(o=!1),lO(i,o))})},lI.prototype._init=function(){var e=this;this._eventBus.on("canvas.viewbox.changing",function(t){e.hide()}),this._eventBus.on("canvas.viewbox.changed",function(t){var n;n=t.viewbox,e._updateRoot(n),e._updateTooltipVisibilty(n),e.show()})},lz.$inject=["eventBus","tooltips","translate"],lH.prototype.updateShapeOutline=function(e,t){var n=!1,i=this._getProviders();i.length&&(0,a.Ed)(i,function(i){n=n||i.updateOutline(t,e)}),n||(0,c.Lj)(e,{x:-this.offset,y:-this.offset,width:t.width+2*this.offset,height:t.height+2*this.offset})},lH.prototype.updateConnectionOutline=function(e,t){var n=_(t);(0,c.Lj)(e,{x:n.x-this.offset,y:n.y-this.offset,width:n.width+2*this.offset,height:n.height+2*this.offset})},lH.prototype.registerProvider=function(e,t){t||(t=e,e=1e3),this._eventBus.on("outline.getProviders",e,function(e){e.providers.push(t)})},lH.prototype._getProviders=function(){var e=this._eventBus.createEvent({type:"outline.getProviders",providers:[]});return this._eventBus.fire(e),e.providers},lH.prototype.getOutline=function(e){var t,n=this._getProviders();return(0,a.Ed)(n,function(n){(0,a.mf)(n.getOutline)&&(t=t||n.getOutline(e))}),t},lH.$inject=["eventBus","styles","elementRegistry"],lF.prototype._updateMultiSelectionOutline=function(e){var t=this._canvas.getLayer("selectionOutline");(0,c.ZH)(t);var n=e.length>1,i=this._canvas.getContainer();if((0,c.Sh)(i)[n?"add":"remove"]("djs-multi-select"),n){var o,r={x:(o=_(e)).x-6,y:o.y-6,width:o.width+12,height:o.height+12},s=(0,c.Ue)("rect");(0,c.Lj)(s,(0,a.f0)({rx:3},r)),(0,c.Sh)(s).add("djs-selection-outline"),(0,c.R3)(t,s)}},lF.$inject=["eventBus","canvas","selection"];var lG={__depends__:[tI],__init__:["outline","multiSelectionOutline"],outline:["type",lH],multiSelectionOutline:["type",lF]},lW=Math.round;function lV(e,t,n,i,o){function r(e,t,n,i){return o.allowed("elements.move",{shapes:e,delta:t,position:n,target:i})}function s(e,n,i,o){if((0,a.Kn)(i)&&(o=i,i=!1),!(n.waypoints||!n.parent||(0,c.Sh)(e.target).has("djs-hit-no-move"))){var r={x:n.x+lW(n.width/2),y:n.y+lW(n.height/2)};return t.init(e,r,"shape.move",{cursor:"grabbing",autoActivate:i,data:{shape:n,context:o||{}}}),!0}}e.on("shape.move.start",1500,function(e){var t,n,o=e.context,r=e.shape,s=i.get().slice();-1===s.indexOf(r)&&(s=[r]),t=s,n=(0,a.vM)(t,"id"),s=(0,a.hX)(t,function(e){for(;e=e.parent;)if(n[e.id])return!1;return!0}),(0,a.f0)(o,{shapes:s,validatedShapes:s,shape:r})}),e.on("shape.move.start",1250,function(e){var t=e.context,n=t.validatedShapes;if(!(t.canExecute=r(n)))return!1}),e.on("shape.move.move",500,function(e){var t,n=e.context,i=n.validatedShapes,o=e.hover,a={x:e.dx,y:e.dy};if(t=r(i,a,{x:e.x,y:e.y},o),n.delta=a,n.canExecute=t,null===t){n.target=null;return}n.target=o}),e.on("shape.move.end",function(e){var t=e.context,i=t.delta,o=t.canExecute,r=t.shapes;if(!1===o)return!1;i.x=lW(i.x),i.y=lW(i.y),(0!==i.x||0!==i.y)&&n.moveElements(r,i,t.target,{primaryShape:t.shape,attach:"attach"===o})}),e.on("element.mousedown",function(e){if(tC(e)){var t=t_(e);if(!t)throw Error("must supply DOM mousedown event");return s(t,e.element)}}),this.start=s}lV.$inject=["eventBus","dragging","modeling","selection","rules"];var lU="djs-dragging",lZ="drop-ok",lK="drop-not-ok",lJ="new-parent",lq="attach-ok";function lX(e,t,n,i){function o(e){var t=x(e,!0),n=t.flatMap(e=>(e.incoming||[]).concat(e.outgoing||[]));return[...new Set(t.concat(n))]}function r(e,n){[lq,lZ,lK,lJ].forEach(function(i){i===n?t.addMarker(e,i):t.removeMarker(e,i)})}e.on("shape.move.start",499,function(e){var r,s=e.context,l=s.shapes,p=s.allDraggedElements,h=(r=o(l),(0,a.hX)(r,function(e){return!(0,eL.Ho)(e)||(0,a.sE)(r,(0,a.KQ)({id:e.source.id}))&&(0,a.sE)(r,(0,a.KQ)({id:e.target.id}))}));if(!s.dragGroup){var u=(0,c.Ue)("g");(0,c.Lj)(u,n.cls("djs-drag-group",["no-events"]));var d=t.getActiveLayer();(0,c.R3)(d,u),s.dragGroup=u}h.forEach(function(e){i.addDragger(e,s.dragGroup)}),p=p?(0,a.xH)([p,o(l)]):o(l),(0,a.Ed)(p,function(e){t.addMarker(e,lU)}),s.allDraggedElements=p,s.differentParents=1!==(0,a.dp)((0,a.vM)(l,function(e){return e.parent&&e.parent.id}))}),e.on("shape.move.move",499,function(e){var t=e.context,n=t.dragGroup,i=t.target,o=t.shape.parent,a=t.canExecute;i&&("attach"===a?r(i,lq):t.canExecute&&o&&i.id!==o.id?r(i,lJ):r(i,t.canExecute?lZ:lK)),eo(n,e.dx,e.dy)}),e.on(["shape.move.out","shape.move.cleanup"],function(e){var t=e.context.target;t&&r(t,null)}),e.on("shape.move.cleanup",function(e){var n=e.context,i=n.allDraggedElements,o=n.dragGroup;(0,a.Ed)(i,function(e){t.removeMarker(e,lU)}),o&&(0,c.Od)(o)}),this.makeDraggable=function(e,n,o){i.addDragger(n,e.dragGroup),o&&t.addMarker(n,lU),e.allDraggedElements?e.allDraggedElements.push(n):e.allDraggedElements=[n]}}lX.$inject=["eventBus","canvas","styles","previewSupport"];var lY=".djs-palette-toggle",lQ=".entry",l0=lY+", "+lQ,l1="djs-palette-",l2="open",l5="two-column";function l3(e,t){this._eventBus=e,this._canvas=t;var n=this;e.on("tool-manager.update",function(e){var t=e.tool;n.updateToolHighlight(t)}),e.on("i18n.changed",function(){n._update()}),e.on("diagram.init",function(){n._diagramInitialized=!0,n._rebuild()})}function l6(e,t){var n=t.getPaletteEntries();return(0,a.mf)(n)?n(e):((0,a.Ed)(n,function(t,n){e[n]=t}),e)}l3.$inject=["eventBus","canvas"],l3.prototype.registerProvider=function(e,t){t||(t=e,e=1e3),this._eventBus.on("palette.getProviders",e,function(e){e.providers.push(t)}),this._rebuild()},l3.prototype.getEntries=function(){return this._getProviders().reduce(l6,{})},l3.prototype._rebuild=function(){this._diagramInitialized&&this._getProviders().length&&(this._container||this._init(),this._update())},l3.prototype._init=function(){var e=this,t=this._eventBus,n=this._getParentContainer(),i=this._container=(0,s.H6)(l3.HTML_MARKUP);n.appendChild(i),(0,s.Sh)(n).add(l1+"shown"),s.cl.bind(i,l0,"click",function(t){var n=t.delegateTarget;if((0,s.wB)(n,lY))return e.toggle();e.trigger("click",t)}),s.B.bind(i,"mousedown",function(e){e.stopPropagation()}),s.cl.bind(i,lQ,"dragstart",function(t){e.trigger("dragstart",t)}),t.on("canvas.resized",this._layoutChanged,this),t.fire("palette.create",{container:i})},l3.prototype._getProviders=function(e){var t=this._eventBus.createEvent({type:"palette.getProviders",providers:[]});return this._eventBus.fire(t),t.providers},l3.prototype._toggleState=function(e){e=e||{};var t,n=this._getParentContainer(),i=this._container,o=this._eventBus,r=(0,s.Sh)(i),a=(0,s.Sh)(n);t="twoColumn"in e?e.twoColumn:this._needsCollapse(n.clientHeight,this._entries||{}),r.toggle(l5,t),a.toggle(l1+l5,t),"open"in e&&(r.toggle(l2,e.open),a.toggle(l1+l2,e.open)),o.fire("palette.changed",{twoColumn:t,open:this.isOpen()})},l3.prototype._update=function(){var e=(0,s.IO)(".djs-palette-entries",this._container),t=this._entries=this.getEntries();(0,s.ZH)(e),(0,a.Ed)(t,function(t,n){var i=t.group||"default",o=(0,s.IO)("[data-group="+(0,tp.D)(i)+"]",e);o||(o=(0,s.H6)('<div class="group"></div>'),(0,s.Lj)(o,"data-group",i),e.appendChild(o));var r=t.html||(t.separator?'<hr class="separator" />':'<div class="entry" draggable="true"></div>'),c=(0,s.H6)(r);if(o.appendChild(c),!t.separator&&((0,s.Lj)(c,"data-action",n),t.title&&(0,s.Lj)(c,"title",t.title),t.className&&function(e,t){var n=(0,s.Sh)(e);((0,a.kJ)(t)?t:t.split(/\s+/g)).forEach(function(e){n.add(e)})}(c,t.className),t.imageUrl)){var l=(0,s.H6)("<img>");(0,s.Lj)(l,"src",t.imageUrl),c.appendChild(l)}}),this.open()},l3.prototype.trigger=function(e,t,n){var i,o,r=t.delegateTarget||t.target;return r?(i=(0,s.Lj)(r,"data-action"),o=t.originalEvent||t,this.triggerEntry(i,e,o,n)):t.preventDefault()},l3.prototype.triggerEntry=function(e,t,n,i){var o,r;if((o=this._entries[e])&&(r=o.action,!1!==this._eventBus.fire("palette.trigger",{entry:o,event:n}))){if((0,a.mf)(r)){if("click"===t)return r(n,i)}else if(r[t])return r[t](n,i);n.preventDefault()}},l3.prototype._layoutChanged=function(){this._toggleState({})},l3.prototype._needsCollapse=function(e,t){return e<46*Object.keys(t).length+50},l3.prototype.close=function(){this._toggleState({open:!1,twoColumn:!1})},l3.prototype.open=function(){this._toggleState({open:!0})},l3.prototype.toggle=function(){this.isOpen()?this.close():this.open()},l3.prototype.isActiveTool=function(e){return e&&this._activeTool===e},l3.prototype.updateToolHighlight=function(e){var t,n;this._toolsContainer||(t=(0,s.IO)(".djs-palette-entries",this._container),this._toolsContainer=(0,s.IO)("[data-group=tools]",t)),n=this._toolsContainer,(0,a.Ed)(n.children,function(t){var n=t.getAttribute("data-action");if(n){var i=(0,s.Sh)(t);n=n.replace("-tool",""),i.contains("entry")&&n===e?i.add("highlighted-entry"):i.remove("highlighted-entry")}})},l3.prototype.isOpen=function(){return(0,s.Sh)(this._container).has(l2)},l3.prototype._getParentContainer=function(){return this._canvas.getContainer()},l3.HTML_MARKUP='<div class="djs-palette"><div class="djs-palette-entries"></div><div class="djs-palette-toggle"></div></div>';var l4="crosshair";function l9(e,t,n,i,o,r,a){this._selection=o,this._dragging=n,this._mouse=a;var s=this,l=function(e){var n,i=t.getActiveLayer();n=e.frame=(0,c.Ue)("rect"),(0,c.Lj)(n,{class:"djs-lasso-overlay",width:1,height:1,x:0,y:0}),(0,c.R3)(i,n)},p=function(e){var t=e.frame,n=e.bbox;(0,c.Lj)(t,{x:n.x,y:n.y,width:n.width,height:n.height})},h=function(e){e.frame&&(0,c.Od)(e.frame)};r.registerTool("lasso",{tool:"lasso.selection",dragging:"lasso"}),e.on("lasso.selection.end",function(t){var n=t.originalEvent.target;(t.hover||n instanceof SVGElement)&&e.once("lasso.selection.ended",function(){s.activateLasso(t.originalEvent,!0)})}),e.on("lasso.end",0,function(e){var t=e.context,n=l8(e),o=i.filter(function(e){return e}),r=tP(e);s.select(o,n,r?t.selection:[])}),e.on("lasso.start",function(e){var t=e.context;t.bbox=l8(e),l(t),t.selection=o.get()}),e.on("lasso.move",function(e){var t=e.context;t.bbox=l8(e),p(t)}),e.on("lasso.cleanup",function(e){h(e.context)}),e.on("element.mousedown",1500,function(e){if(tP(e))return s.activateLasso(e.originalEvent),!0})}function l8(e){var t={x:e.x-e.dx,y:e.y-e.dy},n={x:e.x,y:e.y};return t.x<=n.x&&t.y<n.y||t.x<n.x&&t.y<=n.y?{x:t.x,y:t.y,width:n.x-t.x,height:n.y-t.y}:t.x>=n.x&&t.y<n.y||t.x>n.x&&t.y<=n.y?{x:n.x,y:t.y,width:t.x-n.x,height:n.y-t.y}:t.x<=n.x&&t.y>n.y||t.x<n.x&&t.y>=n.y?{x:t.x,y:n.y,width:n.x-t.x,height:t.y-n.y}:t.x>=n.x&&t.y>n.y||t.x>n.x&&t.y>=n.y?{x:n.x,y:n.y,width:t.x-n.x,height:t.y-n.y}:{x:n.x,y:n.y,width:0,height:0}}l9.$inject=["eventBus","canvas","dragging","elementRegistry","selection","toolManager","mouse"],l9.prototype.activateLasso=function(e,t){this._dragging.init(e,"lasso",{autoActivate:t,cursor:l4,data:{context:{}}})},l9.prototype.activateSelection=function(e,t){this._dragging.init(e,"lasso.selection",{trapClick:!1,autoActivate:t,cursor:l4,data:{context:{}},keepSelection:!0})},l9.prototype.select=function(e,t,n=[]){var i=w(e,t);this._selection.select([...n,...(0,a.VO)(i)])},l9.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateSelection(e,!!e)},l9.prototype.isActive=function(){var e=this._dragging.context();return e&&/^lasso/.test(e.prefix)};var l7="grab";function pe(e,t,n,i,o,r){this._dragging=n,this._mouse=r;var a=this,s=i.get("keyboard",!1);o.registerTool("hand",{tool:"hand",dragging:"hand.move"}),e.on("element.mousedown",1500,function(e){if(tR(e))return a.activateMove(e.originalEvent,!0),!1}),s&&s.addListener(1500,function(e){if(!(!pt(e.keyEvent)||a.isActive())){var t=a._mouse.getLastMoveEvent();a.activateMove(t,!!t)}},"keyboard.keydown"),s&&s.addListener(1500,function(e){pt(e.keyEvent)&&a.isActive()&&a.toggle()},"keyboard.keyup"),e.on("hand.end",function(t){var n=t.originalEvent.target;if(!t.hover&&!(n instanceof SVGElement))return!1;e.once("hand.ended",function(){a.activateMove(t.originalEvent,{reactivate:!0})})}),e.on("hand.move.move",function(e){var n=t.viewbox().scale;t.scroll({dx:e.dx*n,dy:e.dy*n})}),e.on("hand.move.end",function(t){var n=t.context.reactivate;return!tR(t)&&n&&e.once("hand.move.ended",function(e){a.activateHand(e.originalEvent,!0,!0)}),!1})}function pt(e){return(0,tH.ot)("Space",e)}pe.$inject=["eventBus","canvas","dragging","injector","toolManager","mouse"],pe.prototype.activateMove=function(e,t,n){"object"==typeof t&&(n=t,t=!1),this._dragging.init(e,"hand.move",{autoActivate:t,cursor:l7,data:{context:n||{}}})},pe.prototype.activateHand=function(e,t,n){this._dragging.init(e,"hand",{trapClick:!1,autoActivate:t,cursor:l7,data:{context:{reactivate:n}}})},pe.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateHand(e,!!e)},pe.prototype.isActive=function(){var e=this._dragging.context();return!!e&&/^(hand|hand\.move)$/.test(e.prefix)};var pn="connect-ok",pi="connect-not-ok";function po(e,t,n,i,o,r,a){var s=this;this._dragging=t,this._rules=r,this._mouse=a,o.registerTool("global-connect",{tool:"global-connect",dragging:"global-connect.drag"}),e.on("global-connect.hover",function(e){var t=e.context,n=e.hover,o=t.canStartConnect=s.canStartConnect(n);null!==o&&(t.startTarget=n,i.addMarker(n,o?pn:pi))}),e.on(["global-connect.out","global-connect.cleanup"],function(e){var t=e.context.startTarget,n=e.context.canStartConnect;t&&i.removeMarker(t,n?pn:pi)}),e.on(["global-connect.ended"],function(t){var i=t.context.startTarget,o={x:t.x,y:t.y};if(s.canStartConnect(i))return e.once("element.out",function(){e.once(["connect.ended","connect.canceled"],function(){e.fire("global-connect.drag.ended")}),n.start(null,i,o)}),!1})}function pr(e,t,n,i,o,r,a,s){this._palette=e,this._create=t,this._elementFactory=n,this._spaceTool=i,this._lassoTool=o,this._handTool=r,this._globalConnect=a,this._translate=s,e.registerProvider(this)}function pa(e,t,n,i,o){ts.call(this,e),e.on("shape.move.move",250,function(e){var r,l,p=e.context,h=p.canExecute;(p.visualReplacements||(p.visualReplacements={}),h&&h.replacements)?(r=p.canExecute.replacements,(0,a.Ed)(r,function(e){var r=e.oldElementId,l={type:e.newElementType};if(!p.visualReplacements[r]){var h=t.get(r);(0,a.f0)(l,{x:h.x,y:h.y});var u=n.createShape(l);i.addShape(u,h.parent);var d=(0,s.IO)('[data-element-id="'+(0,tp.D)(h.id)+'"]',p.dragGroup);d&&(0,c.Lj)(d,{display:"none"});var f=o.addDragger(u,p.dragGroup);p.visualReplacements[r]=f,i.removeShape(u)}})):(l=p.visualReplacements,(0,a.Ed)(l,function(e,t){var n=(0,s.IO)('[data-element-id="'+(0,tp.D)(t)+'"]',p.dragGroup);n&&(0,c.Lj)(n,{display:"inline"}),e.remove(),l[t]&&delete l[t]}))})}po.$inject=["eventBus","dragging","connect","canvas","toolManager","rules","mouse"],po.prototype.start=function(e,t){this._dragging.init(e,"global-connect",{autoActivate:t,trapClick:!1,data:{context:{}}})},po.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();return this.start(e,!!e)},po.prototype.isActive=function(){var e=this._dragging.context();return e&&/^global-connect/.test(e.prefix)},po.prototype.canStartConnect=function(e){return this._rules.allowed("connection.start",{source:e})},pr.$inject=["palette","create","elementFactory","spaceTool","lassoTool","handTool","globalConnect","translate"],pr.prototype.getPaletteEntries=function(){var e={},t=this._create,n=this._elementFactory,i=this._spaceTool,o=this._lassoTool,r=this._handTool,s=this._globalConnect,c=this._translate;function l(e,i,o,r,s){function c(i){var o=n.createShape((0,a.f0)({type:e},s));t.start(i,o)}return{group:i,className:o,title:r,action:{dragstart:c,click:c}}}function p(e){var i=n.createShape({type:"bpmn:SubProcess",x:0,y:0,isExpanded:!0}),o=n.createShape({type:"bpmn:StartEvent",x:40,y:82,parent:i});t.start(e,[i,o],{hints:{autoSelect:[i]}})}function h(e){t.start(e,n.createParticipantShape())}return(0,a.f0)(e,{"hand-tool":{group:"tools",className:"bpmn-icon-hand-tool",title:c("Activate hand tool"),action:{click:function(e){r.activateHand(e)}}},"lasso-tool":{group:"tools",className:"bpmn-icon-lasso-tool",title:c("Activate lasso tool"),action:{click:function(e){o.activateSelection(e)}}},"space-tool":{group:"tools",className:"bpmn-icon-space-tool",title:c("Activate create/remove space tool"),action:{click:function(e){i.activateSelection(e)}}},"global-connect-tool":{group:"tools",className:"bpmn-icon-connection-multi",title:c("Activate global connect tool"),action:{click:function(e){s.start(e)}}},"tool-separator":{group:"tools",separator:!0},"create.start-event":l("bpmn:StartEvent","event","bpmn-icon-start-event-none",c("Create start event")),"create.intermediate-event":l("bpmn:IntermediateThrowEvent","event","bpmn-icon-intermediate-event-none",c("Create intermediate/boundary event")),"create.end-event":l("bpmn:EndEvent","event","bpmn-icon-end-event-none",c("Create end event")),"create.exclusive-gateway":l("bpmn:ExclusiveGateway","gateway","bpmn-icon-gateway-none",c("Create gateway")),"create.task":l("bpmn:Task","activity","bpmn-icon-task",c("Create task")),"create.data-object":l("bpmn:DataObjectReference","data-object","bpmn-icon-data-object",c("Create data object reference")),"create.data-store":l("bpmn:DataStoreReference","data-store","bpmn-icon-data-store",c("Create data store reference")),"create.subprocess-expanded":{group:"activity",className:"bpmn-icon-subprocess-expanded",title:c("Create expanded sub-process"),action:{dragstart:p,click:p}},"create.participant-expanded":{group:"collaboration",className:"bpmn-icon-participant",title:c("Create pool/participant"),action:{dragstart:h,click:h}},"create.group":l("bpmn:Group","artifact","bpmn-icon-group",c("Create group"))}),e},pa.$inject=["eventBus","elementRegistry","elementFactory","canvas","previewSupport"],(0,o.Z)(pa,ts);var ps=["x","y"],pc=Math.abs;function pl(e){e.on(["connect.hover","connect.move","connect.end"],1250,function(e){var t,n,i,o=e.context,r=o.canExecute,s=o.start,c=o.hover,l=o.source,p=o.target;!(e.originalEvent&&(0,tH.JS)(e.originalEvent))&&(o.initialConnectionStart||(o.initialConnectionStart=o.connectionStart),r&&c&&(t=em(c,"bpmn:Task")?10:20,ps.forEach(function(n){var i=ph(n,c);e[n]<c[n]+t?i$(e,n,c[n]+t):e[n]>c[n]+i-t&&i$(e,n,c[n]+i-t)})),c&&(n=["bpmn:Association","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:SequenceFlow"],(0,a.G)(n,function(e){return r&&r.type===e}))?(o.connectionStart=iO(s),eg(c,["bpmn:Event","bpmn:Gateway"])&&pp(e,iO(c)),eg(c,["bpmn:Task","bpmn:SubProcess"])&&(i=iO(c),ps.forEach(function(t){e[t]>c[t]+20&&e[t]<c[t]+ph(t,c)-20&&i$(e,t,i[t])})),em(l,"bpmn:BoundaryEvent")&&p===l.host&&function(e){var t,n,i=e.context,o=i.source,r=i.target;if(t=i.hover,n=i.source,!t||!n||t!==n){var a=iO(o),s=(0,j.T8)(a,r,-10),c=[];/top|bottom/.test(s)&&c.push("x"),/left|right/.test(s)&&c.push("y"),c.forEach(function(t){var n,i=e[t];40>pc(i-a[t])&&(n=i>a[t]?a[t]+40:a[t]-40,i$(e,t,n))})}}(e)):r&&"bpmn:MessageFlow"===r.type?(em(s,"bpmn:Event")&&(o.connectionStart=iO(s)),em(c,"bpmn:Event")&&pp(e,iO(c))):o.connectionStart=o.initialConnectionStart)})}function pp(e,t){i$(e,"x",t.x),i$(e,"y",t.y)}function ph(e,t){return"x"===e?t.width:t.height}function pu(){this._targets={},this._snapOrigins={},this._snapLocations=[],this._defaultSnaps={}}function pd(){this._snapValues={}}function pf(e,t,n){var i=this;this._elementRegistry=e,t.on(["create.start","shape.move.start"],function(e){i.initSnap(e)}),t.on(["create.move","create.end","shape.move.move","shape.move.end"],1250,function(e){var t=e.context,o=t.shape,r=t.snapContext,a=t.target;if(!(e.originalEvent&&(0,tH.JS)(e.originalEvent)||iN(e)||!a)){var s=r.pointsForTarget(a);s.initialized||((s=i.addSnapTargetPoints(s,o,a)).initialized=!0),n.snap(e,s)}}),t.on(["create.cleanup","shape.move.cleanup"],function(){n.hide()})}function pm(e,t){t.invoke(pf,this),e.on(["create.move","create.end"],1500,pg),e.on(["create.move","create.end","shape.move.move","shape.move.end"],1500,function(e){var t,n,i,o,r=e.context,a=r.canExecute,s=r.target;a&&("attach"===a||a.attach)&&!iN(e)&&(n=(0,j.JA)(s),i=rH(e,s),t=(o=e.context.shape).parent?{x:0,y:0}:(0,j.wS)(o),/top/.test(i)?i$(e,"y",n.top-t.y):/bottom/.test(i)&&i$(e,"y",n.bottom-t.y),/left/.test(i)?i$(e,"x",n.left-t.x):/right/.test(i)&&i$(e,"x",n.right-t.x))})}function pg(e){var t=e.context.createConstraints;if(t){var n=t.top,i=t.right,o=t.bottom,r=t.left;(r&&r>=e.x||i&&i<=e.x)&&i$(e,"x",e.x),(n&&n>=e.y||o&&o<=e.y)&&i$(e,"y",e.y)}}function pv(e,t){return -1!==e.indexOf(t)}function py(e,t,n){return t?{x:e.x-n.x,y:e.y-n.y}:{x:e.x,y:e.y}}function pb(e,t){var n=this;e.on(["resize.start"],function(e){n.initSnap(e)}),e.on(["resize.move","resize.end"],1250,function(e){var i=e.context,o=i.shape,r=o.parent,a=i.direction,s=i.snapContext;if(!(e.originalEvent&&(0,tH.JS)(e.originalEvent)||iN(e))){var c=s.pointsForTarget(r);c.initialized||((c=n.addSnapTargetPoints(c,o,r,a)).initialized=!0),("n"===a||"s"===a)&&i$(e,"x",e.x),("e"===a||"w"===a)&&i$(e,"y",e.y),t.snap(e,c)}}),e.on(["resize.cleanup"],function(){t.hide()})}function px(e,t){var n=(0,j.wS)(e),i=(0,j.JA)(e),o={x:n.x,y:n.y};return -1!==t.indexOf("n")?o.y=i.top:-1!==t.indexOf("s")&&(o.y=i.bottom),-1!==t.indexOf("e")?o.x=i.right:-1!==t.indexOf("w")&&(o.x=i.left),o}function p_(e){this._canvas=e,this._asyncHide=(0,a.Ds)((0,a.ak)(this.hide,this),1e3)}function pw(e,t,n,i){this._open=!1,this._results={},this._eventMaps=[],this._cachedRootElement=null,this._cachedSelection=null,this._cachedViewbox=null,this._canvas=e,this._eventBus=t,this._selection=n,this._translate=i,this._container=this._getBoxHtml(),this._searchInput=(0,s.IO)(pw.INPUT_SELECTOR,this._container),this._resultsContainer=(0,s.IO)(pw.RESULTS_CONTAINER_SELECTOR,this._container),this._canvas.getContainer().appendChild(this._container),t.on(["canvas.destroy","diagram.destroy","drag.init","elements.changed"],this.close,this)}function pE(e,t,n){var i,o=(i="",t.forEach(function(e){var t=(0,tp.r)(e.value||e.matched||e.normal);e.match||e.matched?i+='<b class="'+pw.RESULT_HIGHLIGHT_CLASS+'">'+t+"</b>":i+=t}),""!==i?i:null),r=(0,s.H6)(n);r.innerHTML=o,e.appendChild(r)}function pS(e,t,n,i){this._elementRegistry=e,this._canvas=n,this._search=i,t.registerProvider(this)}function pk(e){let{item:{element:t},tokens:n}=e;return{element:t,primaryTokens:n.label,secondaryTokens:n.id}}pl.$inject=["eventBus"],pu.prototype.getSnapOrigin=function(e){return this._snapOrigins[e]},pu.prototype.setSnapOrigin=function(e,t){this._snapOrigins[e]=t,-1===this._snapLocations.indexOf(e)&&this._snapLocations.push(e)},pu.prototype.addDefaultSnap=function(e,t){var n=this._defaultSnaps[e];n||(n=this._defaultSnaps[e]=[]),n.push(t)},pu.prototype.getSnapLocations=function(){return this._snapLocations},pu.prototype.setSnapLocations=function(e){this._snapLocations=e},pu.prototype.pointsForTarget=function(e){var t=e.id||e,n=this._targets[t];return n||(n=this._targets[t]=new pd).initDefaults(this._defaultSnaps),n},pd.prototype.add=function(e,t){var n=this._snapValues[e];n||(n=this._snapValues[e]={x:[],y:[]}),-1===n.x.indexOf(t.x)&&n.x.push(t.x),-1===n.y.indexOf(t.y)&&n.y.push(t.y)},pd.prototype.snap=function(e,t,n,i){var o=this._snapValues[t];return o&&function(e,t,n){var i,o;for(i=0,n=void 0===n?10:n;i<t.length;i++)if(iB((o=t[i])-e)<=n)return o}(e[n],o[n],i)},pd.prototype.initDefaults=function(e){var t=this;(0,a.Ed)(e||{},function(e,n){(0,a.Ed)(e,function(e){t.add(n,e)})})},pf.$inject=["elementRegistry","eventBus","snapping"],pf.prototype.initSnap=function(e){var t,n=this._elementRegistry,i=e.context,o=i.shape,r=i.snapContext;r||(r=i.snapContext=new pu);var a={x:(t=n.get(o.id)?iO(o,e):{x:e.x+iO(o).x,y:e.y+iO(o).y}).x-o.width/2,y:t.y-o.height/2},s={x:t.x+o.width/2,y:t.y+o.height/2};return r.setSnapOrigin("mid",{x:t.x-e.x,y:t.y-e.y}),(0,eL.j_)(o)||(r.setSnapOrigin("top-left",{x:a.x-e.x,y:a.y-e.y}),r.setSnapOrigin("bottom-right",{x:s.x-e.x,y:s.y-e.y})),r},pf.prototype.addSnapTargetPoints=function(e,t,n){var i=this.getSnapTargets(t,n);return(0,a.Ed)(i,function(n){if((0,eL.j_)(n)){(0,eL.j_)(t)&&e.add("mid",iO(n));return}if((0,eL.Ho)(n)){if(n.waypoints.length<3)return;var i=n.waypoints.slice(1,-1);(0,a.Ed)(i,function(t){e.add("mid",t)});return}e.add("mid",iO(n))}),(0,a.hj)(t.x)&&(0,a.hj)(t.y)&&this._elementRegistry.get(t.id)&&e.add("mid",iO(t)),e},pf.prototype.getSnapTargets=function(e,t){return iI(t).filter(function(e){return!e.hidden})},(0,o.Z)(pm,pf),pm.$inject=["eventBus","injector"],pm.prototype.initSnap=function(e){var t=pf.prototype.initSnap.call(this,e),n=e.shape,i=!!this._elementRegistry.get(n.id);return(0,a.Ed)(n.outgoing,function(n){var o=n.waypoints[0];o=o.original||o,t.setSnapOrigin(n.id+"-docking",py(o,i,e))}),(0,a.Ed)(n.incoming,function(n){var o=n.waypoints[n.waypoints.length-1];o=o.original||o,t.setSnapOrigin(n.id+"-docking",py(o,i,e))}),em(n,"bpmn:Participant")&&t.setSnapLocations(["top-left","bottom-right","mid"]),t},pm.prototype.addSnapTargetPoints=function(e,t,n){pf.prototype.addSnapTargetPoints.call(this,e,t,n);var i=this.getSnapTargets(t,n);(0,a.Ed)(i,function(n){var i;(em(n,"bpmn:SubProcess")&&eD(n)||em(n,"bpmn:Participant")||(i="bpmn:TextAnnotation",[t,n].every(function(e){return em(e,i)})))&&(e.add("top-left",iA(n)),e.add("bottom-right",iL(n)))});var o=this._elementRegistry;return(0,a.Ed)(t.incoming,function(n){if(o.get(t.id)){pv(i,n.source)||e.add("mid",(0,j.wS)(n.source));var r=n.waypoints[0];e.add(n.id+"-docking",r.original||r)}}),(0,a.Ed)(t.outgoing,function(n){if(o.get(t.id)){pv(i,n.target)||e.add("mid",(0,j.wS)(n.target));var r=n.waypoints[n.waypoints.length-1];e.add(n.id+"-docking",r.original||r)}}),em(n,"bpmn:SequenceFlow")&&(e=this.addSnapTargetPoints(e,t,n.parent)),e},pm.prototype.getSnapTargets=function(e,t){return pf.prototype.getSnapTargets.call(this,e,t).filter(function(e){return!em(e,"bpmn:Lane")})},pb.prototype.initSnap=function(e){var t=e.context,n=t.shape,i=t.direction,o=t.snapContext;o||(o=t.snapContext=new pu);var r=px(n,i);return o.setSnapOrigin("corner",{x:r.x-e.x,y:r.y-e.y}),o},pb.prototype.addSnapTargetPoints=function(e,t,n,i){var o=this.getSnapTargets(t,n);return(0,a.Ed)(o,function(t){e.add("corner",iL(t)),e.add("corner",iA(t))}),e.add("corner",px(t,i)),e},pb.$inject=["eventBus","snapping"],pb.prototype.getSnapTargets=function(e,t){return iI(t).filter(function(t){return t.host!==e&&!(0,eL.Ho)(t)&&!t.hidden&&!(0,eL.j_)(t)})},p_.$inject=["canvas"],p_.prototype.snap=function(e,t){var n=e.context.snapContext,i=n.getSnapLocations(),o={x:iN(e,"x"),y:iN(e,"y")};(0,a.Ed)(i,function(i){var r=n.getSnapOrigin(i),s={x:e.x+r.x,y:e.y+r.y};if((0,a.Ed)(["x","y"],function(e){var n;o[e]||void 0===(n=t.snap(s,i,e,7))||(o[e]={value:n,originValue:n-r[e]})}),o.x&&o.y)return!1}),this.showSnapLine("vertical",o.x&&o.x.value),this.showSnapLine("horizontal",o.y&&o.y.value),(0,a.Ed)(["x","y"],function(t){var n=o[t];(0,a.Kn)(n)&&i$(e,t,n.originValue)})},p_.prototype._createLine=function(e){var t=this._canvas.getLayer("snap"),n=(0,c.Ue)("path");return(0,c.Lj)(n,{d:"M0,0 L0,0"}),(0,c.Sh)(n).add("djs-snap-line"),(0,c.R3)(t,n),{update:function(t){(0,a.hj)(t)?"horizontal"===e?(0,c.Lj)(n,{d:"M-100000,"+t+" L+100000,"+t,display:""}):(0,c.Lj)(n,{d:"M "+t+",-100000 L "+t+", +100000",display:""}):(0,c.Lj)(n,{display:"none"})}}},p_.prototype._createSnapLines=function(){this._snapLines={horizontal:this._createLine("horizontal"),vertical:this._createLine("vertical")}},p_.prototype.showSnapLine=function(e,t){var n=this.getSnapLine(e);n&&n.update(t),this._asyncHide()},p_.prototype.getSnapLine=function(e){return this._snapLines||this._createSnapLines(),this._snapLines[e]},p_.prototype.hide=function(){(0,a.Ed)(this._snapLines,function(e){e.update()})},pw.$inject=["canvas","eventBus","selection","translate"],pw.prototype._bindEvents=function(){var e=this;function t(t,n,i,o){e._eventMaps.push({el:t,type:i,listener:s.cl.bind(t,n,i,o)})}t(document,"html","click",function(t){e.close(!1)}),t(this._container,pw.INPUT_SELECTOR,"click",function(e){e.stopPropagation(),e.delegateTarget.focus()}),t(this._container,pw.RESULT_SELECTOR,"mouseover",function(t){t.stopPropagation(),e._scrollToNode(t.delegateTarget),e._preselect(t.delegateTarget)}),t(this._container,pw.RESULT_SELECTOR,"click",function(t){t.stopPropagation(),e._select(t.delegateTarget)}),t(this._container,pw.INPUT_SELECTOR,"keydown",function(e){(0,tH.ot)("ArrowUp",e)&&e.preventDefault(),(0,tH.ot)("ArrowDown",e)&&e.preventDefault()}),t(this._container,pw.INPUT_SELECTOR,"keyup",function(t){if((0,tH.ot)("Escape",t))return e.close();if((0,tH.ot)("Enter",t)){var n=e._getCurrentResult();return n?e._select(n):e.close(!1)}return(0,tH.ot)("ArrowUp",t)?e._scrollToDirection(!0):(0,tH.ot)("ArrowDown",t)?e._scrollToDirection():(0,tH.ot)(["ArrowLeft","ArrowRight"],t)?void 0:void e._search(t.delegateTarget.value)})},pw.prototype._unbindEvents=function(){this._eventMaps.forEach(function(e){s.cl.unbind(e.el,e.type,e.listener)})},pw.prototype._search=function(e){var t=this;if(this._clearResults(),e.trim()){var n=this._searchProvider.find(e);if(!(n=n.filter(function(e){return!t._canvas.getRootElements().includes(e.element)})).length){this._selection.select(null);return}n.forEach(function(e){var n=e.element.id,i=t._createResultNode(e,n);t._results[n]={element:e.element,node:i}});var i=(0,s.IO)(pw.RESULT_SELECTOR,this._resultsContainer);this._scrollToNode(i),this._preselect(i)}},pw.prototype._scrollToDirection=function(e){var t=this._getCurrentResult();if(t){var n=e?t.previousElementSibling:t.nextElementSibling;n&&(this._scrollToNode(n),this._preselect(n))}},pw.prototype._scrollToNode=function(e){if(e&&e!==this._getCurrentResult()){var t=e.offsetTop,n=this._resultsContainer.scrollTop,i=t-this._resultsContainer.clientHeight+e.clientHeight;t<n?this._resultsContainer.scrollTop=t:n<i&&(this._resultsContainer.scrollTop=i)}},pw.prototype._clearResults=function(){(0,s.ZH)(this._resultsContainer),this._results={},this._eventBus.fire("searchPad.cleared")},pw.prototype._getCurrentResult=function(){return(0,s.IO)(pw.RESULT_SELECTED_SELECTOR,this._resultsContainer)},pw.prototype._createResultNode=function(e,t){var n=(0,s.H6)(pw.RESULT_HTML);return e.primaryTokens.length>0&&pE(n,e.primaryTokens,pw.RESULT_PRIMARY_HTML),pE(n,e.secondaryTokens,pw.RESULT_SECONDARY_HTML),(0,s.Lj)(n,pw.RESULT_ID_ATTRIBUTE,t),this._resultsContainer.appendChild(n),n},pw.prototype.registerProvider=function(e){this._searchProvider=e},pw.prototype.open=function(){if(!this._searchProvider)throw Error("no search provider registered");this.isOpen()||(this._cachedRootElement=this._canvas.getRootElement(),this._cachedSelection=this._selection.get(),this._cachedViewbox=this._canvas.viewbox(),this._selection.select(null),this._bindEvents(),this._open=!0,(0,s.Sh)(this._canvas.getContainer()).add("djs-search-open"),(0,s.Sh)(this._container).add("open"),this._searchInput.focus(),this._eventBus.fire("searchPad.opened"))},pw.prototype.close=function(e=!0){this.isOpen()&&(e&&(this._cachedRootElement&&this._canvas.setRootElement(this._cachedRootElement),this._cachedSelection&&this._selection.select(this._cachedSelection),this._cachedViewbox&&this._canvas.viewbox(this._cachedViewbox),this._eventBus.fire("searchPad.restored")),this._cachedRootElement=null,this._cachedSelection=null,this._cachedViewbox=null,this._unbindEvents(),this._open=!1,(0,s.Sh)(this._canvas.getContainer()).remove("djs-search-open"),(0,s.Sh)(this._container).remove("open"),this._clearResults(),this._searchInput.value="",this._searchInput.blur(),this._eventBus.fire("searchPad.closed"),this._canvas.restoreFocus())},pw.prototype.toggle=function(){this.isOpen()?this.close():this.open()},pw.prototype.isOpen=function(){return this._open},pw.prototype._preselect=function(e){var t=this._getCurrentResult();if(e!==t){t&&(0,s.Sh)(t).remove(pw.RESULT_SELECTED_CLASS);var n=(0,s.Lj)(e,pw.RESULT_ID_ATTRIBUTE),i=this._results[n].element;(0,s.Sh)(e).add(pw.RESULT_SELECTED_CLASS),this._canvas.scrollToElement(i,{top:300}),this._selection.select(i),this._eventBus.fire("searchPad.preselected",i)}},pw.prototype._select=function(e){var t=(0,s.Lj)(e,pw.RESULT_ID_ATTRIBUTE),n=this._results[t].element;this._cachedSelection=null,this._cachedViewbox=null,this.close(!1),this._canvas.scrollToElement(n,{top:300}),this._selection.select(n),this._eventBus.fire("searchPad.selected",n)},pw.prototype._getBoxHtml=function(){let e=(0,s.H6)(pw.BOX_HTML),t=(0,s.IO)(pw.INPUT_SELECTOR,e);return t&&t.setAttribute("aria-label",this._translate("Search in diagram")),e},pw.CONTAINER_SELECTOR=".djs-search-container",pw.INPUT_SELECTOR=".djs-search-input input",pw.RESULTS_CONTAINER_SELECTOR=".djs-search-results",pw.RESULT_SELECTOR=".djs-search-result",pw.RESULT_SELECTED_CLASS="djs-search-result-selected",pw.RESULT_SELECTED_SELECTOR="."+pw.RESULT_SELECTED_CLASS,pw.RESULT_ID_ATTRIBUTE="data-result-id",pw.RESULT_HIGHLIGHT_CLASS="djs-search-highlight",pw.BOX_HTML=`<div class="djs-search-container djs-scrollable">
  <div class="djs-search-input">
    <svg class="djs-search-icon" width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path fill-rule="evenodd" clip-rule="evenodd" d="M9.0325 8.5H9.625L13.3675 12.25L12.25 13.3675L8.5 9.625V9.0325L8.2975 8.8225C7.4425 9.5575 6.3325 10 5.125 10C2.4325 10 0.25 7.8175 0.25 5.125C0.25 2.4325 2.4325 0.25 5.125 0.25C7.8175 0.25 10 2.4325 10 5.125C10 6.3325 9.5575 7.4425 8.8225 8.2975L9.0325 8.5ZM1.75 5.125C1.75 6.9925 3.2575 8.5 5.125 8.5C6.9925 8.5 8.5 6.9925 8.5 5.125C8.5 3.2575 6.9925 1.75 5.125 1.75C3.2575 1.75 1.75 3.2575 1.75 5.125Z" fill="#22242A"/>
    </svg>
    <input type="text" spellcheck="false" />
  </div>
  <div class="djs-search-results" />
</div>`,pw.RESULT_HTML='<div class="djs-search-result"></div>',pw.RESULT_PRIMARY_HTML='<div class="djs-search-result-primary"></div>',pw.RESULT_SECONDARY_HTML='<p class="djs-search-result-secondary"></p>',pS.$inject=["elementRegistry","searchPad","canvas","search"],pS.prototype.find=function(e){var t=this._canvas.getRootElements(),n=this._elementRegistry.filter(function(e){return!(0,eL.j_)(e)&&!t.includes(e)});return this._search(n.map(e=>({element:e,label:eH(e),id:e.id})),e,{keys:["label","id"]}).map(pk)};let pC={width:36,height:50},pR={width:50,height:50};function pP(e,t,n){return(0,c.Ue)("path",{d:e,strokeWidth:2,transform:`translate(${t.x}, ${t.y})`,...n})}function pT(e,t){this._styles=t,e.registerProvider(this)}function pj(e,t){var n;return"bpmn:DataObjectReference"===t?n=pC:"bpmn:DataStoreReference"===t&&(n=pR),e.width===n.width&&e.height===n.height}function pD(e){ej.call(this,e)}pT.$inject=["outline","styles"],pT.prototype.getOutline=function(e){var t;let n=this._styles.cls("djs-outline",["no-fill"]);if(!(0,eL.j_)(e))return em(e,"bpmn:Gateway")?(t=(0,c.Ue)("rect"),(0,a.f0)(t.style,{"transform-box":"fill-box",transform:"rotate(45deg)","transform-origin":"center"}),(0,c.Lj)(t,(0,a.f0)({x:2,y:2,rx:4,width:e.width-4,height:e.height-4},n))):eg(e,["bpmn:Task","bpmn:SubProcess","bpmn:Group","bpmn:CallActivity"])?(t=(0,c.Ue)("rect"),(0,c.Lj)(t,(0,a.f0)({x:-5,y:-5,rx:14,width:e.width+10,height:e.height+10},n))):em(e,"bpmn:EndEvent")?(t=(0,c.Ue)("circle"),(0,c.Lj)(t,(0,a.f0)({cx:e.width/2,cy:e.height/2,r:e.width/2+5+1},n))):em(e,"bpmn:Event")?(t=(0,c.Ue)("circle"),(0,c.Lj)(t,(0,a.f0)({cx:e.width/2,cy:e.height/2,r:e.width/2+5},n))):em(e,"bpmn:DataObjectReference")&&pj(e,"bpmn:DataObjectReference")?t=pP("M44.7648 11.3263L36.9892 2.64074C36.0451 1.58628 34.5651 0.988708 33.1904 0.988708H5.98667C3.22688 0.988708 0.989624 3.34892 0.989624 6.26039V55.0235C0.989624 57.9349 3.22688 60.2952 5.98667 60.2952H40.966C43.7257 60.2952 45.963 57.9349 45.963 55.0235V14.9459C45.963 13.5998 45.6407 12.3048 44.7648 11.3263Z",{x:-6,y:-6},n):em(e,"bpmn:DataStoreReference")&&pj(e,"bpmn:DataStoreReference")&&(t=pP("M1.03845 48.1347C1.03845 49.3511 1.07295 50.758 1.38342 52.064C1.69949 53.3938 2.32428 54.7154 3.56383 55.6428C6.02533 57.4841 10.1161 58.7685 14.8212 59.6067C19.5772 60.4538 25.1388 60.8738 30.6831 60.8738C36.2276 60.8738 41.7891 60.4538 46.545 59.6067C51.2504 58.7687 55.3412 57.4842 57.8028 55.6429C59.0424 54.7156 59.6673 53.3938 59.9834 52.064C60.2938 50.7579 60.3285 49.351 60.3285 48.1344V13.8415C60.3285 12.6249 60.2938 11.218 59.9834 9.91171C59.6673 8.58194 59.0423 7.2602 57.8027 6.33294C55.341 4.49168 51.2503 3.20723 46.545 2.36914C41.7891 1.522 36.2276 1.10204 30.6831 1.10205C25.1388 1.10206 19.5772 1.52206 14.8213 2.36923C10.1162 3.20734 6.02543 4.49183 3.5639 6.33314C2.32433 7.26038 1.69951 8.58206 1.38343 9.91181C1.07295 11.2179 1.03845 12.6247 1.03845 13.8411V48.1347Z",{x:-6,y:-6},n)),t},pT.prototype.updateOutline=function(e,t){return(0,eL.j_)(e)?void 0:eg(e,["bpmn:SubProcess","bpmn:Group"])?((0,c.Lj)(t,{width:e.width+10,height:e.height+10}),!0):!!eg(e,["bpmn:Event","bpmn:Gateway","bpmn:DataStoreReference","bpmn:DataObjectReference"])},(0,o.Z)(pD,ej),pD.Viewer=tz,pD.NavigatedViewer=t7,pD.prototype.createDiagram=function(){return this.importXML('<?xml version="1.0" encoding="UTF-8"?><bpmn:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" targetNamespace="http://bpmn.io/schema/bpmn" id="Definitions_1"><bpmn:process id="Process_1" isExecutable="false"><bpmn:startEvent id="StartEvent_1"/></bpmn:process><bpmndi:BPMNDiagram id="BPMNDiagram_1"><bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1"><bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1"><dc:Bounds height="36.0" width="36.0" x="173.0" y="102.0"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></bpmn:definitions>')},pD.prototype._interactionModules=[tJ,t2,t8],pD.prototype._modelingModules=[{__depends__:[{__init__:["alignElements"],alignElements:["type",no]},nl,nC],__init__:["alignElementsContextPadProvider","alignElementsMenuProvider","bpmnAlignElements"],alignElementsContextPadProvider:["type",nP],alignElementsMenuProvider:["type",nj],bpmnAlignElements:["type",nB]},nW,{__depends__:[n0],__init__:["autoScroll"],autoScroll:["type",n1]},{__init__:["bpmnAutoResize","bpmnAutoResizeProvider"],bpmnAutoResize:["type",nU],bpmnAutoResizeProvider:["type",nK]},{__depends__:[n0,n5],__init__:["bendpoints","bendpointSnapping","bendpointMovePreview"],bendpoints:["type",ih],bendpointMove:["type",iv],bendpointMovePreview:["type",ik],connectionSegmentMove:["type",iD],bendpointSnapping:["type",iF]},iK,{__init__:["connectionPreview"],connectionPreview:["type",iJ]},{__depends__:[{__depends__:[nW,{__depends__:[i0],__init__:["complexPreview"],complexPreview:["type",i2]},cR],__init__:["appendPreview"],appendPreview:["type",cT]},cO,nl,tI,iK,ax,{__depends__:[nC,aI,nW],__init__:["replaceMenuProvider"],replaceMenuProvider:["type",c0]}],__init__:["contextPadProvider"],contextPadProvider:["type",c1]},aD,ax,{__depends__:[nC,{__init__:["distributeElements"],distributeElements:["type",c3]}],__init__:["bpmnDistributeElements","distributeElementsMenuProvider"],bpmnDistributeElements:["type",c6],distributeElementsMenuProvider:["type",c9]},{__depends__:[{__init__:["editorActions"],editorActions:["type",c7]}],editorActions:["type",lt]},{__depends__:[{__depends__:[{__init__:["gridSnappingResizeBehavior","gridSnappingSpaceToolBehavior"],gridSnappingResizeBehavior:["type",ls],gridSnappingSpaceToolBehavior:["type",lc]}],__init__:["gridSnapping"],gridSnapping:["type",lo]},{__init__:["gridSnappingAutoPlaceBehavior","gridSnappingParticipantBehavior","gridSnappingLayoutConnectionBehavior"],gridSnappingAutoPlaceBehavior:["type",ll],gridSnappingParticipantBehavior:["type",lp],gridSnappingLayoutConnectionBehavior:["type",lh]}],__init__:["bpmnGridSnapping"],bpmnGridSnapping:["type",ln]},{__init__:["bpmnInteractionEvents"],bpmnInteractionEvents:["type",lu]},{__depends__:[tU],__init__:["keyboardBindings"],keyboardBindings:["type",ld]},{__depends__:[tU,tI],__init__:["keyboardMoveSelection"],keyboardMoveSelection:["type",lx]},{__depends__:[ta,lT,cO],__init__:["labelEditingProvider","labelEditingPreview"],labelEditingProvider:["type",lj],labelEditingPreview:["type",lA]},cR,{__depends__:[{__init__:["tooltips"],tooltips:["type",lI]}],__init__:["modelingFeedback"],modelingFeedback:["type",lz]},{__depends__:[tB,tI,lG,n5,n0,i0],__init__:["move","movePreview"],move:["type",lV],movePreview:["type",lX]},{__depends__:[{__init__:["palette"],palette:["type",l3]},ax,a3,{__depends__:[aH,aw],__init__:["lassoTool"],lassoTool:["type",l9]},{__depends__:[aH,aw],__init__:["handTool"],handTool:["type",pe]},{__depends__:[iK,n5,n0,aH,aw],globalConnect:["type",po]},e3],__init__:["paletteProvider"],paletteProvider:["type",pr]},{__depends__:[i0],__init__:["bpmnReplacePreview"],bpmnReplacePreview:["type",pa]},lT,{__depends__:[{__init__:["createMoveSnapping","resizeSnapping","snapping"],createMoveSnapping:["type",pf],resizeSnapping:["type",pb],snapping:["type",p_]}],__init__:["connectSnapping","createMoveSnapping"],connectSnapping:["type",pl],createMoveSnapping:["type",pm]},{__depends__:[{__depends__:[e3,to,tI],searchPad:["type",pw]},nk],__init__:["bpmnSearch"],bpmnSearch:["type",pS]},{__depends__:[lG],__init__:["outlineProvider"],outlineProvider:["type",pT]}],pD.prototype._modules=[].concat(tz.prototype._modules,pD.prototype._interactionModules,pD.prototype._modelingModules)},4092:function(e,t,n){n.d(t,{Z:function(){return p}});var i=n(1334),o=n(891),r=n(3630),a=n(8661),s=function(){return(s=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},c=function(){function e(e,t,n){var i=this;this._config=s({smallGridSpacing:10,gridSpacing:100,gridLineStroke:.5,gridLineOpacity:.4,gridLineColor:"#ccc"},e||{}),this._canvas=t,this._visible=!1,n.on("diagram.init",function(){i._init(),i.toggle(!0)}),n.on("gridSnapping.toggle",function(e){var t=e.active;i.toggle(t),i._centerGridAroundViewbox()}),n.on("canvas.viewbox.changed",function(e){var t=e.viewbox;i._centerGridAroundViewbox(t)})}return e.prototype._init=function(){var e=(0,o.IO)("defs",this._canvas._svg);e||(e=(0,i.Ue)("defs"),(0,i.R3)(this._canvas._svg,e));var t=(0,i.Ue)("pattern"),n="djs-small-grid-pattern-"+l();(0,i.Lj)(t,{id:n,width:this._config.smallGridSpacing,height:this._config.smallGridSpacing,patternUnits:"userSpaceOnUse"});var r=(0,i.Ue)("path");(0,i.Lj)(r,{d:"M ".concat(this._config.smallGridSpacing,",0 L 0,0 0,").concat(this._config.smallGridSpacing," ").concat(this._config.smallGridSpacing,",").concat(this._config.smallGridSpacing," Z"),fill:"none",stroke:this._config.gridLineColor,strokeWidth:this._config.gridLineStroke,opacity:this._config.gridLineOpacity}),(0,i.R3)(t,r);var a=this._pattern=(0,i.Ue)("pattern"),s="djs-grid-pattern-"+l();(0,i.Lj)(a,{id:s,width:this._config.gridSpacing,height:this._config.gridSpacing,patternUnits:"userSpaceOnUse"});var c=(0,i.Ue)("path");(0,i.Lj)(c,{d:"M ".concat(this._config.gridSpacing,",0 L 0,0 0,").concat(this._config.gridSpacing," ").concat(this._config.gridSpacing,",").concat(this._config.gridSpacing," Z"),fill:"none",stroke:this._config.gridLineColor,strokeWidth:2*this._config.gridLineStroke,opacity:2*this._config.gridLineOpacity}),(0,i.R3)(a,c);var p=(0,i.Ue)("rect");(0,i.Lj)(p,{width:this._config.gridSpacing,height:this._config.gridSpacing,fill:"url(#".concat(n,")")}),(0,i.R3)(a,p),(0,i.R3)(e,t),(0,i.R3)(e,a);var h=this._gfx=(0,i.Ue)("rect");(0,i.Lj)(h,{x:-5e4,y:-5e4,width:1e5,height:1e5,fill:"url(#".concat(s,")")})},e.prototype._centerGridAroundViewbox=function(e){e||(e=this._canvas.viewbox());var t=(0,a.wS)(e);(0,i.Lj)(this._gfx,{x:-5e4+(0,r.q)(t.x,this._config.gridSpacing,"round"),y:-5e4+(0,r.q)(t.y,this._config.gridSpacing,"round")})},e.prototype.isVisible=function(){return this._visible},e.prototype.toggle=function(e){if(void 0===e&&(e=!this._visible),e!==this._visible){var t=this._getParent();e?(0,i.R3)(t,this._gfx):(0,i.ZH)(t),this._visible=e}},e.prototype._getParent=function(){return this._canvas.getLayer("djs-grid-line",-2)},e}();function l(){return Math.round(1e6*Math.random())}c.$inject=["config.gridLine","canvas","eventBus"];var p={__init__:["gridLineBg"],gridLineBg:["type",c]}},7960:function(e,t,n){n.d(t,{Z:function(){return b}});var i=n(891),o=n(1334),r=n(785),a=n(5694),s=n(2722),c=new(n(725)).Z,l={min:.2,max:4};function p(e,t,n,o,a){var s=this;function p(e){(!s._state._svgClientRect||f(s._state._svgClientRect))&&(s._state._svgClientRect=s._svg.getBoundingClientRect()),u(h({x:e.x-s._state._svgClientRect.left,y:e.y-s._state._svgClientRect.top},s._svg,s._lastViewbox),s._canvas),s._update()}function d(e){return function(t){var n,a=y(t);(!s._state._svgClientRect||f(s._state._svgClientRect))&&(s._state._svgClientRect=s._svg.getBoundingClientRect()),e&&p(a);var c=h({x:a.x-s._state._svgClientRect.left,y:a.y-s._state._svgClientRect.top},s._svg,s._lastViewbox),l=o.viewbox(),u=(n={x:l.x+l.width/2,y:l.y+l.height/2},{x:c.x-n.x,y:c.y-n.y}),d=s._viewportDom.getBoundingClientRect(),m={x:a.x-d.left+1,y:a.y-d.top+1};(0,r.f0)(s._state,{cachedViewbox:l,initialDragPosition:{x:a.x,y:a.y},isDragging:!0,offsetViewport:u,offsetViewportDom:m,viewportClientRect:s._viewport.getBoundingClientRect(),parentClientRect:s._parent.getBoundingClientRect()}),i.B.bind(document,"mousemove",v),i.B.bind(document,"mouseup",b)}}function v(e){var t=y(e);if(s._state.isDragging){(!s._state._svgClientRect||f(s._state._svgClientRect))&&(s._state._svgClientRect=s._svg.getBoundingClientRect());var n=s._state.offsetViewportDom,i=s._state.viewportClientRect,o=s._state.parentClientRect;(0,r.f0)(s._viewportDom.style,{top:t.y-n.y-o.top+"px",left:t.x-n.x-o.left+"px"});var a=g(o,{top:t.y-n.y-o.top,left:t.x-n.x-o.left,width:i.width,height:i.height});(0,r.f0)(s._overlay.style,{clipPath:a});var c=h({x:t.x-s._state._svgClientRect.left,y:t.y-s._state._svgClientRect.top},s._svg,s._lastViewbox);u({x:c.x-s._state.offsetViewport.x,y:c.y-s._state.offsetViewport.y},s._canvas)}}function b(e){var t=y(e);s._state.isDragging&&(s._state.initialDragPosition.x===t.x&&s._state.initialDragPosition.y===t.y&&p(e),s._update(),(0,r.f0)(s._state,{cachedViewbox:null,initialDragPosition:null,isDragging:!1,offsetViewport:null,offsetViewportDom:null}),i.B.unbind(document,"mousemove",v),i.B.unbind(document,"mouseup",b))}this._canvas=o,this._elementRegistry=a,this._eventBus=n,this._injector=t,this._state={isOpen:void 0,isDragging:!1,initialDragPosition:null,offsetViewport:null,cachedViewbox:null,dragger:null,svgClientRect:null,parentClientRect:null,zoomDelta:0},this._minimapId=c.next(),this._init(),this.toggle(e&&e.open||!1),i.B.bind(this._viewportDom,"mousedown",d(!1)),i.B.bind(this._svg,"mousedown",d(!0)),i.B.bind(this._parent,"wheel",function(e){if(e.preventDefault(),e.stopPropagation(),e.ctrlKey&&((!s._state._svgClientRect||f(s._state._svgClientRect))&&(s._state._svgClientRect=s._svg.getBoundingClientRect()),i=s._state._svgClientRect,e.x>i.left&&e.x<i.left+i.width&&e.y>i.top&&e.y<i.top+i.height)){var t=0===e.deltaMode?.02:.32,n=-(Math.sqrt(Math.pow(e.deltaY,2)+Math.pow(e.deltaX,2))*m(e.deltaY)*t);if(s._state.zoomDelta+=n,Math.abs(s._state.zoomDelta)>.1){var i,r=Math.log(o.zoom())/Math.log(10),a=(Math.abs(Math.log(l.min)/Math.log(10))+Math.abs(Math.log(l.max)/Math.log(10)))/20,c=Math.round(r/a)*a,p=Math.pow(10,c+=a*(n>0?1:-1));o.zoom(Math.max(l.min,Math.min(l.max,p)),d),s._state.zoomDelta=0;var d=h({x:e.clientX-s._state._svgClientRect.left,y:e.clientY-s._state._svgClientRect.top},s._svg,s._lastViewbox);u(d,s._canvas),s._update()}}}),i.B.bind(this._toggle,"click",function(e){e.preventDefault(),e.stopPropagation(),s.toggle()}),n.on(["shape.added","connection.added"],function(e){var t=e.element;s._addElement(t),s._update()}),n.on(["shape.removed","connection.removed"],function(e){var t=e.element;s._removeElement(t),s._update()}),n.on("elements.changed",250,function(e){e.elements.forEach(function(e){s._updateElement(e)}),s._update()}),n.on("element.updateId",function(e){var t=e.element,n=e.newId;s._updateElementId(t,n)}),n.on("canvas.viewbox.changed",function(){s._state.isDragging||s._update()}),n.on("canvas.resized",function(){document.body.contains(s._parent)&&(s._state.isDragging||s._update(),s._state._svgClientRect=s._svg.getBoundingClientRect())}),n.on(["root.set","plane.set"],function(e){s._clear(),(e.element||e.plane.rootElement).children.forEach(function(e){s._addElement(e)}),s._update()})}function h(e,t,n){var i,o,a,s,c,l,p=t.getBoundingClientRect(),h=function(e,t){var n=e.width/e.height,i=(0,r.f0)({},{x:e.x,y:e.y,width:e.width,height:e.height});if(n>t){var o=i.width*(1/t),a=i.y-(o-i.height)/2;(0,r.f0)(i,{y:a,height:o})}else if(n<t){var s=i.height*t,c=i.x-(s-i.width)/2;(0,r.f0)(i,{x:c,width:s})}return i}(n,p.width/p.height);return{x:(i=e.x,o=p.width,a=h.x,(i-0)*(h.x+h.width-a)/(o-0)+a),y:(s=e.y,c=p.height,l=h.y,(s-0)*(h.y+h.height-l)/(c-0)+l)}}function u(e,t){var n=t.viewbox(),i=n.width,o=n.height;t.viewbox({x:e.x-i/2,y:e.y-o/2,width:i,height:o})}function d(e,t,n){var r,a=((r=(0,i.IO)(".children",t))||(r=(0,o.Ue)("g",{class:"children"}),(0,o.R3)(t,r)),r),s=[].slice.call(a.childNodes)[n];s?t.insertBefore(e,s.nextSibling):t.appendChild(e)}function f(e){return 0===e.width&&0===e.height}p.$inject=["config.minimap","injector","eventBus","canvas","elementRegistry"],p.prototype._init=function(){var e=this._canvas.getContainer(),t=this._parent=document.createElement("div");(0,i.Sh)(t).add("djs-minimap"),e.appendChild(t);var n=this._toggle=document.createElement("div");(0,i.Sh)(n).add("toggle"),t.appendChild(n);var r=this._map=document.createElement("div");(0,i.Sh)(r).add("map"),t.appendChild(r);var a=this._svg=(0,o.Ue)("svg");(0,o.Lj)(a,{width:"100%",height:"100%"}),(0,o.R3)(r,a);var s=this._elementsGroup=(0,o.Ue)("g");(0,o.R3)(a,s);var c=this._viewportGroup=(0,o.Ue)("g");(0,o.R3)(a,c);var l=this._viewport=(0,o.Ue)("rect");(0,o.Sh)(l).add("viewport"),(0,o.R3)(c,l),i.B.bind(t,"mousedown",function(e){e.stopPropagation()});var p=this._viewportDom=document.createElement("div");(0,i.Sh)(p).add("viewport-dom"),this._parent.appendChild(p);var h=this._overlay=document.createElement("div");(0,i.Sh)(h).add("overlay"),this._parent.appendChild(h)},p.prototype._update=function(){var e,t,n,i,a=this._canvas.viewbox(),s=a.inner,c=a.outer;if(function e(t){return(0,r.yW)(t,function(t){return(0,r.Kn)(t)?e(t):(0,r.hj)(t)&&isFinite(t)})}(a)){var l=c.width-s.width,p=c.height-s.height;s.width<c.width?(e=s.x-l/2,n=c.width,s.x+s.width<c.width&&(e=Math.min(0,s.x))):(e=s.x,n=s.width),s.height<c.height?(t=s.y-p/2,i=c.height,s.y+s.height<c.height&&(t=Math.min(0,s.y))):(t=s.y,i=s.height),e-=50,t-=50,n+=100,i+=100,this._lastViewbox={x:e,y:t,width:n,height:i},(0,o.Lj)(this._svg,{viewBox:e+", "+t+", "+n+", "+i}),(0,o.Lj)(this._viewport,{x:a.x,y:a.y,width:a.width,height:a.height});var h=this._state._parentClientRect=this._parent.getBoundingClientRect(),u=this._viewport.getBoundingClientRect(),d={top:u.top-h.top,left:u.left-h.left,width:u.width,height:u.height};(0,r.f0)(this._viewportDom.style,{top:d.top+"px",left:d.left+"px",width:d.width+"px",height:d.height+"px"});var f=g(h,d);(0,r.f0)(this._overlay.style,{clipPath:f})}},p.prototype.open=function(){(0,r.f0)(this._state,{isOpen:!0}),(0,i.Sh)(this._parent).add("open");var e=this._injector.get("translate",!1)||function(e){return e};(0,i.Lj)(this._toggle,"title",e("Close minimap")),this._update(),this._eventBus.fire("minimap.toggle",{open:!0})},p.prototype.close=function(){(0,r.f0)(this._state,{isOpen:!1}),(0,i.Sh)(this._parent).remove("open");var e=this._injector.get("translate",!1)||function(e){return e};(0,i.Lj)(this._toggle,"title",e("Open minimap")),this._eventBus.fire("minimap.toggle",{open:!1})},p.prototype.toggle=function(e){var t=this.isOpen();void 0===e&&(e=!t),e!=t&&(e?this.open():this.close())},p.prototype.isOpen=function(){return this._state.isOpen},p.prototype._updateElement=function(e){try{void 0!==e.parent&&null!==e.parent&&(this._removeElement(e),this._addElement(e))}catch(e){console.warn("Minimap#_updateElement errored",e)}},p.prototype._updateElementId=function(e,t){try{var n=(0,i.IO)("#"+(0,a.D)(this._prefixId(e.id)),this._elementsGroup);n&&(n.id=this._prefixId(t))}catch(e){console.warn("Minimap#_updateElementId errored",e)}},p.prototype.isOnActivePlane=function(e){var t=this._canvas;return t.findRoot?t.findRoot(e)===t.getRootElement():!t.findPlane||t.findPlane(e)===t.getActivePlane()},p.prototype._addElement=function(e){var t,n,r,s=this;if(this._removeElement(e),this.isOnActivePlane(e)){var c=this._createElement(e),l=(0,i.IO)("#"+(0,a.D)(this._prefixId(e.parent.id)),this._elementsGroup);if(c){var p=function(e,t){var n=(0,i.IO)(".djs-children",t.parentNode);if(n){var o=[].slice.call(n.childNodes),r=-1;return o.forEach(function(t,n){(0,i.IO)(".djs-element",t)===e&&(r=n)}),r}}(this._elementRegistry.getGraphics(e),this._elementRegistry.getGraphics(e.parent));return"undefined"!==p&&l?l.childNodes.length>p?d(c,l,p):d(c,l,l.childNodes.length-1):this._elementsGroup.appendChild(c),e.waypoints?(t=e.parent,n=0,r=0,void 0!==t.x&&void 0!==t.y&&(n=-t.x,r=-t.y)):(n=e.x,r=e.y,l&&(n-=(t=e.parent).x,r-=t.y)),(0,o.Lj)(c,{transform:"translate("+n+" "+r+")"}),e.children&&e.children.length&&e.children.forEach(function(e){s._addElement(e)}),c}}},p.prototype._removeElement=function(e){var t=this._svg.getElementById(this._prefixId(e.id));t&&(0,o.Od)(t)},p.prototype._createElement=function(e){var t,n=this._elementRegistry.getGraphics(e);if(n&&(t=(0,s.s)(n))){var r,a=(r=(0,o.d9)(t),(0,i.Kt)("[id]",r).forEach(function(e){e.remove()}),r);return(0,o.Lj)(a,{id:this._prefixId(e.id)}),a}},p.prototype._clear=function(){(0,o.ZH)(this._elementsGroup)},p.prototype._prefixId=function(e){return"djs-minimap-"+e+"-"+this._minimapId};var m=Math.sign||function(e){return e>=0?1:-1};function g(e,t){return"polygon("+[v(t.left,t.top),v(t.left+t.width,t.top),v(t.left+t.width,t.top+t.height),v(t.left,t.top+t.height),v(t.left,e.height),v(e.width,e.height),v(e.width,0),v(0,0),v(0,e.height),v(t.left,e.height)].join(", ")+")"}function v(e,t){return e+"px "+t+"px"}function y(e){return e.center?e.center:{x:e.clientX,y:e.clientY}}var b={__init__:["minimap"],minimap:["type",p]}},3630:function(e,t,n){n.d(t,{N:function(){return i},q:function(){return o}});var i=10;function o(e,t,n){return n||(n="round"),Math[n](e/t)*t}},6384:function(e,t,n){n.d(t,{JS:function(){return l},LO:function(){return m},YW:function(){return f},aw:function(){return c},cY:function(){return h},fZ:function(){return d},ot:function(){return p},wL:function(){return u}});var i=n(785),o=["c","C"],r=["v","V"],a=["y","Y"],s=["z","Z"];function c(e){return e.ctrlKey||e.metaKey||e.shiftKey||e.altKey}function l(e){return!e.altKey&&(e.ctrlKey||e.metaKey)}function p(e,t){return -1!==(e=(0,i.kJ)(e)?e:[e]).indexOf(t.key)||-1!==e.indexOf(t.code)}function h(e){return e.shiftKey}function u(e){return l(e)&&p(o,e)}function d(e){return l(e)&&p(r,e)}function f(e){return l(e)&&!h(e)&&p(s,e)}function m(e){return l(e)&&(p(a,e)||p(s,e)&&h(e))}},8661:function(e,t,n){n.d(t,{Hz:function(){return d},JA:function(){return l},Re:function(){return f},T8:function(){return u},aR:function(){return s},ex:function(){return c},wS:function(){return h},z_:function(){return p}});var i=n(785),o=n(8951),r=n(6823),a=n(4554);function s(e){return{x:Math.round(e.x),y:Math.round(e.y),width:Math.round(e.width),height:Math.round(e.height)}}function c(e){return{x:Math.round(e.x),y:Math.round(e.y)}}function l(e){return{top:e.y,right:e.x+(e.width||0),bottom:e.y+(e.height||0),left:e.x}}function p(e){return{x:e.left,y:e.top,width:e.right-e.left,height:e.bottom-e.top}}function h(e){return(0,a.Ho)(e)?function(e){for(var t=e.waypoints,n=t.reduce(function(e,n,i){var o=t[i-1];if(o){var r=e[e.length-1],a=r&&r.endLength||0,s=Math.sqrt(Math.pow(o.x-n.x,2)+Math.pow(o.y-n.y,2));e.push({start:o,end:n,startLength:a,endLength:a+s,length:s})}return e},[]),i=n.reduce(function(e,t){return e+t.length},0)/2,o=0,r=n[0];r.endLength<i;)r=n[++o];var a=(i-r.startLength)/r.length;return{x:r.start.x+(r.end.x-r.start.x)*a,y:r.start.y+(r.end.y-r.start.y)*a}}(e):c({x:e.x+(e.width||0)/2,y:e.y+(e.height||0)/2})}function u(e,t,n){n=n||0,(0,i.Kn)(n)||(n={x:n,y:n});var o=l(e),r=l(t),a=o.bottom+n.y<=r.top,s=o.left-n.x>=r.right,c=o.top-n.y>=r.bottom,p=o.right+n.x<=r.left,h=a?"top":c?"bottom":null,u=p?"left":s?"right":null;return u&&h?h+"-"+u:u||h||"intersect"}function d(e,t,n){var a=(0,r.Z)(e,t);return 1===a.length||2===a.length&&1>(0,o.tW)(a[0],a[1])?c(a[0]):a.length>1?c((a=(0,i.MR)(a,function(e){var t=Math.floor(100*e.t2)||1;return t=((t=100-t)<10?"0":"")+t,e.segment2+"#"+t}))[n?0:a.length-1]):null}function f(e){e=e.slice();for(var t,n,i,r=0;e[r];)t=e[r],n=e[r-1],i=e[r+1],0===(0,o.tW)(t,i)||(0,o.ZS)(n,i,t)?e.splice(r,1):r++;return e}},5694:function(e,t,n){function i(e){return CSS.escape(e)}n.d(t,{D:function(){return i},r:function(){return r}});var o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function r(e){return(e=""+e)&&e.replace(/[&<>"']/g,function(e){return o[e]})}},8951:function(e,t,n){n.d(t,{Or:function(){return a},SO:function(){return c},ZS:function(){return r},qr:function(){return s},tW:function(){return o}});var i=n(785);function o(e,t){return e&&t?Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)):-1}function r(e,t,n,i){return void 0===i&&(i=5),!!e&&!!t&&!!n&&Math.abs(((t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x))/o(e,t))<=i}function a(e,t){var n=Array.from(arguments).flat();for(let[e,t]of Object.entries({x:"v",y:"h"}))if(function(e,t){let n=t[0];return(0,i.yW)(t,function(t){return 2>=Math.abs(n[e]-t[e])})}(e,n))return t;return!1}function s(e,t,n){return n=n||0,e.x>t.x-n&&e.y>t.y-n&&e.x<t.x+t.width+n&&e.y<t.y+t.height+n}function c(e,t){return{x:Math.round(e.x+(t.x-e.x)/2),y:Math.round(e.y+(t.y-e.y)/2)}}},2722:function(e,t,n){function i(e){return e.childNodes[0]}function o(e){return e.parentNode.childNodes[1]}n.d(t,{G:function(){return o},s:function(){return i}})},725:function(e,t,n){function i(e){this._counter=0,this._prefix=(e?e+"-":"")+Math.floor(1e9*Math.random())+"-"}n.d(t,{Z:function(){return i}}),i.prototype.next=function(){return this._prefix+ ++this._counter}},4554:function(e,t,n){n.d(t,{Ho:function(){return o},j_:function(){return r}});var i=n(785);function o(e){return(0,i.Kn)(e)&&(0,i.e$)(e,"waypoints")}function r(e){return(0,i.Kn)(e)&&(0,i.e$)(e,"labelTarget")}}}]);