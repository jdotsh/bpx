(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[348],{2361:function(e,t,n){Promise.resolve().then(n.bind(n,9735))},9735:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ed}});var i=n(7437),a=n(2265),o=n(7410),r=n(6443),s=n(3229),l=n(6475),c=n(2735),d=n(2208),m=n(3276),p=n(3949),u=n(6841),h=n(9833),v=n(9893),b=n(6002),g=n(615),f=n(5802),y=n(3391),x=n(2048),E=n(4064),w=n(8477),j=n(2613),k=n(7945),T=n(5929),N=n(7226),C=n(1994),S=n(3335);function D(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,S.m6)((0,C.W)(t))}let M=(0,a.memo)(function(e){let{onImport:t,onExport:n,onSave:C,onOpenFolder:S,onPreview:M,onRun:L,onUndo:P,onRedo:A,onZoomIn:I,onZoomOut:F,onFitToViewport:B,onClear:O,onAlignLeft:R,onAlignCenter:Z,onAlignRight:G,onAlignTop:_,onAlignMiddle:X,onAlignBottom:z,onToggleMinimap:V,onToggleLanguage:q,onToggleTheme:U,onMeetingMode:H,theme:Q="light",zoomLevel:J=100,canUndo:W=!1,canRedo:Y=!1,disabled:K=!1,isMeetingMode:$=!1,isMinimapOpen:ee=!1}=e,[et,en]=(0,a.useState)(!1),ei=e=>{let{onClick:t,icon:n,title:a,isDisabled:o=!1,isActive:r=!1,className:s}=e;return(0,i.jsx)("button",{onClick:t,disabled:o||K,title:a,className:D("p-1.5 rounded hover:bg-accent transition-colors inline-flex items-center justify-center","disabled:opacity-50 disabled:cursor-not-allowed",r&&"bg-accent",s),children:(0,i.jsx)(n,{className:"h-4 w-4"})})};return(0,i.jsxs)("div",{className:"bpmn-toolbar flex items-center gap-2 px-3 py-1.5 border-b bg-card",children:[(0,i.jsxs)("div",{className:"flex items-center gap-0.5 border border-border/50 rounded p-0.5",children:[(0,i.jsx)(ei,{icon:s.Z,onClick:C,title:"Save"}),(0,i.jsx)(ei,{icon:l.Z,onClick:()=>{let e=document.getElementById("file-import");null==e||e.click()},title:"Open"}),(0,i.jsx)("input",{type:"file",accept:".xml,.bpmn,.yaml,.yml,.json",style:{display:"none"},id:"file-import",onChange:e=>{var n;(null===(n=e.target.files)||void 0===n?void 0:n[0])&&t&&t(),e.target.value=""}}),(0,i.jsx)(ei,{icon:c.Z,onClick:n,title:"Export"}),(0,i.jsx)(ei,{icon:d.Z,onClick:M,title:"Preview"}),(0,i.jsx)(ei,{icon:m.Z,onClick:L,title:"Run Process"})]}),(0,i.jsxs)("div",{className:"flex items-center gap-0.5 border border-border/50 rounded p-0.5",children:[(0,i.jsx)(ei,{icon:p.Z,onClick:R,title:"Align Left"}),(0,i.jsx)(ei,{icon:u.Z,onClick:Z,title:"Align Center"}),(0,i.jsx)(ei,{icon:h.Z,onClick:G,title:"Align Right"}),(0,i.jsx)(ei,{icon:v.Z,onClick:_,title:"Align Top"}),(0,i.jsx)(ei,{icon:b.Z,onClick:X,title:"Align Middle"}),(0,i.jsx)(ei,{icon:g.Z,onClick:z,title:"Align Bottom"})]}),(0,i.jsxs)("div",{className:"flex items-center gap-0.5 border border-border/50 rounded p-0.5",children:[(0,i.jsx)(ei,{icon:f.Z,onClick:F,title:"Zoom Out"}),(0,i.jsxs)("button",{className:"px-2 py-1.5 min-w-[50px] text-xs font-medium hover:bg-accent rounded transition-colors",onClick:B,title:"Click to fit viewport",children:[J,"%"]}),(0,i.jsx)(ei,{icon:y.Z,onClick:I,title:"Zoom In"}),(0,i.jsx)(ei,{icon:r.Z,onClick:()=>{en(!et),null==B||B()},title:"Fit to Viewport",isActive:et}),(0,i.jsx)(ei,{icon:x.Z,onClick:V,title:"Toggle Minimap",isActive:ee})]}),(0,i.jsxs)("div",{className:"flex items-center gap-0.5 border border-border/50 rounded p-0.5",children:[(0,i.jsx)(ei,{icon:E.Z,onClick:P,title:"Undo",isDisabled:!W}),(0,i.jsx)(ei,{icon:w.Z,onClick:A,title:"Redo",isDisabled:!Y}),(0,i.jsx)(ei,{icon:j.Z,onClick:O,title:"Clear All"})]}),(0,i.jsxs)("div",{className:"flex items-center gap-0.5 border border-border/50 rounded p-0.5",children:[(0,i.jsx)(ei,{icon:k.Z,onClick:q,title:"Language"}),(0,i.jsx)(ei,{icon:o.Z,onClick:H,title:"Meeting/Presentation Mode",isActive:$}),(0,i.jsx)(ei,{icon:"light"===Q?T.Z:N.Z,onClick:U,title:"Toggle Theme"})]})]})});var L=n(6490),P=n(6384),A=n(4092),I=n(7960),F=n(6635);let B=()=>'<?xml version="1.0" encoding="UTF-8"?>\n<bpmn2:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn2="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xsi:schemaLocation="http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd" id="sample-diagram" targetNamespace="http://bpmn.io/schema/bpmn">\n  <bpmn2:process id="Process_1" isExecutable="false">\n    <bpmn2:startEvent id="StartEvent_1"/>\n  </bpmn2:process>\n  <bpmndi:BPMNDiagram id="BPMNDiagram_1">\n    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1">\n      <bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1">\n        <dc:Bounds height="36.0" width="36.0" x="412.0" y="240.0"/>\n      </bpmndi:BPMNShape>\n    </bpmndi:BPMNPlane>\n  </bpmndi:BPMNDiagram>\n</bpmn2:definitions>',O=e=>B(),R=e=>({id:"Process_1",title:"New Process",driver:"default",meta:{},layout:[],bpmn:{}}),Z=[{id:"start-events",title:"Start Events",icon:"bpmn-icon-start-event-none",items:[{action:"create.start-event",type:"bpmn:StartEvent",icon:"bpmn-icon-start-event-none",title:"Start Event",color:"var(--color-start-event)"},{action:"create.start-event-message",type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",icon:"bpmn-icon-start-event-message",title:"Message Start Event",color:"var(--color-start-event)"},{action:"create.start-event-timer",type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",icon:"bpmn-icon-start-event-timer",title:"Timer Start Event",color:"var(--color-start-event)"},{action:"create.start-event-conditional",type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",icon:"bpmn-icon-start-event-condition",title:"Conditional Start Event",color:"var(--color-start-event)"},{action:"create.start-event-signal",type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",icon:"bpmn-icon-start-event-signal",title:"Signal Start Event",color:"var(--color-start-event)"},{action:"create.start-event-error",type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ErrorEventDefinition",icon:"bpmn-icon-start-event-error",title:"Error Start Event",color:"var(--color-start-event)"},{action:"create.start-event-escalation",type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",icon:"bpmn-icon-start-event-escalation",title:"Escalation Start Event",color:"var(--color-start-event)"},{action:"create.start-event-compensation",type:"bpmn:StartEvent",eventDefinitionType:"bpmn:CompensateEventDefinition",icon:"bpmn-icon-start-event-compensation",title:"Compensation Start Event",color:"var(--color-start-event)"}]},{id:"tasks",title:"Tasks",icon:"bpmn-icon-task",items:[{action:"create.task",type:"bpmn:Task",icon:"bpmn-icon-task",title:"Task",color:"var(--color-activity)"},{action:"create.user-task",type:"bpmn:UserTask",icon:"bpmn-icon-user-task",title:"User Task",color:"var(--color-activity)"},{action:"create.service-task",type:"bpmn:ServiceTask",icon:"bpmn-icon-service-task",title:"Service Task",color:"var(--color-activity)"},{action:"create.script-task",type:"bpmn:ScriptTask",icon:"bpmn-icon-script-task",title:"Script Task",color:"var(--color-activity)"},{action:"create.business-rule-task",type:"bpmn:BusinessRuleTask",icon:"bpmn-icon-business-rule-task",title:"Business Rule Task",color:"var(--color-activity)"},{action:"create.send-task",type:"bpmn:SendTask",icon:"bpmn-icon-send-task",title:"Send Task",color:"var(--color-activity)"},{action:"create.receive-task",type:"bpmn:ReceiveTask",icon:"bpmn-icon-receive-task",title:"Receive Task",color:"var(--color-activity)"},{action:"create.manual-task",type:"bpmn:ManualTask",icon:"bpmn-icon-manual-task",title:"Manual Task",color:"var(--color-activity)"}]},{id:"gateways",title:"Gateways",icon:"bpmn-icon-gateway-none",items:[{action:"create.exclusive-gateway",type:"bpmn:ExclusiveGateway",icon:"bpmn-icon-gateway-xor",title:"Exclusive Gateway",color:"var(--color-gateway)"},{action:"create.parallel-gateway",type:"bpmn:ParallelGateway",icon:"bpmn-icon-gateway-parallel",title:"Parallel Gateway",color:"var(--color-gateway)"},{action:"create.inclusive-gateway",type:"bpmn:InclusiveGateway",icon:"bpmn-icon-gateway-or",title:"Inclusive Gateway",color:"var(--color-gateway)"},{action:"create.event-based-gateway",type:"bpmn:EventBasedGateway",icon:"bpmn-icon-gateway-eventbased",title:"Event-based Gateway",color:"var(--color-gateway)"},{action:"create.complex-gateway",type:"bpmn:ComplexGateway",icon:"bpmn-icon-gateway-complex",title:"Complex Gateway",color:"var(--color-gateway)"}]},{id:"end-events",title:"End Events",icon:"bpmn-icon-end-event-none",items:[{action:"create.end-event",type:"bpmn:EndEvent",icon:"bpmn-icon-end-event-none",title:"End Event",color:"var(--color-end-event)"},{action:"create.end-event-message",type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition",icon:"bpmn-icon-end-event-message",title:"Message End Event",color:"var(--color-end-event)"},{action:"create.end-event-escalation",type:"bpmn:EndEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",icon:"bpmn-icon-end-event-escalation",title:"Escalation End Event",color:"var(--color-end-event)"},{action:"create.end-event-error",type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition",icon:"bpmn-icon-end-event-error",title:"Error End Event",color:"var(--color-end-event)"},{action:"create.end-event-compensation",type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CompensateEventDefinition",icon:"bpmn-icon-end-event-compensation",title:"Compensation End Event",color:"var(--color-end-event)"},{action:"create.end-event-signal",type:"bpmn:EndEvent",eventDefinitionType:"bpmn:SignalEventDefinition",icon:"bpmn-icon-end-event-signal",title:"Signal End Event",color:"var(--color-end-event)"},{action:"create.end-event-terminate",type:"bpmn:EndEvent",eventDefinitionType:"bpmn:TerminateEventDefinition",icon:"bpmn-icon-end-event-terminate",title:"Terminate End Event",color:"var(--color-end-event)"},{action:"create.end-event-cancel",type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CancelEventDefinition",icon:"bpmn-icon-end-event-cancel",title:"Cancel End Event",color:"var(--color-end-event)"},{action:"create.end-event-link",type:"bpmn:EndEvent",eventDefinitionType:"bpmn:LinkEventDefinition",icon:"bpmn-icon-end-event-link",title:"Link End Event",color:"var(--color-end-event)"}]},{id:"intermediate-events",title:"Intermediate Events",icon:"bpmn-icon-intermediate-event-none",items:[{action:"create.intermediate-throw-event",type:"bpmn:IntermediateThrowEvent",icon:"bpmn-icon-intermediate-event-none",title:"Intermediate Throw Event",color:"var(--color-throw-event)"},{action:"create.intermediate-catch-event",type:"bpmn:IntermediateCatchEvent",icon:"bpmn-icon-intermediate-event-none",title:"Intermediate Catch Event",color:"var(--color-catch-event)"},{action:"create.intermediate-catch-event-message",type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:MessageEventDefinition",icon:"bpmn-icon-intermediate-event-catch-message",title:"Message Intermediate Catch Event",color:"var(--color-catch-event)"},{action:"create.intermediate-throw-event-message",type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:MessageEventDefinition",icon:"bpmn-icon-intermediate-event-throw-message",title:"Message Intermediate Throw Event",color:"var(--color-throw-event)"},{action:"create.intermediate-catch-event-timer",type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition",icon:"bpmn-icon-intermediate-event-catch-timer",title:"Timer Intermediate Catch Event",color:"var(--color-catch-event)"},{action:"create.intermediate-catch-event-conditional",type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",icon:"bpmn-icon-intermediate-event-catch-condition",title:"Conditional Intermediate Catch Event",color:"var(--color-catch-event)"},{action:"create.intermediate-catch-event-link",type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:LinkEventDefinition",icon:"bpmn-icon-intermediate-event-catch-link",title:"Link Intermediate Catch Event",color:"var(--color-catch-event)"},{action:"create.intermediate-throw-event-link",type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:LinkEventDefinition",icon:"bpmn-icon-intermediate-event-throw-link",title:"Link Intermediate Throw Event",color:"var(--color-throw-event)"},{action:"create.intermediate-catch-event-signal",type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:SignalEventDefinition",icon:"bpmn-icon-intermediate-event-catch-signal",title:"Signal Intermediate Catch Event",color:"var(--color-catch-event)"},{action:"create.intermediate-throw-event-signal",type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:SignalEventDefinition",icon:"bpmn-icon-intermediate-event-throw-signal",title:"Signal Intermediate Throw Event",color:"var(--color-throw-event)"},{action:"create.intermediate-throw-event-compensation",type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:CompensateEventDefinition",icon:"bpmn-icon-intermediate-event-throw-compensation",title:"Compensation Intermediate Throw Event",color:"var(--color-throw-event)"},{action:"create.intermediate-throw-event-escalation",type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",icon:"bpmn-icon-intermediate-event-throw-escalation",title:"Escalation Intermediate Throw Event",color:"var(--color-throw-event)"}]},{id:"subprocess",title:"Sub Process",icon:"bpmn-icon-subprocess-expanded",items:[{action:"create.subprocess-expanded",type:"bpmn:SubProcess",icon:"bpmn-icon-subprocess-expanded",title:"Sub Process (Expanded)",color:"var(--color-activity)",isExpanded:!0},{action:"create.subprocess-collapsed",type:"bpmn:SubProcess",icon:"bpmn-icon-subprocess-collapsed",title:"Sub Process (Collapsed)",color:"var(--color-activity)",isExpanded:!1},{action:"create.event-subprocess-expanded",type:"bpmn:SubProcess",eventDefinitionType:"bpmn:EventSubProcess",icon:"bpmn-icon-event-subprocess-expanded",title:"Event Sub Process",color:"var(--color-activity)",isExpanded:!0},{action:"create.transaction",type:"bpmn:Transaction",icon:"bpmn-icon-transaction",title:"Transaction",color:"var(--color-activity)",isExpanded:!0},{action:"create.call-activity",type:"bpmn:CallActivity",icon:"bpmn-icon-call-activity",title:"Call Activity",color:"var(--color-activity)"}]},{id:"boundary-events",title:"Boundary Events",icon:"bpmn-icon-intermediate-event-none",items:[{action:"create.boundary-event",type:"bpmn:BoundaryEvent",icon:"bpmn-icon-intermediate-event-none",title:"Boundary Event",color:"var(--color-catch-event)"},{action:"create.boundary-event-message",type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",icon:"bpmn-icon-intermediate-event-catch-message",title:"Message Boundary Event",color:"var(--color-catch-event)"},{action:"create.boundary-event-timer",type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",icon:"bpmn-icon-intermediate-event-catch-timer",title:"Timer Boundary Event",color:"var(--color-catch-event)"},{action:"create.boundary-event-escalation",type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",icon:"bpmn-icon-intermediate-event-catch-escalation",title:"Escalation Boundary Event",color:"var(--color-catch-event)"},{action:"create.boundary-event-conditional",type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",icon:"bpmn-icon-intermediate-event-catch-condition",title:"Conditional Boundary Event",color:"var(--color-catch-event)"},{action:"create.boundary-event-error",type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ErrorEventDefinition",icon:"bpmn-icon-intermediate-event-catch-error",title:"Error Boundary Event",color:"var(--color-catch-event)"},{action:"create.boundary-event-signal",type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",icon:"bpmn-icon-intermediate-event-catch-signal",title:"Signal Boundary Event",color:"var(--color-catch-event)"},{action:"create.boundary-event-compensation",type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CompensateEventDefinition",icon:"bpmn-icon-intermediate-event-catch-compensation",title:"Compensation Boundary Event",color:"var(--color-catch-event)"},{action:"create.boundary-event-cancel",type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CancelEventDefinition",icon:"bpmn-icon-intermediate-event-catch-cancel",title:"Cancel Boundary Event",color:"var(--color-catch-event)"}]},{id:"participants",title:"Participants",icon:"bpmn-icon-participant",items:[{action:"create.participant-expanded",type:"bpmn:Participant",icon:"bpmn-icon-participant",title:"Pool",color:"var(--color-participant)",isExpanded:!0},{action:"create.participant-collapsed",type:"bpmn:Participant",icon:"bpmn-icon-lane",title:"Collapsed Pool",color:"var(--color-participant)",isExpanded:!1},{action:"create.lane",type:"bpmn:Lane",icon:"bpmn-icon-lane",title:"Lane",color:"var(--color-participant)"}]},{id:"data",title:"Data Objects",icon:"bpmn-icon-data-object",items:[{action:"create.data-object",type:"bpmn:DataObjectReference",icon:"bpmn-icon-data-object",title:"Data Object",color:"var(--color-data)"},{action:"create.data-store",type:"bpmn:DataStoreReference",icon:"bpmn-icon-data-store",title:"Data Store",color:"var(--color-data)"},{action:"create.data-input",type:"bpmn:DataInput",icon:"bpmn-icon-data-input",title:"Data Input",color:"var(--color-data)"},{action:"create.data-output",type:"bpmn:DataOutput",icon:"bpmn-icon-data-output",title:"Data Output",color:"var(--color-data)"}]},{id:"artifacts",title:"Artifacts",icon:"bpmn-icon-text-annotation",items:[{action:"create.group",type:"bpmn:Group",icon:"bpmn-icon-group",title:"Group",color:"var(--color-artifact)"},{action:"create.text-annotation",type:"bpmn:TextAnnotation",icon:"bpmn-icon-text-annotation",title:"Text Annotation",color:"var(--color-artifact)"}]}];class G{getPaletteEntries(){return{}}hideDefaultPalette(){let e=document.createElement("style");e.textContent="\n      .djs-palette {\n        display: none !important;\n      }\n    ",document.head.appendChild(e)}activateHandTool(e){this.handTool.activateHand(e)}activateLassoTool(e){this.lassoTool.activateSelection(e)}activateSpaceTool(e){this.spaceTool.activateSelection(e)}activateGlobalConnect(e){this.globalConnect.start(e)}createElement(e,t){let n=function(e){for(let t of Z){let n=t.items.find(t=>t.action===e);if(n)return n}}(e);if(!n){let n=this.getElementType(e);if(!n)return;if("create.subprocess-expanded"===e||"expanded-subprocess"===e)this.createSubprocess(t);else if("create.participant-expanded"===e||"expanded-pool"===e)this.createParticipant(t);else{let e=this.elementFactory.createShape({type:n});this.create.start(t,e)}return}try{let e=this.bpmnFactory.create(n.type);if(n.eventDefinitionType){let t=this.bpmnFactory.create(n.eventDefinitionType);e.eventDefinitions=[t]}(n.type.includes("Task")||n.type.includes("Activity"))&&(e.name=n.title);let i={type:n.type,businessObject:e};if(void 0!==n.isExpanded&&(i.isExpanded=n.isExpanded,e.di&&(e.di.isExpanded=n.isExpanded)),"bpmn:Participant"===n.type){let t=this.bpmnFactory.create("bpmn:Process");e.processRef=t,i.width=n.isExpanded?600:400,i.height=n.isExpanded?250:60}if("bpmn:Lane"===n.type&&(i.width=600,i.height=120),("bpmn:SubProcess"===n.type||"bpmn:Transaction"===n.type)&&(i.width=n.isExpanded?350:100,i.height=n.isExpanded?200:80,n.isExpanded)){let e=this.elementFactory.createShape(i),n=this.elementFactory.createShape({type:"bpmn:StartEvent",x:40,y:82,parent:e});this.create.start(t,[e,n],{hints:{autoSelect:[e]}});return}let a=this.elementFactory.createShape(i);this.create.start(t,a)}catch(i){console.error("Failed to create element:",i);let n=this.getElementType(e);if(n){let e=this.elementFactory.createShape({type:n});this.create.start(t,e)}}}createSubprocess(e){let t=this.elementFactory.createShape({type:"bpmn:SubProcess",x:0,y:0,isExpanded:!0}),n=this.elementFactory.createShape({type:"bpmn:StartEvent",x:40,y:82,parent:t});this.create.start(e,[t,n],{hints:{autoSelect:[t]}})}createParticipant(e){this.create.start(e,this.elementFactory.createParticipantShape())}getElementType(e){return({hand:"","hand-tool":"",lasso:"","lasso-tool":"",space:"","space-tool":"","global-connect":"","global-connect-tool":"","create.start-event":"bpmn:StartEvent","none-start-event":"bpmn:StartEvent","create.intermediate-event":"bpmn:IntermediateThrowEvent","none-intermediate-throwing":"bpmn:IntermediateThrowEvent","create.end-event":"bpmn:EndEvent","none-end-event":"bpmn:EndEvent","create.exclusive-gateway":"bpmn:ExclusiveGateway","exclusive-gateway":"bpmn:ExclusiveGateway","create.parallel-gateway":"bpmn:ParallelGateway","create.inclusive-gateway":"bpmn:InclusiveGateway","create.event-based-gateway":"bpmn:EventBasedGateway","create.complex-gateway":"bpmn:ComplexGateway","create.task":"bpmn:Task","create.user-task":"bpmn:UserTask","create.service-task":"bpmn:ServiceTask","create.script-task":"bpmn:ScriptTask","create.manual-task":"bpmn:ManualTask","create.send-task":"bpmn:SendTask","create.receive-task":"bpmn:ReceiveTask","create.business-rule-task":"bpmn:BusinessRuleTask","create.call-activity":"bpmn:CallActivity","create.data-object":"bpmn:DataObjectReference","create.data-store":"bpmn:DataStoreReference","create.subprocess-expanded":"","expanded-subprocess":"","create.participant-expanded":"","expanded-pool":"","create.group":"bpmn:Group","create.text-annotation":"bpmn:TextAnnotation"})[e]||""}constructor(e,t,n,i,a,o,r,s,l,c){this.palette=e,this.create=t,this.elementFactory=n,this.spaceTool=i,this.lassoTool=a,this.handTool=o,this.globalConnect=r,this.translate=s,this.bpmnFactory=l,this.modeling=c,e.registerProvider(this),this.hideDefaultPalette(),window.__customPaletteProvider=this}}G.$inject=["palette","create","elementFactory","spaceTool","lassoTool","handTool","globalConnect","translate","bpmnFactory","modeling"];class _{setupVirtualRendering(){let e=this.modeler.get("eventBus");e.on("canvas.viewbox.changed",()=>{this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout(()=>{this.updateVisibleElements()},50)}),e.on("import.done",()=>{setTimeout(()=>this.updateVisibleElements(),100)}),e.on("elements.changed",()=>{this.updateVisibleElements()})}updateVisibleElements(){if(!this.enabled)return;let e=this.modeler.get("canvas"),t=this.modeler.get("elementRegistry"),n=e.viewbox(),i={left:n.x-this.viewportPadding,top:n.y-this.viewportPadding,right:n.x+n.width+this.viewportPadding,bottom:n.y+n.height+this.viewportPadding},a=new Set,o=0,r=0;t.forEach(e=>{if("bpmn:Process"===e.type||e.labelTarget){a.add(e.id);return}this.isElementInViewport(e,i)?(a.add(e.id),r++,this.visibleElements.has(e.id)||this.showElement(e)):(o++,this.visibleElements.has(e.id)&&this.hideElement(e))}),this.visibleElements=a}isElementInViewport(e,t){return e.waypoints?e.waypoints.some(e=>e.x>=t.left&&e.x<=t.right&&e.y>=t.top&&e.y<=t.bottom):!(e.x+e.width<t.left||e.x>t.right||e.y+e.height<t.top||e.y>t.bottom)}showElement(e){try{let t=this.modeler.get("elementRegistry").getGraphics(e);t&&(t.style.display="",t.style.visibility="visible")}catch(e){}}hideElement(e){try{let t=this.modeler.get("elementRegistry").getGraphics(e);t&&(t.style.display="none",t.style.visibility="hidden")}catch(e){}}enable(){this.enabled=!0,this.updateVisibleElements()}disable(){this.enabled=!1,this.modeler.get("elementRegistry").forEach(e=>{this.showElement(e)}),this.visibleElements.clear()}destroy(){this.updateTimeout&&clearTimeout(this.updateTimeout),this.disable()}constructor(e){this.visibleElements=new Set,this.viewportPadding=100,this.enabled=!0,this.updateTimeout=null,this.modeler=e,this.setupVirtualRendering()}}class X{setupAutoSave(){let e=this.modeler.get("eventBus");this.debouncedSave=()=>{this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{this.save()},this.debounceMs)},e.on("commandStack.changed",()=>{this.debouncedSave&&this.debouncedSave()}),e.on("import.done",()=>{this.saveNow()})}async save(){if(this.saveQueue)return this.saveQueue.then(()=>{if(!this.saveInProgress)return this.save()});this.saveQueue=this.performSave();try{await this.saveQueue}finally{this.saveQueue=null}}async performSave(){if(!this.saveInProgress){this.saveInProgress=!0;try{let{xml:e}=await this.modeler.saveXML({format:!0});if(e===this.lastSavedXml)return;this.lastSavedXml=e,this.onSave&&await this.onSave(e),this.modeler.get("eventBus").fire("diagram.saved",{xml:e})}catch(e){throw console.error("Failed to save diagram:",e),this.modeler.get("eventBus").fire("diagram.saveError",{error:e}),e}finally{this.saveInProgress=!1}}}async saveNow(){return this.debounceTimer&&(clearTimeout(this.debounceTimer),this.debounceTimer=null),await this.save(),this.lastSavedXml}getLastSavedXml(){return this.lastSavedXml}async hasUnsavedChanges(){try{let{xml:e}=await this.modeler.saveXML({format:!0});return e!==this.lastSavedXml}catch(e){return!1}}setDebounceDelay(e){this.debounceMs=e}destroy(){this.debounceTimer&&clearTimeout(this.debounceTimer);let e=this.modeler.get("eventBus");e.off("commandStack.changed"),e.off("import.done"),this.debouncedSave=null,this.saveQueue=null}constructor(e,t,n=500){this.onSave=t,this.debounceMs=n,this.saveQueue=null,this.lastSavedXml="",this.debouncedSave=null,this.debounceTimer=null,this.saveInProgress=!1,this.modeler=e,this.setupAutoSave()}}let z={lang:"en",theme:"light",valueType:"yaml",height:70,gridLine:{smallGridSpacing:20,gridSpacing:100,gridLineStroke:1,gridLineOpacity:.2,gridLineColor:"#e0e0e0"},keyboard:!0};class V{initialize(){this.setupContainer(),this.createModeler(),this.setupKeyboard(),this.loadInitialXml()}setupContainer(){let e="string"==typeof this.options.container?document.querySelector(this.options.container):this.options.container;if(!e)throw Error("Container not found");e.classList.add("bpmn-designer-theme-".concat(this.options.theme)),"dark"===this.options.theme&&e.classList.add("dark"),this.container=e}createModeler(){let{height:e,gridLine:t}=this.options;this.bpmnModeler=new L.Z({container:this.container,height:"".concat(e,"vh"),additionalModules:this.getAdditionalModules(),gridLine:t,minimap:{open:!1}})}getAdditionalModules(){return[I.Z,A.Z,{__init__:["customPaletteProvider"],customPaletteProvider:["type",G]}]}setupKeyboard(){if(!this.options.keyboard)return;this.bpmnModeler.get("eventBus");let e=this.bpmnModeler.get("commandStack"),t=t=>{(0,P.YW)(t)?(e.undo(),t.preventDefault()):(0,P.LO)(t)&&(e.redo(),t.preventDefault())};this.container.addEventListener("keydown",t);let n=this.bpmnModeler.destroy.bind(this.bpmnModeler);this.bpmnModeler.destroy=()=>{this.container.removeEventListener("keydown",t),n()}}loadInitialXml(){let e=B(),t=this.options.value;"bpmn"!==this.options.valueType&&this.options.value&&(t=O(F.zD(this.options.value))),this.bpmnModeler.importXML(t||e).then(e=>{var t,n;let{warnings:i}=e;i&&i.length&&i.forEach(e=>console.warn(e)),this.setupEventListeners(),this.virtualRenderer=new _(this.bpmnModeler),null===(t=(n=this.options).onCreated)||void 0===t||t.call(n,this.bpmnModeler)}).catch(e=>{var t,n;null===(t=(n=this.options).onXmlError)||void 0===t||t.call(n,e)})}setupEventListeners(){let e=this.bpmnModeler.get("eventBus");this.options.onChange&&(this.saveManager=new X(this.bpmnModeler,async e=>{var t,n;null===(t=(n=this.options).onChange)||void 0===t||t.call(n,t=>"json"===t?this.getJson():"xml"===t?e:this.getValue())},500)),e.on("element.selected",e=>{var t,n;null===(t=(n=this.options).onSelect)||void 0===t||t.call(n,e)})}setValue(e){e&&"bpmn"!==this.options.valueType&&(e=O(F.zD(e))),this.bpmnModeler.importXML(e||B()).then(e=>{let{warnings:t}=e;t&&t.length&&t.forEach(e=>console.warn(e))}).catch(e=>{var t,n;null===(t=(n=this.options).onXmlError)||void 0===t||t.call(n,e)})}getValue(){return F.$w(this.getJson())}getJson(){return R("")}getXml(){return new Promise((e,t)=>{this.bpmnModeler.saveXML({format:!0}).then(t=>{e(t.xml||"")}).catch(t)})}clear(){this.setValue()}changeTheme(e){let t=e||("light"===this.options.theme?"dark":"light");this.container.classList.remove("bpmn-designer-theme-".concat(this.options.theme)),this.container.classList.add("bpmn-designer-theme-".concat(t)),"dark"===t?this.container.classList.add("dark"):this.container.classList.remove("dark"),this.options.theme=t,this.bpmnModeler.get("canvas").resized()}changeLanguage(e){this.options.lang=e}getCommandStack(){return this.bpmnModeler.get("commandStack")}getCanvas(){return this.bpmnModeler.get("canvas")}getModeling(){return this.bpmnModeler.get("modeling")}getSelection(){return this.bpmnModeler.get("selection")}toggleMinimap(){let e=this.bpmnModeler.get("minimap");e&&e.toggle()}destroy(){var e,t,n,i;null===(e=(t=this.options).onDestroy)||void 0===e||e.call(t,this),null===(n=this.saveManager)||void 0===n||n.destroy(),null===(i=this.virtualRenderer)||void 0===i||i.destroy(),this.bpmnModeler.destroy()}constructor(e){this.options={...z,...e},this.initialize()}}function q(){let e=document.documentElement.classList.contains("dark");document.querySelectorAll('[class*="djs-hit"], .djs-group rect, [data-element-id*="Group"] rect').forEach(t=>{if(t instanceof SVGElement){var n;let i=t.closest(".djs-group")||t.closest('[data-element-id*="Group"]')||(null===(n=t.parentElement)||void 0===n?void 0:n.classList.contains("djs-group"));if(t.classList.contains("djs-hit")||t.classList.contains("djs-hit-stroke")||t.classList.contains("djs-hit-all")||i){if(i||t.closest('[data-element-id*="Group"]')){if(t.style.stroke="transparent",t.style.strokeOpacity="0",t.style.fill="transparent",t.style.fillOpacity="0",(t.classList.contains("djs-hit")||t.classList.contains("djs-hit-stroke"))&&(t.style.pointerEvents="stroke"),!t.classList.contains("djs-hit")&&"rect"===t.tagName.toLowerCase()){let n=t.parentElement;(null==n?void 0:n.classList.contains("djs-visual"))&&(t.style.fill="transparent",t.style.fillOpacity="0",t.style.stroke=e?"white":"rgba(64, 64, 64, 0.7)",t.style.strokeOpacity=e?"0.7":"1",t.style.strokeDasharray="5, 5",t.style.strokeWidth="2px",t.style.strokeLinecap="round")}}else t.style.stroke="transparent",t.style.strokeOpacity="0",t.style.fill="none",t.style.fillOpacity="0";let n=t.getAttribute("style");if(n&&(n.includes("stroke: white")||n.includes("stroke:#fff"))){let e=n.replace(/stroke:\s*white/gi,"stroke: transparent").replace(/stroke:\s*#fff(fff)?/gi,"stroke: transparent").replace(/stroke:\s*rgb\(255[\s,]+255[\s,]+255\)/gi,"stroke: transparent").replace(/fill:\s*white/gi,"fill: transparent").replace(/fill:\s*#fff(fff)?/gi,"fill: transparent");t.setAttribute("style",e)}}}}),e&&(document.querySelectorAll(".djs-drag-group, .djs-dragging, .djs-dragger").forEach(e=>{e instanceof HTMLElement&&(e.style.backgroundColor="transparent"),e.querySelectorAll("rect").forEach(e=>{let t=e.getAttribute("fill");("white"===t||"#fff"===t||"#ffffff"===t||"#FFF"===t||"#FFFFFF"===t||"rgb(255, 255, 255)"===t||"rgb(255,255,255)"===t)&&e.setAttribute("fill","#374151")})}),document.querySelectorAll('rect[fill="white"], rect[fill="#fff"], rect[fill="#ffffff"], rect[fill="#FFFFFF"], rect[fill="#FFF"], rect[fill="rgb(255, 255, 255)"], rect[fill="rgb(255,255,255)"], path[fill="white"], path[fill="#fff"], path[fill="#ffffff"], circle[fill="white"], circle[fill="#fff"], ellipse[fill="white"], polygon[fill="white"], svg *[fill="white"], svg *[fill="#fff"], svg *[fill="#ffffff"], *[style*="fill: white"], *[style*="fill:white"], *[style*="fill: #fff"], *[style*="fill:#fff"], *[style*="fill: rgb(255"], *[style*="background: white"], *[style*="background-color: white"]').forEach(e=>{if(!(e.classList.contains("djs-hit")||e.closest('[class*="djs-hit"]'))&&(e.closest(".djs-drag-group, .djs-create-group, .djs-dragging, .djs-element, .djs-dragger")||e.closest('[class*="drag"]')||e.closest('[class*="create"]')||e.closest(".djs-shape")||e.closest(".djs-visual")||"rect"===e.tagName.toLowerCase()||"path"===e.tagName.toLowerCase())){e.setAttribute("fill","#1f2937");let t=e.getAttribute("style");if(t){let n=t.replace(/fill:\s*white/gi,"fill: #1f2937").replace(/fill:\s*#fff(fff)?/gi,"fill: #1f2937").replace(/fill:\s*rgb\(255[\s,]+255[\s,]+255\)/gi,"fill: #1f2937").replace(/background(-color)?:\s*white/gi,"background-color: #1f2937").replace(/background(-color)?:\s*#fff(fff)?/gi,"background-color: #1f2937");e.setAttribute("style",n)}}}),document.querySelectorAll(".djs-drag-active, .djs-dragging, .djs-visual, .djs-drag-group, .djs-dragger, .djs-create-group").forEach(e=>{e.querySelectorAll("rect, path, circle, ellipse, polygon, g").forEach(e=>{let t=e.getAttribute("fill"),n=e.getAttribute("style");if(("white"===t||"#fff"===t||"#ffffff"===t||"#FFF"===t||"#FFFFFF"===t||"rgb(255, 255, 255)"===t||"rgb(255,255,255)"===t)&&e.setAttribute("fill","#1f2937"),n&&(n.includes("fill: white")||n.includes("fill:#fff")||n.includes("fill: rgb(255")||n.includes("background: white"))){let t=n.replace(/fill:\s*white/gi,"fill: #1f2937").replace(/fill:\s*#fff(fff)?/gi,"fill: #1f2937").replace(/fill:\s*rgb\(255[\s,]+255[\s,]+255\)/gi,"fill: #1f2937").replace(/background(-color)?:\s*white/gi,"background-color: transparent");e.setAttribute("style",t)}})}),document.querySelectorAll(".djs-dragger, .djs-drag-group, .djs-create-group").forEach(e=>{e instanceof HTMLElement&&(e.style.backgroundColor="transparent")}))}let U=(0,a.memo)(function(e){let{options:t={},onDesignerReady:n,className:o}=e,r=(0,a.useRef)(null),[s,l]=(0,a.useState)(null),[c,d]=(0,a.useState)(!1);(0,a.useEffect)(()=>{d(!0)},[]);let m=(0,a.useMemo)(()=>({height:100,theme:"light",lang:"en",valueType:"yaml",...t}),[t]),p=(0,a.useCallback)(e=>{null==n||n(e)},[n]);return(0,a.useEffect)(()=>{let e;if(!c||!r.current||s)return;let t=null,n=setTimeout(()=>{try{console.log("Initializing BPMN designer...",m),t=new V({container:r.current,...m}),l(t),p(t),console.log("BPMN designer initialized successfully"),e=function(){q();let e=setInterval(q,500),t=null;document.addEventListener("dragstart",e=>{console.log("Drag started - increasing fix frequency"),t&&clearInterval(t),t=setInterval(()=>{q(),document.documentElement.classList.contains("dark")&&(document.querySelectorAll(".djs-drag-group rect, .djs-dragging rect, .djs-dragger rect").forEach(e=>{let t=e.getAttribute("fill");("white"===t||"#fff"===t||"#ffffff"===t)&&(e.setAttribute("fill","#374151"),e instanceof SVGElement&&(e.style.fill="#374151"))}),document.querySelectorAll(".djs-drag-group, .djs-dragging, .djs-dragger").forEach(e=>{e instanceof HTMLElement&&(e.style.backgroundColor="transparent")}))},20)}),document.addEventListener("dragend",()=>{console.log("Drag ended - reducing fix frequency"),t&&(clearInterval(t),t=null),q()}),document.addEventListener("mousedown",e=>{let n=e.target;if(n.closest(".bpmn-palette")||n.closest(".djs-palette")){t&&clearInterval(t),t=setInterval(q,50);let e=()=>{t&&(clearInterval(t),t=null),q(),document.removeEventListener("mouseup",e)};document.addEventListener("mouseup",e)}});let n=new MutationObserver(e=>{let t=!1;e.forEach(e=>{if("childList"===e.type&&e.addedNodes.forEach(e=>{if(e instanceof Element){var n,i,a,o,r,s;((null===(n=e.classList)||void 0===n?void 0:n.contains("djs-hit"))||(null===(i=e.querySelector)||void 0===i?void 0:i.call(e,'[class*="djs-hit"]'))||(null===(a=e.classList)||void 0===a?void 0:a.contains("djs-group"))||(null===(o=e.id)||void 0===o?void 0:o.includes("Group"))||(null===(s=e.getAttribute)||void 0===s?void 0:null===(r=s.call(e,"data-element-id"))||void 0===r?void 0:r.includes("Group")))&&(t=!0)}}),"attributes"===e.type&&("style"===e.attributeName||"stroke"===e.attributeName)){var n,i,a;let o=e.target;((null===(n=o.classList)||void 0===n?void 0:n.contains("djs-hit"))||(null===(i=o.classList)||void 0===i?void 0:i.contains("djs-hit-stroke"))||(null===(a=o.closest)||void 0===a?void 0:a.call(o,".djs-group")))&&(t=!0)}}),t&&q()}),i=document.querySelector(".djs-container");return i&&n.observe(i,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style","stroke","fill","class"]}),()=>{clearInterval(e),n.disconnect()}}()}catch(e){console.error("Failed to initialize BPMN designer:",e),console.error("Container element:",r.current),console.error("Options:",m)}},150);return()=>{clearTimeout(n),null==e||e(),t&&(t.destroy(),l(null))}},[c]),(0,a.useEffect)(()=>{s&&m.theme&&s.changeTheme(m.theme)},[s,m.theme]),(0,i.jsx)("div",{ref:r,className:"flex-1 bpmn-canvas ".concat(o||"")})});var H=n(2451),Q=n(407),J=n(875),W=n(4887),Y=n(3247),K=n(2489);function $(e){var t;let{triggerRef:n,groupId:o,isVisible:r,onClose:s,onAction:l}=e,[c,d]=(0,a.useState)({top:0,left:0}),[m,p]=(0,a.useState)(o||null),[u,h]=(0,a.useState)(""),[v,b]=(0,a.useState)(!1),g=(0,a.useRef)(null),f=(0,a.useRef)(null),[y,x]=(0,a.useState)(!1),E=o?Z.filter(e=>e.id===o):Z,w=u?E.map(e=>({...e,items:e.items.filter(e=>e.title.toLowerCase().includes(u.toLowerCase())||e.action.toLowerCase().includes(u.toLowerCase()))})).filter(e=>e.items.length>0):E;(0,a.useEffect)(()=>{x(!0)},[]),(0,a.useEffect)(()=>{if(!r||!n.current)return;let e=()=>{let e=n.current.getBoundingClientRect(),t=o?280:360,i=o?300:450,a=e.right+8,r=e.top+e.height/2-i/2;a+t>window.innerWidth-10&&(a=e.left-t-8)<10&&(a=window.innerWidth-t-10),r<10?r=10:r+i>window.innerHeight-10&&(r=window.innerHeight-i-10),d({top:r,left:a})};return e(),window.addEventListener("resize",e),window.addEventListener("scroll",e),()=>{window.removeEventListener("resize",e),window.removeEventListener("scroll",e)}},[r,n]),(0,a.useEffect)(()=>{if(!r)return;let e=e=>{var t,i;(null===(t=g.current)||void 0===t?void 0:t.contains(e.target))||(null===(i=n.current)||void 0===i?void 0:i.contains(e.target))||s()};return setTimeout(()=>{document.addEventListener("click",e)},100),()=>document.removeEventListener("click",e)},[r,s,n]),(0,a.useEffect)(()=>{o&&1===E.length&&p(o)},[o,E.length]),(0,a.useEffect)(()=>{v&&f.current&&f.current.focus()},[v]);let j=(e,t)=>{t.preventDefault(),t.stopPropagation(),l(e,t.nativeEvent),s()},k=(e,t)=>{t.stopPropagation(),l(e,t.nativeEvent)};return y&&r?(0,W.createPortal)((0,i.jsxs)("div",{ref:g,className:"bpmn-palette-popover fixed z-[9999] bg-card border border-border rounded-lg shadow-2xl overflow-hidden animate-in fade-in-0 slide-in-from-left-2 duration-200",style:{top:"".concat(c.top,"px"),left:"".concat(c.left,"px"),width:o?"280px":"360px",maxHeight:o?"300px":"450px"},children:[(0,i.jsxs)("div",{className:"sticky top-0 z-10 bg-card border-b border-border",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between p-2 bg-muted/50",children:[(0,i.jsx)("h3",{className:"text-sm font-semibold",children:o?null===(t=E[0])||void 0===t?void 0:t.title:"BPMN Elements"}),(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[!o&&(0,i.jsx)("button",{onClick:()=>{b(!v),h(""),v||setTimeout(()=>{var e;return null===(e=f.current)||void 0===e?void 0:e.focus()},0)},className:"p-1 rounded hover:bg-accent transition-colors",title:"Search elements (Ctrl+F)",children:(0,i.jsx)(Y.Z,{className:"h-4 w-4"})}),(0,i.jsx)("button",{onClick:s,className:"p-1 rounded hover:bg-accent transition-colors",title:"Close (Esc)",children:(0,i.jsx)(K.Z,{className:"h-4 w-4"})})]})]}),v&&(0,i.jsx)("div",{className:"p-2 border-b border-border",children:(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(Y.Z,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,i.jsx)("input",{ref:f,type:"text",value:u,onChange:e=>h(e.target.value),placeholder:"Search elements...",className:"w-full pl-8 pr-2 py-1 text-sm bg-background border border-border rounded focus:outline-none focus:ring-2 focus:ring-primary",onKeyDown:e=>{"Escape"===e.key&&(b(!1),h(""))}})]})})]}),(0,i.jsx)("div",{className:"overflow-y-auto",style:{maxHeight:o?"240px":"350px"},children:(0,i.jsx)("div",{className:"p-2",children:0===w.length?(0,i.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,i.jsx)(Y.Z,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),(0,i.jsx)("p",{className:"text-sm",children:"No elements found"}),(0,i.jsx)("p",{className:"text-xs mt-1",children:"Try a different search term"})]}):w.map(e=>(0,i.jsxs)("div",{className:"mb-2",children:[!o&&(0,i.jsxs)("button",{className:"w-full flex items-center justify-between p-2 rounded hover:bg-accent transition-colors text-sm font-medium",onClick:()=>p(m===e.id?null:e.id),children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("i",{className:"".concat(e.icon," text-base")}),(0,i.jsx)("span",{children:e.title}),(0,i.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",e.items.length,")"]})]}),(0,i.jsx)(Q.Z,{className:"h-4 w-4 transition-transform ".concat(m===e.id?"rotate-90":"")})]}),(m===e.id||u)&&(0,i.jsx)("div",{className:"grid ".concat(o?"grid-cols-3":"grid-cols-4"," gap-1 p-2 mt-1 bg-muted/30 rounded"),children:e.items.map(e=>(0,i.jsxs)("div",{className:"bpmn-entry flex flex-col items-center justify-center p-2 rounded cursor-pointer hover:bg-accent transition-colors group relative",draggable:"true","data-action":e.action,title:e.title,style:{color:e.color},onClick:t=>j(e.action,t),onDragStart:t=>k(e.action,t),children:[(0,i.jsx)("i",{className:"bpmn-entry-icon ".concat(e.icon," text-lg mb-1")}),(0,i.jsx)("span",{className:"text-[10px] text-center leading-tight text-muted-foreground group-hover:text-foreground",children:e.title.length>12?e.title.substring(0,10)+"...":e.title}),(0,i.jsxs)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-popover text-popover-foreground text-xs rounded shadow-md opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-10",children:[e.title,(0,i.jsx)("div",{className:"text-[10px] text-muted-foreground mt-0.5",children:e.action})]})]},e.action))})]},e.id))})})]}),document.body):null}let ee=(0,a.memo)(function(e){let{className:t,onAction:n,activeTool:o}=e,[r,s]=(0,a.useState)(!0),[l,c]=(0,a.useState)(!1),[d,m]=(0,a.useState)(!1),[p,u]=(0,a.useState)(null),[h,v]=(0,a.useState)(new Set),b=(0,a.useRef)(null),g=(0,a.useRef)(null);(0,a.useEffect)(()=>{c(!0);let e=localStorage.getItem("bpmn-palette-expanded");null!==e&&s(JSON.parse(e)),v(new Set(Z.map(e=>e.id)))},[]);let f=(0,a.useCallback)(()=>{s(e=>{let t=!e;return localStorage.setItem("bpmn-palette-expanded",JSON.stringify(t)),t&&m(!1),t})},[]),y=(0,a.useCallback)(e=>{v(t=>{let n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})},[]),x=(0,a.useCallback)((e,t)=>{if(r)return;e.stopPropagation(),e.preventDefault();let n=e.currentTarget;g.current=n,p===t&&d?(m(!1),u(null)):(u(t),m(!0))},[r,p,d]);(0,a.useEffect)(()=>{if(!d)return;let e=e=>{var t;let n=e.target;(null===(t=g.current)||void 0===t?void 0:t.contains(n))||setTimeout(()=>{m(!1),u(null)},100)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[d]);let E=(0,a.useCallback)((e,t)=>{null==n||n(e,t),m(!1),u(null)},[n]),w=(0,a.useCallback)((e,t)=>{e.dataTransfer.effectAllowed="copy",e.dataTransfer.setData("bpmn/element",t),null==n||n(t,e.nativeEvent)},[n]),j=(0,a.useCallback)((e,t)=>{e.preventDefault(),e.stopPropagation(),null==n||n(t,e.nativeEvent)},[n]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{ref:b,className:D("bpmn-palette transition-all duration-300 ease-in-out bg-card border-r border-border h-full overflow-hidden flex flex-col","transform-none opacity-100",r?"w-64":"w-12",t),style:{isolation:"isolate",willChange:"width",backfaceVisibility:"hidden"},children:[(0,i.jsxs)("div",{className:"bpmn-palette_header flex items-center justify-between p-3 border-b border-border flex-shrink-0",children:[r&&(0,i.jsx)("p",{className:"text-sm font-medium",children:(0,i.jsx)("span",{children:"Elements palette"})}),l&&(0,i.jsx)("button",{onClick:f,className:"p-1 hover:bg-accent rounded transition-colors","aria-label":r?"Collapse palette":"Expand palette",children:r?(0,i.jsx)(H.Z,{className:"h-4 w-4"}):(0,i.jsx)(Q.Z,{className:"h-4 w-4"})})]}),r&&(0,i.jsx)("div",{className:"bpmn-palette_content flex-1 overflow-y-auto",children:(0,i.jsxs)("div",{className:"space-y-0",children:[(0,i.jsxs)("div",{className:"border-b border-border/50 bg-muted/30",children:[(0,i.jsx)("div",{className:"flex items-center justify-between p-3 font-medium text-sm",children:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("i",{className:"bpmn-icon-hand-tool text-sm"}),(0,i.jsx)("span",{children:"Tools"})]})}),(0,i.jsx)("div",{className:"p-3 pt-0",children:(0,i.jsxs)("div",{className:"bpmn-entries-grid grid grid-cols-4 gap-2",children:[(0,i.jsx)("div",{className:D("bpmn-entry flex items-center justify-center p-2 rounded cursor-pointer transition-colors","hand"===o?"highlighted-entry bg-primary/20":"hover:bg-accent"),onClick:e=>j(e,"hand-tool"),"data-action":"hand-tool","data-group":"TOOL",title:"Activate Hand Tool",children:(0,i.jsx)("i",{className:"bpmn-entry-icon bpmn-icon-hand-tool"})}),(0,i.jsx)("div",{className:D("bpmn-entry flex items-center justify-center p-2 rounded cursor-pointer transition-colors","lasso"===o?"highlighted-entry bg-primary/20":"hover:bg-accent"),onClick:e=>j(e,"lasso-tool"),"data-action":"lasso-tool","data-group":"TOOL",title:"Activate Lasso Tool",children:(0,i.jsx)("i",{className:"bpmn-entry-icon bpmn-icon-lasso-tool"})}),(0,i.jsx)("div",{className:D("bpmn-entry flex items-center justify-center p-2 rounded cursor-pointer transition-colors","space"===o?"highlighted-entry bg-primary/20":"hover:bg-accent"),onClick:e=>j(e,"space-tool"),"data-action":"space-tool","data-group":"TOOL",title:"Activate Space Tool",children:(0,i.jsx)("i",{className:"bpmn-entry-icon bpmn-icon-space-tool"})}),(0,i.jsx)("div",{className:D("bpmn-entry flex items-center justify-center p-2 rounded cursor-pointer transition-colors","global-connect"===o?"highlighted-entry bg-primary/20":"hover:bg-accent"),onClick:e=>j(e,"global-connect-tool"),"data-action":"global-connect-tool","data-group":"TOOL",title:"Activate Global Connect Tool",children:(0,i.jsx)("i",{className:"bpmn-entry-icon bpmn-icon-connection-multi"})})]})})]}),Z.map(e=>{let t=h.has(e.id);return e.items.slice(0,4),(0,i.jsxs)("div",{className:"border-b border-border/50",children:[(0,i.jsxs)("button",{className:"w-full flex items-center justify-between p-3 font-medium text-sm hover:bg-accent/50 transition-colors",onClick:()=>y(e.id),children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("i",{className:"".concat(e.icon," text-sm")}),(0,i.jsx)("span",{children:e.title})]}),(0,i.jsx)(J.Z,{className:D("h-4 w-4 transition-transform",t?"rotate-180":"")})]}),t&&(0,i.jsx)("div",{className:"p-3 pt-0",children:(0,i.jsx)("div",{className:"bpmn-entries-grid grid grid-cols-4 gap-2",children:e.items.map(t=>(0,i.jsx)("div",{className:"bpmn-entry flex items-center justify-center p-2 rounded cursor-pointer hover:bg-accent transition-colors",draggable:"true",onDragStart:e=>w(e,t.action),onClick:e=>j(e,t.action),"data-action":t.action,"data-group":e.id,title:t.title,style:{color:t.color},children:(0,i.jsx)("i",{className:"bpmn-entry-icon ".concat(t.icon)})},t.action))})})]},e.id)})]})}),!r&&(0,i.jsxs)("div",{className:"bpmn-palette_collapsed-content p-2 space-y-1 flex-1 overflow-y-auto",children:[(0,i.jsxs)("div",{"data-group":"tools",className:"tools-section space-y-1",children:[(0,i.jsx)("div",{className:D("bpmn-entry flex items-center justify-center p-2 rounded cursor-pointer transition-colors","hand"===o?"highlighted-entry bg-primary/20":"hover:bg-accent"),onClick:e=>j(e,"hand-tool"),"data-action":"hand-tool","data-group":"TOOL",title:"Hand Tool",children:(0,i.jsx)("i",{className:"bpmn-entry-icon bpmn-icon-hand-tool"})}),(0,i.jsx)("div",{className:D("bpmn-entry flex items-center justify-center p-2 rounded cursor-pointer transition-colors","lasso"===o?"highlighted-entry bg-primary/20":"hover:bg-accent"),onClick:e=>j(e,"lasso-tool"),"data-action":"lasso-tool","data-group":"TOOL",title:"Lasso Tool",children:(0,i.jsx)("i",{className:"bpmn-entry-icon bpmn-icon-lasso-tool"})}),(0,i.jsx)("div",{className:D("bpmn-entry flex items-center justify-center p-2 rounded cursor-pointer transition-colors","space"===o?"highlighted-entry bg-primary/20":"hover:bg-accent"),onClick:e=>j(e,"space-tool"),"data-action":"space-tool","data-group":"TOOL",title:"Space Tool",children:(0,i.jsx)("i",{className:"bpmn-entry-icon bpmn-icon-space-tool"})}),(0,i.jsx)("div",{className:D("bpmn-entry flex items-center justify-center p-2 rounded cursor-pointer transition-colors","global-connect"===o?"highlighted-entry bg-primary/20":"hover:bg-accent"),onClick:e=>j(e,"global-connect-tool"),"data-action":"global-connect-tool","data-group":"TOOL",title:"Global Connect",children:(0,i.jsx)("i",{className:"bpmn-entry-icon bpmn-icon-connection-multi"})})]}),(0,i.jsx)("div",{role:"separator",className:"h-px bg-border",style:{margin:"8px 0"}}),Z.map(e=>{var t;return(0,i.jsx)("div",{className:"bpmn-entry flex items-center justify-center p-2 rounded cursor-pointer hover:bg-accent transition-colors",onClick:t=>x(t,e.id),"data-group":e.id,title:"Click to show ".concat(e.title),style:{color:null===(t=e.items[0])||void 0===t?void 0:t.color},children:(0,i.jsx)("i",{className:"bpmn-entry-icon ".concat(e.icon)})},e.id)})]})]}),l&&g.current&&(0,i.jsx)($,{triggerRef:{current:g.current},groupId:p||void 0,isVisible:d&&!r,onClose:()=>{m(!1),u(null)},onAction:E})]})});var et=n(4952),en=n(2934),ei=n(8867),ea=n(8124);function eo(e){let{isOpen:t,onClose:n,xml:o}=e,[r,s]=(0,a.useState)(""),[l,c]=(0,a.useState)(!1),[d,m]=(0,a.useState)({tasks:0,events:0,gateways:0,dataObjects:0,participants:0,total:0});(0,a.useEffect)(()=>{o&&(s(u(o)),p(o))},[o]);let p=e=>{let t=(e.match(/<bpmn:(task|userTask|serviceTask|scriptTask|manualTask|receiveTask|sendTask)/gi)||[]).length,n=(e.match(/<bpmn:startEvent/gi)||[]).length,i=(e.match(/<bpmn:endEvent/gi)||[]).length,a=(e.match(/<bpmn:intermediate.*Event/gi)||[]).length,o=(e.match(/<bpmn:boundaryEvent/gi)||[]).length,r=(e.match(/<bpmn:.*Gateway/gi)||[]).length,s=(e.match(/<bpmn:(dataObject|dataStore)/gi)||[]).length,l=(e.match(/<bpmn:participant/gi)||[]).length,c=n+i+a+o;m({tasks:t,events:c,gateways:r,dataObjects:s,participants:l,total:t+c+r+s+l})},u=e=>{let t="",n=0;return e.split(/>\s*</).forEach((e,i)=>{if(0===i)t+=e;else{e.match(/^\/\w/)&&n--;let i="  ".repeat(Math.max(0,n));t+="\n"+i+"<"+e,!e.match(/^\//)&&!e.match(/\/\s*$/)&&n++}}),t},h=async()=>{try{await navigator.clipboard.writeText(o),c(!0),setTimeout(()=>c(!1),2e3)}catch(e){console.error("Failed to copy:",e)}};return t?(0,i.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,i.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:n}),(0,i.jsxs)("div",{className:D("relative z-10 w-[64vw] max-h-[80vh] bg-card rounded-lg shadow-xl","border border-border overflow-hidden flex flex-col"),children:[(0,i.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-border",children:[(0,i.jsxs)("div",{className:"flex items-center gap-4",children:[(0,i.jsx)("h2",{className:"text-lg font-semibold",children:"Preview"}),(0,i.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,i.jsx)(et.Z,{className:"h-4 w-4"}),(0,i.jsx)("span",{className:"font-medium",children:"BPMN 2.0"})]})]}),(0,i.jsx)("button",{onClick:n,className:"p-1 hover:bg-accent rounded-lg transition-colors","aria-label":"Close",children:(0,i.jsx)(K.Z,{className:"h-5 w-5"})})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between px-6 py-3 border-b border-border bg-muted/30",children:[(0,i.jsxs)("div",{className:"flex items-center gap-4",children:[(0,i.jsx)("button",{onClick:h,className:D("flex items-center gap-2 px-3 py-1.5 rounded-md transition-all","hover:bg-accent text-sm font-medium",l?"bg-green-500/20 text-green-600 dark:text-green-400":"bg-card"),children:l?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(en.Z,{className:"h-4 w-4"}),"Copied!"]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(ei.Z,{className:"h-4 w-4"}),"Copy XML"]})}),(0,i.jsxs)("div",{className:"flex items-center gap-3 px-3 py-1.5 bg-card rounded-md",children:[(0,i.jsx)(ea.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,i.jsxs)("div",{className:"flex items-center gap-4 text-sm",children:[(0,i.jsx)("span",{className:"text-muted-foreground",children:"Entities:"}),(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[d.tasks>0&&(0,i.jsxs)("span",{className:"font-medium",children:[(0,i.jsx)("span",{className:"text-blue-600 dark:text-blue-400",children:d.tasks}),(0,i.jsx)("span",{className:"text-muted-foreground ml-1",children:"Tasks"})]}),d.events>0&&(0,i.jsxs)("span",{className:"font-medium",children:[(0,i.jsx)("span",{className:"text-green-600 dark:text-green-400",children:d.events}),(0,i.jsx)("span",{className:"text-muted-foreground ml-1",children:"Events"})]}),d.gateways>0&&(0,i.jsxs)("span",{className:"font-medium",children:[(0,i.jsx)("span",{className:"text-yellow-600 dark:text-yellow-400",children:d.gateways}),(0,i.jsx)("span",{className:"text-muted-foreground ml-1",children:"Gateways"})]}),d.dataObjects>0&&(0,i.jsxs)("span",{className:"font-medium",children:[(0,i.jsx)("span",{className:"text-purple-600 dark:text-purple-400",children:d.dataObjects}),(0,i.jsx)("span",{className:"text-muted-foreground ml-1",children:"Data"})]}),d.participants>0&&(0,i.jsxs)("span",{className:"font-medium",children:[(0,i.jsx)("span",{className:"text-indigo-600 dark:text-indigo-400",children:d.participants}),(0,i.jsx)("span",{className:"text-muted-foreground ml-1",children:"Pools"})]}),0===d.total&&(0,i.jsx)("span",{className:"text-muted-foreground",children:"No entities"})]})]})]})]}),d.total>0&&(0,i.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1 bg-primary/10 text-primary rounded-full text-sm font-medium",children:[(0,i.jsx)("span",{children:"Total:"}),(0,i.jsx)("span",{className:"font-bold",children:d.total})]})]}),(0,i.jsx)("div",{className:"flex-1 p-6 overflow-auto",children:(0,i.jsx)("div",{className:"preview-model",children:(0,i.jsx)("pre",{className:"bg-muted p-4 rounded-lg overflow-x-auto",children:(0,i.jsx)("code",{className:"text-sm font-mono whitespace-pre",children:r})})})})]})]}):null}var er=n(2798);function es(){let[e,t]=(0,a.useState)(null),[n,s]=(0,a.useState)(100),[l,c]=(0,a.useState)(!1),[d,m]=(0,a.useState)(!1),[p,u]=(0,a.useState)(!1),[h,v]=(0,a.useState)(""),[b,g]=(0,a.useState)(!1),[f,y]=(0,a.useState)(!1),[x,E]=(0,a.useState)("hand"),{theme:w,toggleTheme:j}=(0,er.F)(),k=(0,a.useRef)(null),T=(0,a.useCallback)(e=>{t(e),e.changeTheme(w);let n=e.getCommandStack();n.on("changed",()=>{c(n.canUndo()),m(n.canRedo())}),console.log("BPMN Designer ready with custom palette provider")},[w]),N=(0,a.useCallback)((e,t)=>{console.log("handlePaletteAction called:",e,null==t?void 0:t.type);let n=window.__customPaletteProvider;if(!n){console.warn("Custom palette provider not found");return}try{if("hand-tool"===e||"hand"===e)n.activateHandTool(t),E("hand");else if("lasso-tool"===e||"lasso"===e)n.activateLassoTool(t),E("lasso");else if("space-tool"===e||"space"===e)n.activateSpaceTool(t),E("space");else if("global-connect-tool"===e||"global-connect"===e)n.activateGlobalConnect(t),E("global-connect");else{if(!t){let e=document.querySelector(".djs-container");if(e){let n=e.getBoundingClientRect();t=new MouseEvent("click",{clientX:n.left+n.width/2,clientY:n.top+n.height/2,bubbles:!0,cancelable:!0})}}n.createElement(e,t),E("hand")}}catch(t){console.error("Error handling palette action:",e,t)}},[]);(0,a.useEffect)(()=>{if(!k.current||!e)return;let t=k.current.querySelectorAll(".bpmn-entry"),n=[];return t.forEach(e=>{let t=e.getAttribute("data-action");if(!t)return;let i="true"===e.getAttribute("draggable");if(["hand-tool","lasso-tool","space-tool","global-connect-tool","hand","lasso","space","global-connect"].includes(t)){let i=e=>{e.preventDefault(),N(t,e)};e.addEventListener("click",i),n.push({element:e,event:"click",handler:i})}else if(i){let i=e=>{e.stopPropagation(),N(t,e)},a=e=>{e.preventDefault();let n=e.touches[0];N(t,new MouseEvent("mousedown",{clientX:n.clientX,clientY:n.clientY,bubbles:!0}))};e.addEventListener("mousedown",i),e.addEventListener("touchstart",a,{passive:!1}),n.push({element:e,event:"mousedown",handler:i}),n.push({element:e,event:"touchstart",handler:a})}}),()=>{n.forEach(e=>{let{element:t,event:n,handler:i}=e;t.removeEventListener(n,i)})}},[e,N]);let C=(0,a.useCallback)(async()=>{if(e)try{let t=await e.getXml();localStorage.setItem("bpmn-diagram",t),console.log("Diagram saved")}catch(e){console.error("Save failed:",e)}},[e]),S=(0,a.useCallback)(()=>{let e=document.getElementById("file-import");null==e||e.click()},[]),D=(0,a.useCallback)(async()=>{if(e)try{let t=await e.getXml();v(t),u(!0)}catch(e){console.error("Failed to get XML for preview:",e)}},[e]),L=(0,a.useCallback)(()=>{console.log("Run process")},[]),P=(0,a.useCallback)(()=>{var t;let n=document.getElementById("file-import");if(null==n?void 0:null===(t=n.files)||void 0===t?void 0:t[0]){let t=n.files[0],i=new FileReader;i.onload=t=>{var n;let i=null===(n=t.target)||void 0===n?void 0:n.result;null==e||e.setValue(i)},i.readAsText(t)}else{let t=document.createElement("input");t.type="file",t.accept=".bpmn,.xml,.yaml,.yml,.json",t.onchange=t=>{var n;let i=null===(n=t.target.files)||void 0===n?void 0:n[0];if(i){let t=new FileReader;t.onload=t=>{var n;let i=null===(n=t.target)||void 0===n?void 0:n.result;null==e||e.setValue(i)},t.readAsText(i)}},t.click()}},[e]),A=(0,a.useCallback)(async()=>{if(e)try{let t=await e.getXml(),n=new Blob([t],{type:"application/xml"}),i=URL.createObjectURL(n),a=document.createElement("a");a.href=i,a.download="process.bpmn",a.click(),URL.revokeObjectURL(i)}catch(e){console.error("Export failed:",e)}},[e]),I=(0,a.useCallback)(()=>{e&&e.getCommandStack().undo()},[e]),F=(0,a.useCallback)(()=>{e&&e.getCommandStack().redo()},[e]),B=(0,a.useCallback)(()=>{if(e){let t=e.getCanvas(),n=Math.min(1.2*t.zoom(),5);t.zoom(n),s(Math.round(100*n))}},[e]),O=(0,a.useCallback)(()=>{if(e){let t=e.getCanvas(),n=Math.max(t.zoom()/1.2,.2);t.zoom(n),s(Math.round(100*n))}},[e]),R=(0,a.useCallback)(()=>{if(e){let t=e.getCanvas();t.zoom("fit-viewport"),s(Math.round(100*t.zoom()))}},[e]),Z=(0,a.useCallback)(()=>{e&&confirm("Are you sure you want to clear the entire diagram?")&&e.clear()},[e]),G=(0,a.useCallback)(t=>{let n,i;if(!e)return;let a=e.getModeling(),o=e.getSelection().get();if(o.length<2)return;let r=o.map(e=>({element:e,x:e.x||0,y:e.y||0,width:e.width||100,height:e.height||80}));switch(t){case"left":n=Math.min(...r.map(e=>e.x)),r.forEach(e=>{e.x!==n&&a.moveElements([e.element],{x:n-e.x,y:0})});break;case"center":let s=r.reduce((e,t)=>e+t.x+t.width/2,0)/r.length;r.forEach(e=>{let t=e.x+e.width/2;t!==s&&a.moveElements([e.element],{x:s-t,y:0})});break;case"right":n=Math.max(...r.map(e=>e.x+e.width)),r.forEach(e=>{let t=e.x+e.width;t!==n&&a.moveElements([e.element],{x:n-t,y:0})});break;case"top":i=Math.min(...r.map(e=>e.y)),r.forEach(e=>{e.y!==i&&a.moveElements([e.element],{x:0,y:i-e.y})});break;case"middle":let l=r.reduce((e,t)=>e+t.y+t.height/2,0)/r.length;r.forEach(e=>{let t=e.y+e.height/2;t!==l&&a.moveElements([e.element],{x:0,y:l-t})});break;case"bottom":i=Math.max(...r.map(e=>e.y+e.height)),r.forEach(e=>{let t=e.y+e.height;t!==i&&a.moveElements([e.element],{x:0,y:i-t})})}},[e]),_=(0,a.useCallback)(()=>G("left"),[G]),X=(0,a.useCallback)(()=>G("center"),[G]),z=(0,a.useCallback)(()=>G("right"),[G]),V=(0,a.useCallback)(()=>G("top"),[G]),q=(0,a.useCallback)(()=>G("middle"),[G]),H=(0,a.useCallback)(()=>G("bottom"),[G]),Q=(0,a.useCallback)(()=>{null==e||e.toggleMinimap(),y(e=>!e)},[e]),J=(0,a.useCallback)(()=>{console.log("Toggle language")},[]),W=(0,a.useCallback)(()=>{g(e=>!e)},[]),Y=(0,a.useCallback)(()=>{j()},[j]);return(0,a.useEffect)(()=>{e&&e.changeTheme(w)},[w,e]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"bpmn-studio-container flex flex-col h-full",children:[!b&&(0,i.jsx)(M,{onImport:P,onExport:A,onSave:C,onOpenFolder:S,onPreview:D,onRun:L,onUndo:I,onRedo:F,onZoomIn:B,onZoomOut:O,onFitToViewport:R,onClear:Z,onAlignLeft:_,onAlignCenter:X,onAlignRight:z,onAlignTop:V,onAlignMiddle:q,onAlignBottom:H,onToggleMinimap:Q,onToggleLanguage:J,onToggleTheme:Y,onMeetingMode:W,theme:w,zoomLevel:n,canUndo:l,canRedo:d,isMeetingMode:b,isMinimapOpen:f}),(0,i.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[!b&&(0,i.jsx)("div",{ref:k,className:"relative z-20 flex-shrink-0",children:(0,i.jsx)(ee,{onAction:N,activeTool:x})}),(0,i.jsxs)("div",{className:"flex-1 relative overflow-hidden",children:[(0,i.jsx)(U,{onDesignerReady:T,options:{theme:w,onChange:e=>{console.log("BPMN changed:",e("yaml"))}}}),b&&(0,i.jsxs)("div",{className:"absolute top-4 right-4 flex gap-2 z-50",children:[(0,i.jsx)("button",{onClick:W,className:"p-2 bg-card/90 backdrop-blur rounded-lg shadow-lg hover:bg-card transition-colors",title:"Exit Meeting Mode",children:(0,i.jsx)(o.Z,{className:"h-5 w-5"})}),(0,i.jsx)("button",{onClick:R,className:"p-2 bg-card/90 backdrop-blur rounded-lg shadow-lg hover:bg-card transition-colors",title:"Fit to Screen",children:(0,i.jsx)(r.Z,{className:"h-5 w-5"})})]})]})]})]}),(0,i.jsx)(eo,{isOpen:p,onClose:()=>u(!1),xml:h})]})}var el=n(6865);class ec extends a.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Error caught by boundary:",e,t)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[400px] p-8",children:[(0,i.jsx)(el.Z,{className:"h-12 w-12 text-destructive mb-4"}),(0,i.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Something went wrong"}),(0,i.jsx)("p",{className:"text-muted-foreground text-center max-w-md mb-4",children:"An error occurred while rendering this component. Please try refreshing the page."}),this.state.error&&(0,i.jsxs)("details",{className:"text-sm text-muted-foreground max-w-md",children:[(0,i.jsx)("summary",{className:"cursor-pointer hover:text-foreground",children:"Error details"}),(0,i.jsx)("pre",{className:"mt-2 p-2 bg-muted rounded text-xs overflow-auto",children:this.state.error.toString()})]}),(0,i.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-primary text-primary-foreground rounded hover:bg-primary/90 transition-colors",children:"Refresh Page"})]}):this.props.children}constructor(e){super(e),this.state={hasError:!1,error:null}}}function ed(){return(0,i.jsx)("div",{className:"h-screen",children:(0,i.jsx)(ec,{children:(0,i.jsx)(es,{})})})}},2798:function(e,t,n){"use strict";n.d(t,{F:function(){return r},ThemeProvider:function(){return s}});var i=n(7437),a=n(2265);let o=(0,a.createContext)(void 0);function r(){let e=(0,a.useContext)(o);if(!e)throw Error("useTheme must be used within a ThemeProvider");return e}function s(e){let{children:t}=e,[n,r]=(0,a.useState)("light"),[s,l]=(0,a.useState)(!1);(0,a.useEffect)(()=>{l(!0);let e=localStorage.getItem("bpmn-studio-theme");if(e)r(e),document.documentElement.classList.toggle("dark","dark"===e);else{let e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";r(e),document.documentElement.classList.toggle("dark","dark"===e)}},[]);let c=e=>{r(e),localStorage.setItem("bpmn-studio-theme",e),document.documentElement.classList.toggle("dark","dark"===e)};return(0,i.jsx)(o.Provider,{value:{theme:n,toggleTheme:()=>{c("light"===n?"dark":"light")},setTheme:c},children:t})}}},function(e){e.O(0,[964,4,736,971,744],function(){return e(e.s=2361)}),_N_E=e.O()}]);