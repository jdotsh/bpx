(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[348],{2872:function(e,t,n){Promise.resolve().then(n.bind(n,7173))},7173:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Y}});var a=n(7437),o=n(2265),r=n(8906),i=n(2735),l=n(875),s=n(4508);function c(e){let{onExport:t,disabled:n=!1}=e,[r,c]=(0,o.useState)(!1),d=(0,o.useRef)(null);(0,o.useEffect)(()=>{let e=e=>{d.current&&!d.current.contains(e.target)&&c(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let p=e=>{t(e),c(!1)};return(0,a.jsxs)("div",{className:"relative",ref:d,children:[(0,a.jsxs)("button",{onClick:()=>c(!r),disabled:n,className:(0,s.cn)("flex items-center gap-1 px-2 py-1.5 text-xs font-medium rounded transition-colors","hover:bg-accent hover:text-accent-foreground",n&&"opacity-50 cursor-not-allowed",r&&"bg-accent text-accent-foreground"),title:"Export Diagram",children:[(0,a.jsx)(i.Z,{className:"h-4 w-4"}),(0,a.jsx)(l.Z,{className:"h-3 w-3"})]}),r&&(0,a.jsxs)("div",{className:"absolute top-full mt-1 left-0 z-50 min-w-[160px] rounded-md border bg-popover p-1 text-popover-foreground shadow-md",children:[(0,a.jsx)("button",{onClick:()=>p("bpmn"),className:"flex w-full items-center px-2 py-1.5 text-sm rounded hover:bg-accent hover:text-accent-foreground transition-colors",children:"Download as BPMN"}),(0,a.jsx)("button",{onClick:()=>p("xml"),className:"flex w-full items-center px-2 py-1.5 text-sm rounded hover:bg-accent hover:text-accent-foreground transition-colors",children:"Download as XML"}),(0,a.jsx)("button",{onClick:()=>p("svg"),className:"flex w-full items-center px-2 py-1.5 text-sm rounded hover:bg-accent hover:text-accent-foreground transition-colors",children:"Download as SVG"}),(0,a.jsx)("button",{onClick:()=>p("png"),className:"flex w-full items-center px-2 py-1.5 text-sm rounded hover:bg-accent hover:text-accent-foreground transition-colors",children:"Download as PNG"})]})]})}var d=n(3229),p=n(6475),m=n(2208),f=n(3276),u=n(3949),v=n(6841),b=n(9833),g=n(9893),y=n(6002),h=n(615),x=n(5802),k=n(3391),j=n(6443),E=n(2676),w=n(2048),T=n(4064),S=n(8477),N=n(2613),C=n(1473),D=n(7945),A=n(7410),L=n(5929),M=n(7226);let P=(0,o.memo)(function(e){let{onImport:t,onExport:n,onSave:r,onOpenFolder:i,onPreview:l,onRun:P,onUndo:I,onRedo:R,onZoomIn:B,onZoomOut:O,onFitToViewport:G,onClear:z,onAlignLeft:Z,onAlignCenter:U,onAlignRight:_,onAlignTop:q,onAlignMiddle:F,onAlignBottom:V,onToggleMinimap:X,onToggleLanguage:H,onToggleTheme:K,onToggleGrid:Y,onMeetingMode:W,onToggleScrollZoom:J,theme:Q="light",zoomLevel:$=100,canUndo:ee=!1,canRedo:et=!1,disabled:en=!1,isMeetingMode:ea=!1,isMinimapOpen:eo=!1,showGrid:er=!1,scrollZoomEnabled:ei=!0}=e,[el,es]=(0,o.useState)(!1),ec=e=>{let{onClick:t,icon:n,title:o,isDisabled:r=!1,isActive:i=!1,className:l}=e;return(0,a.jsx)("button",{onClick:t,disabled:r||en,title:o,className:(0,s.cn)("p-1.5 rounded hover:bg-accent transition-colors inline-flex items-center justify-center","disabled:opacity-50 disabled:cursor-not-allowed",i&&"bg-accent",l),children:(0,a.jsx)(n,{className:"h-4 w-4"})})};return(0,a.jsxs)("div",{className:"bpmn-toolbar flex items-center gap-2 px-3 py-1.5 border-b bg-card",children:[(0,a.jsxs)("div",{className:"flex items-center gap-0.5 border border-border/50 rounded p-0.5",children:[(0,a.jsx)(ec,{icon:d.Z,onClick:r,title:"Save"}),(0,a.jsx)(ec,{icon:p.Z,onClick:()=>{let e=document.getElementById("file-import");null==e||e.click()},title:"Open"}),(0,a.jsx)("input",{type:"file",accept:".xml,.bpmn,.yaml,.yml,.json",style:{display:"none"},id:"file-import",onChange:e=>{var n;(null===(n=e.target.files)||void 0===n?void 0:n[0])&&t&&t(),e.target.value=""}}),(0,a.jsx)(c,{onExport:n||(()=>{}),disabled:en}),(0,a.jsx)(ec,{icon:m.Z,onClick:l,title:"Preview"}),(0,a.jsx)(ec,{icon:f.Z,onClick:P,title:"Run Process"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-0.5 border border-border/50 rounded p-0.5",children:[(0,a.jsx)(ec,{icon:u.Z,onClick:Z,title:"Align Left"}),(0,a.jsx)(ec,{icon:v.Z,onClick:U,title:"Align Center"}),(0,a.jsx)(ec,{icon:b.Z,onClick:_,title:"Align Right"}),(0,a.jsx)(ec,{icon:g.Z,onClick:q,title:"Align Top"}),(0,a.jsx)(ec,{icon:y.Z,onClick:F,title:"Align Middle"}),(0,a.jsx)(ec,{icon:h.Z,onClick:V,title:"Align Bottom"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-0.5 border border-border/50 rounded p-0.5",children:[(0,a.jsx)(ec,{icon:x.Z,onClick:O,title:"Zoom Out"}),(0,a.jsxs)("button",{className:"px-2 py-1.5 min-w-[50px] text-xs font-medium hover:bg-accent rounded transition-colors",onClick:G,title:"Click to fit viewport",children:[$,"%"]}),(0,a.jsx)(ec,{icon:k.Z,onClick:B,title:"Zoom In"}),(0,a.jsx)(ec,{icon:j.Z,onClick:()=>{es(!el),null==G||G()},title:"Fit to Viewport",isActive:el}),(0,a.jsx)(ec,{icon:E.Z,onClick:J,title:ei?"Disable Scroll Zoom":"Enable Scroll Zoom",isActive:ei}),(0,a.jsx)(ec,{icon:w.Z,onClick:X,title:"Toggle Minimap",isActive:eo})]}),(0,a.jsxs)("div",{className:"flex items-center gap-0.5 border border-border/50 rounded p-0.5",children:[(0,a.jsx)(ec,{icon:T.Z,onClick:I,title:"Undo",isDisabled:!ee}),(0,a.jsx)(ec,{icon:S.Z,onClick:R,title:"Redo",isDisabled:!et}),(0,a.jsx)(ec,{icon:N.Z,onClick:z,title:"Clear All"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-0.5 border border-border/50 rounded p-0.5",children:[(0,a.jsx)(ec,{icon:C.Z,onClick:Y,title:"Toggle Grid",isActive:er}),(0,a.jsx)(ec,{icon:D.Z,onClick:H,title:"Language"}),(0,a.jsx)(ec,{icon:A.Z,onClick:W,title:"Meeting/Presentation Mode",isActive:ea}),(0,a.jsx)(ec,{icon:"light"===Q?L.Z:M.Z,onClick:K,title:"Toggle Theme"})]})]})});var I=n(2451),R=n(407),B=n(4887),O=n(3247),G=n(2489);let z=[{id:"start-events",title:"Start Events",icon:"bpmn-icon-start-event-none",items:[{action:"create.start-event",type:"bpmn:StartEvent",icon:"bpmn-icon-start-event-none",title:"Start Event",color:"var(--color-start-event)"},{action:"create.start-event-message",type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",icon:"bpmn-icon-start-event-message",title:"Message Start Event",color:"var(--color-start-event)"},{action:"create.start-event-timer",type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",icon:"bpmn-icon-start-event-timer",title:"Timer Start Event",color:"var(--color-start-event)"},{action:"create.start-event-conditional",type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",icon:"bpmn-icon-start-event-condition",title:"Conditional Start Event",color:"var(--color-start-event)"},{action:"create.start-event-signal",type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",icon:"bpmn-icon-start-event-signal",title:"Signal Start Event",color:"var(--color-start-event)"},{action:"create.start-event-error",type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ErrorEventDefinition",icon:"bpmn-icon-start-event-error",title:"Error Start Event",color:"var(--color-start-event)"},{action:"create.start-event-escalation",type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",icon:"bpmn-icon-start-event-escalation",title:"Escalation Start Event",color:"var(--color-start-event)"},{action:"create.start-event-compensation",type:"bpmn:StartEvent",eventDefinitionType:"bpmn:CompensateEventDefinition",icon:"bpmn-icon-start-event-compensation",title:"Compensation Start Event",color:"var(--color-start-event)"}]},{id:"tasks",title:"Tasks",icon:"bpmn-icon-task",items:[{action:"create.task",type:"bpmn:Task",icon:"bpmn-icon-task",title:"Task",color:"var(--color-activity)"},{action:"create.user-task",type:"bpmn:UserTask",icon:"bpmn-icon-user-task",title:"User Task",color:"var(--color-activity)"},{action:"create.service-task",type:"bpmn:ServiceTask",icon:"bpmn-icon-service-task",title:"Service Task",color:"var(--color-activity)"},{action:"create.script-task",type:"bpmn:ScriptTask",icon:"bpmn-icon-script-task",title:"Script Task",color:"var(--color-activity)"},{action:"create.business-rule-task",type:"bpmn:BusinessRuleTask",icon:"bpmn-icon-business-rule-task",title:"Business Rule Task",color:"var(--color-activity)"},{action:"create.send-task",type:"bpmn:SendTask",icon:"bpmn-icon-send-task",title:"Send Task",color:"var(--color-activity)"},{action:"create.receive-task",type:"bpmn:ReceiveTask",icon:"bpmn-icon-receive-task",title:"Receive Task",color:"var(--color-activity)"},{action:"create.manual-task",type:"bpmn:ManualTask",icon:"bpmn-icon-manual-task",title:"Manual Task",color:"var(--color-activity)"}]},{id:"gateways",title:"Gateways",icon:"bpmn-icon-gateway-none",items:[{action:"create.exclusive-gateway",type:"bpmn:ExclusiveGateway",icon:"bpmn-icon-gateway-xor",title:"Exclusive Gateway",color:"var(--color-gateway)"},{action:"create.parallel-gateway",type:"bpmn:ParallelGateway",icon:"bpmn-icon-gateway-parallel",title:"Parallel Gateway",color:"var(--color-gateway)"},{action:"create.inclusive-gateway",type:"bpmn:InclusiveGateway",icon:"bpmn-icon-gateway-or",title:"Inclusive Gateway",color:"var(--color-gateway)"},{action:"create.event-based-gateway",type:"bpmn:EventBasedGateway",icon:"bpmn-icon-gateway-eventbased",title:"Event-based Gateway",color:"var(--color-gateway)"},{action:"create.complex-gateway",type:"bpmn:ComplexGateway",icon:"bpmn-icon-gateway-complex",title:"Complex Gateway",color:"var(--color-gateway)"}]},{id:"end-events",title:"End Events",icon:"bpmn-icon-end-event-none",items:[{action:"create.end-event",type:"bpmn:EndEvent",icon:"bpmn-icon-end-event-none",title:"End Event",color:"var(--color-end-event)"},{action:"create.end-event-message",type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition",icon:"bpmn-icon-end-event-message",title:"Message End Event",color:"var(--color-end-event)"},{action:"create.end-event-escalation",type:"bpmn:EndEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",icon:"bpmn-icon-end-event-escalation",title:"Escalation End Event",color:"var(--color-end-event)"},{action:"create.end-event-error",type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition",icon:"bpmn-icon-end-event-error",title:"Error End Event",color:"var(--color-end-event)"},{action:"create.end-event-compensation",type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CompensateEventDefinition",icon:"bpmn-icon-end-event-compensation",title:"Compensation End Event",color:"var(--color-end-event)"},{action:"create.end-event-signal",type:"bpmn:EndEvent",eventDefinitionType:"bpmn:SignalEventDefinition",icon:"bpmn-icon-end-event-signal",title:"Signal End Event",color:"var(--color-end-event)"},{action:"create.end-event-terminate",type:"bpmn:EndEvent",eventDefinitionType:"bpmn:TerminateEventDefinition",icon:"bpmn-icon-end-event-terminate",title:"Terminate End Event",color:"var(--color-end-event)"},{action:"create.end-event-cancel",type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CancelEventDefinition",icon:"bpmn-icon-end-event-cancel",title:"Cancel End Event",color:"var(--color-end-event)"},{action:"create.end-event-link",type:"bpmn:EndEvent",eventDefinitionType:"bpmn:LinkEventDefinition",icon:"bpmn-icon-end-event-link",title:"Link End Event",color:"var(--color-end-event)"}]},{id:"intermediate-events",title:"Intermediate Events",icon:"bpmn-icon-intermediate-event-none",items:[{action:"create.intermediate-throw-event",type:"bpmn:IntermediateThrowEvent",icon:"bpmn-icon-intermediate-event-none",title:"Intermediate Throw Event",color:"var(--color-throw-event)"},{action:"create.intermediate-catch-event",type:"bpmn:IntermediateCatchEvent",icon:"bpmn-icon-intermediate-event-none",title:"Intermediate Catch Event",color:"var(--color-catch-event)"},{action:"create.intermediate-catch-event-message",type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:MessageEventDefinition",icon:"bpmn-icon-intermediate-event-catch-message",title:"Message Intermediate Catch Event",color:"var(--color-catch-event)"},{action:"create.intermediate-throw-event-message",type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:MessageEventDefinition",icon:"bpmn-icon-intermediate-event-throw-message",title:"Message Intermediate Throw Event",color:"var(--color-throw-event)"},{action:"create.intermediate-catch-event-timer",type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition",icon:"bpmn-icon-intermediate-event-catch-timer",title:"Timer Intermediate Catch Event",color:"var(--color-catch-event)"},{action:"create.intermediate-catch-event-conditional",type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",icon:"bpmn-icon-intermediate-event-catch-condition",title:"Conditional Intermediate Catch Event",color:"var(--color-catch-event)"},{action:"create.intermediate-catch-event-link",type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:LinkEventDefinition",icon:"bpmn-icon-intermediate-event-catch-link",title:"Link Intermediate Catch Event",color:"var(--color-catch-event)"},{action:"create.intermediate-throw-event-link",type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:LinkEventDefinition",icon:"bpmn-icon-intermediate-event-throw-link",title:"Link Intermediate Throw Event",color:"var(--color-throw-event)"},{action:"create.intermediate-catch-event-signal",type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:SignalEventDefinition",icon:"bpmn-icon-intermediate-event-catch-signal",title:"Signal Intermediate Catch Event",color:"var(--color-catch-event)"},{action:"create.intermediate-throw-event-signal",type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:SignalEventDefinition",icon:"bpmn-icon-intermediate-event-throw-signal",title:"Signal Intermediate Throw Event",color:"var(--color-throw-event)"},{action:"create.intermediate-throw-event-compensation",type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:CompensateEventDefinition",icon:"bpmn-icon-intermediate-event-throw-compensation",title:"Compensation Intermediate Throw Event",color:"var(--color-throw-event)"},{action:"create.intermediate-throw-event-escalation",type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",icon:"bpmn-icon-intermediate-event-throw-escalation",title:"Escalation Intermediate Throw Event",color:"var(--color-throw-event)"}]},{id:"subprocess",title:"Sub Process",icon:"bpmn-icon-subprocess-expanded",items:[{action:"create.subprocess-expanded",type:"bpmn:SubProcess",icon:"bpmn-icon-subprocess-expanded",title:"Sub Process (Expanded)",color:"var(--color-activity)",isExpanded:!0},{action:"create.subprocess-collapsed",type:"bpmn:SubProcess",icon:"bpmn-icon-subprocess-collapsed",title:"Sub Process (Collapsed)",color:"var(--color-activity)",isExpanded:!1},{action:"create.event-subprocess-expanded",type:"bpmn:SubProcess",eventDefinitionType:"bpmn:EventSubProcess",icon:"bpmn-icon-event-subprocess-expanded",title:"Event Sub Process",color:"var(--color-activity)",isExpanded:!0},{action:"create.transaction",type:"bpmn:Transaction",icon:"bpmn-icon-transaction",title:"Transaction",color:"var(--color-activity)",isExpanded:!0},{action:"create.call-activity",type:"bpmn:CallActivity",icon:"bpmn-icon-call-activity",title:"Call Activity",color:"var(--color-activity)"}]},{id:"boundary-events",title:"Boundary Events",icon:"bpmn-icon-intermediate-event-none",items:[{action:"create.boundary-event",type:"bpmn:BoundaryEvent",icon:"bpmn-icon-intermediate-event-none",title:"Boundary Event",color:"var(--color-catch-event)"},{action:"create.boundary-event-message",type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",icon:"bpmn-icon-intermediate-event-catch-message",title:"Message Boundary Event",color:"var(--color-catch-event)"},{action:"create.boundary-event-timer",type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",icon:"bpmn-icon-intermediate-event-catch-timer",title:"Timer Boundary Event",color:"var(--color-catch-event)"},{action:"create.boundary-event-escalation",type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",icon:"bpmn-icon-intermediate-event-catch-escalation",title:"Escalation Boundary Event",color:"var(--color-catch-event)"},{action:"create.boundary-event-conditional",type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",icon:"bpmn-icon-intermediate-event-catch-condition",title:"Conditional Boundary Event",color:"var(--color-catch-event)"},{action:"create.boundary-event-error",type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ErrorEventDefinition",icon:"bpmn-icon-intermediate-event-catch-error",title:"Error Boundary Event",color:"var(--color-catch-event)"},{action:"create.boundary-event-signal",type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",icon:"bpmn-icon-intermediate-event-catch-signal",title:"Signal Boundary Event",color:"var(--color-catch-event)"},{action:"create.boundary-event-compensation",type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CompensateEventDefinition",icon:"bpmn-icon-intermediate-event-catch-compensation",title:"Compensation Boundary Event",color:"var(--color-catch-event)"},{action:"create.boundary-event-cancel",type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CancelEventDefinition",icon:"bpmn-icon-intermediate-event-catch-cancel",title:"Cancel Boundary Event",color:"var(--color-catch-event)"}]},{id:"participants",title:"Participants",icon:"bpmn-icon-participant",items:[{action:"create.participant-expanded",type:"bpmn:Participant",icon:"bpmn-icon-participant",title:"Pool",color:"var(--color-participant)",isExpanded:!0},{action:"create.participant-collapsed",type:"bpmn:Participant",icon:"bpmn-icon-lane",title:"Collapsed Pool",color:"var(--color-participant)",isExpanded:!1},{action:"create.lane",type:"bpmn:Lane",icon:"bpmn-icon-lane",title:"Lane",color:"var(--color-participant)"}]},{id:"data",title:"Data Objects",icon:"bpmn-icon-data-object",items:[{action:"create.data-object",type:"bpmn:DataObjectReference",icon:"bpmn-icon-data-object",title:"Data Object",color:"var(--color-data)"},{action:"create.data-store",type:"bpmn:DataStoreReference",icon:"bpmn-icon-data-store",title:"Data Store",color:"var(--color-data)"},{action:"create.data-input",type:"bpmn:DataInput",icon:"bpmn-icon-data-input",title:"Data Input",color:"var(--color-data)"},{action:"create.data-output",type:"bpmn:DataOutput",icon:"bpmn-icon-data-output",title:"Data Output",color:"var(--color-data)"}]},{id:"artifacts",title:"Artifacts",icon:"bpmn-icon-text-annotation",items:[{action:"create.group",type:"bpmn:Group",icon:"bpmn-icon-group",title:"Group",color:"var(--color-artifact)"},{action:"create.text-annotation",type:"bpmn:TextAnnotation",icon:"bpmn-icon-text-annotation",title:"Text Annotation",color:"var(--color-artifact)"}]}];function Z(e){var t;let{triggerRef:n,groupId:r,isVisible:i,onClose:l,onAction:s}=e,[c,d]=(0,o.useState)({top:0,left:0}),[p,m]=(0,o.useState)(r||null),[f,u]=(0,o.useState)(""),[v,b]=(0,o.useState)(!1),g=(0,o.useRef)(null),y=(0,o.useRef)(null),[h,x]=(0,o.useState)(!1),[k,j]=(0,o.useState)(null),[E,w]=(0,o.useState)("right"),T=r?z.filter(e=>e.id===r):z,S=f?T.map(e=>({...e,items:e.items.filter(e=>e.title.toLowerCase().includes(f.toLowerCase())||e.action.toLowerCase().includes(f.toLowerCase()))})).filter(e=>e.items.length>0):T;(0,o.useEffect)(()=>{x(!0)},[]),(0,o.useEffect)(()=>{if(!i||!n.current)return;let e=()=>{let e=n.current.getBoundingClientRect(),t=r?280:360,a=r?300:450,o=e.right+8,i=e.top+e.height/2-a/2;o+t>window.innerWidth-10&&(o=e.left-t-8)<10&&(o=window.innerWidth-t-10),i<10?i=10:i+a>window.innerHeight-10&&(i=window.innerHeight-a-10),d({top:i,left:o})};return e(),window.addEventListener("resize",e),window.addEventListener("scroll",e),()=>{window.removeEventListener("resize",e),window.removeEventListener("scroll",e)}},[i,n]),(0,o.useEffect)(()=>{if(!i)return;let e=e=>{var t,a;(null===(t=g.current)||void 0===t?void 0:t.contains(e.target))||(null===(a=n.current)||void 0===a?void 0:a.contains(e.target))||l()};return setTimeout(()=>{document.addEventListener("click",e)},100),()=>document.removeEventListener("click",e)},[i,l,n]),(0,o.useEffect)(()=>{r&&1===T.length&&m(r)},[r,T.length]),(0,o.useEffect)(()=>{v&&y.current&&y.current.focus()},[v]);let N=(e,t)=>{t.preventDefault(),t.stopPropagation(),s(e,t.nativeEvent),l()},C=(e,t)=>{t.stopPropagation(),s(e,t.nativeEvent)},D=(0,o.useCallback)((e,t)=>{j(e),t.currentTarget.getBoundingClientRect().right+200>window.innerWidth-20?w("left"):w("right")},[]),A=(0,o.useCallback)(()=>{j(null)},[]);return h&&i?(0,B.createPortal)((0,a.jsxs)("div",{ref:g,className:"bpmn-palette-popover fixed z-[9999] bg-card border border-border rounded-lg shadow-2xl overflow-hidden animate-in fade-in-0 slide-in-from-left-2 duration-200",style:{top:"".concat(c.top,"px"),left:"".concat(c.left,"px"),width:r?"280px":"360px",maxHeight:r?"300px":"450px"},children:[(0,a.jsxs)("div",{className:"sticky top-0 z-10 bg-card border-b border-border",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 bg-muted/50",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold",children:r?null===(t=T[0])||void 0===t?void 0:t.title:"BPMN Elements"}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[!r&&(0,a.jsx)("button",{onClick:()=>{b(!v),u(""),v||setTimeout(()=>{var e;return null===(e=y.current)||void 0===e?void 0:e.focus()},0)},className:"p-1 rounded hover:bg-accent transition-colors",title:"Search elements (Ctrl+F)",children:(0,a.jsx)(O.Z,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:l,className:"p-1 rounded hover:bg-accent transition-colors",title:"Close (Esc)",children:(0,a.jsx)(G.Z,{className:"h-4 w-4"})})]})]}),v&&(0,a.jsx)("div",{className:"p-2 border-b border-border",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(O.Z,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)("input",{ref:y,type:"text",value:f,onChange:e=>u(e.target.value),placeholder:"Search elements...",className:"w-full pl-8 pr-2 py-1 text-sm bg-background border border-border rounded focus:outline-none focus:ring-2 focus:ring-primary",onKeyDown:e=>{"Escape"===e.key&&(b(!1),u(""))}})]})})]}),(0,a.jsx)("div",{className:"overflow-y-auto overflow-x-visible",style:{maxHeight:r?"240px":"350px",position:"relative"},children:(0,a.jsx)("div",{className:"p-2 overflow-visible",children:0===S.length?(0,a.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,a.jsx)(O.Z,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),(0,a.jsx)("p",{className:"text-sm",children:"No elements found"}),(0,a.jsx)("p",{className:"text-xs mt-1",children:"Try a different search term"})]}):S.map(e=>(0,a.jsxs)("div",{className:"mb-2",children:[!r&&(0,a.jsxs)("button",{className:"w-full flex items-center justify-between p-2 rounded hover:bg-accent transition-colors text-sm font-medium",onClick:()=>m(p===e.id?null:e.id),children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("i",{className:"".concat(e.icon," text-base")}),(0,a.jsx)("span",{children:e.title}),(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",e.items.length,")"]})]}),(0,a.jsx)(R.Z,{className:"h-4 w-4 transition-transform ".concat(p===e.id?"rotate-90":"")})]}),(p===e.id||f)&&(0,a.jsx)("div",{className:"grid ".concat(r?"grid-cols-3":"grid-cols-4"," gap-1 p-2 mt-1 bg-muted/30 rounded overflow-visible"),style:{position:"relative",zIndex:1},children:e.items.map(e=>{let t=k===e.action;return(0,a.jsxs)("div",{className:"bpmn-entry flex flex-col items-center justify-center p-2 rounded cursor-pointer hover:bg-accent transition-colors group relative overflow-visible",draggable:"true","data-action":e.action,style:{color:e.color},onClick:t=>N(e.action,t),onDragStart:t=>C(e.action,t),onMouseEnter:t=>D(e.action,t),onMouseLeave:A,children:[(0,a.jsx)("i",{className:"bpmn-entry-icon ".concat(e.icon," text-lg mb-1")}),(0,a.jsx)("span",{className:"text-[10px] text-center leading-tight text-muted-foreground group-hover:text-foreground",children:e.title.length>12?e.title.substring(0,10)+"...":e.title}),(0,a.jsxs)("div",{className:"absolute top-1/2 transform -translate-y-1/2 ".concat("left"===E?"right-full left-auto mr-2":"left-full right-auto ml-2"," px-3 py-2 bg-popover border border-border text-popover-foreground rounded-md shadow-xl transition-all duration-200 pointer-events-none whitespace-nowrap ").concat(t?"opacity-100 scale-100 z-[10002]":"opacity-0 scale-95 z-[10000]"),style:{visibility:t?"visible":"hidden",transitionDelay:t?"500ms":"0ms"},children:[(0,a.jsx)("div",{className:"font-semibold text-sm",children:e.title}),(0,a.jsxs)("div",{className:"text-[11px] text-muted-foreground mt-0.5",children:["Action: ",e.action]}),(0,a.jsx)("div",{className:"absolute top-1/2 transform -translate-y-1/2 w-0 h-0 border-t-[5px] border-b-[5px] border-transparent ".concat("left"===E?"left-full right-auto border-l-4 border-r-0 border-l-border":"right-full left-auto border-r-4 border-l-0 border-r-border")})]})]},e.action)})})]},e.id))})})]}),document.body):null}let U=(0,o.memo)(function(e){let{className:t,onAction:n,activeTool:r}=e,[i,c]=(0,o.useState)(!0),[d,p]=(0,o.useState)(!1),[m,f]=(0,o.useState)(!1),[u,v]=(0,o.useState)(null),[b,g]=(0,o.useState)(new Set),y=(0,o.useRef)(null),h=(0,o.useRef)(null);(0,o.useEffect)(()=>{p(!0);let e=localStorage.getItem("bpmn-palette-expanded");null!==e&&c(JSON.parse(e)),g(new Set(z.map(e=>e.id)))},[]);let x=(0,o.useCallback)(()=>{c(e=>{let t=!e;return localStorage.setItem("bpmn-palette-expanded",JSON.stringify(t)),t&&f(!1),t})},[]),k=(0,o.useCallback)(e=>{g(t=>{let n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})},[]),j=(0,o.useCallback)((e,t)=>{if(i)return;e.stopPropagation(),e.preventDefault();let n=e.currentTarget;h.current=n,u===t&&m?(f(!1),v(null)):(v(t),f(!0))},[i,u,m]);(0,o.useEffect)(()=>{if(!m)return;let e=e=>{var t;let n=e.target;(null===(t=h.current)||void 0===t?void 0:t.contains(n))||setTimeout(()=>{f(!1),v(null)},100)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[m]);let E=(0,o.useCallback)((e,t)=>{null==n||n(e,t),f(!1),v(null)},[n]),w=(0,o.useCallback)((e,t)=>{e.dataTransfer.effectAllowed="copy",e.dataTransfer.setData("bpmn/element",t),null==n||n(t,e.nativeEvent)},[n]),T=(0,o.useCallback)((e,t)=>{e.preventDefault(),e.stopPropagation(),null==n||n(t,e.nativeEvent)},[n]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{ref:y,className:(0,s.cn)("bpmn-palette transition-all duration-300 ease-in-out bg-card border-r border-border h-full overflow-hidden flex flex-col","transform-none opacity-100",i?"w-64":"w-12",t),style:{isolation:"isolate",willChange:"width",backfaceVisibility:"hidden"},children:[(0,a.jsxs)("div",{className:"bpmn-palette_header flex items-center justify-between p-3 border-b border-border flex-shrink-0",children:[i&&(0,a.jsx)("p",{className:"text-sm font-medium",children:(0,a.jsx)("span",{children:"Elements palette"})}),d&&(0,a.jsx)("button",{onClick:x,className:"p-1 hover:bg-accent rounded transition-colors","aria-label":i?"Collapse palette":"Expand palette",children:i?(0,a.jsx)(I.Z,{className:"h-4 w-4"}):(0,a.jsx)(R.Z,{className:"h-4 w-4"})})]}),i&&(0,a.jsx)("div",{className:"bpmn-palette_content flex-1 overflow-y-auto",children:(0,a.jsxs)("div",{className:"space-y-0",children:[(0,a.jsxs)("div",{className:"border-b border-border/50 bg-muted/30",children:[(0,a.jsx)("div",{className:"flex items-center justify-between p-3 font-medium text-sm",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("i",{className:"bpmn-icon-hand-tool text-sm"}),(0,a.jsx)("span",{children:"Tools"})]})}),(0,a.jsx)("div",{className:"p-3 pt-0",children:(0,a.jsxs)("div",{className:"bpmn-entries-grid grid grid-cols-4 gap-2",children:[(0,a.jsx)("div",{className:(0,s.cn)("bpmn-entry flex items-center justify-center p-2 rounded cursor-pointer transition-colors","hand"===r?"highlighted-entry bg-primary/20":"hover:bg-accent"),onClick:e=>T(e,"hand-tool"),"data-action":"hand-tool","data-group":"TOOL",title:"Activate Hand Tool",children:(0,a.jsx)("i",{className:"bpmn-entry-icon bpmn-icon-hand-tool"})}),(0,a.jsx)("div",{className:(0,s.cn)("bpmn-entry flex items-center justify-center p-2 rounded cursor-pointer transition-colors","lasso"===r?"highlighted-entry bg-primary/20":"hover:bg-accent"),onClick:e=>T(e,"lasso-tool"),"data-action":"lasso-tool","data-group":"TOOL",title:"Activate Lasso Tool",children:(0,a.jsx)("i",{className:"bpmn-entry-icon bpmn-icon-lasso-tool"})}),(0,a.jsx)("div",{className:(0,s.cn)("bpmn-entry flex items-center justify-center p-2 rounded cursor-pointer transition-colors","space"===r?"highlighted-entry bg-primary/20":"hover:bg-accent"),onClick:e=>T(e,"space-tool"),"data-action":"space-tool","data-group":"TOOL",title:"Activate Space Tool",children:(0,a.jsx)("i",{className:"bpmn-entry-icon bpmn-icon-space-tool"})}),(0,a.jsx)("div",{className:(0,s.cn)("bpmn-entry flex items-center justify-center p-2 rounded cursor-pointer transition-colors","global-connect"===r?"highlighted-entry bg-primary/20":"hover:bg-accent"),onClick:e=>T(e,"global-connect-tool"),"data-action":"global-connect-tool","data-group":"TOOL",title:"Activate Global Connect Tool",children:(0,a.jsx)("i",{className:"bpmn-entry-icon bpmn-icon-connection-multi"})})]})})]}),z.map(e=>{let t=b.has(e.id);return e.items.slice(0,4),(0,a.jsxs)("div",{className:"border-b border-border/50",children:[(0,a.jsxs)("button",{className:"w-full flex items-center justify-between p-3 font-medium text-sm hover:bg-accent/50 transition-colors",onClick:()=>k(e.id),children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("i",{className:"".concat(e.icon," text-sm")}),(0,a.jsx)("span",{children:e.title})]}),(0,a.jsx)(l.Z,{className:(0,s.cn)("h-4 w-4 transition-transform",t?"rotate-180":"")})]}),t&&(0,a.jsx)("div",{className:"p-3 pt-0",children:(0,a.jsx)("div",{className:"bpmn-entries-grid grid grid-cols-4 gap-2",children:e.items.map(t=>(0,a.jsx)("div",{className:"bpmn-entry flex items-center justify-center p-2 rounded cursor-pointer hover:bg-accent transition-colors",draggable:"true",onDragStart:e=>w(e,t.action),onClick:e=>T(e,t.action),"data-action":t.action,"data-group":e.id,title:t.title,style:{color:t.color},children:(0,a.jsx)("i",{className:"bpmn-entry-icon ".concat(t.icon)})},t.action))})})]},e.id)})]})}),!i&&(0,a.jsxs)("div",{className:"bpmn-palette_collapsed-content p-2 space-y-1 flex-1 overflow-y-auto",children:[(0,a.jsxs)("div",{"data-group":"tools",className:"tools-section space-y-1",children:[(0,a.jsx)("div",{className:(0,s.cn)("bpmn-entry flex items-center justify-center p-2 rounded cursor-pointer transition-colors","hand"===r?"highlighted-entry bg-primary/20":"hover:bg-accent"),onClick:e=>T(e,"hand-tool"),"data-action":"hand-tool","data-group":"TOOL",title:"Hand Tool",children:(0,a.jsx)("i",{className:"bpmn-entry-icon bpmn-icon-hand-tool"})}),(0,a.jsx)("div",{className:(0,s.cn)("bpmn-entry flex items-center justify-center p-2 rounded cursor-pointer transition-colors","lasso"===r?"highlighted-entry bg-primary/20":"hover:bg-accent"),onClick:e=>T(e,"lasso-tool"),"data-action":"lasso-tool","data-group":"TOOL",title:"Lasso Tool",children:(0,a.jsx)("i",{className:"bpmn-entry-icon bpmn-icon-lasso-tool"})}),(0,a.jsx)("div",{className:(0,s.cn)("bpmn-entry flex items-center justify-center p-2 rounded cursor-pointer transition-colors","space"===r?"highlighted-entry bg-primary/20":"hover:bg-accent"),onClick:e=>T(e,"space-tool"),"data-action":"space-tool","data-group":"TOOL",title:"Space Tool",children:(0,a.jsx)("i",{className:"bpmn-entry-icon bpmn-icon-space-tool"})}),(0,a.jsx)("div",{className:(0,s.cn)("bpmn-entry flex items-center justify-center p-2 rounded cursor-pointer transition-colors","global-connect"===r?"highlighted-entry bg-primary/20":"hover:bg-accent"),onClick:e=>T(e,"global-connect-tool"),"data-action":"global-connect-tool","data-group":"TOOL",title:"Global Connect",children:(0,a.jsx)("i",{className:"bpmn-entry-icon bpmn-icon-connection-multi"})})]}),(0,a.jsx)("div",{role:"separator",className:"h-px bg-border",style:{margin:"8px 0"}}),z.map(e=>{var t;return(0,a.jsx)("div",{className:"bpmn-entry flex items-center justify-center p-2 rounded cursor-pointer hover:bg-accent transition-colors",onClick:t=>j(t,e.id),"data-group":e.id,title:"Click to show ".concat(e.title),style:{color:null===(t=e.items[0])||void 0===t?void 0:t.color},children:(0,a.jsx)("i",{className:"bpmn-entry-icon ".concat(e.icon)})},e.id)})]})]}),d&&h.current&&(0,a.jsx)(Z,{triggerRef:{current:h.current},groupId:u||void 0,isVisible:m&&!i,onClose:()=>{f(!1),v(null)},onAction:E})]})});var _=n(401),q=n(8867),F=n(2869);function V(e){let{isOpen:t,onClose:n,xml:r,onSave:l,readOnly:s=!1}=e,[c,d]=(0,o.useState)(r),[p,m]=(0,o.useState)(!1),[f,u]=(0,o.useState)(null);if((0,o.useEffect)(()=>{d(r),u(null)},[r]),!t)return null;let v=e=>{try{let t=new DOMParser().parseFromString(e,"text/xml").querySelector("parsererror");if(t)return u("Invalid XML: "+t.textContent),!1;return u(null),!0}catch(e){return u("XML parsing error"),!1}};return(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:(0,a.jsxs)("div",{className:"bg-card w-[90%] max-w-5xl h-[80vh] rounded-lg shadow-2xl flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,a.jsxs)("h2",{className:"text-lg font-semibold",children:["BPMN XML ",s?"Viewer":"Editor"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(F.z,{variant:"outline",size:"sm",onClick:()=>{navigator.clipboard.writeText(c),m(!0),setTimeout(()=>m(!1),2e3)},className:"flex items-center gap-2",children:[p?(0,a.jsx)(_.Z,{className:"h-4 w-4"}):(0,a.jsx)(q.Z,{className:"h-4 w-4"}),p?"Copied!":"Copy"]}),(0,a.jsxs)(F.z,{variant:"outline",size:"sm",onClick:()=>{let e=new Blob([c],{type:"text/xml"}),t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="diagram.bpmn",n.click(),URL.revokeObjectURL(t)},className:"flex items-center gap-2",children:[(0,a.jsx)(i.Z,{className:"h-4 w-4"}),"Download"]}),(0,a.jsx)(F.z,{variant:"ghost",size:"sm",onClick:n,children:(0,a.jsx)(G.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsx)("div",{className:"flex-1 p-4 overflow-hidden",children:(0,a.jsx)("textarea",{value:c,onChange:e=>{d(e.target.value),v(e.target.value)},readOnly:s,className:"w-full h-full p-4 font-mono text-sm bg-muted rounded border resize-none focus:outline-none focus:ring-2 focus:ring-primary",spellCheck:!1})}),f&&(0,a.jsx)("div",{className:"px-4 pb-2",children:(0,a.jsx)("div",{className:"text-sm text-destructive bg-destructive/10 rounded p-2",children:f})}),!s&&(0,a.jsxs)("div",{className:"flex items-center justify-end gap-2 p-4 border-t",children:[(0,a.jsx)(F.z,{variant:"outline",onClick:n,children:"Cancel"}),(0,a.jsx)(F.z,{onClick:()=>{v(c)&&l&&(l(c),n())},disabled:!!f,children:"Apply Changes"})]})]})})}var X=n(2798);let H='<?xml version="1.0" encoding="UTF-8"?>\n<bpmn2:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" \n  xmlns:bpmn2="http://www.omg.org/spec/BPMN/20100524/MODEL" \n  xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" \n  xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" \n  xmlns:di="http://www.omg.org/spec/DD/20100524/DI" \n  id="sample-diagram" \n  targetNamespace="http://bpmn.io/schema/bpmn">\n  <bpmn2:process id="Process_1" isExecutable="false">\n    <bpmn2:startEvent id="StartEvent_1" name="Start"/>\n  </bpmn2:process>\n  <bpmndi:BPMNDiagram id="BPMNDiagram_1">\n    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1">\n      <bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1">\n        <dc:Bounds height="36.0" width="36.0" x="412.0" y="240.0"/>\n      </bpmndi:BPMNShape>\n    </bpmndi:BPMNPlane>\n  </bpmndi:BPMNDiagram>\n</bpmn2:definitions>';function K(){let e=(0,o.useRef)(null),t=(0,o.useRef)(null),n=(0,o.useRef)(null),[i,l]=(0,o.useState)(!1),[s,c]=(0,o.useState)(null),[d,p]=(0,o.useState)(!1),[m,f]=(0,o.useState)(!1),{theme:u,setTheme:v}=(0,X.F)(),b=(0,o.useRef)(null),[g,y]=(0,o.useState)(100),[h,x]=(0,o.useState)(!1),[k,j]=(0,o.useState)(void 0),[E,w]=(0,o.useState)(!1),[T,S]=(0,o.useState)(!1),[N,C]=(0,o.useState)(!0),[D,A]=(0,o.useState)(!1),[L,M]=(0,o.useState)(!1),[I,R]=(0,o.useState)(""),[B,O]=(0,o.useState)([]),[G,z]=(0,o.useState)(!0),Z=(0,o.useCallback)((e,t)=>{if(e)try{let n=e.get("canvas");if(!n)return;let a=n._container||n.getContainer(),o=(null==a?void 0:a.querySelector("svg"))||n._svg;if(!o||"function"!=typeof o.createSVGMatrix){console.warn("SVG element not ready, delaying style application"),setTimeout(()=>Z(e,t),100);return}let r=b.current;r||((r=document.createElement("style")).id="bpmn-custom-styles",b.current=r);let i="dark"===t;if(console.log("Applying BPMN styles for theme:",t,"isDark:",i),r.textContent='\n      /* Ensure proper pointer events for drag and drop */\n      .djs-container {\n        pointer-events: auto !important;\n      }\n      \n      .djs-element > * {\n        pointer-events: all !important;\n      }\n      \n      .djs-hit {\n        pointer-events: all !important;\n        fill: transparent !important;\n        stroke: transparent !important;\n      }\n      \n      .djs-shape .djs-hit {\n        fill: transparent !important;\n        pointer-events: all !important;\n      }\n      \n      .djs-drag-active {\n        pointer-events: all !important;\n      }\n      \n      /* === ACTIVITIES (Tasks, Sub-processes) === */\n      \n      /* Task rectangles - MAXIMUM SPECIFICITY */\n      .djs-shape .djs-visual > rect,\n      .djs-element[data-element-id*="Task"] rect,\n      .djs-element[data-element-id*="Activity"] rect,\n      rect.djs-hit,\n      rect.djs-outline {\n        stroke: '.concat(i?"#ffffff":"#000000"," !important;\n        stroke-dasharray: none !important;\n        stroke-width: 2px !important;\n        fill: ").concat(i?"#1f2937":"#ffffff"," !important;\n      }\n      \n      /* All rect elements in shapes (fallback) */\n      .djs-shape rect {\n        stroke: ").concat(i?"#ffffff":"#000000"," !important;\n        fill: ").concat(i?"#1f2937":"#ffffff"," !important;\n      }\n      \n      /* NUCLEAR OPTION: Override ANY rect with black stroke in dark mode */\n      ").concat(i?'\n        rect[stroke="#000000"],\n        rect[stroke="black"],\n        rect[stroke="rgb(0, 0, 0)"],\n        rect[style*="stroke: rgb(0, 0, 0)"],\n        rect[style*="stroke:#000000"],\n        rect[style*="stroke: #000000"],\n        rect[style*="stroke:black"] {\n          stroke: #ffffff !important;\n          stroke-opacity: 1 !important;\n        }\n        \n        /* SUPER NUCLEAR: Target Tasks by ANY means necessary */\n        g[data-element-id*="Task"] rect,\n        g[data-element-id*="Activity"] rect,\n        .djs-group[data-element-id*="Task"] rect,\n        g.djs-element rect,\n        g.djs-shape rect,\n        svg rect:not([fill="none"]):not([fill="transparent"]) {\n          stroke: #ffffff !important;\n          stroke-opacity: 1 !important;\n          stroke-width: 2px !important;\n        }\n        \n        /* Target the visual rect specifically */\n        g[data-element-id*="Task"] > .djs-visual > rect,\n        g[data-element-id*="Activity"] > .djs-visual > rect {\n          stroke: #ffffff !important;\n          fill: #1f2937 !important;\n          stroke-opacity: 1 !important;\n        }\n      ':"",'\n      \n      /* Task type icons (user, service, script, etc) */\n      .djs-element[data-element-id*="Task"] .djs-visual > path,\n      .djs-element[data-element-id*="Task"] .djs-visual > g > path {\n        stroke: ').concat(i?"#ffffff":"#000000"," !important;\n        fill: ").concat(i?"#ffffff":"#000000",' !important;\n      }\n      \n      /* Sub-process markers (+) */\n      .djs-element[data-element-id*="SubProcess"] .djs-visual > path {\n        stroke: ').concat(i?"#ffffff":"#000000"," !important;\n        fill: none !important;\n      }\n      \n      /* === EVENTS === */\n      \n      /* Event circles (outer) */\n      .djs-shape .djs-visual > circle {\n        stroke: ").concat(i?"#ffffff":"#000000"," !important;\n        stroke-width: 2px !important;\n        fill: ").concat(i?"#1f2937":"#ffffff"," !important;\n      }\n      \n      /* All circle elements in shapes (fallback) */\n      .djs-shape circle {\n        stroke: ").concat(i?"#ffffff":"#000000"," !important;\n        fill: ").concat(i?"#1f2937":"#ffffff"," !important;\n      }\n      \n      /* Event inner circles (for intermediate/boundary) */\n      .djs-shape .djs-visual > g > circle {\n        stroke: ").concat(i?"#ffffff":"#000000"," !important;\n        fill: ").concat(i?"#1f2937":"#ffffff",' !important;\n      }\n      \n      /* Event type icons (message, timer, error, signal, etc) */\n      .djs-element[data-element-id*="Event"] .djs-visual > g > path,\n      .djs-element[data-element-id*="Event"] .djs-visual > path {\n        stroke: ').concat(i?"#ffffff":"#000000"," !important;\n        fill: ").concat(i?"#ffffff":"#000000",' !important;\n        stroke-width: 1px !important;\n      }\n      \n      /* Boundary events (attached to activities) */\n      .djs-element[data-element-id*="BoundaryEvent"] .djs-visual > circle {\n        stroke: ').concat(i?"#ffffff":"#000000"," !important;\n        fill: ").concat(i?"#1f2937":"#ffffff"," !important;\n      }\n      \n      /* === GATEWAYS === */\n      \n      /* Gateway diamonds */\n      .djs-shape .djs-visual > polygon {\n        stroke: ").concat(i?"#ffffff":"#000000"," !important;\n        stroke-width: 2px !important;\n        fill: ").concat(i?"#1f2937":"#ffffff"," !important;\n      }\n      \n      /* All polygon elements in shapes (fallback) */\n      .djs-shape polygon {\n        stroke: ").concat(i?"#ffffff":"#000000"," !important;\n        fill: ").concat(i?"#1f2937":"#ffffff",' !important;\n      }\n      \n      /* Gateway symbols (X, +, O, etc) */\n      .djs-element[data-element-id*="Gateway"] .djs-visual > g > path,\n      .djs-element[data-element-id*="Gateway"] .djs-visual > path {\n        stroke: ').concat(i?"#ffffff":"#000000",' !important;\n        fill: none !important;\n        stroke-width: 2px !important;\n      }\n      \n      /* Complex gateway star */\n      .djs-element[data-element-id*="ComplexGateway"] .djs-visual > path {\n        fill: ').concat(i?"#ffffff":"#000000"," !important;\n        stroke: ").concat(i?"#ffffff":"#000000",' !important;\n      }\n      \n      /* === DATA OBJECTS === */\n      \n      /* Data object shapes */\n      .djs-element[data-element-id*="DataObject"] .djs-visual > path,\n      .djs-element[data-element-id*="DataStore"] .djs-visual > path {\n        stroke: ').concat(i?"#ffffff":"#000000"," !important;\n        fill: ").concat(i?"#1f2937":"#ffffff",' !important;\n      }\n      \n      /* Data collection markers */\n      .djs-element[data-element-id*="DataObject"] .djs-visual > g > path {\n        stroke: ').concat(i?"#ffffff":"#000000",' !important;\n        fill: none !important;\n      }\n      \n      /* === PARTICIPANTS (Pools/Lanes) === */\n      \n      /* Pool/Lane containers */\n      .djs-element[data-element-id*="Participant"] .djs-visual > rect,\n      .djs-element[data-element-id*="Lane"] .djs-visual > rect {\n        stroke: ').concat(i?"#ffffff":"#000000"," !important;\n        fill: ").concat(i?"#1f2937":"#ffffff",' !important;\n      }\n      \n      /* Pool/Lane headers */\n      .djs-element[data-element-id*="Participant"] .djs-visual > g > rect:first-child,\n      .djs-element[data-element-id*="Lane"] .djs-visual > g > rect:first-child {\n        fill: ').concat(i?"#374151":"#e5e7eb"," !important;\n      }\n      \n      /* === CONNECTIONS === */\n      \n      /* Sequence flows and message flows */\n      .djs-connection .djs-visual > path {\n        stroke: ").concat(i?"#ffffff":"#000000"," !important;\n        fill: none !important;\n      }\n      \n      /* Arrow heads */\n      .djs-connection .djs-visual > polyline,\n      .djs-connection .djs-visual > polygon {\n        stroke: ").concat(i?"#ffffff":"#000000"," !important;\n        fill: ").concat(i?"#ffffff":"#000000",' !important;\n      }\n      \n      /* Association/Data association (dotted lines) */\n      .djs-connection[data-element-id*="Association"] .djs-visual > path {\n        stroke: ').concat(i?"#ffffff":"#000000",' !important;\n        stroke-dasharray: 5, 5 !important;\n      }\n      \n      /* Message flows (dashed lines) */\n      .djs-connection[data-element-id*="MessageFlow"] .djs-visual > path {\n        stroke: ').concat(i?"#ffffff":"#000000",' !important;\n        stroke-dasharray: 10, 5 !important;\n      }\n      \n      /* === ARTIFACTS === */\n      \n      /* Text annotations */\n      .djs-element[data-element-id*="TextAnnotation"] .djs-visual > rect {\n        stroke: ').concat(i?"#ffffff":"#000000",' !important;\n        fill: none !important;\n        stroke-dasharray: 5, 5 !important;\n      }\n      \n      /* Groups */\n      .djs-element[data-element-id*="Group"] .djs-visual > rect {\n        stroke: ').concat(i?"#ffffff":"#000000"," !important;\n        fill: none !important;\n        stroke-dasharray: 8, 3, 1, 3 !important;\n        stroke-width: 1px !important;\n      }\n      \n      /* === TEXT LABELS === */\n      \n      /* All text elements */\n      .djs-label,\n      .djs-shape .djs-visual text,\n      .djs-element text,\n      text {\n        fill: ").concat(i?"#ffffff":"#000000"," !important;\n      }\n      \n      /* Label backgrounds should be transparent */\n      .djs-label .djs-visual rect {\n        fill: transparent !important;\n        stroke: none !important;\n      }\n      \n      /* === GENERIC FALLBACKS === */\n      \n      /* Any other path elements */\n      .djs-shape .djs-visual > path {\n        stroke: ").concat(i?"#ffffff":"#000000",' !important;\n      }\n      \n      /* All paths with stroke attribute */\n      path[stroke]:not([stroke="none"]) {\n        stroke: ').concat(i?"#ffffff":"#000000"," !important;\n      }\n      \n      /* All ellipse elements */\n      ellipse {\n        stroke: ").concat(i?"#ffffff":"#000000"," !important;\n        fill: ").concat(i?"#1f2937":"#ffffff"," !important;\n      }\n      \n      /* All line elements */\n      line {\n        stroke: ").concat(i?"#ffffff":"#000000",' !important;\n      }\n      \n      /* Filled path elements (icons, markers) */\n      .djs-shape .djs-visual > g > path[fill]:not([fill="none"]) {\n        fill: ').concat(i?"#ffffff":"#000000",' !important;\n      }\n      \n      /* Catch all SVG shapes that might have black stroke in light mode */\n      .djs-visual > *[stroke="#000000"],\n      .djs-visual > *[stroke="black"],\n      .djs-visual > *[stroke="rgb(0,0,0)"],\n      .djs-visual > *[stroke="rgb(0, 0, 0)"] {\n        stroke: ').concat(i?"#ffffff":"#000000",' !important;\n      }\n      \n      /* Catch all nested elements with black stroke */\n      .djs-visual *[stroke="#000000"],\n      .djs-visual *[stroke="black"],\n      .djs-visual *[stroke="rgb(0,0,0)"],\n      .djs-visual *[stroke="rgb(0, 0, 0)"] {\n        stroke: ').concat(i?"#ffffff":"#000000",' !important;\n      }\n      \n      /* Catch all SVG shapes that might have white fill in light mode */\n      .djs-visual > *[fill="#ffffff"],\n      .djs-visual > *[fill="white"],\n      .djs-visual > *[fill="rgb(255,255,255)"],\n      .djs-visual > *[fill="rgb(255, 255, 255)"] {\n        fill: ').concat(i?"#1f2937":"#ffffff",' !important;\n      }\n      \n      /* Catch all nested elements with white fill */\n      .djs-visual *[fill="#ffffff"],\n      .djs-visual *[fill="white"],\n      .djs-visual *[fill="rgb(255,255,255)"],\n      .djs-visual *[fill="rgb(255, 255, 255)"] {\n        fill: ').concat(i?"#1f2937":"#ffffff"," !important;\n      }\n      \n      /* Direct editing text */\n      .djs-direct-editing-parent {\n        color: ").concat(i?"#ffffff":"#000000"," !important;\n        background: transparent !important;\n      }\n      \n      .djs-direct-editing-content {\n        color: ").concat(i?"#ffffff":"#000000"," !important;\n        background: transparent !important;\n        caret-color: ").concat(i?"#ffffff":"#000000",' !important;\n      }\n      \n      /* Ensure the editing box itself is transparent */\n      .djs-direct-editing-parent > div {\n        background: transparent !important;\n      }\n      \n      /* Contenteditable elements should be transparent */\n      [contenteditable="true"] {\n        background: transparent !important;\n        outline: none !important;\n      }\n      \n      /* Focus state for editing */\n      .djs-direct-editing-content:focus {\n        background: transparent !important;\n        outline: 1px dotted ').concat(i?"#60a5fa":"#2563eb"," !important;\n      }\n      \n      /* === SELECTION VISIBILITY FIX === */\n      \n      /* Selected element outline - make it highly visible */\n      .djs-outline {\n        stroke: ").concat(i?"#60a5fa":"#2563eb"," !important;\n        stroke-width: 3px !important;\n        stroke-dasharray: 5, 5 !important;\n        fill: none !important;\n        fill-opacity: 0 !important;\n        opacity: 1 !important;\n      }\n      \n      /* Outline paths and polygons must be transparent */\n      .djs-outline path,\n      .djs-outline polygon,\n      .djs-outline polyline,\n      .djs-outline rect,\n      .djs-outline circle,\n      .djs-outline ellipse {\n        fill: none !important;\n        fill-opacity: 0 !important;\n      }\n      \n      /* Selection box overlay - MUST BE TRANSPARENT */\n      .djs-lasso-overlay {\n        stroke: ").concat(i?"#60a5fa":"#2563eb"," !important;\n        stroke-width: 2px !important;\n        fill: ").concat(i?"rgba(96, 165, 250, 0.1)":"rgba(37, 99, 235, 0.1)"," !important;\n        opacity: 1 !important;\n      }\n      \n      /* Multi-select marquee - transparent background */\n      .djs-marquee {\n        fill: ").concat(i?"rgba(96, 165, 250, 0.1)":"rgba(37, 99, 235, 0.1)"," !important;\n        stroke: ").concat(i?"#60a5fa":"#2563eb"," !important;\n        stroke-width: 1px !important;\n        stroke-dasharray: 5, 5 !important;\n      }\n      \n      /* Selected elements get a highlight */\n      .djs-element.selected .djs-outline {\n        stroke: ").concat(i?"#60a5fa":"#2563eb"," !important;\n        stroke-width: 3px !important;\n        opacity: 1 !important;\n      }\n      \n      /* Hover state for better visibility */\n      .djs-element.hover .djs-outline {\n        stroke: ").concat(i?"#93c5fd":"#60a5fa"," !important;\n        stroke-width: 2px !important;\n        opacity: 0.8 !important;\n      }\n      \n      /* Selection frame around elements */\n      .djs-select-visual {\n        stroke: ").concat(i?"#60a5fa":"#2563eb"," !important;\n        stroke-width: 2px !important;\n        stroke-dasharray: 5, 5 !important;\n        fill: none !important;\n      }\n      \n      /* Multi-selection visual */\n      .djs-multiselect-visual {\n        stroke: ").concat(i?"#60a5fa":"#2563eb"," !important;\n        stroke-width: 2px !important;\n        fill: ").concat(i?"rgba(96, 165, 250, 0.05)":"rgba(37, 99, 235, 0.05)"," !important;\n      }\n      \n      /* Resize handles - small corner squares */\n      .djs-resizer-visual,\n      .djs-resizer-hit {\n        stroke: ").concat(i?"#60a5fa":"#2563eb"," !important;\n        fill: transparent !important;\n        opacity: 1 !important;\n      }\n      \n      /* Resize handle corners - the actual squares */\n      .djs-resizer-visual rect,\n      .djs-resizer-hit rect {\n        fill: ").concat(i?"#60a5fa":"#2563eb"," !important;\n        stroke: ").concat(i?"#ffffff":"#000000"," !important;\n        stroke-width: 1px !important;\n        width: 6px !important;\n        height: 6px !important;\n      }\n      \n      /* Selection frame - MUST BE TRANSPARENT */\n      .djs-selection-frame {\n        fill: transparent !important;\n        stroke: ").concat(i?"#60a5fa":"#2563eb"," !important;\n        stroke-width: 2px !important;\n        stroke-dasharray: 5, 5 !important;\n      }\n      \n      /* Selection visual box - TRANSPARENT BACKGROUND */\n      .djs-selection-visual {\n        fill: transparent !important;\n        stroke: ").concat(i?"#60a5fa":"#2563eb"," !important;\n      }\n      \n      /* Selection overlay background - CRITICAL FIX */\n      .djs-overlay-container .djs-overlay {\n        background: transparent !important;\n      }\n      \n      /* Any selection-related overlays must be transparent */\n      .djs-overlay-container > * {\n        background: transparent !important;\n      }\n      \n      /* Lasso selection area */\n      .djs-lasso-overlay rect {\n        fill: ").concat(i?"rgba(96, 165, 250, 0.1)":"rgba(37, 99, 235, 0.1)"," !important;\n        stroke: ").concat(i?"#60a5fa":"#2563eb"," !important;\n      }\n      \n      /* Drag selection marquee box */\n      .djs-drag-marquee {\n        fill: ").concat(i?"rgba(96, 165, 250, 0.1)":"rgba(37, 99, 235, 0.1)"," !important;\n        stroke: ").concat(i?"#60a5fa":"#2563eb"," !important;\n        stroke-width: 1px !important;\n        stroke-dasharray: 5, 5 !important;\n      }\n      \n      /* Group selection frame */\n      .djs-group-selector {\n        fill: transparent !important;\n        stroke: ").concat(i?"#60a5fa":"#2563eb"," !important;\n        stroke-width: 2px !important;\n        stroke-dasharray: 5, 5 !important;\n      }\n      \n      /* Selected state visual feedback */\n      .selected > .djs-visual {\n        filter: ").concat(i?"drop-shadow(0 0 4px rgba(96, 165, 250, 0.5))":"drop-shadow(0 0 4px rgba(37, 99, 235, 0.3))"," !important;\n      }\n      \n      /* Make sure selection doesn't hide elements */\n      .djs-overlay {\n        pointer-events: none !important;\n      }\n      \n      .djs-overlay.djs-lasso-overlay {\n        pointer-events: all !important;\n      }\n      \n      /* AGGRESSIVE FIX: Force ALL selection rectangles to be transparent */\n      .selected rect:not(.djs-visual rect) {\n        fill: transparent !important;\n      }\n      \n      /* Selection indicators should only be outlines */\n      .djs-outline rect,\n      .djs-selection rect,\n      .djs-select rect {\n        fill: transparent !important;\n        stroke: ").concat(i?"#60a5fa":"#2563eb",' !important;\n        stroke-width: 2px !important;\n      }\n      \n      /* Ensure no background on selection visuals */\n      [class*="select"] rect:not(.djs-visual rect) {\n        fill: transparent !important;\n      }\n      \n      /* Remove any fill from selection frames */\n      .djs-frame rect {\n        fill: transparent !important;\n      }\n      \n      /* Canvas background - target multiple selectors for better coverage */\n      .djs-container,\n      .djs-container svg,\n      .djs-viewport,\n      .djs-plane {\n        background-color: ').concat(i?"#111827":"#f9fafb"," !important;\n      }\n      \n      /* Grid pattern background */\n      .grid-background {\n        background-image: \n          linear-gradient(").concat(i?"rgba(255,255,255,0.03)":"rgba(0,0,0,0.03)"," 1px, transparent 1px),\n          linear-gradient(90deg, ").concat(i?"rgba(255,255,255,0.03)":"rgba(0,0,0,0.03)"," 1px, transparent 1px);\n        background-size: 20px 20px;\n        background-position: 0 0, 0 0;\n      }\n      \n      /* Apply grid to canvas when enabled */\n      .djs-container.show-grid > svg {\n        background-image: \n          linear-gradient(").concat(i?"rgba(255,255,255,0.05)":"rgba(0,0,0,0.05)"," 1px, transparent 1px),\n          linear-gradient(90deg, ").concat(i?"rgba(255,255,255,0.05)":"rgba(0,0,0,0.05)"," 1px, transparent 1px);\n        background-size: 20px 20px;\n        background-position: 0 0, 0 0;\n        background-color: ").concat(i?"#111827":"#f9fafb"," !important;\n      }\n      \n      /* Ensure the SVG itself has the right background */\n      .djs-container > svg {\n        background-color: ").concat(i?"#111827":"#f9fafb"," !important;\n      }\n      \n      /* Hide native BPMN.js palette since we use custom */\n      .djs-palette {\n        display: none !important;\n      }\n      \n      /* === ULTIMATE FALLBACK - Catch ANY element that might be missed === */\n      \n      /* AGGRESSIVE: Force all strokes in djs elements */\n      .djs-container svg * {\n        stroke: ").concat(i?"#ffffff":"#000000",' !important;\n      }\n      \n      /* But preserve transparent strokes */\n      .djs-container svg *[stroke="none"],\n      .djs-container svg *[stroke="transparent"],\n      .djs-container svg *[stroke-opacity="0"] {\n        stroke: transparent !important;\n      }\n      \n      /* Force proper fills on basic shapes */\n      .djs-container svg rect:not([fill="none"]):not([fill="transparent"]),\n      .djs-container svg circle:not([fill="none"]):not([fill="transparent"]),\n      .djs-container svg ellipse:not([fill="none"]):not([fill="transparent"]),\n      .djs-container svg polygon:not([fill="none"]):not([fill="transparent"]) {\n        fill: ').concat(i?"#1f2937":"#ffffff"," !important;\n      }\n      \n      /* Ensure text is always visible */\n      .djs-container svg text,\n      .djs-container svg tspan {\n        fill: ").concat(i?"#ffffff":"#000000"," !important;\n      }\n      \n      /* SUPER AGGRESSIVE: Override ANY stroke attribute in dark mode */\n      ").concat(i?'\n        .djs-container svg *:not([stroke="none"]):not([stroke="transparent"]) {\n          stroke: #ffffff !important;\n        }\n        \n        .djs-container svg path:not([stroke="none"]):not([stroke="transparent"]) {\n          stroke: #ffffff !important;\n        }\n        \n        .djs-container svg line:not([stroke="none"]):not([stroke="transparent"]) {\n          stroke: #ffffff !important;\n        }\n        \n        .djs-container svg polyline:not([stroke="none"]):not([stroke="transparent"]) {\n          stroke: #ffffff !important;\n        }\n        \n        .djs-container svg rect:not([stroke="none"]):not([stroke="transparent"]) {\n          stroke: #ffffff !important;\n        }\n        \n        .djs-container svg circle:not([stroke="none"]):not([stroke="transparent"]) {\n          stroke: #ffffff !important;\n        }\n        \n        .djs-container svg ellipse:not([stroke="none"]):not([stroke="transparent"]) {\n          stroke: #ffffff !important;\n        }\n        \n        .djs-container svg polygon:not([stroke="none"]):not([stroke="transparent"]) {\n          stroke: #ffffff !important;\n        }\n      ':'\n        .djs-container svg *:not([stroke="none"]):not([stroke="transparent"]) {\n          stroke: #000000 !important;\n        }\n      ',"\n    "),r.parentNode||document.head.appendChild(r),a){i?(a.classList.add("dark-mode"),a.classList.remove("light-mode")):(a.classList.add("light-mode"),a.classList.remove("dark-mode")),a.style.backgroundColor=i?"#111827":"#f9fafb";let e=a.querySelector("svg");e&&(e.style.backgroundColor=i?"#111827":"#f9fafb")}let l=e.get("eventBus");l&&l.fire("canvas.viewbox.changed");let s=()=>{document.querySelectorAll(".djs-container svg *").forEach(e=>{var t;let n=null===(t=e.tagName)||void 0===t?void 0:t.toLowerCase();if(e.hasAttribute("stroke")||e.style.stroke){let t=e.getAttribute("stroke")||e.style.stroke;if(t&&"none"!==t&&"transparent"!==t&&(i&&("#000000"===t||"black"===t||"rgb(0, 0, 0)"===t)||!i&&("#ffffff"===t||"white"===t||"rgb(255, 255, 255)"===t)||"rect"===n||"circle"===n||"polygon"===n||"path"===n||"line"===n)){let t=i?"#ffffff":"#000000";e.setAttribute("stroke",t),e.style.stroke=t,e.style.strokeOpacity="1"}}if("rect"===n||"circle"===n||"ellipse"===n||"polygon"===n){let t=e.getAttribute("fill")||e.style.fill;if(t&&"none"!==t&&"transparent"!==t&&!e.closest(".djs-outline")&&!e.closest(".djs-selection")){let t=i?"#1f2937":"#ffffff";e.setAttribute("fill",t),e.style.fill=t}}if("text"===n||"tspan"===n){let t=i?"#ffffff":"#000000";e.setAttribute("fill",t),e.style.fill=t}})};s(),setTimeout(s,50),setTimeout(s,100),setTimeout(s,200),setTimeout(s,500)}catch(e){console.error("Error applying BPMN styles:",e)}},[]);(0,o.useEffect)(()=>{let n=!0,a=null,o=null,i=async()=>{let s=e.current;if(s&&n)try{if(0===s.offsetWidth||0===s.offsetHeight){setTimeout(i,100);return}a=new r.default({container:s,keyboard:{bindTo:window},additionalModules:[],moddleExtensions:{}}),t.current=a,await a.importXML(H),await new Promise(e=>setTimeout(e,50));let e=a.get("eventBus"),d=a.get("commandStack");if(!e||!d){console.warn("BPMN modules not fully initialized, retrying..."),setTimeout(i,100);return}let m=()=>{n&&(p(d.canUndo()),f(d.canRedo()))};e.on("commandStack.changed",m),m();let v=a.get("selection");e.on("selection.changed",e=>{if(!n)return;let t=e.newSelection||[];O(t),t.length>0&&(console.log("Selected ".concat(t.length," element(s)")),setTimeout(()=>{document.querySelectorAll('.djs-outline rect, .djs-selection rect, [class*="select"] rect').forEach(e=>{e.closest(".djs-visual")||(e.style.fill="transparent",e.style.fillOpacity="0",e.setAttribute("fill","none"),e.setAttribute("fill-opacity","0"))}),document.querySelectorAll(".djs-frame, .djs-selection-frame, .djs-select-visual").forEach(e=>{if("rect"===e.tagName||e.querySelector("rect")){let t="rect"===e.tagName?e:e.querySelector("rect");t&&!t.closest(".djs-visual")&&(t.style.fill="transparent",t.setAttribute("fill","none"))}})},0))});let b=a.get("keyboard"),g=a.get("editorActions"),y=a;b&&g&&y&&(g.register("selectAll",()=>{let e=y.get("elementRegistry").filter(e=>"label"!==e.type&&"bpmn:SequenceFlow"!==e.type&&"Process_1"!==e.id&&!e.labelTarget);v.select(e),console.log("Selected all ".concat(e.length," elements"))}),g.register("showReplaceMenu",()=>{let e=v.get();if(1===e.length){let t=e[0];if("Process_1"===t.id||"bpmn:Process"===t.type)return;let n=y.get("popupMenu"),a=y.get("replaceMenuProvider");if(n&&a){let e=y.get("elementRegistry").get(t.id);if(e){let o={x:e.x+(e.width||100)/2,y:e.y-10},r=a.getPopupMenuEntries(t);r&&Object.keys(r).length>0&&(n.open(t,"bpmn-replace",o,r),console.log("Replace menu opened for:",t.type))}}else{let e=y.get("replacePreview");e&&e.toggle()}}}),b.addListener(e=>{let t=e.keyEvent.key,n=e.keyEvent.ctrlKey||e.keyEvent.metaKey;if(n&&"a"===t)return g.trigger("selectAll"),e.keyEvent.preventDefault(),!0;if(" "===t&&!n&&!e.keyEvent.shiftKey&&!e.keyEvent.altKey){let t=document.activeElement;return(!t||"INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName)&&(g.trigger("showReplaceMenu"),e.keyEvent.preventDefault(),!0)}return!1})),Z(a,u);let h=e=>{if(" "===e.key&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&!e.altKey){let t=document.activeElement;if(t&&("INPUT"===t.tagName||"TEXTAREA"===t.tagName||"true"===t.getAttribute("contenteditable")))return;let n=s.querySelector(".djs-container");if(n&&(n.contains(t)||t===document.body)){let t=v.get();if(1===t.length){e.preventDefault(),e.stopPropagation();let n=t[0];if("Process_1"===n.id||"bpmn:Process"===n.type)return;console.log("Spacebar pressed with element selected:",n.type);let a=y.get("popupMenu"),o=y.get("replaceMenuProvider");if(a&&o){let e=y.get("elementRegistry").get(n.id);if(e){let t={x:e.x+(e.width||100)/2,y:e.y-10},r=o.getPopupMenuEntries(n);r&&Object.keys(r).length>0&&(a.open(n,"bpmn-replace",t,r),console.log("Replace menu triggered via spacebar"))}}}}}};setTimeout(()=>{window.document.addEventListener("keydown",h),t.current&&(t.current._spacebarHandler=h)},0);let x=a.get("canvas"),k=x._container||x.getContainer();k&&N&&k.classList.add("show-grid"),k&&(o=new MutationObserver(e=>{let t=document.documentElement.classList.contains("dark")?"dark":"light",n="dark"===t;e.forEach(e=>{if(e.addedNodes.forEach(e=>{if(1===e.nodeType&&e.tagName){let t=e.tagName.toLowerCase();("rect"===t||"g"===t||"svg"===t)&&("rect"!==t||(e.style.stroke=n?"#ffffff":"#000000",e.setAttribute("stroke",n?"#ffffff":"#000000"),e.closest(".djs-outline")||e.closest(".djs-selection")||(e.style.fill=n?"#1f2937":"#ffffff",e.setAttribute("fill",n?"#1f2937":"#ffffff"))),(e.querySelectorAll?e.querySelectorAll("rect"):[]).forEach(e=>{e.style.stroke=n?"#ffffff":"#000000",e.setAttribute("stroke",n?"#ffffff":"#000000"),e.style.strokeOpacity="1",e.closest(".djs-outline")||e.closest(".djs-selection")||(e.style.fill=n?"#1f2937":"#ffffff",e.setAttribute("fill",n?"#1f2937":"#ffffff"))})),e.querySelectorAll&&e.querySelectorAll("*").forEach(e=>{var t;let a=null===(t=e.tagName)||void 0===t?void 0:t.toLowerCase();"rect"!==a&&"circle"!==a&&"polygon"!==a&&"path"!==a&&"line"!==a||((e.hasAttribute("stroke")||e.style.stroke)&&(e.style.stroke=n?"#ffffff":"#000000",e.setAttribute("stroke",n?"#ffffff":"#000000"),e.style.strokeOpacity="1"),"rect"!==a&&"circle"!==a&&"polygon"!==a||e.closest(".djs-outline")||e.closest(".djs-selection")||(e.style.fill=n?"#1f2937":"#ffffff",e.setAttribute("fill",n?"#1f2937":"#ffffff")))})}}),"attributes"===e.type&&e.target){let t=e.target;if(t.tagName){let a=t.tagName.toLowerCase();if("rect"===a&&("stroke"===e.attributeName||"style"===e.attributeName)){let e=t.getAttribute("stroke")||t.style.stroke;n&&("#000000"===e||"black"===e)&&(t.style.stroke="#ffffff",t.setAttribute("stroke","#ffffff"))}}}})})).observe(k,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["stroke","fill","style"]}),l(!0),c(null)}catch(e){console.error("BPMN initialization error:",e),c(e instanceof Error?e.message:"Failed to initialize")}};return setTimeout(i,100),()=>{if(n=!1,o&&o.disconnect(),a)try{a._spacebarHandler&&document.removeEventListener("keydown",a._spacebarHandler),a.destroy()}catch(e){}}},[u,Z]),(0,o.useEffect)(()=>{if(t.current&&i){Z(t.current,u);let e=t.current.get("canvas"),n=(null==e?void 0:e._container)||(null==e?void 0:e.getContainer());n&&N&&n.classList.add("show-grid");let a=()=>{let e="dark"===u;document.querySelectorAll('[data-element-id*="Task"]').forEach(t=>{t.querySelectorAll("rect").forEach(t=>{let n=t.getAttribute("stroke")||t.style.stroke;(e?"#000000"!==n&&"black"!==n&&"rgb(0, 0, 0)"!==n:"#ffffff"!==n&&"white"!==n&&"rgb(255, 255, 255)"!==n)||(console.log("Fixing Task stroke:",n,"",e?"#ffffff":"#000000"),t.setAttribute("stroke",e?"#ffffff":"#000000"),t.style.stroke=e?"#ffffff":"#000000",t.style.strokeOpacity="1",t.closest(".djs-outline")||(t.setAttribute("fill",e?"#1f2937":"#ffffff"),t.style.fill=e?"#1f2937":"#ffffff"))})})};[0,100,200,500,1e3,2e3].forEach(e=>{setTimeout(a,e)})}},[u,i,N,Z]),(0,o.useEffect)(()=>{if(!t.current)return;let e=t.current.get("zoomScroll");e&&e.toggle(G)},[G]);let _=(0,o.useCallback)(async()=>{if(t.current){x(!0);try{let{xml:e}=await t.current.saveXML({format:!0});localStorage.setItem("bpmn-diagram",e||""),console.log("Saved to localStorage")}catch(e){console.error("Save error:",e)}finally{x(!1)}}},[]),q=(0,o.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"bpmn";if(t.current)try{var n,a;if("svg"===e){let e=t.current.get("canvas"),a=e._svg||(null===(n=e.getContainer())||void 0===n?void 0:n.querySelector("svg"));if(a){let e=a.cloneNode(!0);e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");let t=new XMLSerializer().serializeToString(e),n=new Blob([t],{type:"image/svg+xml"}),o=URL.createObjectURL(n),r=document.createElement("a");r.href=o,r.download="diagram.svg",r.click(),URL.revokeObjectURL(o)}}else if("png"===e){let e=t.current.get("canvas"),n=e._svg||(null===(a=e.getContainer())||void 0===a?void 0:a.querySelector("svg"));if(n){let e=n.getBBox(),t=e.width+e.x+50,a=e.height+e.y+50,o=document.createElement("canvas");o.width=t,o.height=a;let r=o.getContext("2d");if(r){r.fillStyle="white",r.fillRect(0,0,t,a);let e=n.cloneNode(!0);e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("width",String(t)),e.setAttribute("height",String(a));let i=new XMLSerializer().serializeToString(e),l=new Blob([i],{type:"image/svg+xml;charset=utf-8"}),s=URL.createObjectURL(l),c=new Image;c.onload=()=>{r.drawImage(c,0,0),URL.revokeObjectURL(s),o.toBlob(e=>{if(e){let t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="diagram.png",n.click(),URL.revokeObjectURL(t)}},"image/png")},c.src=s}}}else{let{xml:n}=await t.current.saveXML({format:!0}),a=new Blob([n||""],{type:"text/xml"}),o=URL.createObjectURL(a),r=document.createElement("a");r.href=o,r.download="xml"===e?"diagram.xml":"diagram.bpmn",r.click(),URL.revokeObjectURL(o)}}catch(e){console.error("Export error:",e)}},[]),F=(0,o.useCallback)(e=>{var n;let a=null===(n=e.target.files)||void 0===n?void 0:n[0];if(!a||!t.current)return;let o=new FileReader;o.onload=async e=>{try{var n,o,r;let i=null===(n=e.target)||void 0===n?void 0:n.result,l=i,s=null===(o=a.name.split(".").pop())||void 0===o?void 0:o.toLowerCase();if("json"===s){let e=JSON.parse(i);l=H,console.log("Importing JSON format:",e),alert("JSON import: Elements detected, using default template. Full JSON import requires custom parser.")}else("yaml"===s||"yml"===s)&&(console.log("Importing YAML format"),l=H,alert("YAML import: Using default template. Full YAML import requires yaml parser library."));await (null===(r=t.current)||void 0===r?void 0:r.importXML(l))}catch(e){console.error("Import error:",e),alert("Import failed: "+(e instanceof Error?e.message:"Unknown error"))}},o.readAsText(a)},[]),K=(0,o.useCallback)(()=>{var e;let n=null===(e=t.current)||void 0===e?void 0:e.get("commandStack");(null==n?void 0:n.canUndo())&&n.undo()},[]),Y=(0,o.useCallback)(()=>{var e;let n=null===(e=t.current)||void 0===e?void 0:e.get("commandStack");(null==n?void 0:n.canRedo())&&n.redo()},[]),W=(0,o.useCallback)(()=>{if(t.current)try{var e;let n=t.current.get("canvas");if(!n)return;let a=n._svg||(null===(e=n._container)||void 0===e?void 0:e.querySelector("svg"));if(!a||!a.createSVGMatrix){console.warn("SVG not ready for zoom");return}let o=n.zoom();if("number"==typeof o){let e=Math.min(1.2*o,4);n.zoom(e),y(Math.round(100*e))}}catch(e){console.error("Zoom in error:",e)}},[]),J=(0,o.useCallback)(()=>{if(t.current)try{var e;let n=t.current.get("canvas");if(!n)return;let a=n._svg||(null===(e=n._container)||void 0===e?void 0:e.querySelector("svg"));if(!a||!a.createSVGMatrix){console.warn("SVG not ready for zoom");return}let o=n.zoom();if("number"==typeof o){let e=Math.max(o/1.2,.2);n.zoom(e),y(Math.round(100*e))}}catch(e){console.error("Zoom out error:",e)}},[]),Q=(0,o.useCallback)(()=>{if(t.current)try{var e;let n=t.current.get("canvas");if(!n)return;let a=n._svg||(null===(e=n._container)||void 0===e?void 0:e.querySelector("svg"));if(!a||!a.createSVGMatrix){console.warn("SVG not ready for zoom");return}n.zoom("fit-viewport"),y(100)}catch(e){console.error("Zoom reset error:",e)}},[]),$=(0,o.useCallback)(async()=>{t.current&&await t.current.importXML(H)},[]),ee=(0,o.useCallback)(()=>{let e="light"===u?"dark":"light";if(console.log("Theme toggle:",u,"->",e),v(e),t.current){Z(t.current,e);let n=()=>{let t="dark"===e;document.querySelectorAll(".djs-container svg *").forEach(e=>{if(e.hasAttribute("stroke")){let n=e.getAttribute("stroke");n&&"none"!==n&&"transparent"!==n&&(e.style.stroke=t?"#ffffff":"#000000",e.setAttribute("stroke",t?"#ffffff":"#000000"))}if(e.hasAttribute("fill")){let n=e.getAttribute("fill");n&&"none"!==n&&"transparent"!==n&&("rect"===e.tagName||"circle"===e.tagName||"ellipse"===e.tagName||"polygon"===e.tagName?(e.style.fill=t?"#1f2937":"#ffffff",e.setAttribute("fill",t?"#1f2937":"#ffffff")):("text"===e.tagName||"tspan"===e.tagName||"path"===e.tagName)&&(e.style.fill=t?"#ffffff":"#000000",e.setAttribute("fill",t?"#ffffff":"#000000")))}"rect"!==e.tagName&&"circle"!==e.tagName&&"ellipse"!==e.tagName&&"polygon"!==e.tagName&&"path"!==e.tagName&&"line"!==e.tagName&&"polyline"!==e.tagName||e.getAttribute("stroke-opacity")&&"0"===e.getAttribute("stroke-opacity")||(e.style.stroke=t?"#ffffff":"#000000")})};n(),setTimeout(n,100),setTimeout(n,300);try{let n=t.current.get("canvas"),a=t.current.get("eventBus");if(n&&a){let t=n.viewbox(),o=n._container||n.getContainer();if(o){let t="dark"===e?"#111827":"#f9fafb";o.style.backgroundColor=t;let n=o.querySelector("svg");n&&(n.style.backgroundColor=t);let a=o.querySelector(".djs-viewport");a&&(a.style.backgroundColor=t),N&&o.classList.add("show-grid")}requestAnimationFrame(()=>{a&&a.fire("canvas.viewbox.changed",t)})}}catch(e){console.error("Theme toggle redraw error:",e)}}},[u,Z]),et=(0,o.useCallback)(()=>{if(!t.current||B.length<2)return;let e=t.current.get("modeling");t.current.get("canvas");let n=B.reduce((e,t)=>t.x<e.x?t:e,B[0]);B.forEach(t=>{t.id!==n.id&&e.moveElements([t],{x:n.x-t.x,y:0})})},[B]),en=(0,o.useCallback)(()=>{if(!t.current||B.length<2)return;let e=t.current.get("modeling"),n=B.reduce((e,t)=>e+t.x+t.width/2,0)/B.length;B.forEach(t=>{let a=n-t.width/2;e.moveElements([t],{x:a-t.x,y:0})})},[B]),ea=(0,o.useCallback)(()=>{if(!t.current||B.length<2)return;let e=t.current.get("modeling"),n=B.reduce((e,t)=>t.x+t.width>e.x+e.width?t:e,B[0]),a=n.x+n.width;B.forEach(t=>{if(t.id!==n.id){let n=a-t.width;e.moveElements([t],{x:n-t.x,y:0})}})},[B]),eo=(0,o.useCallback)(()=>{if(!t.current||B.length<2)return;let e=t.current.get("modeling"),n=B.reduce((e,t)=>t.y<e.y?t:e,B[0]);B.forEach(t=>{t.id!==n.id&&e.moveElements([t],{x:0,y:n.y-t.y})})},[B]),er=(0,o.useCallback)(()=>{if(!t.current||B.length<2)return;let e=t.current.get("modeling"),n=B.reduce((e,t)=>e+t.y+t.height/2,0)/B.length;B.forEach(t=>{let a=n-t.height/2;e.moveElements([t],{x:0,y:a-t.y})})},[B]),ei=(0,o.useCallback)(()=>{if(!t.current||B.length<2)return;let e=t.current.get("modeling"),n=B.reduce((e,t)=>t.y+t.height>e.y+e.height?t:e,B[0]),a=n.y+n.height;B.forEach(t=>{if(t.id!==n.id){let n=a-t.height;e.moveElements([t],{x:0,y:n-t.y})}})},[B]),el=(0,o.useCallback)(async()=>{if(t.current)try{let{xml:e}=await t.current.saveXML({format:!0});R(e||""),M(!0)}catch(e){console.error("Preview error:",e)}},[]),es=(0,o.useCallback)(async e=>{if(t.current)try{await t.current.importXML(e),M(!1)}catch(e){console.error("XML import error:",e),alert("Failed to apply XML changes: "+(e instanceof Error?e.message:"Unknown error"))}},[]),ec=(0,o.useCallback)(()=>{t.current&&(console.log("Starting process simulation..."),alert("Process simulation would start here. This requires integration with a BPMN engine."))},[]),ed=(0,o.useCallback)(()=>{w(!E),E?document.fullscreenElement&&document.exitFullscreen():document.documentElement.requestFullscreen()},[E]),ep=(0,o.useCallback)(()=>{S(!T),console.log("Minimap toggle:",!T)},[T]),em=(0,o.useCallback)(()=>{console.log("Language toggle - would implement i18n"),alert("Language switching would be implemented with i18n library")},[]),ef=(0,o.useCallback)(()=>{C(e=>{let n=!e;if(t.current){let e=t.current.get("canvas"),a=e._container||e.getContainer();a&&(n?a.classList.add("show-grid"):a.classList.remove("show-grid"))}return n})},[]),eu=(0,o.useCallback)(()=>{z(e=>{let n=!e;if(t.current){let e=t.current.get("zoomScroll");e&&(n?e.toggle(!0):e.toggle(!1))}return n})},[]),ev=(0,o.useCallback)((e,n)=>{if(t.current){if(console.log("Palette action:",e),e.endsWith("-tool")){j(e.replace("-tool",""));let a=t.current.get("handTool"),o=t.current.get("lassoTool"),r=t.current.get("spaceTool"),i=t.current.get("globalConnect");switch(e){case"hand-tool":null==a||a.activateHand(n);break;case"lasso-tool":null==o||o.activateSelection(n);break;case"space-tool":null==r||r.activateSelection(n);break;case"global-connect-tool":null==i||i.toggle(n)}return}if(e.startsWith("create.")){let a=t.current.get("elementFactory"),o=t.current.get("create"),r=t.current.get("canvas"),i=t.current.get("modeling"),l=e.replace("create.","");console.log("Creating element type:",l);let s={"start-event":{type:"bpmn:StartEvent"},"start-event-message":{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"},"start-event-timer":{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"},"start-event-conditional":{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"},"start-event-signal":{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"},"end-event":{type:"bpmn:EndEvent"},"end-event-message":{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition"},"end-event-escalation":{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"},"end-event-error":{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"},"end-event-cancel":{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CancelEventDefinition"},"end-event-compensation":{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"},"end-event-signal":{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:SignalEventDefinition"},"end-event-terminate":{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:TerminateEventDefinition"},"intermediate-event":{type:"bpmn:IntermediateThrowEvent"},"intermediate-event-message":{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:MessageEventDefinition"},"intermediate-event-timer":{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition"},"intermediate-event-escalation":{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"},"intermediate-event-conditional":{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"},"intermediate-event-link":{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:LinkEventDefinition"},"intermediate-event-compensation":{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"},"intermediate-event-signal":{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:SignalEventDefinition"},task:{type:"bpmn:Task"},"user-task":{type:"bpmn:UserTask"},"service-task":{type:"bpmn:ServiceTask"},"script-task":{type:"bpmn:ScriptTask"},"business-rule-task":{type:"bpmn:BusinessRuleTask"},"send-task":{type:"bpmn:SendTask"},"receive-task":{type:"bpmn:ReceiveTask"},"manual-task":{type:"bpmn:ManualTask"},"exclusive-gateway":{type:"bpmn:ExclusiveGateway"},"parallel-gateway":{type:"bpmn:ParallelGateway"},"inclusive-gateway":{type:"bpmn:InclusiveGateway"},"event-based-gateway":{type:"bpmn:EventBasedGateway"},"complex-gateway":{type:"bpmn:ComplexGateway"},"subprocess-expanded":{type:"bpmn:SubProcess",isExpanded:!0},"subprocess-collapsed":{type:"bpmn:SubProcess",isExpanded:!1},"event-subprocess":{type:"bpmn:SubProcess",triggeredByEvent:!0},transaction:{type:"bpmn:Transaction"},"call-activity":{type:"bpmn:CallActivity"},"data-object":{type:"bpmn:DataObjectReference"},"data-store":{type:"bpmn:DataStoreReference"},"data-input":{type:"bpmn:DataInput"},"data-output":{type:"bpmn:DataOutput"},"participant-expanded":{type:"bpmn:Participant"},participant:{type:"bpmn:Participant"},lane:{type:"bpmn:Lane"},group:{type:"bpmn:Group"},"text-annotation":{type:"bpmn:TextAnnotation"}}[l]||{type:"bpmn:Task"},c={type:s.type};if(s.eventDefinitionType){let e=t.current.get("bpmnFactory"),n=e.create(s.eventDefinitionType);c.eventDefinitionType=s.eventDefinitionType,c.businessObject=e.create(s.type,{eventDefinitions:[n]})}"isExpanded"in s&&(c.isExpanded=s.isExpanded),"triggeredByEvent"in s&&(c.triggeredByEvent=s.triggeredByEvent);let d=a.createShape(c);if(n instanceof DragEvent)console.log("Starting drag create for:",l),o.start(n,d);else{console.log("Creating element via click:",l);let e=r.getRootElement(),t=r.viewbox(),n=t.x+t.width/2,a=t.y+t.height/2;i.createShape(d,{x:n,y:a},e)}}}},[]);return s?(0,a.jsx)("div",{className:"h-screen flex items-center justify-center bg-gray-50",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-red-600 mb-2",children:"Error Loading Studio"}),(0,a.jsx)("p",{className:"text-gray-600",children:s}),(0,a.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Reload Page"})]})}):(0,a.jsxs)("div",{className:"h-screen flex flex-col bg-background",children:[(0,a.jsx)(P,{onSave:_,onExport:q,onImport:()=>{var e;return null===(e=n.current)||void 0===e?void 0:e.click()},onUndo:K,onRedo:Y,onZoomIn:W,onZoomOut:J,onFitToViewport:Q,onClear:$,onToggleTheme:ee,onAlignLeft:et,onAlignCenter:en,onAlignRight:ea,onAlignTop:eo,onAlignMiddle:er,onAlignBottom:ei,onPreview:el,onRun:ec,onMeetingMode:ed,onToggleMinimap:ep,onToggleLanguage:em,onToggleGrid:ef,onToggleScrollZoom:eu,theme:u,zoomLevel:g,canUndo:d,canRedo:m,disabled:h,isMeetingMode:E,isMinimapOpen:T,showGrid:N,scrollZoomEnabled:G}),(0,a.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[!E&&(0,a.jsx)(U,{onAction:ev,activeTool:k}),(0,a.jsxs)("div",{className:"flex-1 relative bg-gray-50 dark:bg-gray-900",children:[(0,a.jsx)("div",{ref:e,className:"w-full h-full",style:{position:"absolute",top:0,left:0,right:0,bottom:0}}),!i&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-50/90 dark:bg-gray-900/90 pointer-events-none",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:"Initializing BPMN Studio..."})]})})]})]}),(0,a.jsx)("input",{ref:n,type:"file",accept:".bpmn,.xml",onChange:F,className:"hidden"}),(0,a.jsx)(V,{isOpen:L,onClose:()=>M(!1),xml:I,onSave:es,readOnly:!1})]})}function Y(){return(0,a.jsx)(K,{})}},2798:function(e,t,n){"use strict";n.d(t,{F:function(){return i},ThemeProvider:function(){return l}});var a=n(7437),o=n(2265);let r=(0,o.createContext)(void 0);function i(){let e=(0,o.useContext)(r);if(!e)throw Error("useTheme must be used within a ThemeProvider");return e}function l(e){let{children:t}=e,[n,i]=(0,o.useState)("light"),[l,s]=(0,o.useState)(!1);(0,o.useEffect)(()=>{s(!0);let e=localStorage.getItem("bpmn-studio-theme");if(e)i(e),"dark"===e?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark");else{let e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";i(e),"dark"===e?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}},[]);let c=e=>{i(e),localStorage.setItem("bpmn-studio-theme",e),"dark"===e?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")};return(0,a.jsx)(r.Provider,{value:{theme:n,toggleTheme:()=>{c("light"===n?"dark":"light")},setTheme:c},children:t})}},2869:function(e,t,n){"use strict";n.d(t,{z:function(){return c}});var a=n(7437),o=n(2265),r=n(5293),i=n(535),l=n(4508);let s=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),c=o.forwardRef((e,t)=>{let{className:n,variant:o,size:i,asChild:c=!1,...d}=e,p=c?r.g7:"button";return(0,a.jsx)(p,{className:(0,l.cn)(s({variant:o,size:i,className:n})),ref:t,...d})});c.displayName="Button"},4508:function(e,t,n){"use strict";n.d(t,{cn:function(){return r}});var a=n(1994),o=n(3335);function r(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,o.m6)((0,a.W)(t))}}},function(e){e.O(0,[50,845,878,906,732,971,117,744],function(){return e(e.s=2872)}),_N_E=e.O()}]);