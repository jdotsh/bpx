"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[960],{9653:function(t,e,i){i.r(e),i.d(e,{default:function(){return w}});var n=i(891),o=i(1334),a=i(785),r=i(5694),s=i(2722),h=new(i(725)).Z,l={min:.2,max:4};function d(t,e,i,o,r){var s=this;function d(t){(!s._state._svgClientRect||g(s._state._svgClientRect))&&(s._state._svgClientRect=s._svg.getBoundingClientRect()),p(c({x:t.x-s._state._svgClientRect.left,y:t.y-s._state._svgClientRect.top},s._svg,s._lastViewbox),s._canvas),s._update()}function _(t){return function(e){var i,r=m(e);(!s._state._svgClientRect||g(s._state._svgClientRect))&&(s._state._svgClientRect=s._svg.getBoundingClientRect()),t&&d(r);var h=c({x:r.x-s._state._svgClientRect.left,y:r.y-s._state._svgClientRect.top},s._svg,s._lastViewbox),l=o.viewbox(),p=(i={x:l.x+l.width/2,y:l.y+l.height/2},{x:h.x-i.x,y:h.y-i.y}),_=s._viewportDom.getBoundingClientRect(),u={x:r.x-_.left+1,y:r.y-_.top+1};(0,a.f0)(s._state,{cachedViewbox:l,initialDragPosition:{x:r.x,y:r.y},isDragging:!0,offsetViewport:p,offsetViewportDom:u,viewportClientRect:s._viewport.getBoundingClientRect(),parentClientRect:s._parent.getBoundingClientRect()}),n.B.bind(document,"mousemove",v),n.B.bind(document,"mouseup",w)}}function v(t){var e=m(t);if(s._state.isDragging){(!s._state._svgClientRect||g(s._state._svgClientRect))&&(s._state._svgClientRect=s._svg.getBoundingClientRect());var i=s._state.offsetViewportDom,n=s._state.viewportClientRect,o=s._state.parentClientRect;(0,a.f0)(s._viewportDom.style,{top:e.y-i.y-o.top+"px",left:e.x-i.x-o.left+"px"});var r=f(o,{top:e.y-i.y-o.top,left:e.x-i.x-o.left,width:n.width,height:n.height});(0,a.f0)(s._overlay.style,{clipPath:r});var h=c({x:e.x-s._state._svgClientRect.left,y:e.y-s._state._svgClientRect.top},s._svg,s._lastViewbox);p({x:h.x-s._state.offsetViewport.x,y:h.y-s._state.offsetViewport.y},s._canvas)}}function w(t){var e=m(t);s._state.isDragging&&(s._state.initialDragPosition.x===e.x&&s._state.initialDragPosition.y===e.y&&d(t),s._update(),(0,a.f0)(s._state,{cachedViewbox:null,initialDragPosition:null,isDragging:!1,offsetViewport:null,offsetViewportDom:null}),n.B.unbind(document,"mousemove",v),n.B.unbind(document,"mouseup",w))}this._canvas=o,this._elementRegistry=r,this._eventBus=i,this._injector=e,this._state={isOpen:void 0,isDragging:!1,initialDragPosition:null,offsetViewport:null,cachedViewbox:null,dragger:null,svgClientRect:null,parentClientRect:null,zoomDelta:0},this._minimapId=h.next(),this._init(),this.toggle(t&&t.open||!1),n.B.bind(this._viewportDom,"mousedown",_(!1)),n.B.bind(this._svg,"mousedown",_(!0)),n.B.bind(this._parent,"wheel",function(t){if(t.preventDefault(),t.stopPropagation(),t.ctrlKey&&((!s._state._svgClientRect||g(s._state._svgClientRect))&&(s._state._svgClientRect=s._svg.getBoundingClientRect()),n=s._state._svgClientRect,t.x>n.left&&t.x<n.left+n.width&&t.y>n.top&&t.y<n.top+n.height)){var e=0===t.deltaMode?.02:.32,i=-(Math.sqrt(Math.pow(t.deltaY,2)+Math.pow(t.deltaX,2))*u(t.deltaY)*e);if(s._state.zoomDelta+=i,Math.abs(s._state.zoomDelta)>.1){var n,a=Math.log(o.zoom())/Math.log(10),r=(Math.abs(Math.log(l.min)/Math.log(10))+Math.abs(Math.log(l.max)/Math.log(10)))/20,h=Math.round(a/r)*r,d=Math.pow(10,h+=r*(i>0?1:-1));o.zoom(Math.max(l.min,Math.min(l.max,d)),_),s._state.zoomDelta=0;var _=c({x:t.clientX-s._state._svgClientRect.left,y:t.clientY-s._state._svgClientRect.top},s._svg,s._lastViewbox);p(_,s._canvas),s._update()}}}),n.B.bind(this._toggle,"click",function(t){t.preventDefault(),t.stopPropagation(),s.toggle()}),i.on(["shape.added","connection.added"],function(t){var e=t.element;s._addElement(e),s._update()}),i.on(["shape.removed","connection.removed"],function(t){var e=t.element;s._removeElement(e),s._update()}),i.on("elements.changed",250,function(t){t.elements.forEach(function(t){s._updateElement(t)}),s._update()}),i.on("element.updateId",function(t){var e=t.element,i=t.newId;s._updateElementId(e,i)}),i.on("canvas.viewbox.changed",function(){s._state.isDragging||s._update()}),i.on("canvas.resized",function(){document.body.contains(s._parent)&&(s._state.isDragging||s._update(),s._state._svgClientRect=s._svg.getBoundingClientRect())}),i.on(["root.set","plane.set"],function(t){s._clear(),(t.element||t.plane.rootElement).children.forEach(function(t){s._addElement(t)}),s._update()})}function c(t,e,i){var n,o,r,s,h,l,d=e.getBoundingClientRect(),c=function(t,e){var i=t.width/t.height,n=(0,a.f0)({},{x:t.x,y:t.y,width:t.width,height:t.height});if(i>e){var o=n.width*(1/e),r=n.y-(o-n.height)/2;(0,a.f0)(n,{y:r,height:o})}else if(i<e){var s=n.height*e,h=n.x-(s-n.width)/2;(0,a.f0)(n,{x:h,width:s})}return n}(i,d.width/d.height);return{x:(n=t.x,o=d.width,r=c.x,(n-0)*(c.x+c.width-r)/(o-0)+r),y:(s=t.y,h=d.height,l=c.y,(s-0)*(c.y+c.height-l)/(h-0)+l)}}function p(t,e){var i=e.viewbox(),n=i.width,o=i.height;e.viewbox({x:t.x-n/2,y:t.y-o/2,width:n,height:o})}function _(t,e,i){var a,r=((a=(0,n.IO)(".children",e))||(a=(0,o.Ue)("g",{class:"children"}),(0,o.R3)(e,a)),a),s=[].slice.call(r.childNodes)[i];s?e.insertBefore(t,s.nextSibling):e.appendChild(t)}function g(t){return 0===t.width&&0===t.height}d.$inject=["config.minimap","injector","eventBus","canvas","elementRegistry"],d.prototype._init=function(){var t=this._canvas.getContainer(),e=this._parent=document.createElement("div");(0,n.Sh)(e).add("djs-minimap"),t.appendChild(e);var i=this._toggle=document.createElement("div");(0,n.Sh)(i).add("toggle"),e.appendChild(i);var a=this._map=document.createElement("div");(0,n.Sh)(a).add("map"),e.appendChild(a);var r=this._svg=(0,o.Ue)("svg");(0,o.Lj)(r,{width:"100%",height:"100%"}),(0,o.R3)(a,r);var s=this._elementsGroup=(0,o.Ue)("g");(0,o.R3)(r,s);var h=this._viewportGroup=(0,o.Ue)("g");(0,o.R3)(r,h);var l=this._viewport=(0,o.Ue)("rect");(0,o.Sh)(l).add("viewport"),(0,o.R3)(h,l),n.B.bind(e,"mousedown",function(t){t.stopPropagation()});var d=this._viewportDom=document.createElement("div");(0,n.Sh)(d).add("viewport-dom"),this._parent.appendChild(d);var c=this._overlay=document.createElement("div");(0,n.Sh)(c).add("overlay"),this._parent.appendChild(c)},d.prototype._update=function(){var t,e,i,n,r=this._canvas.viewbox(),s=r.inner,h=r.outer;if(function t(e){return(0,a.yW)(e,function(e){return(0,a.Kn)(e)?t(e):(0,a.hj)(e)&&isFinite(e)})}(r)){var l=h.width-s.width,d=h.height-s.height;s.width<h.width?(t=s.x-l/2,i=h.width,s.x+s.width<h.width&&(t=Math.min(0,s.x))):(t=s.x,i=s.width),s.height<h.height?(e=s.y-d/2,n=h.height,s.y+s.height<h.height&&(e=Math.min(0,s.y))):(e=s.y,n=s.height),t-=50,e-=50,i+=100,n+=100,this._lastViewbox={x:t,y:e,width:i,height:n},(0,o.Lj)(this._svg,{viewBox:t+", "+e+", "+i+", "+n}),(0,o.Lj)(this._viewport,{x:r.x,y:r.y,width:r.width,height:r.height});var c=this._state._parentClientRect=this._parent.getBoundingClientRect(),p=this._viewport.getBoundingClientRect(),_={top:p.top-c.top,left:p.left-c.left,width:p.width,height:p.height};(0,a.f0)(this._viewportDom.style,{top:_.top+"px",left:_.left+"px",width:_.width+"px",height:_.height+"px"});var g=f(c,_);(0,a.f0)(this._overlay.style,{clipPath:g})}},d.prototype.open=function(){(0,a.f0)(this._state,{isOpen:!0}),(0,n.Sh)(this._parent).add("open");var t=this._injector.get("translate",!1)||function(t){return t};(0,n.Lj)(this._toggle,"title",t("Close minimap")),this._update(),this._eventBus.fire("minimap.toggle",{open:!0})},d.prototype.close=function(){(0,a.f0)(this._state,{isOpen:!1}),(0,n.Sh)(this._parent).remove("open");var t=this._injector.get("translate",!1)||function(t){return t};(0,n.Lj)(this._toggle,"title",t("Open minimap")),this._eventBus.fire("minimap.toggle",{open:!1})},d.prototype.toggle=function(t){var e=this.isOpen();void 0===t&&(t=!e),t!=e&&(t?this.open():this.close())},d.prototype.isOpen=function(){return this._state.isOpen},d.prototype._updateElement=function(t){try{void 0!==t.parent&&null!==t.parent&&(this._removeElement(t),this._addElement(t))}catch(t){console.warn("Minimap#_updateElement errored",t)}},d.prototype._updateElementId=function(t,e){try{var i=(0,n.IO)("#"+(0,r.D)(this._prefixId(t.id)),this._elementsGroup);i&&(i.id=this._prefixId(e))}catch(t){console.warn("Minimap#_updateElementId errored",t)}},d.prototype.isOnActivePlane=function(t){var e=this._canvas;return e.findRoot?e.findRoot(t)===e.getRootElement():!e.findPlane||e.findPlane(t)===e.getActivePlane()},d.prototype._addElement=function(t){var e,i,a,s=this;if(this._removeElement(t),this.isOnActivePlane(t)){var h=this._createElement(t),l=(0,n.IO)("#"+(0,r.D)(this._prefixId(t.parent.id)),this._elementsGroup);if(h){var d=function(t,e){var i=(0,n.IO)(".djs-children",e.parentNode);if(i){var o=[].slice.call(i.childNodes),a=-1;return o.forEach(function(e,i){(0,n.IO)(".djs-element",e)===t&&(a=i)}),a}}(this._elementRegistry.getGraphics(t),this._elementRegistry.getGraphics(t.parent));return"undefined"!==d&&l?l.childNodes.length>d?_(h,l,d):_(h,l,l.childNodes.length-1):this._elementsGroup.appendChild(h),t.waypoints?(e=t.parent,i=0,a=0,void 0!==e.x&&void 0!==e.y&&(i=-e.x,a=-e.y)):(i=t.x,a=t.y,l&&(i-=(e=t.parent).x,a-=e.y)),(0,o.Lj)(h,{transform:"translate("+i+" "+a+")"}),t.children&&t.children.length&&t.children.forEach(function(t){s._addElement(t)}),h}}},d.prototype._removeElement=function(t){var e=this._svg.getElementById(this._prefixId(t.id));e&&(0,o.Od)(e)},d.prototype._createElement=function(t){var e,i=this._elementRegistry.getGraphics(t);if(i&&(e=(0,s.s)(i))){var a,r=(a=(0,o.d9)(e),(0,n.Kt)("[id]",a).forEach(function(t){t.remove()}),a);return(0,o.Lj)(r,{id:this._prefixId(t.id)}),r}},d.prototype._clear=function(){(0,o.ZH)(this._elementsGroup)},d.prototype._prefixId=function(t){return"djs-minimap-"+t+"-"+this._minimapId};var u=Math.sign||function(t){return t>=0?1:-1};function f(t,e){return"polygon("+[v(e.left,e.top),v(e.left+e.width,e.top),v(e.left+e.width,e.top+e.height),v(e.left,e.top+e.height),v(e.left,t.height),v(t.width,t.height),v(t.width,0),v(0,0),v(0,t.height),v(e.left,t.height)].join(", ")+")"}function v(t,e){return t+"px "+e+"px"}function m(t){return t.center?t.center:{x:t.clientX,y:t.clientY}}var w={__init__:["minimap"],minimap:["type",d]}},5694:function(t,e,i){function n(t){return CSS.escape(t)}i.d(e,{D:function(){return n},r:function(){return a}});var o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function a(t){return(t=""+t)&&t.replace(/[&<>"']/g,function(t){return o[t]})}},2722:function(t,e,i){function n(t){return t.childNodes[0]}function o(t){return t.parentNode.childNodes[1]}i.d(e,{G:function(){return o},s:function(){return n}})},725:function(t,e,i){function n(t){this._counter=0,this._prefix=(t?t+"-":"")+Math.floor(1e9*Math.random())+"-"}i.d(e,{Z:function(){return n}}),n.prototype.next=function(){return this._prefix+ ++this._counter}}}]);